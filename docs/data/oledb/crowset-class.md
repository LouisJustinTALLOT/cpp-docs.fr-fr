---
title: CRowset, classe | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAll
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
dev_langs:
- C++
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: d65f9c7c796724a77935693690ac73357867dab0
ms.sourcegitcommit: b217daee32d3413cf33753d9b4dc35a0022b1bfa
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/24/2018
ms.locfileid: "39233514"
---
# <a name="crowset-class"></a>CRowset, classe
Encapsule un objet d’ensemble de lignes OLE DB et plusieurs liées interfaces et fournit des méthodes de manipulation pour les données de l’ensemble de lignes.  
  
## <a name="syntax"></a>Syntaxe

```cpp
template <class TAccessor = CAccessorBase>  
class CRowset  
```  
  
#### <a name="parameters"></a>Paramètres  
 *TAccessor*  
 Classe d’accesseur. La valeur par défaut est `CAccessorBase`.  
  
## <a name="requirements"></a>Configuration requise  
 **En-tête :** atldbcli.h  

## <a name="members"></a>Membres  
  
### <a name="methods"></a>Méthodes  
  
|||  
|-|-|  
|[AddRefRows](#addrefrows)|Incrémente le décompte de références associé à la ligne actuelle.|  
|[Fermer](#close)|Libère les lignes et en cours `IRowset` interface.|  
|[Compare](#compare)|Compare deux crée des signets à l’aide de [IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx).|  
|[CRowset](#crowset)|Crée un `CRowset` de l’objet et l’associe (éventuellement) une `IRowset` interface fournie en tant que paramètre.|  
|[Supprimer](#delete)|Supprime des lignes de l’ensemble de lignes à l’aide [IRowsetChange:DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx).|  
|[FindNextRow](#findnextrow)|Recherche la ligne correspondante suivante après le signet spécifié.|  
|[GetApproximatePosition](#getapproximateposition)|Retourne la position approximative d’une ligne correspondant à un signet.|  
|[GetData](#getdata)|Récupère les données à partir de la copie de l’ensemble de lignes de la ligne.|  
|[GetDataHere](#getdatahere)|Récupère les données à partir de la mémoire tampon spécifiée.|  
|[GetOriginalData](#getoriginaldata)|Récupère les données récemment extraite ou transmise à la source de données, en ignorant les modifications en attente.|  
|[GetRowStatus](#getrowstatus)|Retourne l’état de toutes les lignes.|  
|[Insert](#insert)|Crée et insère une nouvelle ligne à l’aide [IRowsetChange:InsertRow](https://msdn.microsoft.com/library/ms716921.aspx).|  
|[IsSameRow](#issamerow)|Compare la ligne spécifiée avec la ligne actuelle.|  
|[MoveFirst](#movefirst)|Repositionne l’emplacement de récupération suivant à la position initiale.|  
|[MoveLast](#movelast)|Passe au dernier enregistrement.|  
|[MoveNext](#movenext)|Extrait les données à partir de la ligne suivante séquentielle ou un nombre spécifié de positions au-delà de la ligne suivante.|  
|[MovePrev](#moveprev)|Se déplace vers l’enregistrement précédent.|  
|[MoveToBookmark](#movetobookmark)|Extrait la ligne marquée par un signet ou la ligne à l’offset spécifié à partir de ce signet.|  
|[MoveToRatio](#movetoratio)|Extrait les lignes à partir d’un emplacement de fractions de seconde dans l’ensemble de lignes.|  
|[ReleaseRows](#releaserows)|Appels [IRowset::ReleaseRows](https://msdn.microsoft.com/library/ms719771.aspx) pour libérer le handle de ligne actuelle.|  
|[SetData](#setdata)|Définit les valeurs de données dans une ou plusieurs colonnes d’une ligne en utilisant [IRowsetChange:SetData](https://msdn.microsoft.com/library/ms721232.aspx).|  
|[Annulation](#undo)|Annule toutes les modifications apportées à une ligne depuis la dernière extraction ou [mise à jour](../../data/oledb/crowset-update.md).|  
|[Mettre à jour](#update)|Transmet les modifications apportées à la ligne en cours depuis la dernière extraction ou de la mise à jour en attente.|  
|[UpdateAll](#updateall)|Transmet les modifications apportées à toutes les lignes depuis la dernière extraction ou de la mise à jour en attente.|  
  
## <a name="remarks"></a>Notes  
 Dans OLE DB, un ensemble de lignes est l’objet par le biais duquel un programme définit et récupère des données.  
  
 Cette classe n’est pas destinée à être instanciée mais plutôt passé comme paramètre de modèle à `CTable` ou `CCommand` (`CRowset` est la valeur par défaut).  

## <a name="addrefrows"></a> CRowset::AddRefRows
Appels [IRowset::AddRefRows](https://msdn.microsoft.com/library/ms719619.aspx) d’incrémentation (1) le décompte de références associé avec le descripteur de ligne actuelle.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT AddRefRows() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode incrémente le décompte de références pour le handle de ligne actuelle. Appelez [ReleaseRows](../../data/oledb/crowset-releaserows.md) pour décrémenter le décompte. Lignes retournées par les méthodes de déplacement ont un nombre de références d’un.  

## <a name="close"></a> CRowset::Close
Libère les lignes et en cours [IRowset](https://msdn.microsoft.com/library/ms720986.aspx) interface.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
void Close() throw();  
  
```  
  
### <a name="remarks"></a>Notes  
 Cette méthode libère toutes les lignes actuellement dans l’ensemble de lignes.  

## <a name="compare"></a> CRowset::Compare
Compare deux crée des signets à l’aide de [IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx).  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,   
   const CBookmarkBase& bookmark2,   
   DBCOMPARE* pComparison) const throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *Bookmark1*  
 [in] Le premier signet à comparer.  
  
 *Bookmark2*  
 [in] Le deuxième signet à comparer.  
  
 *pComparison*  
 [out] Pointeur vers le résultat de la comparaison.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetLocate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetLocate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 Pour plus d’informations sur l’utilisation de signets dans des consommateurs, consultez [à l’aide de signets](../../data/oledb/using-bookmarks.md).  

## <a name="crowset"></a> CRowset::CRowset
Crée un `CRowset` de l’objet et l’associe (éventuellement) une [IRowset](https://msdn.microsoft.com/library/ms720986.aspx) interface fournie en tant que paramètre.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
      CRowset();   

CRowset(IRowset* pRowset);  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pRowset*  
 [in] Un pointeur vers un `IRowset` interface à associer à cette classe.  

## <a name="delete"></a> CRowset::Delete
Appels [IRowsetChange::DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx) pour supprimer la ligne actuelle de l’ensemble de lignes.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT Delete() const throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  

## <a name="findnextrow"></a> CRowset::FindNextRow
Recherche la ligne correspondante suivante après le signet spécifié.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT FindNextRow(DBCOMPAREOP op,   
  BYTE* pData,   
   DBTYPE wType,   
   DBLENGTH nLength,   
   BYTE bPrecision,   
   BYTE bScale,   
   BOOL bSkipCurrent = TRUE,   
   CBookmarkBase* pBookmark = NULL) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *Op*  
 [in] L’opération à utiliser pour comparer les valeurs de ligne. Pour les valeurs, consultez [IRowsetFind::FindNextRow](https://msdn.microsoft.com/library/ms723091.aspx).  
  
 *pData*  
 [in] Pointeur vers la valeur à mettre en correspondance.  
  
 *wType*  
 [in] Indique le type de données de la partie de la valeur de la mémoire tampon. Pour plus d’informations sur les indicateurs de type, consultez [Types de données](https://msdn.microsoft.com/library/ms723969.aspx) dans le *de référence du programmeur OLE DB* dans le SDK Windows.  
  
 *nLength*  
 [in] La longueur, en octets, de la structure de données de consommateur allouée pour la valeur de données. Pour plus d’informations, consultez la description de `cbMaxLen` dans [Structures DBBINDING](https://msdn.microsoft.com/library/ms716845.aspx) dans le *de référence du programmeur OLE DB.*  
  
 *bPrecision*  
 [in] La précision maximale utilisée lors de l’obtention des données. Utilisé uniquement si *wType* est DBTYPE_NUMERIC. Pour plus d’informations, consultez [Conversions impliquant DBTYPE_NUMERIC ou DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx) dans le *de référence du programmeur OLE DB*.  
  
 *bScale*  
 [in] L’échelle utilisée lors de l’obtention des données. Utilisé uniquement si *wType* soit DBTYPE_NUMERIC DBTYPE_DECIMAL. Pour plus d’informations, consultez [Conversions impliquant DBTYPE_NUMERIC ou DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx) dans le *de référence du programmeur OLE DB*.  
  
 *bSkipCurrent*  
 [in] Le nombre de lignes à partir du signet à partir duquel commencer une recherche.  
  
 *pBookmark*  
 [in] Le signet de position à laquelle démarrer une recherche.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetFind`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetFind` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 Pour plus d’informations sur l’utilisation de signets dans des consommateurs, consultez [à l’aide de signets](../../data/oledb/using-bookmarks.md).  

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition
Retourne la position approximative d’une ligne correspondant à un signet.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,   
   DBCOUNTITEM* pPosition,   
   DBCOUNTITEM* pcRows) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pBookmark*  
 [in] Pointeur vers un signet qui identifie la ligne dont la position doit être trouvé. NULL si seul le nombre de lignes est requis.  
  
 *pPosition*  
 [out] Un pointeur vers l’emplacement où `GetApproximatePosition` retourne la position de la ligne. NULL si la position n’est pas obligatoire.  
  
 *pcRows*  
 [out] Un pointeur vers l’emplacement où `GetApproximatePosition` retourne le nombre total de lignes. NULL si le nombre de lignes n’est pas obligatoire.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetScroll`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetScroll` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 Pour plus d’informations sur l’utilisation de signets dans des consommateurs, consultez [à l’aide de signets](../../data/oledb/using-bookmarks.md).  

## <a name="getdata"></a> CRowset::GetData
Récupère les données à partir de la copie de l’ensemble de lignes de la ligne.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT GetData() throw();   


HRESULT GetData(int nAccessor) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *nAccessor*  
 [in] Le numéro d’index (décalage de zéro) de l’accesseur à utiliser pour accéder aux données.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Si vous spécifiez un accesseur qui n’est pas un auto-accesseur dans [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), cette méthode permet d’obtenir explicitement les données en transmettant le numéro de l’accesseur.  

## <a name="getdatahere"></a> CRowset::GetDataHere
Récupère les données à partir de la ligne actuelle et le place dans la mémoire tampon spécifiée.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT GetDataHere(int nAccessor,   
  void* pBuffer) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *nAccessor*  
 [in] Le numéro d’index de l’accesseur à utiliser pour accéder aux données.  
  
 *pBuffer*  
 [out] Une mémoire tampon dans laquelle placer les données de l’enregistrement actuel.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Pour obtenir un exemple montrant comment utiliser cette fonction, consultez le [exemple MultiRead](../../visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData
Appels `IRowsetUpdate::GetOriginalData` pour récupérer les données récemment extraite ou transmise à la source de données.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT GetOriginalData() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode récupère les données extraites le plus récemment à partir d’ou transmise à la source de données ; elle ne récupère pas les valeurs en fonction des modifications en attente.  
  
 Cette méthode requiert l’interface facultative `IRowsetUpdate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes. 

## <a name="getrowstatus"></a> CRowset::GetRowStatus
Retourne l’état de toutes les lignes.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pStatus*  
 [out] Un pointeur vers un emplacement où `GetRowStatus` retourne la valeur d’état. Consultez DBPENDINGSTATUS dans la référence du programmeur OLE DB.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetUpdate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.   

## <a name="insert"></a> CRowset::Insert
Crée et initialise une nouvelle ligne à l’aide de données à partir de l’accesseur.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT Insert(int nAccessor = 0,   
   bool bGetHRow = false) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *nAccessor*  
 [in] Le numéro de l’accesseur à utiliser pour insérer les données.  
  
 *bGetHRow*  
 [in] Indique si le handle de la ligne insérée est extraite.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetChange`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetChange` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 Insertion peut échouer si une ou plusieurs colonnes n’est pas accessible en écriture. Modifier le mappage de votre curseur pour corriger ce problème.  
  
### <a name="example"></a>Exemple  
 L’exemple suivant montre comment accéder à une source de données via un ensemble de lignes, puis insérez une chaîne à l’aide d’une table dans cet ensemble de lignes.  
  
 Tout d’abord, créez une classe de table en insérant un nouvel objet ATL dans votre projet. Par exemple, cliquez sur le projet dans le volet espace de travail et sélectionnez **nouvel objet ATL**. À partir de la **accès aux données** catégorie, sélectionnez **consommateur**. Créer un objet du consommateur de type **Table**. (En sélectionnant **Table** crée un ensemble de lignes directement à partir de la table ; sélection **commande** crée un ensemble de lignes via une commande SQL.) Sélectionnez une source de données, en spécifiant une table par le biais duquel pour accéder à cette source de données. Si vous appelez votre objet consommateur **CCustomerTable**, vous implémentez ensuite votre code d’insertion comme suit :  
  
 [!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]  

## <a name="issamerow"></a> CRowset::IsSameRow
Compare la ligne spécifiée avec la ligne actuelle.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT IsSameRow(HROW hRow) const throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *hRow*  
 [in] Handle vers la ligne à comparer à la ligne actuelle.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard. S_OK indique les lignes sont les mêmes. Pour les autres valeurs, consultez [IRowsetIndentity::IsSameRow](https://msdn.microsoft.com/library/ms719629.aspx) dans le *de référence du programmeur OLE DB* dans le SDK Windows.  

## <a name="movefirst"></a> CRowset::MoveFirst
Déplace le curseur à la position initiale et récupère la ligne initiale.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MoveFirst() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Appels [IRowset::RestartPosition](https://msdn.microsoft.com/library/ms712877.aspx) à repositionner l’emplacement de récupération suivant à la position initiale (la position qui était l’emplacement suivant-extraction lors de la création de l’ensemble de lignes) et récupère la ligne initiale.  

## <a name="movelast"></a> CRowset::MoveLast
Déplace le curseur vers la dernière ligne.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MoveLast() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Appels [IRowset::RestartPosition](https://msdn.microsoft.com/library/ms712877.aspx) à repositionner l’emplacement de récupération suivant à la dernière position et récupère la dernière ligne.  
  
 Cette méthode requiert que vous définissez `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes. (Pour de meilleures performances, vous pouvez également définir `DBPROP_QUICKRESTART` avec la valeur VARIANT_TRUE.)  

## <a name="movenext"></a> CRowset::MoveNext
Déplace le curseur à l’enregistrement suivant.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MoveNext() throw();HRESULT MoveNext(LONG lSkip,   
   bool bForward= true) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *lSkip*  
 [in] Le nombre de lignes à ignorer avant l’extraction.  
  
 *bForward*  
 [in] Passer **true** d’avancer jusqu'à l’enregistrement suivant, **false** à déplacer vers le haut.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard. Lorsque la fin de l’ensemble de lignes a été atteinte, retourne DB_S_ENDOFROWSET.  
  
### <a name="remarks"></a>Notes  
 Extrait la ligne séquentielle suivante à partir de la `CRowset` objet, en mémorisant la position précédente. Si vous le souhaitez, vous pouvez choisir de passer directement *lSkip* lignes ou en arrière.  
  
 Cette méthode requiert que vous définissez les propriétés suivantes avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes :  
  
-   `DBPROP_CANSCROLLBACKWARDS` doit être VARIANT_TRUE si *lSkip* < 0  
  
-   `DBPROP_CANFETCHBACKWARDS` doit être VARIANT_TRUE si *bForward* = false  
  
 Dans le cas contraire (si *lSkip* > = 0 et *bForward* = true), vous n’avez pas besoin de définir des propriétés supplémentaires.  

## <a name="moveprev"></a> CRowset::MovePrev
Déplace le curseur à l’enregistrement précédent.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MovePrev() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert que vous définissez soit `DBPROP_CANFETCHBACKWARDS` ou `DBPROP_CANSCROLLBACKWARDS` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes. 

## <a name="movetobookmark"></a> CRowset::MoveToBookmark
Extrait la ligne marquée par un signet ou la ligne à l’offset spécifié (*lSkip*) à partir de ce signet.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,   
   LONG lSkip = 0) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *Signet*  
 [in] Un signet est l’emplacement à partir duquel vous souhaitez extraire des données.  
  
 *lSkip*  
 [in] Le nombre de lignes à partir du signet à la ligne cible. Si *lSkip* est égal à zéro, la première ligne extraite est la ligne marquée par un signet. Si *lSkip* est 1, la première ligne extraite est la ligne après la ligne marquée par un signet. Si *lSkip* est -1, la première ligne extraite est la ligne avant la ligne marquée par un signet.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetLocate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetLocate` sur VARIANT_TRUE et `DBPROP_CANFETCHBACKWARDS` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 Pour plus d’informations sur l’utilisation de signets dans des consommateurs, consultez [à l’aide de signets](../../data/oledb/using-bookmarks.md).  
  
## <a name="movetoratio"></a> CRowset::MoveToRatio
Extrait les lignes à partir d’un emplacement de fractions de seconde dans l’ensemble de lignes.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,   
   DBCOUNTITEM nDenominator,bool bForward = true) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *nNumerator*  
 [in] Le numérateur permet de déterminer les fractions de seconde positionnels à partir de laquelle extraire des données.  
  
 *nDenominator*  
 [in] Le dénominateur permet de déterminer les fractions de seconde positionnels à partir de laquelle extraire des données.  
  
 *bForward*  
 [in] Indique s’il faut avancer ou reculer. La valeur par défaut est simple.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 `MoveToRatio` extrait les lignes selon à peu près à la formule suivante :  
  
 `(nNumerator *  RowsetSize ) / nDenominator`  
  
 Où `RowsetSize` est la taille de l’ensemble de lignes, mesurée en lignes. La précision de cette formule varie selon le fournisseur spécifique. Pour plus d’informations, consultez [IRowsetScroll::GetRowsAtRatio](https://msdn.microsoft.com/library/ms709602.aspx).  
  
 Cette méthode requiert l’interface facultative `IRowsetScroll`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetScroll` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  

## <a name="releaserows"></a> CRowset::ReleaseRows
Appels [IRowset::ReleaseRows](https://msdn.microsoft.com/library/ms719771.aspx) pour libérer le handle de ligne actuelle.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT ReleaseRows() throw();  
  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  

## <a name="setdata"></a> CRowset::SetData
Définit les valeurs de données dans une ou plusieurs colonnes d’une ligne.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT SetData() const throw();   


HRESULT SetData(int nAccessor) const throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *nAccessor*  
 [in] Le numéro de l’accesseur à utiliser pour accéder aux données.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Pour le `SetData` formulaire qui accepte aucun argument, tous les utilisateurs connectés sont utilisés pour la mise à jour. Vous appelez généralement `SetData` pour définir les valeurs de données dans les colonnes dans une ligne, puis appelez [mise à jour](../../data/oledb/crowset-update.md) pour transmettre ces modifications.  
  
 Cette méthode requiert l’interface facultative `IRowsetChange`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetChange` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
 L’opération de configuration peut échouer si une ou plusieurs colonnes n’est pas accessible en écriture. Modifier le mappage de votre curseur pour corriger ce problème. 
  
## <a name="undo"></a> CRowset::Undo
Annule toutes les modifications apportées à une ligne depuis la dernière extraction ou [mise à jour](../../data/oledb/crowset-update.md).  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pcRows*  
 [out] Un pointeur vers l’emplacement où `Undo` retourne le nombre de lignes, elle a tenté d’annuler si nécessaire.  
  
 *phRow*  
 [out] Un pointeur vers l’emplacement où `Undo` retourne un tableau de handles pour toutes les lignes, elle a tenté d’annuler si nécessaire.  
  
 *pStatus*  
 [out] Un pointeur vers l’emplacement où `Undo` retourne la valeur d’état de ligne. Aucun état n’est retournée si *pStatus* a la valeur null.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Cette méthode requiert l’interface facultative `IRowsetUpdate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  

## <a name="update"></a> CRowset::Update
Transmet toutes les modifications apportées à la ligne actuelle depuis la dernière extraction ou `Update` appeler sur celle-ci.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pcRows*  
 [out] Un pointeur vers l’emplacement où `Update` retourne le nombre de lignes, elle a tenté de mettre à jour, si nécessaire.  
  
 *phRow*  
 [out] Un pointeur vers l’emplacement où `Update` retourne le handle de la ligne, elle a tenté de mettre à jour. Aucun handle n’est retournée si *phRow* a la valeur null.  
  
 *pStatus*  
 [out] Un pointeur vers l’emplacement où `Update` retourne la valeur d’état de ligne. Aucun état n’est retournée si *pStatus* a la valeur null.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  
  
### <a name="remarks"></a>Notes  
 Transmet les modifications apportées à la ligne actuelle dans la mesure où cette ligne dernière extraction ou mis à jour en attente (à l’aide de `Update` ou [UpdateAll](../../data/oledb/crowset-updateall.md)). Vous appelez généralement [SetData](../../data/oledb/crowset-setdata.md) pour définir les valeurs de données dans les colonnes dans une ligne, puis appelez `Update` pour transmettre ces modifications.  
  
 Cette méthode requiert l’interface facultative `IRowsetUpdate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  

## <a name="updateall"></a> CRowset::UpdateAll
Transmet toutes les modifications apportées à toutes les lignes depuis la dernière extraction ou `Update` appeler sur celle-ci.  
  
### <a name="syntax"></a>Syntaxe  
  
```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,   
   HROW** pphRow = NULL,   
   DBROWSTATUS** ppStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>Paramètres  
 *pcRows*  
 [out] Un pointeur vers l’emplacement où `UpdateAll` retourne le nombre de lignes, elle a tenté de mettre à jour, si nécessaire.  
  
 *pphRow*  
 [out] Pointeur vers la mémoire dans lequel `UpdateAll` retourne le handle de la ligne, elle a tenté de mettre à jour. Aucun handle n’est retournée si *pphRow* a la valeur null.  
  
 *ppStatus*  
 [out] Un pointeur vers l’emplacement où `Update` retourne la valeur d’état de ligne. Aucun état n’est retournée si *ppStatus* a la valeur null.  
  
### <a name="remarks"></a>Notes  
 Transmet toutes les modifications apportées à toutes les lignes dans la mesure où ces lignes ont été dernière extraction ou mis à jour à l’aide de [mise à jour](../../data/oledb/crowset-update.md) ou `UpdateAll`. `UpdateAll` met à jour chaque ligne qui a été modifié, que vous ayez toujours le handle pour eux (consultez *pphRow*) ou non.  
  
 Par exemple, si vous avez utilisé `Insert` pour insérer cinq lignes dans un ensemble de lignes, vous pouvez appeler `Update` cinq fois ou appel `UpdateAll` une fois tous les mettre à jour.  
  
 Cette méthode requiert l’interface facultative `IRowsetUpdate`, qui ne peut pas être pris en charge sur tous les fournisseurs ; si ce n’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` VARIANT_TRUE avant d’appeler `Open` sur la table ou d’une commande qui contient l’ensemble de lignes.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur HRESULT standard.  

## <a name="see-also"></a>Voir aussi  
 [Exemple DBVIEWER](../../visual-cpp-samples.md)   
 [Exemple multiRead](../../visual-cpp-samples.md)   
 [Attributs multiRead](../../visual-cpp-samples.md)   
 [Modèles du consommateur OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)   
 [Référence des modèles du consommateur OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)