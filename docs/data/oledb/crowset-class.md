---
title: CRowset, classe
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 2be4cb1936536b68aed1f8ea937f6f72904c766d
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/27/2020
ms.locfileid: "87221521"
---
# <a name="crowset-class"></a>CRowset, classe

Encapsule un objet d’ensemble de lignes OLE DB et plusieurs interfaces connexes et fournit des méthodes de manipulation pour les données de l’ensemble de lignes.

## <a name="syntax"></a>Syntaxe

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Paramètres

*TAccessor*<br/>
Classe d’accesseur. Par défaut, il s’agit de `CAccessorBase`.

## <a name="requirements"></a>Spécifications

**En-tête :** atldbcli.h

## <a name="members"></a>Membres

### <a name="methods"></a>Méthodes

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrémente le nombre de références associé à la ligne actuelle.|
|[Close](#close)|Libère les lignes et l' `IRowset` interface actuelle.|
|[Compare](#compare)|Compare deux signets à l’aide de [IRowsetLocate :: compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Crée un `CRowset` objet et (éventuellement) l’associe à une `IRowset` interface fournie en tant que paramètre.|
|[Supprimer](#delete)|Supprime des lignes de l’ensemble de lignes à l’aide de [IRowsetChange : DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Recherche la ligne correspondante suivante après le signet spécifié.|
|[GetApproximatePosition](#getapproximateposition)|Retourne la position approximative d’une ligne correspondant à un signet.|
|[GetData](#getdata)|Récupère des données de la copie du jeu de lignes de la ligne.|
|[GetDataHere](#getdatahere)|Récupère des données de la mémoire tampon spécifiée.|
|[GetOriginalData](#getoriginaldata)|Récupère les données récemment extraites ou transmises à la source de données, en ignorant les modifications en attente.|
|[GetRowStatus](#getrowstatus)|Retourne l’état de toutes les lignes.|
|[Insérer](#insert)|Crée et insère une nouvelle ligne à l’aide de [IRowsetChange : InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Compare la ligne spécifiée à la ligne actuelle.|
|[MoveFirst](#movefirst)|Repositionne l’emplacement d’extraction suivante à la position initiale.|
|[MoveLast](#movelast)|Passe au dernier enregistrement.|
|[MoveNext](#movenext)|Extrait des données de la ligne suivante ou d’un nombre spécifié de positions au-delà de la ligne suivante.|
|[MovePrev](#moveprev)|Passe à l’enregistrement précédent.|
|[MoveToBookmark](#movetobookmark)|Extrait la ligne marquée par un signet ou la ligne à un décalage spécifié à partir de ce signet.|
|[MoveToRatio](#movetoratio)|Extrait des lignes à partir d’une position fractionnaire dans l’ensemble de lignes.|
|[ReleaseRows](#releaserows)|Appelle [IRowset :: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) pour libérer le handle de ligne actuel.|
|[SetData](#setdata)|Définit des valeurs de données dans une ou plusieurs colonnes d’une ligne à l’aide de [IRowsetChange : SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Annuler](#undo)|Annule toutes les modifications apportées à une ligne depuis la dernière extraction ou [mise à jour](../../data/oledb/crowset-update.md).|
|[Mettre à jour](#update)|Transmet toutes les modifications en attente apportées à la ligne actuelle depuis la dernière extraction ou mise à jour.|
|[UpdateAll](#updateall)|Transmet toutes les modifications en attente apportées à toutes les lignes depuis la dernière extraction ou mise à jour.|

## <a name="remarks"></a>Notes

Dans OLE DB, un ensemble de lignes est l’objet par le biais duquel un programme définit et récupère des données.

Cette classe n’est pas destinée à être instanciée mais passée comme paramètre de modèle à `CTable` ou `CCommand` ( `CRowset` est la valeur par défaut).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset :: AddRefRows

Appelle [IRowset :: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) pour incrémenter (d’un) le nombre de références associé au handle de ligne actuel.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode incrémente le décompte de références pour le handle de ligne actuel. Appelez [ReleaseRows](../../data/oledb/crowset-releaserows.md) pour décrémenter le nombre. Les lignes retournées par les méthodes Move ont un décompte de références d’un.

## <a name="crowsetclose"></a><a name="close"></a>CRowset :: Close

Libère les lignes et l’interface [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) actuelle.

### <a name="syntax"></a>Syntaxe

```cpp
void Close() throw();
```

### <a name="remarks"></a>Notes

Cette méthode libère toutes les lignes présentes dans l’ensemble de lignes.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset :: compare

Compare deux signets à l’aide de [IRowsetLocate :: compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Paramètres

*Signet1*<br/>
dans Premier signet à comparer.

*Signet2*<br/>
dans Deuxième signet à comparer.

*pComparison*<br/>
à Pointeur vers le résultat de la comparaison.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetLocate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetLocate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

Pour plus d’informations sur l’utilisation des signets dans les consommateurs, consultez [utilisation de signets](../../data/oledb/using-bookmarks.md).

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset :: CRowset

Crée un `CRowset` objet et (éventuellement) l’associe à une interface [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) fournie en tant que paramètre.

### <a name="syntax"></a>Syntaxe

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Paramètres

*pRowset*<br/>
dans Pointeur vers une `IRowset` interface à associer à cette classe.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset ::D supprim

Appelle [IRowsetChange ::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) pour supprimer la ligne actuelle de l’ensemble de lignes.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset :: FindNextRow

Recherche la ligne correspondante suivante après le signet spécifié.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Paramètres

*opérationnel*<br/>
dans Opération à utiliser pour comparer les valeurs de ligne. Pour obtenir les valeurs, consultez [IRowsetFind :: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
dans Pointeur vers la valeur à mettre en correspondance.

*wType*<br/>
dans Indique le type de données de la partie valeur de la mémoire tampon. Pour plus d’informations sur les indicateurs de type, consultez [types de données](/previous-versions/windows/desktop/ms723969(v=vs.85)) dans le *OLE DB Guide de référence du programmeur* dans le SDK Windows.

*nLength*<br/>
dans Longueur, en octets, de la structure de données de consommateur allouée pour la valeur de données. Pour plus d’informations, consultez la description de `cbMaxLen` dans les [structures DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) dans le *Guide de référence du programmeur OLE DB.*

*bPrecision*<br/>
dans Précision maximale utilisée pour obtenir des données. Utilisé uniquement si *wType* est DBTYPE_NUMERIC. Pour plus d’informations, consultez [conversions impliquant DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) dans le *Guide de référence du programmeur OLE DB*.

*bScale*<br/>
dans Échelle utilisée lors de l’obtention de données. Utilisé uniquement si *wType* est DBTYPE_NUMERIC ou DBTYPE_DECIMAL. Pour plus d’informations, consultez [conversions impliquant DBTYPE_NUMERIC ou DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) dans le *Guide de référence du programmeur OLE DB*.

*bSkipCurrent*<br/>
dans Nombre de lignes du signet à partir desquelles démarrer une recherche.

*pBookmark*<br/>
dans Signet de position à laquelle démarrer une recherche.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetFind` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetFind` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

Pour plus d’informations sur l’utilisation des signets dans les consommateurs, consultez [utilisation de signets](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset :: GetApproximatePosition

Retourne la position approximative d’une ligne correspondant à un signet.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Paramètres

*pBookmark*<br/>
dans Pointeur vers un signet qui identifie la ligne dont la position doit être recherchée. NULL si seul le nombre de lignes est requis.

*pPosition*<br/>
à Pointeur vers l’emplacement où `GetApproximatePosition` retourne la position de la ligne. NULL si la position n’est pas requise.

*pcRows*<br/>
à Pointeur vers l’emplacement où `GetApproximatePosition` retourne le nombre total de lignes. NULL si le nombre de lignes n’est pas requis.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetScroll` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetScroll` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

Pour plus d’informations sur l’utilisation des signets dans les consommateurs, consultez [utilisation de signets](../../data/oledb/using-bookmarks.md).

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset :: GetData

Récupère des données de la copie du jeu de lignes de la ligne.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Paramètres

*nAccessor*<br/>
dans Numéro d’index (offset zéro) de l’accesseur à utiliser pour accéder aux données.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Si vous spécifiez un accesseur qui n’est pas un autoaccesseur dans [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), utilisez cette méthode pour récupérer explicitement les données en passant le numéro d’accesseur.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset :: GetDataHere

Récupère des données de la ligne actuelle et les place dans la mémoire tampon spécifiée.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Paramètres

*nAccessor*<br/>
dans Numéro d’index de l’accesseur à utiliser pour accéder aux données.

*pBuffer*<br/>
à Mémoire tampon dans laquelle placer les données de l’enregistrement en cours.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Pour obtenir un exemple d’utilisation de cette fonction, consultez l' [exemple MultiRead](../../overview/visual-cpp-samples.md).

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset :: GetOriginalData

Appelle `IRowsetUpdate::GetOriginalData` pour récupérer les données récemment extraites ou transmises à la source de données.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode récupère les données récemment extraites de la source de données ou transmises à celle-ci ; elle ne récupère pas les valeurs en fonction des modifications en attente.

Cette méthode requiert l’interface facultative `IRowsetUpdate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset :: GetRowStatus

Retourne l’état de toutes les lignes.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Paramètres

*pStatus*<br/>
à Pointeur vers un emplacement où `GetRowStatus` retourne la valeur d’État. Consultez DBPENDINGSTATUS dans le Guide de référence du programmeur OLE DB.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetUpdate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset :: Insert

Crée et Initialise une nouvelle ligne à l’aide des données de l’accesseur.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Paramètres

*nAccessor*<br/>
dans Numéro de l’accesseur à utiliser pour insérer les données.

*bGetHRow*<br/>
dans Indique si le handle de la ligne insérée est récupéré.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetChange` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetChange` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

L’insertion peut échouer si une ou plusieurs colonnes ne sont pas accessibles en écriture. Modifier le mappage de votre curseur pour corriger ce problème.

### <a name="example"></a>Exemple

L’exemple suivant montre comment accéder à une source de données via un ensemble de lignes, puis insérer une chaîne à l’aide d’une table de cet ensemble de lignes.

Tout d’abord, créez une classe de table en insérant un nouvel objet ATL dans votre projet. Par exemple, cliquez avec le bouton droit sur le projet dans le volet espace de travail, puis sélectionnez **nouvel objet ATL**. Dans la catégorie **accès aux données** , sélectionnez **consommateur**. Créez un objet de consommateur de type **table**. (La sélection de la **table** crée un ensemble de lignes directement à partir de la table ; la sélection de la **commande** crée un ensemble de lignes à l’aide d’une commande SQL.) Sélectionnez une source de données, en spécifiant une table via laquelle accéder à cette source de données. Si vous appelez votre objet de consommateur **CCustomerTable**, vous devez implémenter votre code d’insertion comme suit :

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset :: IsSameRow

Compare la ligne spécifiée à la ligne actuelle.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Paramètres

*Fère*<br/>
dans Handle vers la ligne à comparer à la ligne actuelle.

### <a name="return-value"></a>Valeur de retour

HRESULT standard. S_OK indique que les lignes sont identiques. Pour les autres valeurs, consultez [IRowsetIndentity :: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) dans le *Guide de référence du programmeur OLE DB* dans le SDK Windows.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset :: MoveFirst

Déplace le curseur à la position initiale et récupère la ligne initiale.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Appelle [IRowset :: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) pour repositionner l’emplacement d’extraction suivante à la position initiale (position qui était l’emplacement d’extraction suivant lors de la création de l’ensemble de lignes) et récupère la ligne initiale.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset :: MoveLast

Déplace le curseur vers la dernière ligne.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Appelle [IRowset :: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) pour repositionner l’emplacement d’extraction suivant à la dernière position et récupère la dernière ligne.

Cette méthode requiert que vous ayez défini `DBPROP_CANSCROLLBACKWARDS` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes. (Pour de meilleures performances, vous pouvez également définir `DBPROP_QUICKRESTART` sur VARIANT_TRUE.)

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset :: MoveNext

Déplace le curseur vers l’enregistrement suivant.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Paramètres

*lSkip*<br/>
dans Nombre de lignes à ignorer avant l’extraction.

*bForward*<br/>
dans Passez **`true`** pour avancer à l’enregistrement suivant, **`false`** pour revenir en arrière.

### <a name="return-value"></a>Valeur de retour

HRESULT standard. Lorsque la fin de l’ensemble de lignes a été atteinte, retourne DB_S_ENDOFROWSET.

### <a name="remarks"></a>Notes

Récupère la ligne suivante de l' `CRowset` objet, en mémorisant la position précédente. Si vous le souhaitez, vous pouvez choisir d’ignorer les lignes *lSkip* ou de revenir en arrière.

Cette méthode nécessite de définir les propriétés suivantes avant d’appeler `Open` sur la table ou la commande contenant l’ensemble de lignes :

- `DBPROP_CANSCROLLBACKWARDS`doit être VARIANT_TRUE si *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS`doit être VARIANT_TRUE si *bForward* = false

Sinon (si *lSkip* >= 0 et *bForward* = true), vous n’avez pas besoin de définir des propriétés supplémentaires.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset :: MovePrev

Déplace le curseur vers l’enregistrement précédent.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Pour cette méthode, vous devez définir `DBPROP_CANFETCHBACKWARDS` ou `DBPROP_CANSCROLLBACKWARDS` pour VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset :: MoveToBookmark

Extrait la ligne marquée par un signet ou la ligne à un décalage spécifié (*lSkip*) à partir de ce signet.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Paramètres

*bookmark*<br/>
dans Signet marquant l’emplacement à partir duquel vous souhaitez extraire des données.

*lSkip*<br/>
dans Nombre de lignes du signet à la ligne cible. Si *lSkip* est égal à zéro, la première ligne extraite est la ligne avec signet. Si *lSkip* est 1, la première ligne extraite est la ligne qui suit la ligne marquée par un signet. Si *lSkip* est-1, la première ligne extraite est la ligne avant la ligne avec signet.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetLocate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir sur `DBPROP_IRowsetLocate` VARIANT_TRUE et définir `DBPROP_CANFETCHBACKWARDS` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

Pour plus d’informations sur l’utilisation des signets dans les consommateurs, consultez [utilisation de signets](../../data/oledb/using-bookmarks.md).

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset :: MoveToRatio

Extrait des lignes à partir d’une position fractionnaire dans l’ensemble de lignes.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Paramètres

*nNumerator*<br/>
dans Numérateur utilisé pour déterminer la position fractionnaire à partir de laquelle récupérer des données.

*nDenominator*<br/>
dans Dénominateur utilisé pour déterminer la position fractionnaire à partir de laquelle récupérer des données.

*bForward*<br/>
dans Indique s’il faut avancer ou reculer. La valeur par défaut est Forward.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

`MoveToRatio`Récupère les lignes en fonction de la formule suivante :

`(nNumerator *  RowsetSize ) / nDenominator`

où `RowsetSize` est la taille de l’ensemble de lignes, mesurée en lignes. La précision de cette formule dépend du fournisseur spécifique. Pour plus d’informations, consultez [IRowsetScroll :: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Cette méthode requiert l’interface facultative `IRowsetScroll` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetScroll` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset :: ReleaseRows

Appelle [IRowset :: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) pour libérer le handle de ligne actuel.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset :: SetData

Définit des valeurs de données dans une ou plusieurs colonnes d’une ligne.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Paramètres

*nAccessor*<br/>
dans Numéro de l’accesseur à utiliser pour accéder aux données.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Pour le `SetData` formulaire qui n’accepte aucun argument, tous les accesseurs sont utilisés pour la mise à jour. En général, vous appelez `SetData` pour définir des valeurs de données dans les colonnes d’une ligne, puis appelez [Update](../../data/oledb/crowset-update.md) pour transmettre ces modifications.

Cette méthode requiert l’interface facultative `IRowsetChange` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetChange` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

L’opération de paramétrage peut échouer si une ou plusieurs colonnes ne sont pas accessibles en écriture. Modifier le mappage de votre curseur pour corriger ce problème.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset :: Undo

Annule toutes les modifications apportées à une ligne depuis la dernière extraction ou [mise à jour](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Paramètres

*pcRows*<br/>
à Pointeur vers l’emplacement où `Undo` retourne le nombre de lignes qu’il a tenté d’annuler, si nécessaire.

*phRow*<br/>
à Pointeur vers l’emplacement où `Undo` retourne un tableau de handles à toutes les lignes qu’il a tenté d’annuler, si nécessaire.

*pStatus*<br/>
à Pointeur vers l’emplacement où `Undo` retourne la valeur d’état de ligne. Aucun État n’est retourné si *pStatus* a la valeur null.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Cette méthode requiert l’interface facultative `IRowsetUpdate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset :: Update

Transmet toutes les modifications en attente apportées à la ligne actuelle depuis la dernière extraction ou `Update` appel sur celle-ci.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Paramètres

*pcRows*<br/>
à Pointeur vers l’emplacement où `Update` retourne le nombre de lignes qu’il a tenté de mettre à jour, si nécessaire.

*phRow*<br/>
à Pointeur vers l’emplacement où `Update` retourne le handle de la ligne qu’il a tenté de mettre à jour. Aucun handle n’est retourné si *phRow* a la valeur null.

*pStatus*<br/>
à Pointeur vers l’emplacement où `Update` retourne la valeur d’état de ligne. Aucun État n’est retourné si *pStatus* a la valeur null.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

### <a name="remarks"></a>Notes

Transmet toutes les modifications en attente apportées à la ligne actuelle depuis la dernière extraction ou mise à jour de cette ligne (à l’aide `Update` de ou [UpdateAll](../../data/oledb/crowset-updateall.md)). Vous appelez généralement [SetData](../../data/oledb/crowset-setdata.md) pour définir des valeurs de données dans les colonnes d’une ligne, puis appeler `Update` pour transmettre ces modifications.

Cette méthode requiert l’interface facultative `IRowsetUpdate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset :: UpdateAll

Transmet toutes les modifications en attente apportées à toutes les lignes depuis la dernière extraction ou `Update` appel sur celle-ci.

### <a name="syntax"></a>Syntaxe

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Paramètres

*pcRows*<br/>
à Pointeur vers l’emplacement où `UpdateAll` retourne le nombre de lignes qu’il a tenté de mettre à jour, si nécessaire.

*pphRow*<br/>
à Pointeur vers la mémoire dans lequel `UpdateAll` retourne le handle de la ligne qu’il a tenté de mettre à jour. Aucun handle n’est retourné si *pphRow* a la valeur null.

*ppStatus*<br/>
à Pointeur vers l’emplacement où `Update` retourne la valeur d’état de ligne. Aucun État n’est retourné si *ppStatus* a la valeur null.

### <a name="remarks"></a>Notes

Transmet toutes les modifications en attente apportées à toutes les lignes depuis la dernière extraction ou mise à jour de ces lignes à l’aide de [Update](../../data/oledb/crowset-update.md) ou `UpdateAll` . `UpdateAll`met à jour toutes les lignes qui ont été modifiées, que vous ayez toujours le descripteur pour eux (consultez *pphRow*) ou non.

Par exemple, si vous avez utilisé `Insert` pour insérer cinq lignes dans un ensemble de lignes, vous pouvez soit appeler `Update` cinq fois, soit appeler `UpdateAll` une fois pour les mettre à jour.

Cette méthode requiert l’interface facultative `IRowsetUpdate` , qui peut ne pas être prise en charge sur tous les fournisseurs ; si c’est le cas, la méthode retourne E_NOINTERFACE. Vous devez également définir `DBPROP_IRowsetUpdate` sur VARIANT_TRUE avant `Open` d’appeler sur la table ou la commande contenant l’ensemble de lignes.

### <a name="return-value"></a>Valeur de retour

HRESULT standard.

## <a name="see-also"></a>Voir aussi

[DBViewer, exemple](../../overview/visual-cpp-samples.md)<br/>
[Exemple MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Exemple d’attributs MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Modèles du consommateur OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Informations de référence sur les modèles de consommateurs OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)
