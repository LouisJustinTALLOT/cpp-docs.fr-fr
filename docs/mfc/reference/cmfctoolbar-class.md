---
title: Classe CMFCToolBar
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: dc1a8b1fc852ff1071b20ced64fc8e0686725a83
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375075"
---
# <a name="cmfctoolbar-class"></a>Classe CMFCToolBar

La `CMFCToolBar` classe ressemble à [la classe CToolBar](../../mfc/reference/ctoolbar-class.md), mais fournit un support supplémentaire pour les fonctionnalités d’interface utilisateur. Celles-ci incluent les barres d'outils à deux dimensions, les barres d'outils avec images interactives, les grandes icônes, les boutons pager, les barres d'outils verrouillées, les contrôles rebar, le texte sous les images, les images d'arrière-plan et les barres d'outils avec onglets. La classe `CMFCToolBar` contient également une prise en charge intégrée de la personnalisation des barres d'outils et des menus par l'utilisateur, du glisser-déplacer entre les barres d'outils et les menus, des boutons de zone de liste modifiable, des boutons de zone d'édition, des sélecteurs de couleurs et des boutons de regroupement.

Pour plus de détails, consultez le code source situé dans le dossier **VC\\\\atlmfc src\\mfc** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|Constructeur par défaut.|
|`CMFCToolBar::~CMFCToolBar`|Destructeur.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|Ajoute une commande de menu à la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.|
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|Incréments par un le compteur qui est associé à la commande donnée.|
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|Ajoute des images des ressources de l’interface utilisateur à la collecte d’images de l’application.|
|[CMFCToolBar::AdjustLayout](#adjustlayout)|Recalcule la taille et la position d’une barre d’outils. (Overrides [CBasePane::AdjustLayout](../../mfc/reference/cbasepane-class.md#adjustlayout)).|
|[CMFCToolBar::Ajuster](#adjustsize)|Recalcule la taille de la barre d’outils.|
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|Précise si les étiquettes de texte peuvent être affichées sous les images sur les boutons de la barre d’outils.|
|[CMFCToolBar:AreTextLabels](#aretextlabels)|Précise si des étiquettes de texte sous les images sont actuellement affichées sur les boutons de la barre d’outils.|
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|Activez ou désactivez la génération automatique d’images bouton inactives.|
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|Retourne l’index d’un objet [spécifié de classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) dans cette barre d’outils.|
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|Calcule la taille horizontale de la barre d’outils. (Overrides [CBasePane::CalcFixedLayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout).)|
|[CMFCToolBar:CalcSize](#calcsize)|Appelé par le cadre dans le cadre du processus de calcul de la mise en page. (Overrides [CPane::CalcSize](../../mfc/reference/cpane-class.md#calcsize).)|
|[CMFCToolBar:CanHandleSiblings](#canhandlesiblings)|Détermine si la barre d'outils et son frère sont placés sur le même volet.|
|[CMFCToolBar::CleanUpImages](#cleanupimages)|Libère les ressources système allouées pour les images de barres d’outils.|
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|Libère les ressources système allouées pour les images verrouillées de barres d’outils.|
|[CMFCToolBar:CanBeClosed](#canbeclosed)|Précise si un utilisateur peut fermer la barre d’outils. (Overrides [CBasePane::CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed).)|
|[CMFCToolBar:CanBeRestored](#canberestored)|Détermine si le système peut restaurer une barre d’outils à son état d’origine après la personnalisation.|
|[CMFCToolBar:CanFocus](#canfocus)|Précise si la vitre peut recevoir la mise au point. (Overrides [CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus).)|
|[CMFCToolBar:CanHandleSiblings](#canhandlesiblings)|Détermine si la barre d'outils et son frère sont placés sur le même volet.|
|[CMFCToolBar::CommandToIndex](#commandtoindex)|Retourne l’index du bouton dans la barre d’outils avec un ID de commande spécifié.|
|[CMFCToolBar::Créer](#create)|Crée un objet `CMFCToolBar` .|
|[CMFCToolBar::CreateEx](#createex)|Crée `CMFCToolBar` un objet qui utilise des options de style supplémentaires, telles que de grandes icônes.|
|[CMFCToolBar::Deactivate](#deactivate)|Désactiver la barre d’outils.|
|[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)|Permet ou désactive le bouton **Ajouter ou supprimer les boutons** qui apparaît à l’extrémité de la barre d’outils.|
|[CMFCToolBar::EnableDocking](#enabledocking)|Permet l’amarrage de la vitre au cadre principal. (Overrides [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking).)|
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|Permet ou désactive de grandes icônes sur les boutons de la barre d’outils.|
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|Permet ou désactive la personnalisation rapide des barres d’outils afin que l’utilisateur puisse appuyer sur la clé **Alt** et faire glisser un bouton vers un nouvel emplacement.|
|[CMFCToolBar::EnableReflections](#enablereflections)|Permet ou désactive la réflexion de commande.|
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|Permet ou désactive les étiquettes de texte sous des images bouton de barre d’outils.|
|[CMFCToolBar::DeHandlePermanent](#fromhandlepermanent)|Récupère un pointeur `CMFCToolBar` sur l’objet qui contient la poignée de fenêtre donnée.|
|[CMFCToolBar:GetAllButtons](#getallbuttons)|Retourne une liste de boutons en lecture seulement dans une barre d’outils.|
|[CMFCToolBar:GetAllToolbars](#getalltoolbars)|Renvoie une liste de lecture uniquement de toutes les barres d’outils de l’application.|
|[CMFCToolBar:GetBasicCommands](#getbasiccommands)|Renvoie une liste de commandes de base définies dans l’application.|
|[CMFCToolBar::GetButton](#getbutton)|Retourne un pointeur à l’objet `CMFCToolBarButton` qui a un index spécifié de bouton de barre d’outils.|
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|Renvoie l’ID de commande, le style et l’index d’image du bouton à un index spécifié.|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|Retourne les dimensions de chaque bouton sur la barre d’outils.|
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|Retourne le style actuel du bouton de la barre d’outils qui se trouve à l’index spécifié.|
|[CMFCToolBar::GetButtonText](#getbuttontext)|Retourne l’étiquette de texte d’un bouton qui a un index spécifié.|
|[CMFCToolBar::GetColdImages](#getcoldimages)|Retourne un pointeur à la collection d’images de bouton de barre d’outils froides dans l’application.|
|[CMFCToolBar:GetColumnWidth](#getcolumnwidth)|Retourne la largeur des boutons de la barre d’outils.|
|[CMFCToolBar:GetCommandButtons](#getcommandbuttons)|Renvoie une liste de boutons qui ont une carte d’identité de commande spécifiée à partir de toutes les barres d’outils dans l’application.|
|[CMFCToolBar::GetCount](#getcount)|Retourne le nombre de boutons et de séparateurs sur la barre d’outils.|
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|Récupère un pointeur `CMFCCustomizeButton` sur l’objet associé à la barre d’outils.|
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|Retourne l’index de l’image par défaut pour un bouton de barre d’outils avec un IDENTIFIANT de commande spécifié.|
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|Retourne un pointeur à la collection d’images qui sont utilisées pour les boutons de barre d’outils désactivés dans l’application.|
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|Retourne un pointeur à la collection d’images qui sont utilisées pour les boutons de menu désactivés dans l’application.|
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|Récupère un pointeur sur l’objet bouton de menu qui affiche actuellement son sous-menu.|
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|Précise si les images de boutons désactivés sont des versions tamisées des images bouton régulières, ou prises à partir de la collection d’images bouton désactivées.|
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|Retourne un pointeur sur le bouton de la barre d’outils qui est actuellement mis en surbrillance.|
|[CMFCToolBar:GetHotBorder](#gethotborder)|Détermine si les boutons de la barre d’outils sont suivis à chaud.|
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|Retourne la couleur de texte des boutons de barre d’outils mis en surbrillance.|
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|Retourne une poignée à la fenêtre qui avait la mise au point d’entrée juste avant la barre d’outils.|
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|Précise si les appels pour définir des étiquettes de bouton sont ignorés.|
|[CMFCToolBar::GetImageSize](#getimagesize)|Retourne la taille actuelle des images bouton de barre d’outils.|
|[CMFCToolBar::GetImages](#getimages)|Retourne un pointeur à la collection d’images bouton par défaut dans l’application.|
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|Retourne le décalage d’index utilisé pour trouver les images bouton de barre d’outils pour cette barre d’outils dans la liste globale des images de bouton de barre d’outils.|
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|Récupère la région de la zone client qui doit être redessiné pour le bouton à l’index donné.|
|[CMFCToolBar::GetItemID](#getitemid)|Retourne l’ID de commande du bouton de la barre d’outils à un index spécifié.|
|[CMFCToolBar::GetItemRect](#getitemrect)|Retourne le rectangle de délimitation du bouton à un index spécifié.|
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|Retourne un pointeur à la collection de grandes images froides de bouton de barre d’outils dans l’application.|
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|Retourne un pointeur à la collection de grandes images de bouton de barre d’outils désactivées dans l’application.|
|[CMFCToolBar::GetLargeImages](#getlargeimages)|Retourne un pointeur à la collection de grandes images bouton de barre d’outils dans l’application.|
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|Retourne un pointeur à la collection d’images froides verrouillées dans la barre d’outils.|
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|Retourne un pointeur à la collection d’images désactivées verrouillées dans la barre d’outils.|
|[CMFCToolBar::GetLockedImages](#getlockedimages)|Retourne un pointeur à la collection d’images bouton verrouillées dans la barre d’outils.|
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|Retourne la taille par défaut des images verrouillées de barre d’outils.|
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|Retourne un pointeur à la collection d’images verrouillées de menu de barres d’outils dans la barre d’outils.|
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|Retourne la taille des boutons de menu dans l’application.|
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|Retourne la taille des images bouton de menu dans l’application.|
|[CMFCToolBar::GetMenuImages](#getmenuimages)|Retourne un pointeur à la collection d’images bouton de menu dans l’application.|
|[CMFCToolBar:GetOrigButtons](#getorigbuttons)|Récupère la collection de boutons non personnalisés de la barre d’outils.|
|[CMFCToolBar:GetOrigResetButtons](#getorigresetbuttons)|Récupère la collection de boutons de réinitialisation non personnalisés de la barre d’outils.|
|[CMFCToolBar::GetResourceID](#getresourceid)|Récupère l’id de ressources de la barre d’outils.|
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|Détermine quel objet, le cadre parent ou le propriétaire, envoie des commandes à la barre d’outils.|
|[CMFCToolBar:GetRowHeight](#getrowheight)|Retourne la hauteur des boutons de barre d’outils.|
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|Précise si des conseils d’outils sont affichés pour les boutons de barre d’outils.|
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|Récupère le frère de la barre d’outils.|
|[CMFCToolBar::GetUserImages](#getuserimages)|Retourne un pointeur à la collection d’images de bouton de barre d’outils définies par l’utilisateur dans l’application.|
|[CMFCToolBar::HitTest](#hittest)|Retourne l’index du bouton de la barre d’outils qui se trouve à la position spécifiée.|
|[CMFCToolBar:InsertButton](#insertbutton)|Insère un bouton dans la barre d’outils.|
|[CMFCToolBar:InsertSeparator](#insertseparator)|Insère un séparateur dans la barre d’outils.|
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|Invalide la zone client du bouton de la barre d’outils qui existe à l’index fourni.|
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|Détermine si un utilisateur peut ajouter ou supprimer les boutons de la barre d’outils en utilisant l’option de menu **Personnaliser.**|
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|Précise si *une personnalisation rapide* est utilisée pour faire glisser un bouton.|
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|Précise si la génération automatique d’images bouton inactives (non surespéritées) est activée.|
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|Détermine si une commande figure sur la liste des commandes de base.|
|[CMFCToolBar:IsButtonExtrasizeAvailable](#isbuttonextrasizeavailable)|Détermine si la barre d’outils peut afficher les boutons qui ont des bordures étendues.|
|[CMFCToolBar:IsButtonHighlighted](#isbuttonhighlighted)|Détermine si un bouton sur la barre d’outils est mis en surbrillance.|
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|Détermine si une commande est autorisée.|
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|Détermine si une commande est rarement utilisée (voir [CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)).|
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|Précise si le cadre de la barre d’outils est en mode personnalisation.|
|[CMFCToolBar::IsDragButton](#isdragbutton)|Détermine si un bouton de barre d’outils est traîné.|
|[CMFCToolBar:IsExistCustomizeButton](#isexistcustomizebutton)|Détermine si la barre d’outils contient le bouton **Customize.**|
|[CMFCToolBar::IsFloating](#isfloating)|Détermine si la barre d’outils flotte.|
|[CMFCToolBar::IsLargeIcons](#islargeicons)|Précise si les barres d’outils de l’application affichent actuellement de grandes icônes.|
|[CMFCToolBar::IsLastCommandDeButton](#islastcommandfrombutton)|Détermine si la commande la plus récemment exécutée a été envoyée à partir du bouton de barre d’outils spécifié.|
|[CMFCToolBar:IsLocked](#islocked)|Détermine si la barre d’outils est verrouillée.|
|[CMFCToolBar::IsOneRowWithSibling](#isonerowwithsibling)|Détermine si la barre d’outils et sa barre d’outils de frère sont positionnés sur la même rangée.|
|[CMFCToolBar:IsUserDéfined](#isuserdefined)|Précise si la barre d’outils est définie par l’utilisateur.|
|[CMFCToolBar::LoadBitmap](#loadbitmap)|Charge les images de barre d’outils à partir des ressources de l’application.|
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|Charge les images de barre d’outils à partir des ressources de l’application. Inclut de grandes images.|
|[CMFCToolBar::LoadParameters](#loadparameters)|Charge les options globales de barres d’outils du registre Windows.|
|[CMFCToolBar::LoadState](#loadstate)|Charge les informations d’état de la barre d’outils du registre Windows. (Overrides [CPane::LoadState](../../mfc/reference/cpane-class.md#loadstate).)|
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|Charge la barre d’outils à partir des ressources d’application.|
|[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)|Charge la barre d’outils à `CMFCToolBarInfo` partir des ressources d’application en utilisant la classe d’aide pour permettre à l’application d’utiliser de grandes images.|
|[CMFCToolBar::OnChangeHot](#onchangehot)|Appelé par le cadre quand un utilisateur sélectionne un bouton sur la barre d’outils.|
|[CMFCToolBar::OnFillBackground](#onfillbackground)|Appelé par le cadre de [CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint) pour remplir l’arrière-plan de la barre d’outils.|
|[CMFCToolBar::OnReset](#onreset)|Restaure la barre d’outils à son état d’origine.|
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(Overrides [CBasePane::OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|Restaure le texte d’un bouton de barre d’outils à son état par défaut.|
|`CMFCToolBar::OnUpdateCmdUI`|Utilisé en interne.|
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|Supprime tous les boutons de la barre d’outils.|
|[CMFCToolBar::RemoveButton](#removebutton)|Supprime le bouton avec l’index spécifié de la barre d’outils.|
|[CMFCToolBar::SupprimerStateDeRegistry](#removestatefromregistry)|Supprime les informations d’état de la barre d’outils du registre Windows.|
|[CMFCToolBar::RemplacerButton](#replacebutton)|Remplace un bouton de barre d’outils par un autre bouton de barre d’outils.|
|[CMFCToolBar::ResetAll](#resetall)|Restaure toutes les barres d’outils dans leurs états d’origine.|
|[CMFCToolBar::ResetAllImages](#resetallimages)|Efface toutes les collections d’images de barres d’outils dans l’application.|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|Restaure l'état initial d'une barre d'outils.|
|[CMFCToolBar::SaveState](#savestate)|Enregistre les informations d’état pour la barre d’outils dans le registre Windows. (Overrides [CPane::SaveState](../../mfc/reference/cpane-class.md#savestate).)|
|`CMFCToolBar::Serialize`|(Substitue `CBasePane::Serialize`.)|
|[CMFCToolBar:SetBasicCommands](#setbasiccommands)|Définit la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.|
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|Définit l’ID de commande, le style et l’identification d’image d’un bouton de barre d’outils.|
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|Définit le style du bouton de la barre d’outils à l’index donné.|
|[CMFCToolBar::SetButtonText](#setbuttontext)|Définit l’étiquette de texte d’un bouton de barre d’outils.|
|[CMFCToolBar:SetButtons](#setbuttons)|Définit les boutons pour la barre d’outils.|
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|Spécifie lorsque les commandes rarement utilisées n’apparaissent pas dans le menu de l’application.|
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|Permet ou désactive le mode de personnalisation pour toutes les barres d’outils de l’application.|
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|Précise si les boutons désactivés sur la barre d’outils sont atténués ou si des images désactivées sont utilisées pour les boutons désactivés.|
|[CMFCToolBar::SetHeight](#setheight)|Définit la hauteur de la barre d’outils.|
|[CMFCToolBar:SetHotBorder](#sethotborder)|Précise si les boutons de barre d’outils sont suivis à chaud.|
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|Définit la couleur du texte pour les boutons chauds de barre d’outils.|
|[CMFCToolBar:SetLargeIcons](#setlargeicons)|Précise si les boutons de barre d’outils affichent de grandes icônes.|
|[CMFCToolBar:SetLockedSizes](#setlockedsizes)|Définit les tailles de boutons verrouillés et d’images verrouillées sur la barre d’outils.|
|[CMFCToolBar:SetMenuSizes](#setmenusizes)|Définit la taille des boutons de menu de barre d’outils et leurs images.|
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|Définit la liste des commandes qui ne peuvent pas être exécutées par l’utilisateur.|
|[CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)|Positionne la barre d’outils et son frère sur la même rangée.|
|[CMFCToolBar::SetPermament](#setpermament)|Précise si un utilisateur peut fermer la barre d’outils.|
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|Précise si le cadre parent ou le propriétaire envoie des commandes à la barre d’outils.|
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|Précise si le cadre affiche des conseils d’outils.|
|[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)|Spécifie le frère de la barre d’outils.|
|[CMFCToolBar:SetSizes](#setsizes)|Spécifie la taille des boutons et des images sur toutes les barres d’outils.|
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|Spécifie les propriétés d’un bouton sur la barre d’outils.|
|[CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)|Positionne la barre d’outils et son frère sur des rangées séparées.|
|[CMFCToolBar::SetUserImages](#setuserimages)|Définit la collection d’images définies par l’utilisateur dans l’application.|
|[CMFCToolBar::StretchPane](#stretchpane)|Étire la barre d’outils verticalement ou horizontalement. (Overrides [CBasePane::StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane).)|
|[CMFCToolBar::TranslateChar](#translatechar)|Exécute une commande de bouton si le code clé spécifié correspond à un raccourci de clavier valide.|
|[CMFCToolBar::Mise à jourButton](#updatebutton)|Mise à jour de l’état du bouton spécifié.|
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|Repositionne les boutons de barre d’outils dans les dimensions données.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|Détermine si la barre d’outils est affichée dans la liste sur la vitre **Toolbars** de la boîte de dialogue **Customize.**|
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|Calcule la hauteur maximale d’un bouton dans la barre d’outils.|
|[CMFCToolBar::DoPaint](#dopaint)|Repeindre une barre d’outils.|
|[CMFCToolBar::DrawButton](#drawbutton)|Repeindre un bouton de barre d’outils.|
|[CMFCToolBar::DrawSeparator](#drawseparator)|Repeindre un séparateur sur une barre d’outils.|
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|Appelé par le cadre lorsque l’outiltip pour un bouton est sur le point d’être affiché.|

### <a name="data-members"></a>Données membres

|Nom|Description|
|----------|-----------------|
|[CMFCToolBar:m_bDontScaleImages](#m_bdontscaleimages)|Précise s’il faut mettre à l’échelle ou non des images de barres d’outils en mode DPI élevé.|
|[CMFCToolBar:m_dblLargeImageRatio](#m_dbllargeimageratio)|Spécifie le rapport entre la dimension (hauteur ou largeur) des grandes images et la dimension des images régulières.|

## <a name="remarks"></a>Notes

Pour intégrer `CMFCToolBar` un objet dans votre application, suivez ces étapes :

1. Ajouter `CMFCToolBar` un objet à la fenêtre du cadre principal.

1. Lorsque vous traitez le message WM_CREATE pour la fenêtre principale du cadre, appelez [CMFCToolBar: ::Create](#create) ou [CMFCToolBar::CreateEx](#createex) pour créer la barre d’outils et spécifier son style.

1. Appelez [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking) pour spécifier le style d’amarrage.

Pour insérer un bouton spécial, comme une boîte combo ou une barre d’outils, réservez un bouton factice dans la ressource mère et remplacez le bouton factice à l’heure d’exécution en utilisant [CMFCToolBar::ReplaceButton](#replacebutton). Pour plus d’informations, voir [Procédure pas à pas: Mettre des contrôles sur les barres d’outils](../walkthrough-putting-controls-on-toolbars.md).

`CMFCToolBar`est la classe de base pour les classes de bibliothèque MFC [CMFCMenuBar Classe](../../mfc/reference/cmfcmenubar-class.md), [CMFCPopupMenuBar Classe](../../mfc/reference/cmfcpopupmenubar-class.md), et [CMFCDropDownToolBar Classe](../../mfc/reference/cmfcdropdowntoolbar-class.md).

## <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser différentes méthodes de la classe `CMFCToolBar` . L’exemple montre comment définir le texte de l’étiquette de fenêtre de la barre d’outils, définir les bordures, définir le style de la vitre, et activer le bouton **Ajouter ou supprimer les boutons** qui apparaît à l’extrémité de la barre d’outils. Cet extrait de code fait partie de [l’échantillon de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>Spécifications

**En-tête:** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="cmfctoolbaraddbasiccommand"></a><a name="addbasiccommand"></a>CMFCToolBar::AddBasicCommand

Ajoute une commande de menu à la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] Spécifie la commande à ajouter.

### <a name="remarks"></a>Notes

Une commande de base est toujours affichée lorsque le menu est ouvert. Cette méthode est significative lorsque l’utilisateur choisit de voir les commandes récemment utilisées.

Utilisez la méthode [CMFCToolBar:SetBasicCommands](#setbasiccommands) pour définir la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu. Utilisez la méthode [CMFCToolBar:GetBasicCommands](#getbasiccommands) pour récupérer la liste des commandes de base qui est utilisée par votre application.

## <a name="cmfctoolbaraddcommandusage"></a><a name="addcommandusage"></a>CMFCToolBar::AddCommandUsage

Incréments par un le compteur qui est associé à la commande donnée.

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>Paramètres

*uiCommand (en)*<br/>
[dans] Spécifie le compteur de commande à l’incrément.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsque l’utilisateur sélectionne un élément de menu.

Le cadre utilise des compteurs de commande pour afficher les éléments de menu récemment utilisés.

Cette méthode incrémente le compteur de commande en utilisant la méthode [CMFCCmdUsageCount::AddCmd.](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)

## <a name="cmfctoolbaraddtoolbarforimagecollection"></a><a name="addtoolbarforimagecollection"></a>CMFCToolBar::AddToolBarForImageCollection

Ajoute des images des ressources de l’interface utilisateur à la collecte d’images de l’application.

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
[dans] Id de ressources d’une barre d’outils avec des images à charger.

*uiBmpResID*<br/>
[dans] Id de ressource d’une bitmap avec des images de barre d’outils.

*uiColdResID*<br/>
[dans] Id de ressource d’une bitmap avec des images de barre d’outils « froides ».

*uiMenuResID*<br/>
[dans] Id de ressource d’une bitmap avec des images de menu.

*uiDisabledResID*<br/>
[dans] Id de ressource d’une bitmap avec des images désactivées de barre d’outils.

*uiMenuDisabledResID*<br/>
[dans] Id de ressource d’un bitmap avec des images de menu désactivées.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode réussit; FALSE si *uiResID* ou *uiBmpResID* ne spécifient pas les ressources valides, ou une autre erreur se produit.

### <a name="remarks"></a>Notes

Appelez cette méthode pour charger une bitmap avec des images de barre d’outils et l’ajouter à la collection d’images de barres d’outils. Cette méthode crée un objet de barre d’outils temporaire et appelle [CMFCToolBar::LoadToolBar](#loadtoolbar).

## <a name="cmfctoolbaradjustlayout"></a><a name="adjustlayout"></a>CMFCToolBar::AdjustLayout

Recalcule la taille et la position d’une barre d’outils.

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque la barre d’outils a été créée pour recalculer sa taille et sa position.

Le cadre appelle cette méthode chaque fois que la disposition de la barre d’outils doit être modifiée. Par exemple, la mise en page doit changer lorsque l’utilisateur déplace une autre barre de contrôle, resize une fenêtre d’application ou personnalise la barre d’outils.

Remplacez cette méthode pour fournir votre propre mise `CMFCToolbar`en page dynamique dans les classes que vous dérivez de .

## <a name="cmfctoolbaradjustsize"></a><a name="adjustsize"></a>CMFCToolBar::Ajuster

Recalcule la taille de la barre d’outils.

```
void AdjustSize();
```

### <a name="remarks"></a>Notes

Cette méthode permet de s’assurer que la barre d’outils s’adapte dans les limites du cadre parent. Cette méthode ne fait rien si la barre d’outils n’a pas de cadre parent.

La [méthode CMFCToolBar::AdjustLayout](#adjustlayout) appelle cette méthode pour recalculer la taille `CMFCReBar` si le parent de la barre d’outils n’est pas un objet.

## <a name="cmfctoolbarallowchangetextlabels"></a><a name="allowchangetextlabels"></a>CMFCToolBar::AllowChangeTextLabels

Précise si les étiquettes de texte peuvent être affichées sous les images sur les boutons de la barre d’outils.

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI s’il est autorisé à afficher des étiquettes de texte sous les images; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode est appelée par la boîte de dialogue de personnalisation pour déterminer s’il convient d’activer une case de **cocher d’étiquettes de texte Show** sur la page **des barres d’outils** pour la barre d’outils sélectionnée.

La implémentation par défaut renvoie TRUE.

Remplacer cette méthode dans un `CMFCToolBar` objet dérivé et retourner FALSE lorsque vous ne voulez pas que l’utilisateur décide si les étiquettes de texte sont affichées sur les boutons de la barre d’outils sous les images.

## <a name="cmfctoolbarallowshowonlist"></a><a name="allowshowonlist"></a>CMFCToolBar::AllowShowOnList

Détermine si la barre d’outils est affichée dans la liste des barres d’outils sur le volet **Toolbars** de la boîte de dialogue **Customize.**

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si l’objet de la barre d’outils peut être affiché dans la boîte de liste sur la page de personnalisation de la barre d’outils; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode est appelée par le cadre pour déterminer si la liste sur `CMFCToolBar`la page de personnalisation de la barre d’outils doit inclure un objet particulier dérivé de .

L’implémentation par défaut renvoie toujours TRUE. Remplacez cette méthode lorsque vous ne voulez pas qu’une barre d’outils apparaisse dans la liste des barres d’outils dans la boîte de dialogue de personnalisation.

## <a name="cmfctoolbararetextlabels"></a><a name="aretextlabels"></a>CMFCToolBar:AreTextLabels

Précise si des étiquettes de texte sous les images sont actuellement affichées sur les boutons de la barre d’outils.

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si les boutons de la barre d’outils affichent des étiquettes de texte ci-dessous les images ; autrement FALSE.

### <a name="remarks"></a>Notes

Utilisez [CMFCToolBar::EnableTextLabels](#enabletextlabels) pour spécifier si le texte est affiché. La valeur par défaut est FALSE. Appelez [CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) pour spécifier si l’utilisateur peut modifier ce paramètre dans la boîte de dialogue de personnalisation.

## <a name="cmfctoolbarautograyinactiveimages"></a><a name="autograyinactiveimages"></a>CMFCToolBar::AutoGrayInactiveImages

Activez ou désactivez la génération automatique d’images bouton inactives.

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] Une valeur Boolean qui spécifie s’il faut assombrir les images inactives. Si ce paramètre est VRAI, les images inactives sont tamisées. Sinon, les images inactives ne sont pas tamisées.

*nGrayImagePercentage*<br/>
[dans] Spécifie le pourcentage de luminance pour les images inactives. Si *bEnable* est FALSE, cette valeur est ignorée.

*bRedrawAllToolbars*<br/>
[dans] Une valeur Boolean qui précise s’il faut redessiner toutes les barres d’outils de l’application. Si ce paramètre est VRAI, cette méthode redessiner toutes les barres d’outils.

### <a name="remarks"></a>Notes

Si *bEnable* est VRAI, le cadre utilise *nGrayImagePercentage* pour générer des images inactives à partir des images régulières. Sinon, vous devez fournir l’ensemble d’images inactives en utilisant la méthode [CMFCToolBar::GetColdImages.](#getcoldimages) Par défaut, cette option est désactivée.

Pour plus d’informations sur le paramètre *nGrayImagePercentage,* voir [CMFCToolBarImages::GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages).

## <a name="cmfctoolbarbuttontoindex"></a><a name="buttontoindex"></a>CMFCToolBar::ButtonToIndex

Retourne l’index d’un objet [spécifié de classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) dans cette barre d’outils.

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Un pointeur vers l’objet bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Index de *pButton* dans la liste interne des boutons de barre d’outils; ou -1 si le bouton spécifié n’est pas sur cette barre d’outils.

## <a name="cmfctoolbarcalcfixedlayout"></a><a name="calcfixedlayout"></a>CMFCToolBar::CalcFixedLayout

Calcule la taille horizontale de la barre d’outils.

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*bStretch*<br/>
[dans] VRAI pour étirer la barre d’outils à la taille du cadre parent.

*bHorz (en)*<br/>
[dans] VRAI pour orienter la barre d’outils horizontalement; FALSE pour orienter la barre d’outils verticalement.

### <a name="return-value"></a>Valeur de retour

Un `CSize` objet qui spécifie la taille de la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode calcule la taille de `CMFCToolBar::CalcLayout` la barre d’outils en utilisant la méthode. Il passe le drapeau LM_STRETCH pour le *paramètre dwMode* si *bStretch* est VRAI. Il passe le drapeau LM_HORZ si *bHorz* est VRAI.

Consultez l’échantillon VisualStudioDemo par exemple qui utilise cette méthode.

## <a name="cmfctoolbarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a>CMFCToolBar::CalcMaxButtonHeight

Calcule la hauteur maximale des boutons dans la barre d’outils.

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>Valeur de retour

La hauteur maximale des boutons.

### <a name="remarks"></a>Notes

Cette méthode calcule la hauteur maximale parmi tous les boutons de barre d’outils sur la barre d’outils. La hauteur peut varier en fonction de facteurs tels que l’état actuel d’amarrage de la barre d’outils.

Remplacer cette méthode dans une `CMFCToolBar` classe dérivée pour fournir votre propre calcul de hauteur.

## <a name="cmfctoolbarcalcsize"></a><a name="calcsize"></a>CMFCToolBar:CalcSize

Appelé par le cadre dans le cadre du processus de calcul de la mise en page.

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>Paramètres

*bVertDock (en)*<br/>
[dans] VRAI pour spécifier que la barre d’outils est amarré verticalement; FALSE pour spécifier que la barre d’outils est amarré horizontalement.

### <a name="return-value"></a>Valeur de retour

Un `CSize` objet qui spécifie la taille globale des boutons sur la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode tient compte des attributs qui affectent la taille de chaque bouton, comme la zone de l’étiquette de texte et la taille de la bordure.

Si la barre d’outils ne contient pas de boutons, cette méthode renvoie la taille réservée d’un seul bouton en utilisant la méthode [CMFCToolBar::GetButtonSize](#getbuttonsize) méthode.

## <a name="cmfctoolbarcanbeclosed"></a><a name="canbeclosed"></a>CMFCToolBar:CanBeClosed

Précise si un utilisateur peut fermer la barre d’outils.

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils peut être fermée par l’utilisateur; autrement FALSE.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode pour déterminer si l’utilisateur peut fermer une barre d’outils. Si la méthode renvoie TRUE, le cadre permet à la commande SC_CLOSE dans le menu système de la barre d’outils et l’utilisateur peut fermer la barre d’outils en utilisant une case à cocher dans la liste des barres d’outils dans la boîte de dialogue de personnalisation.

La implémentation par défaut renvoie TRUE. Remplacer cette méthode dans une `CMFCToolBar` classe dérivée pour fabriquer des objets de barre d’outils qui ne peuvent pas être fermés par l’utilisateur.

## <a name="cmfctoolbarcanberestored"></a><a name="canberestored"></a>CMFCToolBar:CanBeRestored

Détermine si le système peut restaurer une barre d’outils à son état d’origine après la personnalisation.

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils peut être restaurée à partir des ressources d’application; autrement FALSE.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode pour déterminer si une barre d’outils peut être retournée à son état d’origine après personnalisation. L’état d’origine est chargé à partir des ressources d’application.

Si `CanBeRestored` elle retourne TRUE, la page **Toolbars** de la boîte de dialogue de personnalisation permet le bouton **Reset** pour la barre d’outils sélectionnée.

L’implémentation par défaut renvoie TRUE si l’ID de ressources d’origine de la barre d’outils lorsqu’elle a été chargée n’est pas nulle. Habituellement, seules les barres d’outils définies par l’utilisateur ne peuvent pas être restaurées.

Vous pouvez passer `CanBeRestored` outre à la méthode pour personnaliser ce comportement dans les classes dérivées.

## <a name="cmfctoolbarcanfocus"></a><a name="canfocus"></a>CMFCToolBar:CanFocus

Précise si la vitre peut recevoir la mise au point.

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode renvoie FALSE.

### <a name="remarks"></a>Notes

Cette méthode remplace la mise en œuvre de la classe de base, [CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus), parce que les objets de barre d’outils ne peuvent pas recevoir de mise au point.

## <a name="cmfctoolbarcanhandlesiblings"></a><a name="canhandlesiblings"></a>CMFCToolBar:CanHandleSiblings

Détermine si la barre d'outils et son frère sont placés sur le même volet.

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils a un frère ou une sœur et que la barre d’outils et son frère sont positionnés sur le même volet; autrement FALSE.

### <a name="remarks"></a>Notes

La méthode interne CMFCCustomizeButton::CreatePopupMenu méthode appelle cette méthode pour déterminer comment afficher le menu pop-up **Customize.** Si cette méthode renvoie TRUE, le cadre affiche les **boutons Afficher sur One Row** ou Afficher les boutons sur les boutons Two **Rows.**

En règle générale, vous n'avez pas à utiliser cette méthode. Pour activer le bouton **Personnaliser** qui apparaît sur la barre d’outils, appelez la méthode [CMFCToolBar::EnableCustomizeButton.](#enablecustomizebutton) Pour activer les **boutons d’exposition sur une rangée** ou afficher les boutons sur deux boutons de **lignes,** appelez [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="cmfctoolbarcleanupimages"></a><a name="cleanupimages"></a>CMFCToolBar::CleanUpImages

Libère les ressources système allouées pour les images de barres d’outils.

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’une application s’arrête.

## <a name="cmfctoolbarcleanuplockedimages"></a><a name="cleanuplockedimages"></a>CMFCToolBar::CleanUpLockedImages

Libère les ressources système allouées pour les images verrouillées de barres d’outils.

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque le style visuel de votre application change. Consultez l’échantillon VisualStudioDemo par exemple qui utilise cette méthode.

## <a name="cmfctoolbarcommandtoindex"></a><a name="commandtoindex"></a>CMFCToolBar::CommandToIndex

Retourne l’index du bouton dans la barre d’outils avec un ID de commande spécifié.

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>Paramètres

*nIDFind (en)*<br/>
[dans] Spécifie l’ID de commande.

*iIndexFirst*<br/>
[dans] Spécifie l’indice initial pour commencer.

### <a name="return-value"></a>Valeur de retour

Index zéro du bouton de la barre d’outils si la méthode a été réussie; -1 s’il n’y a pas de bouton avec l’ID spécifié.

### <a name="remarks"></a>Notes

Un `CMFCToolBar` objet maintient une liste interne des boutons sur la barre d’outils. Appelez cette fonction pour récupérer l’index d’un bouton dans la liste étant donné l’ID de commande du bouton.

Si *iIndex* est supérieur à 0, cette méthode ignore tout bouton sur la barre d’outils qui a un indice inférieur à *iIndex*.

## <a name="cmfctoolbarcreate"></a><a name="create"></a>CMFCToolBar::Créer

Crée un objet `CMFCToolBar` .

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
[dans] Un pointeur à la fenêtre parente de la barre d’outils.

*dwStyle (en)*<br/>
[dans] Le style barre d’outils. Consultez [Toolbar Control et Button Styles](/windows/win32/Controls/toolbar-control-and-button-styles) dans le Windows SDK pour la liste des styles.

*nID*<br/>
[dans] L’id de la fenêtre enfant de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode réussit; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode crée une barre de contrôle et la fixe à la barre d’outils. Il crée la barre de contrôle avec le style TBSTYLE_FLAT. Appelez [CMFCToolBar:CreateEx](#createex) si vous voulez un style de barre de contrôle différent.

## <a name="cmfctoolbarcreateex"></a><a name="createex"></a>CMFCToolBar::CreateEx

Crée `CMFCToolBar` un objet qui utilise des options de style supplémentaires, telles que de grandes icônes.

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
[dans] Un pointeur à la fenêtre parente de la barre d’outils.

*dwCtrlStyle (en)*<br/>
[dans] Styles supplémentaires pour la création de l’objet de barre de commande embarqué.

*dwStyle (en)*<br/>
[dans] Le style barre d’outils. Consultez [Toolbar Control et Button Styles](/windows/win32/Controls/toolbar-control-and-button-styles) pour une liste de styles appropriés.

*rcBorders*<br/>
[dans] Un `CRect` objet qui spécifie les largeurs des bordures de la fenêtre de la barre d’outils.

*nID*<br/>
[dans] L’id de la fenêtre enfant de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nonzero si cette méthode réussit; sinon 0.

### <a name="remarks"></a>Notes

Cette méthode crée une barre de contrôle et la fixe à la barre d’outils.

Appelez cette méthode au lieu de [CMFCToolBar::Créer](#create) lorsque vous voulez fournir des styles spécifiques. Par exemple, définissez *dwCtrlStyle* à TBSTYLE_FLAT TBSTYLE_TRANSPARENT de créer une barre d’outils qui ressemble aux barres d’outils qui sont utilisées par Internet Explorer 4.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `CreateEx` utiliser `CMFCToolBar` la méthode de la classe. Cet extrait de code fait partie de [l’échantillon de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbardeactivate"></a><a name="deactivate"></a>CMFCToolBar::Deactivate

Désactiver la barre d’outils.

```
virtual void Deactivate();
```

### <a name="remarks"></a>Notes

Cette méthode désactive la barre d’outils en supprimant la mise au point du bouton de barre d’outils mis en surbrillance. Le cadre appelle cette méthode lorsque la barre d’outils perd du focus ou est détruite.

## <a name="cmfctoolbardopaint"></a><a name="dopaint"></a>CMFCToolBar::DoPaint

Repeindre une barre d’outils.

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[dans] Un pointeur vers un contexte d’appareil.

### <a name="remarks"></a>Notes

Cette méthode est appelée par le cadre lorsqu’une partie de la barre d’outils doit être repeinte.

Remplacer cette méthode pour personnaliser l’apparence `CMFCToolBar`d’un objet dérivé de .

## <a name="cmfctoolbardrawbutton"></a><a name="drawbutton"></a>CMFCToolBar::DrawButton

Repeindre un bouton de barre d’outils.

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[dans] Un pointeur vers un contexte d’appareil.

*pButton*<br/>
[dans] Un pointeur à un bouton à dessiner.

*pImages (en)*<br/>
[dans] Un pointeur pour les images de la barre d’outils.

*bHighlighted*<br/>
[dans] VRAI si le bouton est mis en surbrillance; autrement FALSE.

*bDrawDisabledImages*<br/>
[dans] VRAI si les boutons désactivés sont tamisés; autrement FALSE.

### <a name="return-value"></a>Valeur de retour

VRAI si le bouton a été repeint; FALSE si le bouton est caché.

### <a name="remarks"></a>Notes

La méthode [CMFCToolBar::DrawButton](#drawbutton) appelle cette méthode lorsqu’un bouton de barre d’outils doit être repeint.

Remplacez cette méthode si vous souhaitez personnaliser l’apparence des boutons sur votre barre d’outils.

## <a name="cmfctoolbardrawseparator"></a><a name="drawseparator"></a>CMFCToolBar::DrawSeparator

Repeindre un séparateur sur une barre d’outils.

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[dans] Un pointeur vers un contexte d’appareil.

*Rect*<br/>
[dans] Le rectangle de délimitation de l’endroit où le séparateur est dessiné, en pixels.

*bHorz (en)*<br/>
[dans] VRAI si le séparateur est horizontal, FALSE si le séparateur est vertical.

### <a name="remarks"></a>Notes

[CMFCToolBar::DoPaint](#dopaint) appelle cette méthode pour chaque [objet CMFCToolBar::DrawSeparator](#drawseparator) qui a le style TBBS_SEPARATOR, au lieu d’appeler [CMFCToolBar::DrawButton](#drawbutton) pour ces boutons.

Remplacer cette méthode dans une classe dérivée de [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) pour personnaliser l’apparence des séparateurs sur la barre d’outils. La mise en œuvre par défaut appelle [CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator) pour dessiner un séparateur dont l’apparence est déterminée par le gestionnaire visuel actuel.

## <a name="cmfctoolbarenablecustomizebutton"></a><a name="enablecustomizebutton"></a>CMFCToolBar::EnableCustomizeButton

Permet ou désactive le bouton Customize qui apparaît sur la barre d’outils.

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] Permet ou désactive le bouton Customize.

*iCustomizeCmd*<br/>
[dans] L’ID de commande du bouton Customize.

*strCustomizeText*<br/>
[dans] L’étiquette de texte du bouton Customize.

*uiCustomizeTextResId*<br/>
[dans] L’ID de chaîne de ressources de l’étiquette de bouton Customize.

*bQuickCustomize (en)*<br/>
[dans] Permet ou désactive l’option **Ajouter ou supprimer les boutons** sur le menu qui tombe du bouton.

### <a name="remarks"></a>Notes

Si *iCustomizeCmd* est de -1, le cadre affiche le bouton Customize lorsque plusieurs boutons de barre d’outils ne rentrent pas dans la zone de la barre d’outils. Le bouton affiche une double flèche à pointage gauche, ou chevron, ce qui indique qu’il y a plus de boutons.

Si *iCustomizeCmd* spécifie un IDENTIFIANT de commande valide, et *bEnable* est VRAI, le bouton Customize est toujours affiché. Le bouton a une petite flèche vers le bas et ouvre un menu qui contient une commande. Cette commande utilise l’étiquette de texte spécifiée par *strCustomizeText*. Si *bQuickCustomize* est également VRAI, le menu affiche l’option **Ajouter ou supprimer les boutons.**

Le cadre ajoute dynamiquement au menu tous les boutons qui ne rentrent pas dans la zone de la barre d’outils avant l’élément qui est spécifié par *iCustomizeCmd*. Le chevron est affiché à côté de la flèche vers le bas.

## <a name="cmfctoolbarenabledocking"></a><a name="enabledocking"></a>CMFCToolBar::EnableDocking

Permet l’amarrage de la vitre au cadre principal.

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>Paramètres

*dwAlignment*<br/>
[dans] Spécifie l’alignement d’amarrage pour permettre.

### <a name="remarks"></a>Notes

Cette méthode étend la mise en œuvre de la classe `CBasePane::m_dwControlBarStyle` de base, [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking), en définissant le membre des données à AFX_CBRS_FLOAT. Cette méthode passe ensuite *dwAlignment* à la mise en œuvre de la classe de base.

## <a name="cmfctoolbarenablelargeicons"></a><a name="enablelargeicons"></a>CMFCToolBar::EnableLargeIcons

Permet ou désactive de grandes icônes sur les boutons de la barre d’outils.

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour permettre aux grandes icônes, FALSE de désactiver les grandes icônes.

### <a name="remarks"></a>Notes

Par défaut, de grandes icônes sont activées.

## <a name="cmfctoolbarenablequickcustomization"></a><a name="enablequickcustomization"></a>CMFCToolBar::EnableQuickCustomization

Permet ou désactive la personnalisation rapide des barres d’outils afin que l’utilisateur puisse appuyer sur la clé **Alt** et faire glisser un bouton vers un nouvel emplacement.

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour permettre une personnalisation rapide, FALSE pour désactiver la personnalisation rapide.

## <a name="cmfctoolbarenablereflections"></a><a name="enablereflections"></a>CMFCToolBar::EnableReflections

Permet ou désactive la réflexion de commande.

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour permettre la réflexion de commande ; FALSE pour désactiver la réflexion de commande.

### <a name="remarks"></a>Notes

Appelez cette méthode pour activer la réflexion de commande pour les boutons de barre d’outils qui contiennent des commandes intégrées, telles que les boîtes combo.

Pour plus d’informations sur la réflexion de commande, voir [TN062: Message Reflection for Windows Controls](../../mfc/tn062-message-reflection-for-windows-controls.md).

## <a name="cmfctoolbarenabletextlabels"></a><a name="enabletextlabels"></a>CMFCToolBar::EnableTextLabels

Permet ou désactive les étiquettes de texte sous des images bouton de barre d’outils.

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
VRAI si les étiquettes de texte apparaissent sous des images bouton de barre d’outils ; autrement FALSE.

### <a name="remarks"></a>Notes

Si les étiquettes de texte sont activées, tous les boutons de la barre d’outils sont agrandis pour fournir de l’espace pour que les étiquettes soient affichées sous les images. La boîte de dialogue de personnalisation dispose d’une case à cocher **d’étiquette de texte Show** sur la page Des barres **d’outils.** Lorsque l’utilisateur sélectionne une barre d’outils `EnableTextLabels` et vérifie cette option, le cadre nécessite la barre d’outils sélectionnée. Vous pouvez désactiver la case à cocher pour un objet dérivé de [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) en retournant FALSE de [CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) .

## <a name="cmfctoolbarfromhandlepermanent"></a><a name="fromhandlepermanent"></a>CMFCToolBar::DeHandlePermanent

Récupère un pointeur `CMFCToolBar` sur l’objet qui contient la poignée de fenêtre donnée.

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>Paramètres

*Hwnd*<br/>
[dans] La poignée de fenêtre à rechercher.

### <a name="return-value"></a>Valeur de retour

Un pointeur `CMFCToolBar` sur l’objet qui contient la `CMFCToolBar` poignée de fenêtre donnée, ou NULL si aucun objet correspondant n’existe.

### <a name="remarks"></a>Notes

Cette méthode partagée examine chaque barre d’outils dans l’application pour l’objet `CMFCToolBar` qui contient la poignée de fenêtre donnée.

## <a name="cmfctoolbargetallbuttons"></a><a name="getallbuttons"></a>CMFCToolBar:GetAllButtons

Retourne une liste de boutons en lecture seulement dans une barre d’outils.

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Une référence constante à un objet [de classe CObList,](../../mfc/reference/coblist-class.md) qui contient une collection d’objets de [classe CMFCToolBarButton.](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="cmfctoolbargetalltoolbars"></a><a name="getalltoolbars"></a>CMFCToolBar:GetAllToolbars

Renvoie une liste de lecture uniquement de toutes les barres d’outils de l’application.

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>Valeur de retour

Une référence const à un objet de classe `CMFCToolBar` [CObList](../../mfc/reference/coblist-class.md) qui contient une collection d’objets.

## <a name="cmfctoolbargetbasiccommands"></a><a name="getbasiccommands"></a>CMFCToolBar:GetBasicCommands

Renvoie une liste de commandes de base définies dans l’application.

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>Valeur de retour

Une référence const à un objet [de classe CList](../../mfc/reference/clist-class.md) qui contient une collection de commandes de base.

### <a name="remarks"></a>Notes

Ajoutez des commandes de base en appelant [CMFCToolBar::AddBasicCommand](#addbasiccommand) ou [CMFCToolBar:SetBasicCommands](#setbasiccommands).

## <a name="cmfctoolbargetbutton"></a><a name="getbutton"></a>CMFCToolBar::GetButton

Retourne un pointeur à l’objet [cmFCToolBarButton Class](../../mfc/reference/cmfctoolbarbutton-class.md) à un index spécifié.

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>Paramètres

*iIndex (en)*<br/>
[dans] Spécifie l’index du bouton pour revenir.

### <a name="return-value"></a>Valeur de retour

Un pointeur sur le bouton de la barre d’outils s’il existe; ou NULL s’il n’y a pas un tel bouton.

## <a name="cmfctoolbargetbuttoninfo"></a><a name="getbuttoninfo"></a>CMFCToolBar::GetButtonInfo

Renvoie l’ID de commande, le style et l’index d’image du bouton à un index spécifié.

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index du bouton dans la liste des boutons sur la barre d’outils.

*nID*<br/>
[out] L’ID de commande d’un bouton.

*nStyle*<br/>
[out] Le style du bouton.

*iImage (en)*<br/>
[out] L’index de l’image pour le bouton.

### <a name="remarks"></a>Notes

La `GetButtonInfo` méthode trouve un bouton de barre d’outils à l’index spécifié et récupère l’ID de commande, le style et l’index d’image du bouton.

Si le bouton à l’index spécifié n’existe pas, le cadre définit *nID* et *nStyle* à 0, et *iImage* à -1 lorsque la méthode revient.

## <a name="cmfctoolbargetbuttonsize"></a><a name="getbuttonsize"></a>CMFCToolBar::GetButtonSize

Retourne les dimensions de chaque bouton sur la barre d’outils.

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>Valeur de retour

Un objet [CSize Class](../../atl-mfc-shared/reference/csize-class.md) qui spécifie les dimensions de chaque bouton sur la barre d’outils.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar:SetSizes](#setsizes) ou [CMFCToolBar::SetLockedSizes](#setlockedsizes) pour définir les dimensions de chaque bouton sur la barre d’outils.

## <a name="cmfctoolbargetbuttonstyle"></a><a name="getbuttonstyle"></a>CMFCToolBar::GetButtonStyle

Retourne le style actuel du bouton de la barre d’outils qui se trouve à l’index spécifié.

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index d’un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Une valeur qui spécifie le style du bouton de la barre d’outils. . Consultez [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) pour une liste de styles possibles.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar::SetButtonStyle](#setbuttonstyle) pour définir le style d’un bouton de barre d’outils

## <a name="cmfctoolbargetbuttontext"></a><a name="getbuttontext"></a>CMFCToolBar::GetButtonText

Retourne l’étiquette de texte d’un bouton qui a un index spécifié.

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index d’un bouton de barre d’outils.

*rString (en)*<br/>
[out] Le texte d’étiquette du bouton de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Le texte d’étiquette du bouton de la barre d’outils.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar::SetButtonText](#setbuttontext) ou [CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext) pour définir l’étiquette de texte.

## <a name="cmfctoolbargetcoldimages"></a><a name="getcoldimages"></a>CMFCToolBar::GetColdImages

Retourne un pointeur à la collection d’images de bouton de barre d’outils froides dans l’application.

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images froides bouton barre d’outils.

### <a name="remarks"></a>Notes

Les images froides sont les images qui sont utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils. Appelez [CMFCToolBar::LoadBitmapEx](#loadbitmapex) ou [CMFCToolBar::LoadBitmap](#loadbitmap) pour charger les images froides.

## <a name="cmfctoolbargetcolumnwidth"></a><a name="getcolumnwidth"></a>CMFCToolBar:GetColumnWidth

Retourne la largeur des boutons de la barre d’outils.

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur qui spécifie la largeur des boutons de barre d’outils.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode pour calculer la disposition des barres d’outils. Remplacer cette méthode dans une classe dérivée pour spécifier une largeur de colonne différente pour votre barre d’outils.

## <a name="cmfctoolbargetcommandbuttons"></a><a name="getcommandbuttons"></a>CMFCToolBar:GetCommandButtons

Renvoie une liste de boutons qui ont une carte d’identité de commande spécifiée à partir de toutes les barres d’outils dans l’application.

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] L’ID de commande des boutons.

*listeButtons*<br/>
[out] Une référence à un objet [CObList Class](../../mfc/reference/coblist-class.md) qui reçoit la liste des boutons de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Le nombre de boutons qui ont l’ID de commande spécifié.

## <a name="cmfctoolbargetcount"></a><a name="getcount"></a>CMFCToolBar::GetCount

Retourne le nombre de boutons et de séparateurs sur la barre d’outils.

```
int GetCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre de boutons et de séparateurs sur la barre d’outils.

## <a name="cmfctoolbargetcustomizebutton"></a><a name="getcustomizebutton"></a>CMFCToolBar::GetCustomizeButton

Récupère un pointeur `CMFCCustomizeButton` sur l’objet associé à la barre d’outils.

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur `CMFCCustomizeButton` à l’objet qui est associé à la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode récupère le bouton **Customize** qui apparaît à l’extrémité de la barre d’outils. Utilisez la méthode [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) pour ajouter le bouton **Customize** à votre barre d’outils.

Vous pouvez appeler la [cmFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton) méthode pour déterminer `CMFCCustomizeButton` si la barre d’outils contient un objet valide.

## <a name="cmfctoolbargetdefaultimage"></a><a name="getdefaultimage"></a>CMFCToolBar::GetDefaultImage

Retourne l’index de l’image par défaut pour un bouton de barre d’outils avec un IDENTIFIANT de commande spécifié.

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
[dans] Spécifie l’ID de commande du bouton.

### <a name="return-value"></a>Valeur de retour

L’index de l’image de la barre d’outils dans la liste partagée des images.

### <a name="remarks"></a>Notes

Utilisez cette méthode commune pour récupérer l’index de l’image par défaut pour un bouton de barre d’outils avec l’ID de commande spécifié. La valeur de retour est un index dans la collection partagée d’images bouton de barre d’outils pour toutes les barres d’outils de l’application. Appelez la méthode [CMFCToolBar:GetImages](#getimages) pour obtenir un pointeur à cette collection.

## <a name="cmfctoolbargetdisabledimages"></a><a name="getdisabledimages"></a>CMFCToolBar::GetDisabledImages

Retourne un pointeur à la collection d’images qui sont utilisées pour les boutons de barre d’outils désactivés dans l’application.

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images de bouton de barre d’outils désactivées.

### <a name="remarks"></a>Notes

Chargez les images de bouton de barre d’outils désactivées en utilisant la [classe CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md) et les méthodes [CMFCToolBar:LoadBitmap](#loadbitmap) méthodes.

## <a name="cmfctoolbargetdisabledmenuimages"></a><a name="getdisabledmenuimages"></a>CMFCToolBar::GetDisabledMenuImages

Retourne un pointeur à la collection d’images qui sont utilisées pour les boutons de menu désactivés dans l’application.

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images de menu désactivées.

### <a name="remarks"></a>Notes

Chargez les images désactivées en utilisant la méthode [CMFCToolBarEditBoxButton Class.](../../mfc/reference/cmfctoolbareditboxbutton-class.md)

## <a name="cmfctoolbargetdroppeddownmenu"></a><a name="getdroppeddownmenu"></a>CMFCToolBar::GetDroppedDownMenu

Récupère un pointeur sur l’objet bouton de menu qui affiche actuellement son sous-menu.

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>Paramètres

*pIndex (pIndex)*<br/>
[out] Reçoit l’index du bouton dans la collection des boutons de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Un pointeur sur l’objet bouton de menu qui affiche son sous-menu ou NULL si aucun menu n’affiche son sous-menu.

### <a name="remarks"></a>Notes

Si cette méthode renvoie une valeur non-NULL et *pIndex* n’est pas NULL, la valeur indiquée par *pIndex* est définie à l’index du bouton de menu dans la collection de boutons de barre d’outils.

## <a name="cmfctoolbargetgraydisabledbuttons"></a><a name="getgraydisabledbuttons"></a>CMFCToolBar::GetGrayDisabledButtons

Précise si les images de boutons désactivés sont des versions tamisées des images bouton régulières, ou prises à partir de la collection d’images bouton désactivées.

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI pour assombrir les images des boutons désactivés; FALSE pour obtenir des images de la collection d’images désactivées.

### <a name="remarks"></a>Notes

Utilisez [CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons) pour passer d’images tamisées à des images de la collection d’images désactivées.

## <a name="cmfctoolbargethighlightedbutton"></a><a name="gethighlightedbutton"></a>CMFCToolBar::GetHighlightedButton

Retourne un pointeur sur le bouton de la barre d’outils qui est actuellement mis en surbrillance.

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet bouton de barre d’outils ; ou NULL si aucun bouton n’est mis en surbrillance.

### <a name="remarks"></a>Notes

Un bouton de barre d’outils est mis en surbrillance s’il a une mise au point du clavier. Un bouton de barre d’outils est également mis en évidence si les boutons de la barre d’outils sont suivis à chaud dans cette application (pour plus d’informations, voir [CMFCToolBar::GetHotBorder](#gethotborder) et [CMFCToolBar::SetHotBorder](#sethotborder)) et la souris est pointant vers elle quand aucun bouton de barre d’outils ou élément de menu a mise au point du clavier.

## <a name="cmfctoolbargethotborder"></a><a name="gethotborder"></a>CMFCToolBar:GetHotBorder

Détermine si les boutons de la barre d’outils sont *suivis à chaud*. Si un bouton est suivi à chaud, il est mis en surbrillance lorsque la souris se déplace à travers elle.

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si les boutons de la barre d’outils sont suivis à chaud; autrement, FALSE.

### <a name="remarks"></a>Notes

Par défaut, les boutons de la barre d’outils sont suivis à chaud.

## <a name="cmfctoolbargethottextcolor"></a><a name="gethottextcolor"></a>CMFCToolBar::GetHotTextColor

Retourne la couleur de texte des boutons de barre d’outils mis en surbrillance.

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>Valeur de retour

Une valeur [COLORREF](/windows/win32/gdi/colorref) qui représente la couleur actuelle du texte mis en évidence.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar::SetHotTextColor](#sethottextcolor) pour définir une nouvelle couleur de texte pour les boutons de barre d’outils mis en évidence.

## <a name="cmfctoolbargethwndlastfocus"></a><a name="gethwndlastfocus"></a>CMFCToolBar::GetHwndLastFocus

Retourne une poignée à la fenêtre qui avait la mise au point d’entrée juste avant la barre d’outils.

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Une poignée à la fenêtre qui n’est pas dérivée de [cmFCBaseToolBar Class](../../mfc/reference/cmfcbasetoolbar-class.md), qui avait auparavant la mise au point d’entrée; ou NULL s’il n’y a pas une telle fenêtre.

### <a name="remarks"></a>Notes

Lorsqu’un `CMFCToolBar` contrôle reçoit la mise au point d’entrée, il stocke une poignée à la fenêtre qui a perdu la mise au point afin qu’il puisse le restaurer plus tard.

## <a name="cmfctoolbargetignoresettext"></a><a name="getignoresettext"></a>CMFCToolBar::GetIgnoreSetText

Précise si les appels pour définir des étiquettes de bouton sont ignorés.

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si les appels pour définir des étiquettes de bouton sont ignorés ; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbargetimages"></a><a name="getimages"></a>CMFCToolBar::GetImages

Retourne un pointeur à la collection d’images bouton par défaut dans l’application.

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur de l’objet [CMFCToolBarImages Class](../../mfc/reference/cmfctoolbarimages-class.md) qui contient la collection d’images par défaut pour toutes les barres d’outils de l’application.

### <a name="remarks"></a>Notes

Cette méthode partagée donne accès à la collection de toutes les images par défaut de la barre d’outils pour l’application. Appelez la méthode [CMFCToolBar::LoadBitmap](#loadbitmap) pour ajouter des images à la collection.

## <a name="cmfctoolbargetimagesize"></a><a name="getimagesize"></a>CMFCToolBar::GetImageSize

Retourne la taille actuelle des images bouton de barre d’outils.

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>Valeur de retour

Un objet [CSize Class](../../atl-mfc-shared/reference/csize-class.md) qui représente la taille actuelle des images bouton de barre d’outils.

## <a name="cmfctoolbargetimagesoffset"></a><a name="getimagesoffset"></a>CMFCToolBar::GetImagesOffset

Retourne le décalage d’index utilisé pour trouver les images bouton de barre d’outils pour cette barre d’outils dans la liste globale des images de bouton de barre d’outils.

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>Valeur de retour

L’index compense les images de la barre d’outils.

### <a name="remarks"></a>Notes

Toutes les images par défaut de barre d’outils sont stockées dans la liste globale [de classe CMFCToolBarImages.](../../mfc/reference/cmfctoolbarimages-class.md) Les images de chaque bouton de la barre d’outils sont stockées consécutivement dans cette liste. Pour calculer l’index de l’image, ajoutez l’index du bouton dans la barre d’outils au décalage du début de la liste des images pour ce bouton de barre d’outils.

Appelez [CMFCToolBar::ButtonToIndex](#buttontoindex) pour obtenir l’index d’un bouton de barre d’outils donné un pointeur sur le bouton.

Appelez [CMFCToolBar::GetImages](#getimages) pour obtenir un pointeur à la collection d’images de barres d’outils.

## <a name="cmfctoolbargetinvalidateitemrect"></a><a name="getinvalidateitemrect"></a>CMFCToolBar::GetInvalidateItemRect

Récupère la région de la zone client qui doit être redessiné pour le bouton à l’index donné.

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index du bouton pour lequel récupérer la zone client.

*lpRect*<br/>
[out] Un pointeur vers un objet RECT qui reçoit la région de la zone client.

### <a name="remarks"></a>Notes

Le *paramètre lpRect* ne doit pas être NULL. S’il n’existe pas de bouton à l’index fourni, *lpRect* reçoit un objet RECT qui est paraséqué à zéro.

## <a name="cmfctoolbargetitemid"></a><a name="getitemid"></a>CMFCToolBar::GetItemID

Retourne l’ID de commande du bouton de la barre d’outils à un index spécifié.

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index du bouton de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

L’ID de commande du bouton de la barre d’outils; ou zéro si le bouton avec l’index spécifié n’existe pas.

## <a name="cmfctoolbargetitemrect"></a><a name="getitemrect"></a>CMFCToolBar::GetItemRect

Retourne le rectangle de délimitation du bouton à un index spécifié.

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index d’un bouton de barre d’outils.

*lpRect*<br/>
[out] Un pointeur à `CRect` objecter qui reçoit les coordonnées du rectangle de délimitation de l’image.

### <a name="remarks"></a>Notes

L’objet `CRect` auquel les points *lpRect* est réglé à 0 si un bouton à l’index spécifié n’existe pas.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `GetItemRect` utiliser `CMFCToolBar` la méthode de la classe. Cet extrait de code fait partie de [l’échantillon de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="cmfctoolbargetlargecoldimages"></a><a name="getlargecoldimages"></a>CMFCToolBar::GetLargeColdImages

Retourne un pointeur à la collection de grandes images froides de bouton de barre d’outils dans l’application.

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection de grandes images froides.

### <a name="remarks"></a>Notes

Les images froides sont les images qui sont utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils. Appelez [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les grandes images froides.

## <a name="cmfctoolbargetlargedisabledimages"></a><a name="getlargedisabledimages"></a>CMFCToolBar::GetLargeDisabledImages

Retourne un pointeur à la collection de grandes images de bouton de barre d’outils désactivées dans l’application.

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection de grandes images de bouton de barre d’outils désactivées.

### <a name="remarks"></a>Notes

Les grandes images sont de grandes versions des images régulières de bouton de barre d’outils. Appelez [CMFCToolBar::LoadBitmapEx](#loadbitmapex) ou [CMFCToolBar::LoadBitmap](#loadbitmap) pour charger les grandes images.

## <a name="cmfctoolbargetlargeimages"></a><a name="getlargeimages"></a>CMFCToolBar::GetLargeImages

Retourne un pointeur à la collection de grandes images bouton de barre d’outils dans l’application.

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection de grandes images bouton de barre d’outils.

### <a name="remarks"></a>Notes

Les grandes images sont de grandes versions des images régulières de bouton de barre d’outils. Appelez [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les grandes images.

## <a name="cmfctoolbargetlockedcoldimages"></a><a name="getlockedcoldimages"></a>CMFCToolBar::GetLockedColdImages

Retourne un pointeur à la collection d’images froides verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images froides verrouillées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images régulières du bouton de la barre d’outils que le cadre utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils. Les images froides sont les images qui sont utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils.

Cette méthode renvoie NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également une défaillance d’affirmation dans Debug construit si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, voir [CMFCToolBar::IsLocked](#islocked).

Appelez la méthode [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les images froides verrouillées.

## <a name="cmfctoolbargetlockeddisabledimages"></a><a name="getlockeddisabledimages"></a>CMFCToolBar::GetLockedDisabledImages

Retourne un pointeur à la collection d’images désactivées verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images désactivées verrouillées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images régulières du bouton de la barre d’outils que le cadre utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils. Les images désactivées sont les images que le cadre utilise lorsqu’un bouton a le style TBBS_DISABLED.

Cette méthode renvoie NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également une défaillance d’affirmation dans Debug construit si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, voir [CMFCToolBar::IsLocked](#islocked).

Appelez la méthode [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les images désactivées verrouillées.

## <a name="cmfctoolbargetlockedimages"></a><a name="getlockedimages"></a>CMFCToolBar::GetLockedImages

Retourne un pointeur à la collection d’images bouton verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images verrouillées bouton barre d’outils, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images régulières du bouton de la barre d’outils que le cadre utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode renvoie NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également une défaillance d’affirmation dans Debug construit si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, voir [CMFCToolBar::IsLocked](#islocked).

## <a name="cmfctoolbargetlockedimagesize"></a><a name="getlockedimagesize"></a>CMFCToolBar::GetLockedImageSize

Retourne la taille par défaut des images verrouillées de barre d’outils.

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>Valeur de retour

Une `CSize` structure qui spécifie la taille `CSize` d’images verrouillées de barres d’outils ou d’une structure vide si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images régulières du bouton de la barre d’outils que le cadre utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode `CSize` renvoie une structure avec une largeur nulle et une hauteur nulle si la barre d’outils n’est pas verrouillée. Cette méthode génère également une défaillance d’affirmation dans Debug construit si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, voir [CMFCToolBar::IsLocked](#islocked).

Appelez la méthode [CMFCToolBar::SetLockedSizes](#setlockedsizes) pour spécifier la taille de l’image verrouillée.

## <a name="cmfctoolbargetlockedmenuimages"></a><a name="getlockedmenuimages"></a>CMFCToolBar::GetLockedMenuImages

Retourne un pointeur à la collection d’images verrouillées de menu de barres d’outils dans la barre d’outils.

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images verrouillées de menu de barre d’outils, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images régulières du menu de barres d’outils que le cadre utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode renvoie NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également une défaillance d’affirmation dans Debug construit si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, voir [CMFCToolBar::IsLocked](#islocked).

Appelez la méthode [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les images verrouillées du menu.

## <a name="cmfctoolbargetmenubuttonsize"></a><a name="getmenubuttonsize"></a>CMFCToolBar::GetMenuButtonSize

Retourne la taille des boutons de menu dans l’application.

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>Valeur de retour

Un `CSize` objet qui représente la taille des boutons de menu, en pixels.

### <a name="remarks"></a>Notes

La taille des boutons de menu sur les barres d’outils est maintenue comme une variable globale et peut être récupérée par cette méthode statique.

Appelez [CMFCToolBar::SetMenuSizes](#setmenusizes) pour définir cette variable globale.

## <a name="cmfctoolbargetmenuimages"></a><a name="getmenuimages"></a>CMFCToolBar::GetMenuImages

Retourne un pointeur à la collection d’images bouton de menu dans l’application.

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la collection d’images de menu.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar::LoadBitmapEx](#loadbitmapex) pour charger les images du menu.

Appelez la [méthode CMFCToolBar::SetMenuSizes](#setmenusizes) pour définir la taille des boutons et leurs images.

## <a name="cmfctoolbargetmenuimagesize"></a><a name="getmenuimagesize"></a>CMFCToolBar::GetMenuImageSize

Retourne la taille des images bouton de menu dans l’application.

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>Valeur de retour

Un `CSize` objet qui représente la taille des images de menu.

### <a name="remarks"></a>Notes

Cette méthode renvoie la taille des images sur les boutons de menu de barre d’outils qui est maintenu comme une variable globale. Appelez [CMFCToolBar::SetMenuSizes](#setmenusizes) pour définir cette variable globale.

## <a name="cmfctoolbargetorigbuttons"></a><a name="getorigbuttons"></a>CMFCToolBar:GetOrigButtons

Récupère la collection de boutons non personnalisés de la barre d’outils.

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Une référence à la liste des boutons non personnalisés de la barre d’outils.

### <a name="remarks"></a>Notes

Le cadre crée une copie des boutons de barre d’outils avant qu’ils ne soient personnalisés par l’utilisateur. La méthode [CMFCToolBar::SetButtons](#setbuttons) ajoute une copie de chaque bouton dans le tableau fourni à la liste des boutons d’origine. La [méthode CMFCToolBar::RestoreOriginalState](#restoreoriginalstate) restaure l’état d’origine de la barre d’outils en la chargeant à partir du fichier de ressources.

Pour définir la liste des boutons d’origine pour votre barre d’outils, appelez la méthode [CMFCToolBar::SetOrigButtons.](#setorigbuttons)

## <a name="cmfctoolbargetorigresetbuttons"></a><a name="getorigresetbuttons"></a>CMFCToolBar:GetOrigResetButtons

Récupère la collection de boutons de réinitialisation non personnalisés de la barre d’outils.

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Une référence à la liste des boutons de réinitialisation non personnalisés de la barre d’outils.

### <a name="remarks"></a>Notes

Lorsque l’utilisateur clique sur le bouton **Reset** en mode personnalisation, le cadre utilise cette méthode pour restaurer les boutons qui ont été supprimés de la barre d’outils.

La méthode [CMFCToolBar::SetButtons](#setbuttons) ajoute une copie de chaque bouton de barre d’outils à la liste des boutons de réinitialisation d’origine après avoir appelé la méthode [CMFCToolBar::OnReset.](#onreset) Vous pouvez remplacer la méthode [CMFCToolBar::OnReset](#onreset) pour personnaliser l’apparence des boutons après que l’utilisateur appuyez sur le bouton **Reset.**

## <a name="cmfctoolbargetresourceid"></a><a name="getresourceid"></a>CMFCToolBar::GetResourceID

Récupère l’id de ressources de la barre d’outils.

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>Valeur de retour

L’ID de ressource de la barre d’outils.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar::LoadToolBarEx](#loadtoolbarex) pour définir l’ID de ressources de la barre d’outils.

## <a name="cmfctoolbargetroutecommandsviaframe"></a><a name="getroutecommandsviaframe"></a>CMFCToolBar::GetRouteCommandsViaFrame

Détermine quel objet, le cadre parent ou le propriétaire, envoie des commandes à la barre d’outils.

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le cadre parent envoie des commandes à la barre d’outils; 0 si le propriétaire envoie des commandes à la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, le cadre parent envoie des commandes à la barre d’outils. Appelez [CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe) pour changer ce comportement.

Si cette méthode renvoie une valeur non zéro, vous pouvez récupérer `CMFCToolBar::GetCommandTarget` un pointeur sur l’objet cadre parent en utilisant la méthode. Consultez l’échantillon VisualStudioDemo par exemple qui utilise cette méthode.

## <a name="cmfctoolbargetrowheight"></a><a name="getrowheight"></a>CMFCToolBar:GetRowHeight

Retourne la hauteur des boutons de barre d’outils.

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>Valeur de retour

La hauteur des boutons de barre d’outils, en pixels.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode pour calculer la disposition des barres d’outils. Remplacer cette méthode dans une classe dérivée pour spécifier une hauteur différente pour votre barre d’outils.

## <a name="cmfctoolbargetshowtooltips"></a><a name="getshowtooltips"></a>CMFCToolBar::GetShowTooltips

Précise si des conseils d’outils sont affichés pour les boutons de barre d’outils.

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>Valeur de retour

VRAI si des conseils d’outils sont affichés pour les boutons de barre d’outils; autrement FALSE.

### <a name="remarks"></a>Notes

Par défaut, des conseils d’outils sont affichés. Vous pouvez changer ce drapeau statique en appelant [CMFCToolBar::SetShowTooltips](#setshowtooltips).

## <a name="cmfctoolbargetsiblingtoolbar"></a><a name="getsiblingtoolbar"></a>CMFCToolBar::GetSiblingToolBar

Récupère le frère de la barre d’outils.

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la barre d’outils frère.

### <a name="remarks"></a>Notes

Pour plus d’informations sur la façon d’activer les **boutons d’exposition sur one Row** et afficher les boutons sur les boutons Two **Rows,** voir [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="cmfctoolbargetuserimages"></a><a name="getuserimages"></a>CMFCToolBar::GetUserImages

Retourne un pointeur à la collection d’images de bouton de barre d’outils définies par l’utilisateur dans l’application.

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur pour la collecte d’images de bouton de barre d’outils définies par l’utilisateur pour toutes les barres d’outils de l’application.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar::SetUserImages](#setuserimages) pour définir la collection d’images définies par l’utilisateur dans l’application.

## <a name="cmfctoolbarhittest"></a><a name="hittest"></a>CMFCToolBar::HitTest

Retourne l’index du bouton de la barre d’outils qui se trouve à la position spécifiée.

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>Paramètres

*Point*<br/>
[dans] Le point à tester, dans les coordonnées des clients.

### <a name="return-value"></a>Valeur de retour

L’index du bouton qui se trouve à la position spécifiée, ou -1 s’il n’y a pas un tel bouton ou le bouton est un séparateur.

## <a name="cmfctoolbarinsertbutton"></a><a name="insertbutton"></a>CMFCToolBar:InsertButton

Insère un bouton dans la barre d’outils.

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>Paramètres

*Bouton*<br/>
[dans] Spécifie le bouton à insérer.

*iInsertAt*<br/>
[dans] Spécifie la position à base zéro pour insérer le bouton à.

### <a name="return-value"></a>Valeur de retour

La position à laquelle le bouton a été inséré ou -1 en cas d’erreur.

### <a name="remarks"></a>Notes

Si *iInsertAt* est -1, cette méthode ajoute le bouton à la fin de la liste des boutons de barre d’outils.

Appelez la [CMFCToolBar::InsertSeparator](#insertseparator) méthode pour insérer un séparateur dans la barre d’outils.

## <a name="cmfctoolbarinsertseparator"></a><a name="insertseparator"></a>CMFCToolBar:InsertSeparator

Insère un séparateur dans la barre d’outils.

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>Paramètres

*iInsertAt*<br/>
[dans] Spécifie la position à base de zéro pour insérer le séparateur à. Ce paramètre doit être supérieur à 0.

### <a name="return-value"></a>Valeur de retour

La position à laquelle le séparateur a été inséré ou -1 en cas d’erreur.

### <a name="remarks"></a>Notes

Appelez cette méthode pour insérer un séparateur entre deux boutons existants. Si *iInsertAt* est -1, cette méthode ajoute le séparateur à la fin de la liste des boutons de barre d’outils.

Vous ne pouvez pas utiliser cette méthode pour ajouter un séparateur à une barre d’outils vide.

Appelez la [méthode CMFCToolBar:InsertButton](#insertbutton) pour insérer un bouton dans la barre d’outils.

## <a name="cmfctoolbarinvalidatebutton"></a><a name="invalidatebutton"></a>CMFCToolBar::InvalidateButton

Invalide la zone client du bouton de la barre d’outils qui existe à l’index fourni.

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index zéro du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Un pointeur `CMFCToolBarButton` sur l’objet qui existe à l’index fourni ou NULL si aucun objet de ce genre n’existe.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’elle met à jour la zone client associée à un bouton de barre d’outils. Il appelle la méthode [CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect) avec `CMFCToolBarButton` le rectangle client de l’objet qui existe à l’index fourni.

## <a name="cmfctoolbarisaddremovequickcustomize"></a><a name="isaddremovequickcustomize"></a>CMFCToolBar::IsAddRemoveQuickCustomize

Détermine si un utilisateur peut ajouter ou supprimer les boutons de la barre d’outils en utilisant l’option de menu **Personnaliser.**

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>Valeur de retour

VRAI si un utilisateur peut utiliser l’option de menu **Customize** pour modifier la barre d’outils; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarisaltcustomizemode"></a><a name="isaltcustomizemode"></a>CMFCToolBar::IsAltCustomizeMode

Précise si *une personnalisation rapide* est utilisée pour faire glisser un bouton. Lorsque la personnalisation rapide est activée, un utilisateur peut appuyer et tenir la clé Alt et faire glisser un bouton vers un nouvel emplacement.

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>Valeur de retour

VRAI si la personnalisation rapide est utilisée pour faire glisser un bouton; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarisautograyinactiveimages"></a><a name="isautograyinactiveimages"></a>CMFCToolBar::IsAutoGrayInactiveImages

Précise si la génération automatique d’images bouton inactives (non surespéritées) est activée.

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>Valeur de retour

VRAI si l’option de dimer automatiquement les images inactives est activée; autrement FALSE.

### <a name="remarks"></a>Notes

Vous pouvez activer ou désactiver la gradation automatique des images inactives en appelant [CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages).

## <a name="cmfctoolbarisbasiccommand"></a><a name="isbasiccommand"></a>CMFCToolBar::IsBasicCommand

Détermine si une commande figure sur la liste des commandes de base.

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] Spécifie l’ordre de vérifier.

### <a name="return-value"></a>Valeur de retour

VRAI si la commande spécifiée appartient à la liste des commandes de base; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode statique détermine si la commande spécifiée par *uiCmd* appartient à la liste globale des commandes de base. Vous pouvez modifier la liste des commandes de base en appelant [CMFCToolBar::AddBasicCommand](#addbasiccommand) ou [CMFCToolBar:SetBasicCommands](#setbasiccommands).

## <a name="cmfctoolbarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a>CMFCToolBar:IsButtonExtrasizeAvailable

Détermine si la barre d’outils peut afficher les boutons qui ont des bordures étendues.

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre peut afficher des boutons avec la taille supplémentaire de la bordure; autrement FALSE.

### <a name="remarks"></a>Notes

L’objet de la barre d’outils renvoie VRAI s’il peut afficher des boutons qui ont étendu les bordures. Un bouton de barre d’outils appelle cette méthode lorsqu’il gère le [CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd) notification et définira son drapeau interne de taille de bordure supplémentaire en conséquence. Ce drapeau interne peut être récupéré plus tard en appelant [CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize).

Remplacer cette méthode dans une `CMFCToolBar` classe dérivée et retourner VRAI si votre barre peut afficher les boutons de la barre d’outils avec la taille de la bordure supplémentaire et retourner FALSE autrement. La implémentation par défaut renvoie TRUE.

## <a name="cmfctoolbarisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CMFCToolBar:IsButtonHighlighted

Détermine si le bouton spécifié est mis en surbrillance.

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>Paramètres

*iButton (en)*<br/>
[dans] Spécifie l’index d’un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

VRAI si le bouton spécifié est mis en surbrillance; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbariscommandpermitted"></a><a name="iscommandpermitted"></a>CMFCToolBar::IsCommandPermitted

Détermine si une commande est autorisée.

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] Spécifie l’ordre de vérifier.

### <a name="return-value"></a>Valeur de retour

VRAI si la commande spécifiée est autorisée; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode statique détermine si la commande spécifiée par *uiCmd* appartient à la liste globale des commandes non autorisées.

Vous pouvez modifier la liste des commandes non autorisées en appelant [CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands).

## <a name="cmfctoolbariscommandrarelyused"></a><a name="iscommandrarelyused"></a>CMFCToolBar::IsCommandRarelyUsed

Détermine si une commande est rarement utilisée.

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] Spécifie l’ordre de vérifier.

### <a name="return-value"></a>Valeur de retour

VRAI si la commande spécifiée est rarement utilisée; autrement FALSE.

### <a name="remarks"></a>Notes

La `IsCommandRarelyUsed` méthode renvoie FALSE lorsqu’une ou plusieurs des conditions suivantes se produisent :

- La commande spécifiée appartient à la liste des commandes de base

- La commande spécifiée est l’une des commandes standard

- Le cadre est en mode personnalisation

- La liste des commandes de base est vide

- Plus de 20 % des appels de commande sont des appels à la commande spécifiée.

## <a name="cmfctoolbariscustomizemode"></a><a name="iscustomizemode"></a>CMFCToolBar::IsCustomizeMode

Précise si le cadre de la barre d’outils est en mode personnalisation.

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>Valeur de retour

VRAI si le cadre est en mode personnalisation; autrement FALSE.

### <a name="remarks"></a>Notes

Vous pouvez basculer le mode de personnalisation en appelant [CMFCToolBar::SetCustomizeMode](#setcustomizemode).

Le cadre change le mode lorsque l’utilisateur invoque la boîte de dialogue de personnalisation ( [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)).

## <a name="cmfctoolbarisdragbutton"></a><a name="isdragbutton"></a>CMFCToolBar::IsDragButton

Détermine si un bouton de barre d’outils est traîné.

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Pointeur sur un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

VRAI si le bouton spécifié est traîné; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarisexistcustomizebutton"></a><a name="isexistcustomizebutton"></a>CMFCToolBar:IsExistCustomizeButton

Détermine si la barre d’outils contient le bouton **Customize.**

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils contient le bouton **Customize;** autrement FALSE.

### <a name="remarks"></a>Notes

Si cette méthode renvoie VRAI, la [méthode CMFCToolBar::GetCustomizeButton](#getcustomizebutton) méthode renvoie un pointeur sur le bouton **Customize** qui apparaît à l’extrémité de la barre d’outils.

Utilisez la méthode [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton) pour ajouter le bouton **Customize** à votre barre d’outils.

## <a name="cmfctoolbarisfloating"></a><a name="isfloating"></a>CMFCToolBar::IsFloating

Détermine si la barre d’outils flotte.

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils flotte; autrement, FALSE.

## <a name="cmfctoolbarislargeicons"></a><a name="islargeicons"></a>CMFCToolBar::IsLargeIcons

Précise si les barres d’outils de l’application affichent actuellement de grandes icônes.

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>Valeur de retour

VRAI si l’application utilise de grandes icônes; autrement FALSE.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar::SetLargeIcons](#setlargeicons) à basculer entre les grandes icônes et les icônes régulières.

Le cadre modifie automatiquement le mode lorsque l’utilisateur bascule la case à cocher **des grandes icônes** sur la page **Options** de la boîte de dialogue **Customization.**

## <a name="cmfctoolbarislastcommandfrombutton"></a><a name="islastcommandfrombutton"></a>CMFCToolBar::IsLastCommandDeButton

Détermine si la commande la plus récemment exécutée a été envoyée à partir du bouton de barre d’outils spécifié.

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Pointeur au bouton.

### <a name="return-value"></a>Valeur de retour

VRAI si la dernière commande a été envoyée à partir du bouton qui *pButton* spécifie; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode obtient un pointeur à `CWnd::GetCurrentMessage`une [structure MSG](/windows/win32/api/winuser/ns-winuser-msg) en appelant . Il compare ensuite le HWND du `MSG::lParam` `MSG::hwnd` bouton avec le et les membres pour déterminer si le bouton était la source de la commande.

## <a name="cmfctoolbarislocked"></a><a name="islocked"></a>CMFCToolBar:IsLocked

Détermine si la barre d’outils est verrouillée.

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils est verrouillée; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode renvoie TRUE lorsque l’utilisateur ne peut pas effectuer des tâches de personnalisation telles que le repositionnement des boutons de barre d’outils.

Les barres d’outils verrouillées utilisent des listes d’images distinctes. Pour plus d’informations sur ces listes d’images, voir [CMFCToolBar::LoadBitmapEx](#loadbitmapex).

## <a name="cmfctoolbarisonerowwithsibling"></a><a name="isonerowwithsibling"></a>CMFCToolBar::IsOneRowWithSibling

Détermine si la barre d’outils et sa barre d’outils de frère sont positionnés sur la même rangée.

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils et son frère sont positionnés sur la même rangée; autrement FALSE.

### <a name="remarks"></a>Notes

La [méthode CMFCCustomizeButton::CreatePopupMenu](internal-classes.md) méthode appelle cette méthode pour déterminer comment afficher le menu pop-up **Customize.** Si cette méthode renvoie TRUE, le cadre affiche les boutons Afficher sur le bouton **One Row.** Dans le cas contraire, le cadre affiche les boutons Afficher sur le bouton **Two Rows.**

En règle générale, vous n'avez pas à utiliser cette méthode. Pour activer les **boutons d’exposition sur une rangée** ou afficher les boutons sur deux boutons de **lignes,** appelez [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar).

## <a name="cmfctoolbarisresourcechanged"></a><a name="isresourcechanged"></a>CMFCToolBar::IsResourceChanged

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarissibling"></a><a name="issibling"></a>CMFCToolBar::IsSibling

```
BOOL IsSibling();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarisuserdefined"></a><a name="isuserdefined"></a>CMFCToolBar:IsUserDéfined

Précise si la barre d’outils est définie par l’utilisateur.

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre d’outils a été créée par l’utilisateur; autrement FALSE.

## <a name="cmfctoolbarloadbitmap"></a><a name="loadbitmap"></a>CMFCToolBar::LoadBitmap

Charge les images de barre d’outils à partir des ressources de l’application.

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images hot toolbar.

*uiColdResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images froides de barre d’outils.

*uiMenuResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images régulières de menu.

*Bloqué*<br/>
[dans] VRAI pour verrouiller la barre d’outils; autrement FALSE.

*uiDisabledResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images de barre d’outils désactivées.

*uiMenuDisabledResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images de menu désactivées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

La méthode [CMFCToolBar::LoadToolBarEx](#loadtoolbarex) appelle cette méthode pour charger les images qui sont associées à la barre d’outils. Surchargez cette méthode pour effectuer un chargement personnalisé des ressources d’images.

Appelez la méthode `LoadBitmapEx` pour charger des images supplémentaires après avoir créé la barre d’outils.

## <a name="cmfctoolbarloadbitmapex"></a><a name="loadbitmapex"></a>CMFCToolBar::LoadBitmapEx

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>Paramètres

[dans] *params*<br/>
[dans] *bLocked*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarloadlargeiconsstate"></a><a name="loadlargeiconsstate"></a>CMFCToolBar::LoadLargeIconsState

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>Paramètres

[dans] *lpszProfileName*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarloadparameters"></a><a name="loadparameters"></a>CMFCToolBar::LoadParameters

Charge les options globales de barres d’outils du registre Windows.

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
[dans] Spécifie le chemin relatif de la clé de registre Windows.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode charge des paramètres globaux tels que le type d’animation de menu, le style d’ombre de menu, et s’il faut afficher de grandes icônes du registre Windows.

La méthode [CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate) appelle cette méthode dans le cadre du processus d’initialisation de l’application.

## <a name="cmfctoolbarloadstate"></a><a name="loadstate"></a>CMFCToolBar::LoadState

Charge les informations d’état de la barre d’outils du registre Windows.

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
[dans] Spécifie le chemin relatif de la clé de registre Windows.

*nIndex*<br/>
[dans] Spécifie l’ID de contrôle de la barre d’outils.

*uiID*<br/>
[dans] Spécifie l’ID de ressources de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode dans le cadre du processus d’initialisation de la demande. Pour plus d’informations, voir [CWinAppEx:LoadState](../../mfc/reference/cwinappex-class.md#loadstate).

## <a name="cmfctoolbarloadtoolbar"></a><a name="loadtoolbar"></a>CMFCToolBar::LoadToolBar

Charge la barre d’outils à partir des ressources d’application.

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
[dans] L’ID de ressource de la barre d’outils.

*uiColdResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images froides de barre d’outils.

*uiMenuResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images régulières de menu.

*Bloqué*<br/>
[dans] Une valeur Boolean qui précise si la barre d’outils est verrouillée ou non. Si ce paramètre est *VRAI,* la barre d’outils est verrouillée. Sinon, la barre d’outils n’est pas verrouillée.

*uiDisabledResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images de barre d’outils désactivées.

*uiMenuDisabledResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images de menu désactivées.

*uiHotResID*<br/>
[dans] L’ID de ressource de la bitmap qui se réfère aux images hot toolbar.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lors de l’initialisation pour charger les images qui sont associées à la barre d’outils.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `LoadToolBar` utiliser `CMFCToolBar` la méthode dans la classe. Cet extrait de code fait partie de [l’échantillon de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbarloadtoolbarex"></a><a name="loadtoolbarex"></a>CMFCToolBar::LoadToolBarEx

Charge la barre d’outils à `CMFCToolBarInfo` partir des ressources d’application en utilisant la classe d’aide pour permettre à l’application d’utiliser de grandes images.

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiToolbarResID*<br/>
[dans] L’ID de ressource de la barre d’outils.

*params*<br/>
[dans] Une référence `CMFCToolBarInfo` à un objet qui contient les Œd de ressources pour les images de la barre d’outils.

*Bloqué*<br/>
[dans] Une valeur Boolean qui précise si la barre d’outils est verrouillée ou non. Si ce paramètre est VRAI, la barre d’outils est verrouillée. Sinon, la barre d’outils n’est pas verrouillée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez cette méthode pour charger les images de barres d’outils à partir des ressources d’application.

## <a name="cmfctoolbarm_dbllargeimageratio"></a><a name="m_dbllargeimageratio"></a>CMFCToolBar:m_dblLargeImageRatio

Spécifie le rapport entre la dimension (hauteur ou largeur) des grandes images et la dimension des images régulières.

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>Notes

Le ratio par défaut est de 2. Vous pouvez modifier cette valeur pour rendre les grandes images de barres d’outils plus grandes ou plus petites.

Le cadre utilise ce membre de données lorsque vous ne spécifiez pas un ensemble de grandes images. Par exemple, si vous ne fournissez que l’ensemble de petites images avec la taille 16x16 et que vous souhaitez que les grandes images aient la taille 24x24, définissez ce membre de données à 1,5.

## <a name="cmfctoolbarnextmenu"></a><a name="nextmenu"></a>CMFCToolBar::NextMenu

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbaronbeforeremovebutton"></a><a name="onbeforeremovebutton"></a>CMFCToolBar::OnBeforeRemoveButton

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[in] Inutilisé.

*dropEffect*<br/>
[in] Inutilisé.

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbaronchangehot"></a><a name="onchangehot"></a>CMFCToolBar::OnChangeHot

Appelé par le cadre quand un utilisateur sélectionne un bouton sur la barre d’outils.

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>Paramètres

*iHot (en)*<br/>
[dans] Spécifie l’index du bouton de la barre d’outils qui est sélectionné; ou -1 si aucun bouton de barre d’outils n’est sélectionné.

### <a name="remarks"></a>Notes

Remplacez cette méthode pour traiter les notifications que l’utilisateur a sélectionnées sur une barre d’outils.

## <a name="cmfctoolbaronchangevisualmanager"></a><a name="onchangevisualmanager"></a>CMFCToolBar::OnChangeVisualManager

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbaronfillbackground"></a><a name="onfillbackground"></a>CMFCToolBar::OnFillBackground

Appelé par le cadre de [CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint) pour remplir l’arrière-plan de la barre d’outils.

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[dans] Un pointeur vers un contexte d’appareil.

### <a name="remarks"></a>Notes

[CMFCToolBar::DoPaint](#dopaint) appelle cette méthode lorsque l’arrière-plan d’une barre d’outils a été rempli. L'implémentation par défaut n'exécute aucune opération.

Remplacer cette méthode pour dessiner un fond personnalisé dans les classes dérivées.

## <a name="cmfctoolbaronglobalfontschanged"></a><a name="onglobalfontschanged"></a>CMFCToolBar::OnGlobalFontsChanged

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbaronreset"></a><a name="onreset"></a>CMFCToolBar::OnReset

Restaure la barre d’outils à son état d’origine.

```
virtual void OnReset();
```

### <a name="remarks"></a>Notes

Remplacer cette méthode pour gérer la notification concernant une réinitialisation de la barre d’outils.

L'implémentation par défaut n'exécute aucune opération. Remplacer `OnReset` dans une classe `CMFCToolBar` dérivée du moment où la barre d’outils a des boutons factices qui doivent être remplacés lorsque la barre d’outils retourne à son état d’origine.

## <a name="cmfctoolbaronsetaccdata"></a><a name="onsetaccdata"></a>CMFCToolBar::OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>Paramètres

[dans] *lVal (En)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a>CMFCToolBar::OnSetDefaultButtonText

Restaure le texte d’un bouton de barre d’outils à son état par défaut.

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Points à un bouton, dont le texte est en cours de jeu.

### <a name="return-value"></a>Valeur de retour

VRAI si le texte a été restauré avec succès; autrement FALSE.

### <a name="remarks"></a>Notes

Remplacez cette méthode pour traiter les notifications que le texte d’un bouton de barre d’outils est modifié à sa valeur par défaut.

La implémentation par défaut charge le texte d’un bouton à partir des ressources d’application.

## <a name="cmfctoolbaronusertooltip"></a><a name="onusertooltip"></a>CMFCToolBar::OnUserToolTip

Appelé par le cadre lorsque l’outiltip pour un bouton est sur le point d’être affiché.

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Indique un bouton de barre d’outils pour lequel un tooltip doit être affiché.

*strTTText*<br/>
[out] Une référence `CString` à l’objet qui reçoit le texte de l’outiltip.

### <a name="return-value"></a>Valeur de retour

VRAI si *strTTText* était peuplé de texte tooltip; autrement FALSE.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsque le bout d’outil d’un bouton de barre d’outils est sur le point d’être affiché. Si `OnUserToolTip` vous retournez VRAI, le cadre affiche un `OnUserToolTip` tooltip qui contient le texte retourné par *strTTText*. Sinon, l’outil contient le texte du bouton.

Remplacer `OnUserToolTip` pour personnaliser les conseils d’outils des boutons de barre d’outils. La implémentation par défaut appelle [CMFCToolBar::OnUserToolTip](#onusertooltip) pour obtenir le texte tooltip.

## <a name="cmfctoolbarprevmenu"></a><a name="prevmenu"></a>CMFCToolBar::PrevMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarprocesscommand"></a><a name="processcommand"></a>CMFCToolBar::ProcessCommand

Affiche un message WM_COMMAND à la fenêtre qui possède la barre d’outils.

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[dans] Pointeur vers un bouton sur la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode doit toujours revenir VRAI. MFC utilise les valeurs FALSE en interne.

### <a name="remarks"></a>Notes

Cette méthode affiche un message WM_COMMAND à la fenêtre qui possède la barre d’outils en appelant [CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage) et en passant l’ID de commande du bouton spécifié comme paramètre *wParam.*

Utilisez la [macro ON_COMMAND](message-map-macros-mfc.md#on_command) pour cartographier le message WM_COMMAND à une fonction membre.

## <a name="cmfctoolbarremoveallbuttons"></a><a name="removeallbuttons"></a>CMFCToolBar::RemoveAllButtons

Supprime tous les boutons et séparateurs de la barre d’outils.

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’elle recrée ou détruit une barre d’outils.

## <a name="cmfctoolbarremovebutton"></a><a name="removebutton"></a>CMFCToolBar::RemoveButton

Supprime de la barre d’outils le bouton qui a l’index spécifié.

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>Paramètres

*iIndex (en)*<br/>
[dans] Spécifie l’index zéro du bouton à supprimer.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode réussit, ou FALSE si l’index spécifié est invalide ou l’index se réfère au bouton **Customize.**

### <a name="remarks"></a>Notes

Cette méthode met à jour les attributs supplémentaires de barre d’outils qui sont affectés par la suppression du bouton. Par exemple, cette méthode supprime les séparateurs non essentiels de la barre d’outils et reconstruit la table des touches de raccourci.

Pour plus d’informations sur le bouton **Customize,** voir [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton).

## <a name="cmfctoolbarremovestatefromregistry"></a><a name="removestatefromregistry"></a>CMFCToolBar::SupprimerStateDeRegistry

Supprime les informations d’état de la barre d’outils du registre Windows.

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
[dans] Spécifie la clé du registre où se trouvent les informations de l’État.

*nIndex*<br/>
[dans] L’ID de contrôle de la barre d’outils.

*uiID*<br/>
[dans] L’ID de ressource de la barre d’outils. Si ce paramètre est de -1, cette méthode utilise la méthode [CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid) pour récupérer l’ID de ressource.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’elle supprime une barre d’outils définie par l’utilisateur.

Remplacez cette méthode si vous stockez des informations d’état supplémentaires dans le registre Windows.

## <a name="cmfctoolbarreplacebutton"></a><a name="replacebutton"></a>CMFCToolBar::RemplacerButton

Remplace un bouton de barre d’outils par un autre bouton de barre d’outils.

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] L’ID de commande du bouton à remplacer.

*Bouton*<br/>
[dans] Une référence `CMFCToolBarButton` à l’insertion.

*Balle*<br/>
[dans] Une valeur Boolean qui précise s’il faut remplacer tous les boutons qui ont l’ID de commande spécifié par *uiCmd*. Si ce paramètre est VRAI, tous les boutons qui ont l’ID de commande spécifié sont remplacés. Sinon, le premier bouton est remplacé.

### <a name="return-value"></a>Valeur de retour

Le nombre de boutons qui sont remplacés. Cette méthode renvoie 0 si un bouton avec l’ID de commande spécifié n’existe pas sur la barre d’outils.

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque vous souhaitez ajouter des boutons de barre d’outils qui ne peuvent pas être chargés à partir de ressources. Vous pouvez créer un bouton de placeholder à l’heure de la conception et remplacer ce bouton par un bouton personnalisé lorsque vous initialisez la barre d’outils. Consultez l’échantillon VisualStudioDemo par exemple qui utilise cette méthode.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `ReplaceButton` utiliser `CMFCToolBar` la méthode dans la classe. Cet extrait de code fait partie de [l’échantillon de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="cmfctoolbarresetall"></a><a name="resetall"></a>CMFCToolBar::ResetAll

Restaure toutes les barres d’outils dans leurs états d’origine.

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>Notes

Cette méthode appelle la [cmFCToolBar::RestoreOriginalState](#restoreoriginalstate) méthode sur chaque barre d’outils dans l’application qui peut être restaurée. Il utilise la [cmFCToolBar::CanBeRestored](#canberestored) méthode pour déterminer si une barre d’outils peut être restaurée.

## <a name="cmfctoolbarresetallimages"></a><a name="resetallimages"></a>CMFCToolBar::ResetAllImages

Efface toutes les collections d’images de barres d’outils dans l’application.

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>Notes

Cette méthode efface les collections d’images qui sont paraphés par le [CMFCToolBar::LoadToolBar](#loadtoolbar) et [CMFCToolBar::LoadBitmap](#loadbitmap) méthodes.

## <a name="cmfctoolbarresetimages"></a><a name="resetimages"></a>CMFCToolBar::ResetImages

```
virtual void ResetImages();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarrestorefocus"></a><a name="restorefocus"></a>CMFCToolBar::RestoreFocus

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a>CMFCToolBar::RestoreOriginalState

Restaure l'état initial d'une barre d'outils.

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode réussit, ou FALSE si la méthode échoue ou la barre d’outils est définie par l’utilisateur.

### <a name="remarks"></a>Notes

Cette méthode charge la barre d’outils du fichier de ressources en utilisant la méthode [CMFCToolBar::LoadToolBar.](#loadtoolbar)

Le cadre appelle cette méthode lorsque l’utilisateur choisit le bouton **Reset All** sur la page **Toolbars** d’une boîte de dialogue de personnalisation.

## <a name="cmfctoolbarsaveparameters"></a><a name="saveparameters"></a>CMFCToolBar:SaveParameters

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>Paramètres

[dans] *lpszProfileName*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsavestate"></a><a name="savestate"></a>CMFCToolBar::SaveState

Enregistre les informations d’état pour la barre d’outils dans le registre Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
[dans] Spécifie le chemin relatif de la clé de registre Windows.

*nIndex*<br/>
[dans] L’ID de contrôle de la barre d’outils.

*uiID*<br/>
[dans] L’ID de ressource de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’elle sauve l’état de l’application au registre. Pour plus d’informations, voir [CWinAppEx:SaveState](../../mfc/reference/cwinappex-class.md#savestate).

## <a name="cmfctoolbarsetbasiccommands"></a><a name="setbasiccommands"></a>CMFCToolBar:SetBasicCommands

Définit la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>Paramètres

*lstCommands*<br/>
[dans] Une référence `CList` à un objet qui contient une collection de commandes.

### <a name="remarks"></a>Notes

Une commande de base est toujours affichée lorsque le menu est ouvert. Cette méthode est significative lorsque l’utilisateur choisit de voir les commandes récemment utilisées.

Utilisez la méthode [CMFCToolBar:AddBasicCommand](#addbasiccommand) pour ajouter une commande à la liste des commandes de base. Utilisez la méthode [CMFCToolBar:GetBasicCommands](#getbasiccommands) pour récupérer la liste des commandes de base qui est utilisée par votre application.

Consultez l’échantillon Explorer par exemple qui utilise cette méthode.

## <a name="cmfctoolbarsetbuttoninfo"></a><a name="setbuttoninfo"></a>CMFCToolBar::SetButtonInfo

Définit l’ID de commande, le style et l’identification d’image d’un bouton de barre d’outils.

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index zéro du bouton dont les propriétés sont définies.

*nID*<br/>
[dans] L’ID de commande du bouton.

*nStyle*<br/>
[dans] Le style du bouton. Consultez [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) pour la liste des styles de boutons de barre d’outils disponibles.

*iImage (en)*<br/>
[dans] L’index d’image à base nulle du bouton (c’est-à-dire l’index dans la collection d’images de barres d’outils).

### <a name="remarks"></a>Notes

Appelez cette méthode pour définir les propriétés d’un bouton de barre d’outils.

Dans Debug construit, cette méthode génère un échec d’affirmation si l’index qui est spécifié par *nIndex* est invalide.

Appelez la méthode [CMFCToolBar::SetButtonStyle](#setbuttonstyle) pour définir uniquement le style du bouton.

## <a name="cmfctoolbarsetbuttons"></a><a name="setbuttons"></a>CMFCToolBar:SetButtons

Définit les boutons pour la barre d’outils.

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>Paramètres

*lpIDArray*<br/>
[dans] Un pointeur à la gamme d’adresses des boutons à insérer.

*nIDCompte*<br/>
[dans] Le nombre d’articles dans *lpIDArray*.

*bRemapImages (en)*<br/>
[dans] Une valeur Boolean qui précise s’il faut associer les images bouton existantes avec les boutons insérés. Si ce paramètre est VRAI, les images sont remapped.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez cette méthode pour supprimer les boutons existants d’une barre d’outils et insérer une collection de nouveaux boutons.

Cette méthode ajoute le bouton **Personnaliser** à la barre d’outils et envoie le message AFX_WM_RESETTOOLBAR à la fenêtre parente de la barre d’outils. Pour plus d’informations sur le bouton **Customize,** voir [CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton).

## <a name="cmfctoolbarsetbuttonstyle"></a><a name="setbuttonstyle"></a>CMFCToolBar::SetButtonStyle

Définit le style du bouton de la barre d’outils à l’index donné.

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index zéro du bouton de la barre d’outils dont le style doit être défini.

*nStyle*<br/>
[dans] Le style du bouton. Consultez [ToolBar Control Styles](../../mfc/reference/toolbar-control-styles.md) pour la liste des styles de boutons de barre d’outils disponibles.

### <a name="remarks"></a>Notes

Cette méthode supprime le style TBBS_PRESSED si *nStyle* est TBBS_DISABLED parce que l’utilisateur ne peut pas cliquer sur un bouton désactivé.

## <a name="cmfctoolbarsetbuttontext"></a><a name="setbuttontext"></a>CMFCToolBar::SetButtonText

Définit l’étiquette de texte d’un bouton de barre d’outils.

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] L’index du bouton de la barre d’outils.

*lpszText*<br/>
[dans] L’étiquette de texte du bouton de la barre d’outils. Doit être non-NULL.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode réussit; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode renvoie FALSE si l’index fourni ne se réfère pas à un bouton de barre d’outils valide.

## <a name="cmfctoolbarsetcommandusageoptions"></a><a name="setcommandusageoptions"></a>CMFCToolBar::SetCommandUsageOptions

Spécifie lorsque les commandes rarement utilisées n’apparaissent pas dans le menu de l’application.

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>Paramètres

*nStartCount (en)*<br/>
[dans] Précise le nombre de fois que les commandes doivent être exécutées avant que le cadre ne montre que les commandes de base et récemment utilisées.

*nMinUsagePercentage (en)*<br/>
[dans] Le pourcentage de fois où une commande doit être exécutée pour être considérée comme une commande récemment utilisée.

### <a name="return-value"></a>Valeur de retour

FALSE si *nMinUsagePercentage* est égal ou supérieur à 100; autrement VRAI.

### <a name="remarks"></a>Notes

Appelez cette méthode pour personnaliser l’algorithme que le cadre utilise pour déterminer l’apparence des éléments de menu de base et récemment utilisés. Pour plus d’informations sur les commandes de base, voir [CMFCToolBar:AddBasicCommand](#addbasiccommand).

Cette classe `CMFCCmdUsageCount` utilise la classe pour suivre le nombre d’utilisations des commandes. Pour plus d’informations sur cette classe, voir [CMFCCmdUsageCount Class](../../mfc/reference/cmfccmdusagecount-class.md).

## <a name="cmfctoolbarsetcustomizemode"></a><a name="setcustomizemode"></a>CMFCToolBar::SetCustomizeMode

Permet ou désactive le mode de personnalisation pour toutes les barres d’outils de l’application.

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] Une valeur Boolean qui spécifie s’il faut activer ou désactiver le mode de personnalisation. Définissez ce paramètre sur TRUE pour activer le mode de personnalisation ou FALSE pour le désactiver.

### <a name="return-value"></a>Valeur de retour

VRAI si l’appel de cette méthode change le mode de personnalisation; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode ajuste la disposition et redessue chaque barre d’outils de l’application. Appelez le [CMFCToolBar::IsCustomizeMode](#iscustomizemode) méthode pour déterminer si l’application est en mode personnalisation,

## <a name="cmfctoolbarsetgraydisabledbuttons"></a><a name="setgraydisabledbuttons"></a>CMFCToolBar::SetGrayDisabledButtons

Précise si les boutons indisponibles sur la barre d’outils sont atténués, ou si des images sans bouton sont utilisées.

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>Paramètres

*bGrayDisabledButtons*<br/>
[dans] Une valeur Boolean qui spécifie comment afficher les boutons indisponibles. Si ce paramètre est VRAI, le cadre assombrit les boutons. Dans le cas contraire, le cadre utilise la collection d’images bouton-indisponibles.

### <a name="remarks"></a>Notes

Par défaut, les boutons indisponibles sont atténués.

## <a name="cmfctoolbarsetheight"></a><a name="setheight"></a>CMFCToolBar::SetHeight

Définit la hauteur de la barre d’outils.

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>Paramètres

*cyHeight*<br/>
[dans] La hauteur de la barre d’outils, en pixels.

### <a name="remarks"></a>Notes

Cette méthode redessiner la barre d’outils après qu’elle a la hauteur.

## <a name="cmfctoolbarsethelpmode"></a><a name="sethelpmode"></a>CMFCToolBar:SetHelpMode

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>Paramètres

[dans] *bOn*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsethot"></a><a name="sethot"></a>CMFCToolBar::SetHot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>Paramètres

[dans] *pMenuButton*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsethotborder"></a><a name="sethotborder"></a>CMFCToolBar:SetHotBorder

Précise si les boutons de barre d’outils sont suivis à chaud.

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>Paramètres

*bShowHotBorder (en)*<br/>
[dans] Une valeur Boolean qui spécifie s’il faut faire chahoir. Si ce paramètre est VRAI, la barre d’outils suit à chaud ses boutons. Sinon, la barre d’outils ne chauffe pas ses boutons.

### <a name="remarks"></a>Notes

Si un bouton est suivi à chaud, le cadre met en évidence le bouton lorsque la souris se déplace à travers elle. Par défaut, chaque barre d’outils hot-tracks ses boutons.

Appelez la méthode [CMFCToolBar::GetHotBorder](#gethotborder) pour déterminer si la barre d’outils suit ses boutons.

## <a name="cmfctoolbarsethottextcolor"></a><a name="sethottextcolor"></a>CMFCToolBar::SetHotTextColor

Définit la couleur du texte pour les boutons chauds de barre d’outils.

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>Paramètres

*clrText*<br/>
[dans] Spécifie la couleur du texte pour les boutons de barre d’outils qui sont suivis à chaud.

### <a name="remarks"></a>Notes

Pour plus d’informations sur les boutons hot-tracked toolbar, voir [CMFCToolBar::GetHotBorder](#gethotborder) et [CMFCToolBar:SetHotBorder](#sethotborder).

## <a name="cmfctoolbarsetignoresettext"></a><a name="setignoresettext"></a>CMFCToolBar::SetIgnoreSetText

```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

[dans] *bValue (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsetlargeicons"></a><a name="setlargeicons"></a>CMFCToolBar:SetLargeIcons

Précise si les boutons de barre d’outils affichent de grandes icônes.

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>Paramètres

*bLargeIcons*<br/>
[dans] Une valeur Boolean qui spécifie les icônes à utiliser. Si ce paramètre est VRAI, le cadre affiche de grandes icônes. Sinon, le cadre affiche des icônes régulières.

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsque l’utilisateur modifie l’état de la case à cocher **Des grandes icônes** dans l’onglet **Options** de la boîte de dialogue **Customize.** Cette méthode resize toutes les barres d’outils de l’application.

Par défaut, le cadre affiche des icônes régulières.

Pour plus d’informations sur la boîte de dialogue **Customize,** voir [CMFCToolBarsCustomizeDialog Class](../../mfc/reference/cmfctoolbarscustomizedialog-class.md).

## <a name="cmfctoolbarsetlockedsizes"></a><a name="setlockedsizes"></a>CMFCToolBar:SetLockedSizes

Définit les tailles de boutons verrouillés et d’images verrouillées sur la barre d’outils.

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>Paramètres

*tailleButton*<br/>
[dans] Spécifie la taille des boutons verrouillés de barre d’outils.

*tailleImage*<br/>
[dans] Spécifie la taille des images verrouillées de barres d’outils.

*bDontScale (en)*<br/>
Précise s’il faut mettre à l’échelle ou non verrouillé des images de barres d’outils en mode DPI élevé.

### <a name="remarks"></a>Notes

La taille par défaut des boutons verrouillés est de 23x22 pixels. La taille par défaut des images verrouillées est de 16x15 pixels.

Appelez la méthode [CMFCToolBar::GetLockedImageSize](#getlockedimagesize) pour récupérer la taille des images verrouillées. Appelez la [méthode CMFCToolBar::GetButtonSize](#getbuttonsize) pour récupérer la taille des boutons verrouillés de barre d’outils.

## <a name="cmfctoolbarsetmaskmode"></a><a name="setmaskmode"></a>CMFCToolBar::SetMaskMode

```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>Paramètres

[dans] *bMasked*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsetmenusizes"></a><a name="setmenusizes"></a>CMFCToolBar:SetMenuSizes

Définit la taille des boutons de menu de barre d’outils et leurs images.

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>Paramètres

*tailleButton*<br/>
[dans] Spécifie la taille des boutons de barre d’outils, en pixels.

*tailleImage*<br/>
[dans] Spécifie la taille des images de barres d’outils, en pixels.

### <a name="remarks"></a>Notes

Par défaut, les boutons de menu et leurs images ont une taille indéfinie.

Appelez la méthode [CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize) pour déterminer la taille des boutons de menu et la [CMFCToolBar::GetMenuImageSize](#getmenuimagesize) méthode pour déterminer la taille des images bouton de menu.

Voir les échantillons IEDemo et MSMoneyDemo pour des exemples qui utilisent cette méthode.

## <a name="cmfctoolbarsetnonpermittedcommands"></a><a name="setnonpermittedcommands"></a>CMFCToolBar::SetNonPermittedCommands

Définit la liste des commandes qui ne peuvent pas être exécutées par l’utilisateur.

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>Paramètres

*lstCommands*<br/>
[dans] Une référence `CList` à un objet qui contient les commandes qui ne peuvent pas être exécutées par l’utilisateur.

### <a name="remarks"></a>Notes

Appelez cette méthode pour empêcher l’utilisateur de sélectionner certaines commandes. Par exemple, vous pouvez empêcher l’utilisateur de sélectionner certaines commandes pour des raisons de sécurité. Voir les échantillons MDITabsDemo et MenuSubSet pour des exemples qui utilisent cette méthode.

Cette méthode efface la liste précédente des commandes non autorisées. Par défaut, la liste des commandes non autorisées est vide.

## <a name="cmfctoolbarsetonerowwithsibling"></a><a name="setonerowwithsibling"></a>CMFCToolBar::SetOneRowWithSibling

Positionne la barre d’outils et son frère sur la même rangée.

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsque l’utilisateur clique sur les **boutons d’exposition sur le** bouton One Row.

Appelez la méthode [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) pour activer les **boutons d’exposition sur une rangée** ou afficher les boutons sur les boutons Two **Rows.** Si vous appelez [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) pour cette barre d’outils, la barre d’outils frère est déplacée à la rangée de cette barre d’outils. Sinon, cette barre d’outils est déplacée à la rangée de la sœur.

Le cadre appelle la méthode [CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling) lorsque l’utilisateur clique sur les **boutons d’exposition sur le bouton Two Rows.**

## <a name="cmfctoolbarsetorigbuttons"></a><a name="setorigbuttons"></a>CMFCToolBar:SetOrigButtons

```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>Paramètres

[dans] *lstOrigButtons*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarsetpermament"></a><a name="setpermament"></a>CMFCToolBar::SetPermament

Précise si un utilisateur peut fermer la barre d’outils.

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>Paramètres

*bPermament*<br/>
[dans] Une valeur Boolean qui spécifie si un utilisateur peut fermer la barre d’outils. Si ce paramètre est VRAI, un utilisateur ne peut pas fermer la barre d’outils. Sinon, un utilisateur peut fermer la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, un utilisateur peut fermer chaque barre d’outils.

Appelez la [CMFCToolBar::CanBeClosed](#canbeclosed) méthode pour déterminer si un utilisateur peut fermer la barre d’outils.

## <a name="cmfctoolbarsetroutecommandsviaframe"></a><a name="setroutecommandsviaframe"></a>CMFCToolBar::SetRouteCommandsViaFrame

Précise si le cadre parent ou le propriétaire envoie des commandes à la barre d’outils.

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue (en)*<br/>
[dans] Si ce paramètre est VRAI, le cadre parent envoie des commandes à la barre d’outils. Sinon, le propriétaire envoie des commandes à la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, le cadre parent envoie des commandes à la barre d’outils. Appelez la méthode [CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe) pour déterminer si le cadre parent ou le propriétaire envoie des commandes à la barre d’outils.

## <a name="cmfctoolbarsetshowtooltips"></a><a name="setshowtooltips"></a>CMFCToolBar::SetShowTooltips

Précise si le cadre affiche des conseils d’outils.

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue (en)*<br/>
[dans] Si ce paramètre est VRAI, le cadre affiche des conseils d’outil. Sinon, le cadre cache des conseils d’outils.

### <a name="remarks"></a>Notes

Par défaut, le cadre affiche des conseils d’outils.

Appelez la méthode [CMFCToolBar::GetShowTooltips](#getshowtooltips) pour déterminer si le cadre affiche des conseils d’outils.

## <a name="cmfctoolbarsetsiblingtoolbar"></a><a name="setsiblingtoolbar"></a>CMFCToolBar::SetSiblingToolBar

Spécifie le frère de la barre d’outils.

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>Paramètres

*pBrotherToolbar*<br/>
[dans] Un pointeur à la barre d’outils frère.

### <a name="remarks"></a>Notes

Cette méthode permet aux **boutons d’affichage sur une rangée** ou afficher les boutons sur les boutons Two **Rows** qui sont affichés lorsque l’utilisateur affiche le menu pop-up **Customize.** Appelez cette méthode lorsque vous souhaitez permettre à l’utilisateur de spécifier si les barres d’outils connexes apparaissent sur la même ligne ou sur différentes lignes.

Appelez cette méthode après avoir permis le bouton **Personnaliser** qui apparaît sur la barre d’outils. Pour activer le bouton **Personnaliser,** appelez la méthode [CMFCToolBar::EnableCustomizeButton.](#enablecustomizebutton)

Pour récupérer le frère d’une barre d’outils, appelez [CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar).

## <a name="cmfctoolbarsetsizes"></a><a name="setsizes"></a>CMFCToolBar:SetSizes

Spécifie la taille des boutons et des images sur toutes les barres d’outils.

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>Paramètres

*tailleButton*<br/>
[dans] La taille des boutons de barre d’outils, en pixels.

*tailleImage*<br/>
[dans] La taille des images bouton de barre d’outils, en pixels.

### <a name="remarks"></a>Notes

La taille par défaut des boutons de barre d’outils est de 23x22 pixels. La taille par défaut des images de bouton de barre d’outils est de 16x15 pixels.

Appelez la [méthode CMFCToolBar:GetImageSize](#getimagesize) pour récupérer la taille des images bouton de barre d’outils. Appelez la [méthode CMFCToolBar:GetButtonSize](#getbuttonsize) pour récupérer la taille des boutons de la barre d’outils.

## <a name="cmfctoolbarsettoolbarbtntext"></a><a name="settoolbarbtntext"></a>CMFCToolBar::SetToolBarBtnText

Spécifie les propriétés d’un bouton sur la barre d’outils.

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>Paramètres

*nBtnIndex*<br/>
[dans] L’index zéro du bouton de la barre d’outils dans la liste des boutons de barre d’outils.

*szText*<br/>
[dans] Spécifie l’étiquette de texte du bouton de la barre d’outils.

*bShowText (en)*<br/>
[dans] Si ce paramètre est VRAI, le cadre affiche l’étiquette de texte. Sinon, le cadre cache l’étiquette de texte.

*bShowImage (en)*<br/>
[dans] Si ce paramètre est VRAI, le cadre affiche l’image bouton de barre d’outils. Sinon, le cadre cache l’image bouton de barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, le cadre affiche les images des boutons de la barre d’outils, mais ne montre pas l’étiquette de texte des boutons de barre d’outils.

Dans Debug construit, cette méthode génère une défaillance d’affirmation si *nBtnIndex* ne se réfère pas à un bouton de barre d’outils valide ou le bouton de barre d’outils est un séparateur.

## <a name="cmfctoolbarsettworowswithsibling"></a><a name="settworowswithsibling"></a>CMFCToolBar::SetTwoRowsWithSibling

Positionne la barre d’outils et son frère sur des rangées séparées.

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsque l’utilisateur clique sur les **boutons d’exposition sur le bouton Two Rows.**

Appelez la méthode [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) pour activer les **boutons d’exposition sur une rangée** ou afficher les boutons sur les boutons Two **Rows.** Si vous appelez [CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar) pour cette barre d’outils, la barre d’outils frère est déplacée à une rangée séparée. Sinon, cette barre d’outils est déplacée à une rangée séparée.

Le cadre appelle la méthode [CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling) lorsque l’utilisateur clique sur les **boutons d’exposition sur le** bouton One Row.

## <a name="cmfctoolbarsetuserimages"></a><a name="setuserimages"></a>CMFCToolBar::SetUserImages

Définit la collection d’images définies par l’utilisateur dans l’application.

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>Paramètres

*pUserImages*<br/>
[dans] Un pointeur pour la collection d’images définies par l’utilisateur.

### <a name="return-value"></a>Valeur de retour

Nonzero si la méthode réussit; autrement 0 si `CMFCToolBarImages` l’objet spécifié n’est pas valide ou a une taille d’image qui diffère de la taille de l’image par défaut de la barre d’outils.

### <a name="remarks"></a>Notes

Le cadre utilise des images définies par l’utilisateur pour dessiner des boutons de barre d’outils personnalisés par l’utilisateur. La liste d’images spécifiée par *pUserImages* est partagée entre toutes les barres d’outils de l’application.

Cette méthode génère une défaillance d’affirmation dans `CMFCToolBarImages` Debug construit si l’objet spécifié n’est pas valide ou a une taille d’image qui diffère de la taille d’image par défaut de la barre d’outils.

Les échantillons OutlookDemo, ToolTipDemo et VisualStudioDemo utilisent cette méthode pour définir la collection mondiale d’images définies par l’utilisateur. Ils chargent le fichier qui est nommé UserImages.bmp, qui est situé dans l’annuaire de fonctionnement de l’application.

Appelez la méthode [CMFCToolBar:GetUserImages](#getuserimages) pour récupérer la collection d’images définies par l’utilisateur dans l’application.

## <a name="cmfctoolbarstretchpane"></a><a name="stretchpane"></a>CMFCToolBar::StretchPane

Étire la barre d’outils verticalement ou horizontalement, et repositionne les boutons si nécessaire.

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>Paramètres

*nLength (en)*<br/>
[dans] La quantité, en pixels, par laquelle étirer la vitre.

*bVert (en)*<br/>
[dans] Si TRUE, étire la vitre verticalement. Si FALSE, étire la vitre horizontalement.

### <a name="return-value"></a>Valeur de retour

Un `CSize` objet qui spécifie la taille de la zone client de la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode appelle [CMFCToolBar::WrapToolBar](#wraptoolbar) pour repositionner les boutons dans la barre d’outils étirée.

La valeur de retour est déterminée en appelant [CMFCToolBar::CalcSize](#calcsize).

## <a name="cmfctoolbartranslatechar"></a><a name="translatechar"></a>CMFCToolBar::TranslateChar

Exécute une commande de bouton si le code clé spécifié correspond à un raccourci de clavier valide.

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>Paramètres

*Nchar*<br/>
[dans] Spécifie un code clé virtuel. Pour une liste de codes clés virtuels standard, voir Winuser.h

### <a name="return-value"></a>Valeur de retour

FALSE si le code clé spécifié est soit imprimable ou ne correspond pas à un raccourci clavier valide; VRAI si le code clé spécifié correspond à une option de menu de décrochage; autrement, la valeur de retour de [CMFCToolBar::ProcessCommand](#processcommand).

### <a name="remarks"></a>Notes

Le cadre appelle cette méthode lorsqu’une clé est pressé avec la clé Alt.

## <a name="cmfctoolbarupdatebutton"></a><a name="updatebutton"></a>CMFCToolBar::Mise à jourButton

Mise à jour de l’état du bouton spécifié.

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index zéro du bouton à mettre à jour.

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarwraptoolbar"></a><a name="wraptoolbar"></a>CMFCToolBar::WrapToolBar

Repositionne les boutons de barre d’outils dans les dimensions données.

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>Paramètres

*nWidth (en)*<br/>
[dans] Largeur maximale de la barre d’outils.

*nHeight (en)*<br/>
[dans] Hauteur maximale de la barre d’outils. Non utilisé si la barre d’outils flotte.

*pDC*<br/>
[dans] Pointeur vers un contexte d’appareil. Si NULL, le contexte de l’appareil pour la barre d’outils est utilisé.

*nColumnWidth (en)*<br/>
[dans] Largeur du bouton. Si -1, la largeur actuelle est utilisée.

[dans] m *nRowHeight* Button hauteur. Si -1, la hauteur actuelle est utilisée.

### <a name="return-value"></a>Valeur de retour

Le nombre de rangées de boutons sur la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode repositionne les boutons à l’intérieur de la barre d’outils, enveloppant les boutons sur des lignes supplémentaires si nécessaire.

## <a name="cmfctoolbarm_bdontscaleimages"></a><a name="m_bdontscaleimages"></a>CMFCToolBar:m_bDontScaleImages

Précise s’il faut ou non mettre à l’échelle des images de barres d’outils en mode DPI élevé.

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>Notes

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md)<br/>
[Classe CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[Classe CMFCDropDownToolBar](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[Procédure pas à pas : placement de contrôles dans les barres d'outils](../../mfc/walkthrough-putting-controls-on-toolbars.md)
