---
title: CMFCToolBar, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: d2af7a808e07e0368dd43ed920b6d8736a90b995
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/16/2020
ms.locfileid: "79420224"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar, classe

La classe `CMFCToolBar` ressemble à la [classe CToolBar](../../mfc/reference/ctoolbar-class.md), mais fournit une prise en charge supplémentaire pour les fonctionnalités de l’interface utilisateur. Celles-ci incluent les barres d'outils à deux dimensions, les barres d'outils avec images interactives, les grandes icônes, les boutons pager, les barres d'outils verrouillées, les contrôles rebar, le texte sous les images, les images d'arrière-plan et les barres d'outils avec onglets. La classe `CMFCToolBar` contient également une prise en charge intégrée de la personnalisation des barres d'outils et des menus par l'utilisateur, du glisser-déplacer entre les barres d'outils et les menus, des boutons de zone de liste modifiable, des boutons de zone d'édition, des sélecteurs de couleurs et des boutons de regroupement.

Pour plus d’informations, consultez le code source situé dans le dossier **VC\\atlmfc\\src\\MFC** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Name|Description|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|Constructeur par défaut.|
|`CMFCToolBar::~CMFCToolBar`|Destructeur.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Name|Description|
|----------|-----------------|
|[CMFCToolBar :: AddBasicCommand](#addbasiccommand)|Ajoute une commande de menu à la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.|
|[CMFCToolBar :: AddCommandUsage](#addcommandusage)|Incrémente d’une unité le compteur associé à la commande donnée.|
|[CMFCToolBar :: AddToolBarForImageCollection](#addtoolbarforimagecollection)|Ajoute des images à partir des ressources de l’interface utilisateur à la collection d’images dans l’application.|
|[CMFCToolBar :: AdjustLayout](#adjustlayout)|Recalcule la taille et la position d’une barre d’outils. (Substitue [CBasePane :: AdjustLayout](../../mfc/reference/cbasepane-class.md#adjustlayout)).|
|[CMFCToolBar :: AdjustSize](#adjustsize)|Recalcule la taille de la barre d’outils.|
|[CMFCToolBar :: AllowChangeTextLabels](#allowchangetextlabels)|Spécifie si les étiquettes de texte peuvent être affichées sous images sur les boutons de la barre d’outils.|
|[CMFCToolBar :: AreTextLabels](#aretextlabels)|Spécifie si les étiquettes de texte sous les images sont actuellement affichées sur les boutons de la barre d’outils.|
|[CMFCToolBar :: AutoGrayInactiveImages](#autograyinactiveimages)|Active ou désactive la génération automatique d’images de bouton inactives.|
|[CMFCToolBar :: ButtonToIndex](#buttontoindex)|Retourne l’index d’un objet de [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) spécifié dans cette barre d’outils.|
|[CMFCToolBar :: CalcFixedLayout](#calcfixedlayout)|Calcule la taille horizontale de la barre d’outils. (Substitue [CBasePane :: CalcFixedLayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout).)|
|[CMFCToolBar :: CalcSize](#calcsize)|Appelée par l’infrastructure dans le cadre du processus de calcul de la disposition. (Substitue [CPane :: CalcSize](../../mfc/reference/cpane-class.md#calcsize).)|
|[CMFCToolBar :: CanHandleSiblings](#canhandlesiblings)|Détermine si la barre d'outils et son frère sont placés sur le même volet.|
|[CMFCToolBar :: CleanUpImages](#cleanupimages)|Libère les ressources système allouées pour les images de barre d’outils.|
|[CMFCToolBar :: CleanUpLockedImages](#cleanuplockedimages)|Libère les ressources système allouées pour les images de barre d’outils verrouillées.|
|[CMFCToolBar :: CanBeClosed](#canbeclosed)|Spécifie si un utilisateur peut fermer la barre d’outils. (Substitue [CBasePane :: CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed).)|
|[CMFCToolBar :: CanBeRestored](#canberestored)|Détermine si le système peut restaurer une barre d’outils à son état d’origine après la personnalisation.|
|[CMFCToolBar :: CanFocus](#canfocus)|Spécifie si le volet peut recevoir le focus. (Substitue [CBasePane :: CanFocus](../../mfc/reference/cbasepane-class.md#canfocus).)|
|[CMFCToolBar :: CanHandleSiblings](#canhandlesiblings)|Détermine si la barre d'outils et son frère sont placés sur le même volet.|
|[CMFCToolBar :: CommandToIndex](#commandtoindex)|Retourne l’index du bouton dans la barre d’outils avec un ID de commande spécifié.|
|[CMFCToolBar :: Create](#create)|Crée un objet `CMFCToolBar`.|
|[CMFCToolBar :: CreateEx](#createex)|Crée un objet `CMFCToolBar` qui utilise des options de style supplémentaires, telles que de grandes icônes.|
|[CMFCToolBar ::D eactivate](#deactivate)|Désactive la barre d’outils.|
|[CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton)|Active ou désactive le bouton **Ajouter ou supprimer des boutons** qui apparaît à la fin de la barre d’outils.|
|[CMFCToolBar :: EnableDocking](#enabledocking)|Active l’ancrage du volet au frame principal. (Substitue [CBasePane :: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking).)|
|[CMFCToolBar :: EnableLargeIcons](#enablelargeicons)|Active ou désactive les grandes icônes sur les boutons de la barre d’outils.|
|[CMFCToolBar :: EnableQuickCustomization](#enablequickcustomization)|Active ou désactive la personnalisation rapide des barres d’outils afin que l’utilisateur puisse appuyer sur la touche **ALT** et faire glisser un bouton vers un nouvel emplacement.|
|[CMFCToolBar :: EnableReflections](#enablereflections)|Active ou désactive la réflexion de la commande.|
|[CMFCToolBar :: EnableTextLabels](#enabletextlabels)|Active ou désactive les étiquettes de texte sous les images de bouton de barre d’outils.|
|[CMFCToolBar :: FromHandlePermanent](#fromhandlepermanent)|Récupère un pointeur vers l’objet `CMFCToolBar` qui contient le handle de fenêtre donné.|
|[CMFCToolBar :: GetAllButtons](#getallbuttons)|Retourne une liste en lecture seule de boutons dans une barre d’outils.|
|[CMFCToolBar :: GetAllToolbars](#getalltoolbars)|Retourne une liste en lecture seule de toutes les barres d’outils de l’application.|
|[CMFCToolBar :: GetBasicCommands](#getbasiccommands)|Retourne une liste en lecture seule des commandes de base définies dans l’application.|
|[CMFCToolBar :: GetButton](#getbutton)|Retourne un pointeur vers l’objet `CMFCToolBarButton` qui a un index de bouton de barre d’outils spécifié.|
|[CMFCToolBar :: GetButtonInfo](#getbuttoninfo)|Retourne l’ID de commande, le style et l’index d’image du bouton à un index spécifié.|
|[CMFCToolBar :: GetButtonSize](#getbuttonsize)|Retourne les dimensions de chaque bouton de la barre d’outils.|
|[CMFCToolBar :: GetButtonStyle](#getbuttonstyle)|Retourne le style actuel du bouton de barre d’outils situé à l’index spécifié.|
|[CMFCToolBar :: GetButtonText](#getbuttontext)|Retourne l’étiquette de texte d’un bouton ayant un index spécifié.|
|[CMFCToolBar :: GetColdImages](#getcoldimages)|Retourne un pointeur désignant la collection d’images de boutons de barre d’outils froid dans l’application.|
|[CMFCToolBar :: GetColumnWidth](#getcolumnwidth)|Retourne la largeur des boutons de la barre d’outils.|
|[CMFCToolBar :: GetCommandButtons](#getcommandbuttons)|Retourne une liste des boutons qui ont un ID de commande spécifié à partir de toutes les barres d’outils de l’application.|
|[CMFCToolBar :: GetCount](#getcount)|Retourne le nombre de boutons et de séparateurs dans la barre d’outils.|
|[CMFCToolBar :: GetCustomizeButton](#getcustomizebutton)|Récupère un pointeur vers l’objet `CMFCCustomizeButton` associé à la barre d’outils.|
|[CMFCToolBar :: GetDefaultImage](#getdefaultimage)|Retourne l’index de l’image par défaut d’un bouton de barre d’outils avec un ID de commande spécifié.|
|[CMFCToolBar :: GetDisabledImages](#getdisabledimages)|Retourne un pointeur vers la collection d’images utilisées pour les boutons de barre d’outils désactivés dans l’application.|
|[CMFCToolBar :: GetDisabledMenuImages](#getdisabledmenuimages)|Retourne un pointeur vers la collection d’images utilisées pour les boutons de menu désactivés dans l’application.|
|[CMFCToolBar :: GetDroppedDownMenu](#getdroppeddownmenu)|Récupère un pointeur vers l’objet de bouton de menu qui affiche actuellement son sous-menu.|
|[CMFCToolBar :: GetGrayDisabledButtons](#getgraydisabledbuttons)|Spécifie si les images de boutons désactivés sont des versions estompées des images de bouton normales ou sont extraites de la collection d’images de bouton désactivées.|
|[CMFCToolBar :: GetHighlightedButton](#gethighlightedbutton)|Retourne un pointeur vers le bouton de barre d’outils actuellement mis en surbrillance.|
|[CMFCToolBar :: GetHotBorder](#gethotborder)|Détermine si les boutons de la barre d’outils sont suivis à chaud.|
|[CMFCToolBar :: GetHotTextColor](#gethottextcolor)|Retourne la couleur de texte des boutons de la barre d’outils en surbrillance.|
|[CMFCToolBar :: GetHwndLastFocus](#gethwndlastfocus)|Retourne un handle vers la fenêtre qui avait le focus d’entrée juste avant la barre d’outils.|
|[CMFCToolBar :: GetIgnoreSetText](#getignoresettext)|Spécifie si les appels pour définir des étiquettes de bouton sont ignorés.|
|[CMFCToolBar :: GetImageSize](#getimagesize)|Retourne la taille actuelle des images de bouton de barre d’outils.|
|[CMFCToolBar :: GetImages](#getimages)|Retourne un pointeur désignant la collection d’images de bouton par défaut dans l’application.|
|[CMFCToolBar :: GetImagesOffset](#getimagesoffset)|Retourne le décalage d’index utilisé pour rechercher les images de bouton de barre d’outils pour cette barre d’outils dans la liste globale des images de bouton de barre d’outils.|
|[CMFCToolBar :: GetInvalidateItemRect](#getinvalidateitemrect)|Récupère la région de la zone cliente qui doit être redessinée pour le bouton à l’index donné.|
|[CMFCToolBar :: GetItemID](#getitemid)|Retourne l’ID de commande du bouton de barre d’outils à un index spécifié.|
|[CMFCToolBar :: GetItemRect](#getitemrect)|Retourne le rectangle englobant du bouton à un index spécifié.|
|[CMFCToolBar :: GetLargeColdImages](#getlargecoldimages)|Retourne un pointeur vers la collection d’images de boutons de barre d’outils à froid importante dans l’application.|
|[CMFCToolBar :: GetLargeDisabledImages](#getlargedisabledimages)|Retourne un pointeur vers la collection d’images de bouton de barre d’outils désactivées volumineuses dans l’application.|
|[CMFCToolBar :: GetLargeImages](#getlargeimages)|Retourne un pointeur désignant la collection d’images de boutons de barre d’outils volumineuses dans l’application.|
|[CMFCToolBar :: GetLockedColdImages](#getlockedcoldimages)|Retourne un pointeur vers la collection d’images à froid verrouillées dans la barre d’outils.|
|[CMFCToolBar :: GetLockedDisabledImages](#getlockeddisabledimages)|Retourne un pointeur vers la collection d’images verrouillées désactivées dans la barre d’outils.|
|[CMFCToolBar :: GetLockedImages](#getlockedimages)|Retourne un pointeur désignant la collection d’images de bouton verrouillées dans la barre d’outils.|
|[CMFCToolBar :: GetLockedImageSize](#getlockedimagesize)|Retourne la taille par défaut des images de barre d’outils verrouillées.|
|[CMFCToolBar :: GetLockedMenuImages](#getlockedmenuimages)|Retourne un pointeur désignant la collection d’images de menu de barre d’outils verrouillées dans la barre d’outils.|
|[CMFCToolBar :: GetMenuButtonSize](#getmenubuttonsize)|Retourne la taille des boutons de menu dans l’application.|
|[CMFCToolBar :: GetMenuImageSize](#getmenuimagesize)|Retourne la taille des images de bouton de menu dans l’application.|
|[CMFCToolBar :: GetMenuImages](#getmenuimages)|Retourne un pointeur désignant la collection d’images de bouton de menu dans l’application.|
|[CMFCToolBar :: GetOrigButtons](#getorigbuttons)|Récupère la collection de boutons non personnalisés de la barre d’outils.|
|[CMFCToolBar :: GetOrigResetButtons](#getorigresetbuttons)|Récupère la collection de boutons de réinitialisation non personnalisés de la barre d’outils.|
|[CMFCToolBar :: GetResourceID](#getresourceid)|Récupère l’ID de ressource de la barre d’outils.|
|[CMFCToolBar :: GetRouteCommandsViaFrame](#getroutecommandsviaframe)|Détermine l’objet, le frame parent ou le propriétaire, qui envoie des commandes à la barre d’outils.|
|[CMFCToolBar :: GetRowHeight](#getrowheight)|Retourne la hauteur des boutons de la barre d’outils.|
|[CMFCToolBar :: GetShowTooltips](#getshowtooltips)|Spécifie si les info-bulles sont affichées pour les boutons de barre d’outils.|
|[CMFCToolBar :: GetSiblingToolBar](#getsiblingtoolbar)|Récupère le frère de la barre d’outils.|
|[CMFCToolBar :: GetUserImages](#getuserimages)|Retourne un pointeur désignant la collection d’images de bouton de barre d’outils définies par l’utilisateur dans l’application.|
|[CMFCToolBar :: HitTest](#hittest)|Retourne l’index du bouton de barre d’outils situé à la position spécifiée.|
|[CMFCToolBar :: InsertButton](#insertbutton)|Insère un bouton dans la barre d’outils.|
|[CMFCToolBar :: InsertSeparator](#insertseparator)|Insère un séparateur dans la barre d’outils.|
|[CMFCToolBar :: InvalidateButton](#invalidatebutton)|Invalide la zone cliente du bouton de barre d’outils qui existe à l’index fourni.|
|[CMFCToolBar :: IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|Détermine si un utilisateur peut ajouter ou supprimer des boutons de barre d’outils à l’aide de l’option de menu **personnaliser** .|
|[CMFCToolBar :: IsAltCustomizeMode](#isaltcustomizemode)|Spécifie si la *personnalisation rapide* est utilisée pour faire glisser un bouton.|
|[CMFCToolBar :: IsAutoGrayInactiveImages](#isautograyinactiveimages)|Spécifie si la génération automatique d’images de bouton inactives (non en surbrillance) est activée.|
|[CMFCToolBar :: IsBasicCommand](#isbasiccommand)|Détermine si une commande est dans la liste des commandes de base.|
|[CMFCToolBar :: IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|Détermine si la barre d’outils peut afficher des boutons avec des bordures étendues.|
|[CMFCToolBar :: IsButtonHighlighted](#isbuttonhighlighted)|Détermine si un bouton de la barre d’outils est mis en surbrillance.|
|[CMFCToolBar :: IsCommandPermitted](#iscommandpermitted)|Détermine si une commande est autorisée.|
|[CMFCToolBar :: IsCommandRarelyUsed](#iscommandrarelyused)|Détermine si une commande est rarement utilisée (consultez [CMFCToolBar :: SetCommandUsageOptions](#setcommandusageoptions)).|
|[CMFCToolBar :: IsCustomizeMode](#iscustomizemode)|Spécifie si l’infrastructure de barre d’outils est en mode de personnalisation.|
|[CMFCToolBar :: IsDragButton](#isdragbutton)|Détermine si un bouton de barre d’outils est glissé.|
|[CMFCToolBar :: IsExistCustomizeButton](#isexistcustomizebutton)|Détermine si la barre d’outils contient le bouton **personnaliser** .|
|[CMFCToolBar :: IsFloating](#isfloating)|Détermine si la barre d’outils est flottante.|
|[CMFCToolBar :: IsLargeIcons](#islargeicons)|Spécifie si les barres d’outils de l’application affichent actuellement de grandes icônes.|
|[CMFCToolBar :: IsLastCommandFromButton](#islastcommandfrombutton)|Détermine si la dernière commande exécutée a été envoyée à partir du bouton de barre d’outils spécifié.|
|[CMFCToolBar :: IsLocked](#islocked)|Détermine si la barre d’outils est verrouillée.|
|[CMFCToolBar :: IsOneRowWithSibling](#isonerowwithsibling)|Détermine si la barre d’outils et sa barre d’outils frères sont positionnés sur la même ligne.|
|[CMFCToolBar :: IsUserDefined](#isuserdefined)|Spécifie si la barre d’outils est définie par l’utilisateur.|
|[CMFCToolBar :: LoadBitmap](#loadbitmap)|Charge les images de barre d’outils à partir des ressources de l’application.|
|[CMFCToolBar :: LoadBitmapEx](#loadbitmapex)|Charge les images de barre d’outils à partir des ressources de l’application. Comprend des images de grande taille.|
|[CMFCToolBar :: LoadParameters](#loadparameters)|Charge les options globales de la barre d’outils à partir du Registre Windows.|
|[CMFCToolBar :: LoadState](#loadstate)|Charge les informations d’état de la barre d’outils à partir du Registre Windows. (Substitue [CPane :: LoadState](../../mfc/reference/cpane-class.md#loadstate).)|
|[CMFCToolBar :: LoadToolBar](#loadtoolbar)|Charge la barre d’outils à partir des ressources d’application.|
|[CMFCToolBar :: LoadToolBarEx](#loadtoolbarex)|Charge la barre d’outils à partir des ressources d’application à l’aide de la classe d’assistance `CMFCToolBarInfo` pour permettre à l’application d’utiliser des images de grande taille.|
|[CMFCToolBar :: OnChangeHot](#onchangehot)|Appelé par le Framework quand un utilisateur sélectionne un bouton dans la barre d’outils.|
|[CMFCToolBar :: OnFillBackground](#onfillbackground)|Appelé par l’infrastructure à partir de [CBasePane ::D opaint](../../mfc/reference/cbasepane-class.md#dopaint) pour remplir l’arrière-plan de la barre d’outils.|
|[CMFCToolBar :: OnReset](#onreset)|Restaure l’état d’origine de la barre d’outils.|
|[CMFCToolBar :: OnSetAccData](#onsetaccdata)|(Substitue [CBasePane :: OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[CMFCToolBar :: OnSetDefaultButtonText](#onsetdefaultbuttontext)|Rétablit l’État par défaut du texte d’un bouton de barre d’outils.|
|`CMFCToolBar::OnUpdateCmdUI`|Utilisé en interne.|
|[CMFCToolBar :: RemoveAllButtons](#removeallbuttons)|Supprime tous les boutons de la barre d’outils.|
|[CMFCToolBar :: RemoveButton](#removebutton)|Supprime le bouton avec l’index spécifié de la barre d’outils.|
|[CMFCToolBar :: RemoveStateFromRegistry](#removestatefromregistry)|Supprime les informations d’état de la barre d’outils du Registre Windows.|
|[CMFCToolBar :: ReplaceButton](#replacebutton)|Remplace un bouton de barre d’outils par un autre bouton de barre d’outils.|
|[CMFCToolBar :: ResetAll](#resetall)|Restaure toutes les barres d’outils à leur état d’origine.|
|[CMFCToolBar :: ResetAllImages](#resetallimages)|Efface toutes les collections d’images de la barre d’outils dans l’application.|
|[CMFCToolBar :: RestoreOriginalState](#restoreoriginalstate)|Restaure l'état initial d'une barre d'outils.|
|[CMFCToolBar :: saveste](#savestate)|Enregistre les informations d’état de la barre d’outils dans le Registre Windows. (Substitue [CPane :: saveste](../../mfc/reference/cpane-class.md#savestate).)|
|`CMFCToolBar::Serialize`|(Substitue `CBasePane::Serialize`.)|
|[CMFCToolBar :: SetBasicCommands](#setbasiccommands)|Définit la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.|
|[CMFCToolBar :: SetButtonInfo](#setbuttoninfo)|Définit l’ID de commande, le style et l’ID d’image d’un bouton de barre d’outils.|
|[CMFCToolBar :: SetButtonStyle](#setbuttonstyle)|Définit le style du bouton de barre d’outils à l’index donné.|
|[CMFCToolBar :: SetButtonText](#setbuttontext)|Définit l’étiquette de texte d’un bouton de barre d’outils.|
|[CMFCToolBar :: SetButtons](#setbuttons)|Définit les boutons de la barre d’outils.|
|[CMFCToolBar :: SetCommandUsageOptions](#setcommandusageoptions)|Spécifie si les commandes rarement utilisées n’apparaissent pas dans le menu de l’application.|
|[CMFCToolBar :: SetCustomizeMode](#setcustomizemode)|Active ou désactive le mode de personnalisation pour toutes les barres d’outils de l’application.|
|[CMFCToolBar :: SetGrayDisabledButtons](#setgraydisabledbuttons)|Spécifie si les boutons désactivés de la barre d’outils sont estompés ou si des images désactivées sont utilisées pour les boutons désactivés.|
|[CMFCToolBar :: SetHeight](#setheight)|Définit la hauteur de la barre d’outils.|
|[CMFCToolBar :: SetHotBorder](#sethotborder)|Spécifie si les boutons de barre d’outils sont suivis à chaud.|
|[CMFCToolBar :: SetHotTextColor](#sethottextcolor)|Définit la couleur du texte pour les boutons de la barre d’outils active.|
|[CMFCToolBar :: SetLargeIcons](#setlargeicons)|Spécifie si les boutons de la barre d’outils affichent de grandes icônes.|
|[CMFCToolBar :: SetLockedSizes](#setlockedsizes)|Définit la taille des boutons verrouillés et des images verrouillées dans la barre d’outils.|
|[CMFCToolBar :: SetMenuSizes](#setmenusizes)|Définit la taille des boutons de menu de la barre d’outils et leurs images.|
|[CMFCToolBar :: SetNonPermittedCommands](#setnonpermittedcommands)|Définit la liste des commandes qui ne peuvent pas être exécutées par l’utilisateur.|
|[CMFCToolBar :: SetOneRowWithSibling](#setonerowwithsibling)|Positionne la barre d’outils et son frère sur la même ligne.|
|[CMFCToolBar :: SetPermament](#setpermament)|Spécifie si un utilisateur peut fermer la barre d’outils.|
|[CMFCToolBar :: SetRouteCommandsViaFrame](#setroutecommandsviaframe)|Spécifie si le frame parent ou le propriétaire envoie des commandes à la barre d’outils.|
|[CMFCToolBar :: SetShowTooltips](#setshowtooltips)|Spécifie si l’infrastructure affiche des info-bulles.|
|[CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar)|Spécifie le frère de la barre d’outils.|
|[CMFCToolBar :: SetSizes](#setsizes)|Spécifie la taille des boutons et des images sur toutes les barres d’outils.|
|[CMFCToolBar :: SetToolBarBtnText](#settoolbarbtntext)|Spécifie les propriétés d’un bouton dans la barre d’outils.|
|[CMFCToolBar :: SetTwoRowsWithSibling](#settworowswithsibling)|Positionne la barre d’outils et son frère sur des lignes distinctes.|
|[CMFCToolBar :: SetUserImages](#setuserimages)|Définit la collection d’images définies par l’utilisateur dans l’application.|
|[CMFCToolBar :: StretchPane](#stretchpane)|Étire la barre d’outils verticalement ou horizontalement. (Substitue [CBasePane :: StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane).)|
|[CMFCToolBar :: TranslateChar](#translatechar)|Exécute une commande de bouton si le code de clé spécifié correspond à un raccourci clavier valide.|
|[CMFCToolBar :: UpdateButton](#updatebutton)|Met à jour l’état du bouton spécifié.|
|[CMFCToolBar :: WrapToolBar](#wraptoolbar)|Repositionne les boutons de la barre d’outils dans les dimensions spécifiées.|

### <a name="protected-methods"></a>Méthodes protégées

|Name|Description|
|----------|-----------------|
|[CMFCToolBar :: AllowShowOnList](#allowshowonlist)|Détermine si la barre d’outils est affichée dans la liste du volet **barres d’outils** de la boîte de dialogue **personnaliser** .|
|[CMFCToolBar :: CalcMaxButtonHeight](#calcmaxbuttonheight)|Calcule la hauteur maximale d’un bouton dans la barre d’outils.|
|[CMFCToolBar ::D oPaint](#dopaint)|Repeint une barre d’outils.|
|[CMFCToolBar ::D rawButton](#drawbutton)|Repeint un bouton de barre d’outils.|
|[CMFCToolBar ::D rawSeparator](#drawseparator)|Repeint un séparateur sur une barre d’outils.|
|[CMFCToolBar :: OnUserToolTip](#onusertooltip)|Appelée par l’infrastructure lorsque l’info-bulle d’un bouton est sur le paragraphe d’être affichée.|

### <a name="data-members"></a>Données membres

|Name|Description|
|----------|-----------------|
|[CMFCToolBar :: m_bDontScaleImages](#m_bdontscaleimages)|Spécifie s’il faut mettre à l’échelle les images de barre d’outils en mode haute résolution.|
|[CMFCToolBar :: m_dblLargeImageRatio](#m_dbllargeimageratio)|Spécifie le ratio entre la dimension (hauteur ou largeur) des grandes images et la dimension des images normales.|

## <a name="remarks"></a>Notes

Pour incorporer un objet `CMFCToolBar` dans votre application, procédez comme suit :

1. Ajoutez un objet `CMFCToolBar` à la fenêtre frame principale.

1. Lorsque vous traitez le message WM_CREATE pour la fenêtre frame principale, appelez [CMFCToolBar :: Create](#create) ou [CMFCToolBar :: CreateEx](#createex) pour créer la barre d’outils et spécifier son style.

1. Appelez [CBasePane :: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking) pour spécifier le style d’ancrage.

Pour insérer un bouton spécial, tel qu’une zone de liste modifiable ou une barre d’outils déroulante, réservez un bouton factice dans la ressource parente, puis remplacez le bouton factice au moment de l’exécution à l’aide de [CMFCToolBar :: ReplaceButton](#replacebutton). Pour plus d’informations, consultez [procédure pas à pas : ajout de contrôles aux barres d’outils](../walkthrough-putting-controls-on-toolbars.md).

`CMFCToolBar` est la classe de base des classes de bibliothèque MFC [CMFCMenuBar Class](../../mfc/reference/cmfcmenubar-class.md), [Cmfcpopupmenubar, Class](../../mfc/reference/cmfcpopupmenubar-class.md)et [CMFCDropDownToolBar Class](../../mfc/reference/cmfcdropdowntoolbar-class.md).

## <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser différentes méthodes de la classe `CMFCToolBar` . L’exemple montre comment définir le texte de l’étiquette de la fenêtre de la barre d’outils, définir les bordures, définir le style du volet et activer le bouton **Ajouter ou supprimer des boutons** qui apparaît à la fin de la barre d’outils. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>Spécifications

**En-tête :** afxtoolbar. h

## <a name="inheritance-hierarchy"></a>Hiérarchie d’héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

##  <a name="addbasiccommand"></a>CMFCToolBar :: AddBasicCommand

Ajoute une commande de menu à la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans Spécifie la commande à ajouter.

### <a name="remarks"></a>Notes

Une commande de base est toujours affichée lorsque le menu est ouvert. Cette méthode est significative lorsque l’utilisateur choisit d’afficher les commandes récemment utilisées.

Utilisez la méthode [CMFCToolBar :: SetBasicCommands](#setbasiccommands) pour définir la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu. Utilisez la méthode [CMFCToolBar :: GetBasicCommands](#getbasiccommands) pour récupérer la liste des commandes de base utilisées par votre application.

##  <a name="addcommandusage"></a>CMFCToolBar :: AddCommandUsage

Incrémente d’une unité le compteur associé à la commande donnée.

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>Paramètres

*uiCommand*<br/>
dans Spécifie le compteur de commandes à incrémenter.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur sélectionne un élément de menu.

L’infrastructure utilise des compteurs de commande pour afficher les éléments de menu récemment utilisés.

Cette méthode incrémente le compteur de commandes à l’aide de la méthode [CMFCCmdUsageCount :: AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd) .

##  <a name="addtoolbarforimagecollection"></a>CMFCToolBar :: AddToolBarForImageCollection

Ajoute des images à partir des ressources de l’interface utilisateur à la collection d’images dans l’application.

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
dans ID de ressource d’une barre d’outils avec des images à charger.

*uiBmpResID*<br/>
dans ID de ressource d’une image bitmap avec des images de barre d’outils.

*uiColdResID*<br/>
dans ID de ressource d’une image bitmap avec des images de barre d’outils « froides ».

*uiMenuResID*<br/>
dans ID de ressource d’une image bitmap avec des images de menu.

*uiDisabledResID*<br/>
dans ID de ressource d’une image bitmap avec les images de barre d’outils désactivées.

*uiMenuDisabledResID*<br/>
dans ID de ressource d’une image bitmap avec des images de menu désactivées.

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode est réussie ; FALSe si *uiResID* ou *uiBmpResID* ne spécifient pas de ressources valides ou si une autre erreur se produit.

### <a name="remarks"></a>Notes

Appelez cette méthode pour charger une image bitmap avec des images de barre d’outils et l’ajouter à la collection d’images de barre d’outils. Cette méthode crée un objet de barre d’outils temporaire et appelle [CMFCToolBar :: LoadToolBar](#loadtoolbar).

##  <a name="adjustlayout"></a>CMFCToolBar :: AdjustLayout

Recalcule la taille et la position d’une barre d’outils.

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque la barre d’outils a été créée pour recalculer sa taille et sa position.

L’infrastructure appelle cette méthode chaque fois que la disposition de la barre d’outils doit être modifiée. Par exemple, la disposition doit changer lorsque l’utilisateur déplace une autre barre de contrôles, redimensionne une fenêtre d’application ou personnalise la barre d’outils.

Substituez cette méthode pour fournir votre propre disposition dynamique dans les classes que vous dérivez de `CMFCToolbar`.

##  <a name="adjustsize"></a>CMFCToolBar :: AdjustSize

Recalcule la taille de la barre d’outils.

```
void AdjustSize();
```

### <a name="remarks"></a>Notes

Cette méthode permet de s’assurer que la barre d’outils tient dans les limites du frame parent. Cette méthode ne fait rien si la barre d’outils n’a pas de frame parent.

La méthode [CMFCToolBar :: AdjustLayout](#adjustlayout) appelle cette méthode pour recalculer la taille si le parent de la barre d’outils n’est pas un objet `CMFCReBar`.

##  <a name="allowchangetextlabels"></a>CMFCToolBar :: AllowChangeTextLabels

Spécifie si les étiquettes de texte peuvent être affichées sous images sur les boutons de la barre d’outils.

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE s’il est autorisé à afficher les étiquettes de texte sous les images ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode est appelée par la boîte de dialogue de personnalisation pour déterminer s’il faut activer une case à cocher **afficher les étiquettes de texte** sur la page **barres** d’outils de la barre d’outils sélectionnée.

L’implémentation par défaut retourne la valeur TRUE.

Substituez cette méthode dans un objet dérivé de `CMFCToolBar` et retournez la valeur FALSe lorsque vous ne voulez pas que l’utilisateur décide si des étiquettes de texte sont affichées sur les boutons de la barre d’outils sous les images.

##  <a name="allowshowonlist"></a>CMFCToolBar :: AllowShowOnList

Détermine si la barre d’outils est affichée dans la liste des barres d’outils du volet **barres d’outils** de la boîte de dialogue **personnaliser** .

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si l’objet Toolbar peut être affiché dans la zone de liste de la page de personnalisation de la barre d’outils ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode est appelée par l’infrastructure pour déterminer si la liste sur la page de personnalisation de la barre d’outils doit inclure un objet particulier dérivé de `CMFCToolBar`.

L’implémentation par défaut retourne toujours la valeur TRUE. Substituez cette méthode quand vous ne souhaitez pas qu’une barre d’outils apparaisse dans la liste barres d’outils de la boîte de dialogue Personnalisation.

##  <a name="aretextlabels"></a>CMFCToolBar :: AreTextLabels

Spécifie si les étiquettes de texte sous les images sont actuellement affichées sur les boutons de la barre d’outils.

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si les boutons de la barre d’outils affichent des étiquettes de texte sous les images ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Utilisez [CMFCToolBar :: EnableTextLabels](#enabletextlabels) pour spécifier si le texte est affiché. La valeur par défaut est FALSE. Appelez [CMFCToolBar :: AllowChangeTextLabels](#allowchangetextlabels) pour spécifier si l’utilisateur peut modifier ce paramètre dans la boîte de dialogue Personnalisation.

##  <a name="autograyinactiveimages"></a>CMFCToolBar :: AutoGrayInactiveImages

Active ou désactive la génération automatique d’images de bouton inactives.

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans Valeur booléenne qui spécifie s’il faut estomper les images inactives. Si ce paramètre a la valeur TRUE, les images inactives sont estompées. Dans le cas contraire, les images inactives ne sont pas estompées.

*nGrayImagePercentage*<br/>
dans Spécifie le pourcentage de luminance pour les images inactives. Si *bEnable* a la valeur false, cette valeur est ignorée.

*bRedrawAllToolbars*<br/>
dans Valeur booléenne qui spécifie s’il faut redessiner toutes les barres d’outils dans l’application. Si ce paramètre a la valeur TRUE, cette méthode redessine toutes les barres d’outils.

### <a name="remarks"></a>Notes

Si *bEnable* a la valeur true, le Framework utilise *nGrayImagePercentage* pour générer des images inactives à partir des images normales. Sinon, vous devez fournir l’ensemble des images inactives à l’aide de la méthode [CMFCToolBar :: GetColdImages](#getcoldimages) . Par défaut, cette option est désactivée.

Pour plus d’informations sur le paramètre *nGrayImagePercentage* , consultez [CMFCToolBarImages :: GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages).

##  <a name="buttontoindex"></a>CMFCToolBar :: ButtonToIndex

Retourne l’index d’un objet de [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) spécifié dans cette barre d’outils.

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers l’objet bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Index de *pButton* dans la liste interne des boutons de la barre d’outils ; ou-1 si le bouton spécifié ne figure pas dans cette barre d’outils.

##  <a name="calcfixedlayout"></a>CMFCToolBar :: CalcFixedLayout

Calcule la taille horizontale de la barre d’outils.

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*bStretch*<br/>
dans TRUE pour étirer la barre d’outils à la taille du frame parent.

*bHorz*<br/>
dans TRUE pour orienter horizontalement la barre d’outils ; FALSe pour orienter verticalement la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Objet `CSize` qui spécifie la taille de la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode calcule la taille de la barre d’outils à l’aide de la méthode `CMFCToolBar::CalcLayout`. Elle passe l’indicateur LM_STRETCH pour le paramètre *dwMode* si *bStretch* a la valeur true. Elle passe l’indicateur LM_HORZ si *bHorz* a la valeur true.

Consultez l’exemple VisualStudioDemo pour obtenir un exemple qui utilise cette méthode.

##  <a name="calcmaxbuttonheight"></a>CMFCToolBar :: CalcMaxButtonHeight

Calcule la hauteur maximale des boutons dans la barre d’outils.

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>Valeur de retour

Hauteur maximale des boutons.

### <a name="remarks"></a>Notes

Cette méthode calcule la hauteur maximale parmi tous les boutons de la barre d’outils de la barre d’outils. La hauteur peut varier en fonction de facteurs tels que l’état d’ancrage de la barre d’outils actuelle.

Substituez cette méthode dans une classe dérivée de `CMFCToolBar` pour fournir votre propre calcul de hauteur.

##  <a name="calcsize"></a>CMFCToolBar :: CalcSize

Appelée par l’infrastructure dans le cadre du processus de calcul de la disposition.

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>Paramètres

*bVertDock*<br/>
dans TRUE pour spécifier que la barre d’outils est ancrée verticalement ; FALSe pour spécifier que la barre d’outils est ancrée horizontalement.

### <a name="return-value"></a>Valeur de retour

Objet `CSize` qui spécifie la taille globale des boutons sur la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode prend en compte les attributs qui affectent la taille de chaque bouton, tels que la zone de l’étiquette de texte et la taille de la bordure.

Si la barre d’outils ne contient aucun bouton, cette méthode retourne la taille réservée d’un seul bouton à l’aide de la méthode [CMFCToolBar :: GetButtonSize](#getbuttonsize) .

##  <a name="canbeclosed"></a>CMFCToolBar :: CanBeClosed

Spécifie si un utilisateur peut fermer la barre d’outils.

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils peut être fermée par l’utilisateur ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut fermer une barre d’outils. Si la méthode retourne la valeur TRUE, le Framework active la commande SC_CLOSE dans le menu système de la barre d’outils et l’utilisateur peut fermer la barre d’outils à l’aide d’une case à cocher dans la liste des barres d’outils de la boîte de dialogue Personnalisation.

L’implémentation par défaut retourne la valeur TRUE. Substituez cette méthode dans une classe dérivée de `CMFCToolBar` pour créer des objets de barre d’outils qui ne peuvent pas être fermés par l’utilisateur.

##  <a name="canberestored"></a>CMFCToolBar :: CanBeRestored

Détermine si le système peut restaurer une barre d’outils à son état d’origine après la personnalisation.

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils peut être restaurée à partir des ressources de l’application ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si une barre d’outils peut être retournée à son état d’origine après la personnalisation. L’état d’origine est chargé à partir des ressources de l’application.

Si `CanBeRestored` retourne la valeur TRUE, la page **barres d’outils** de la boîte de dialogue Personnalisation active le bouton **Réinitialiser** pour la barre d’outils sélectionnée.

L’implémentation par défaut retourne la valeur TRUE si l’ID de ressource d’origine de la barre d’outils lors de son chargement est différent de zéro. En règle générale, seules les barres d’outils définies par l’utilisateur ne peuvent pas être restaurées.

Vous pouvez substituer la méthode `CanBeRestored` pour personnaliser ce comportement dans les classes dérivées.

##  <a name="canfocus"></a>CMFCToolBar :: CanFocus

Spécifie si le volet peut recevoir le focus.

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

Cette méthode remplace l’implémentation de la classe de base, [CBasePane :: CanFocus](../../mfc/reference/cbasepane-class.md#canfocus), car les objets Toolbar ne peuvent pas recevoir le focus.

##  <a name="canhandlesiblings"></a>CMFCToolBar :: CanHandleSiblings

Détermine si la barre d'outils et son frère sont placés sur le même volet.

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils a un frère et que la barre d’outils et son frère sont positionnés sur le même volet ; Sinon, FALSe.

### <a name="remarks"></a>Notes

La méthode interne CMFCCustomizeButton :: CreatePopupMenu appelle cette méthode pour déterminer comment afficher le menu contextuel **personnaliser** . Si cette méthode retourne la valeur TRUE, l’infrastructure affiche les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** .

En règle générale, vous n'avez pas à utiliser cette méthode. Pour activer le bouton **personnaliser** qui apparaît dans la barre d’outils, appelez la méthode [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton) . Pour activer les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** , appelez [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar).

##  <a name="cleanupimages"></a>CMFCToolBar :: CleanUpImages

Libère les ressources système allouées pour les images de barre d’outils.

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’une application s’arrête.

##  <a name="cleanuplockedimages"></a>CMFCToolBar :: CleanUpLockedImages

Libère les ressources système allouées pour les images de barre d’outils verrouillées.

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque le style visuel de votre application change. Consultez l’exemple VisualStudioDemo pour obtenir un exemple qui utilise cette méthode.

##  <a name="commandtoindex"></a>CMFCToolBar :: CommandToIndex

Retourne l’index du bouton dans la barre d’outils avec un ID de commande spécifié.

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>Paramètres

*nIDFind*<br/>
dans Spécifie l’ID de la commande.

*iIndexFirst*<br/>
dans Spécifie l’index initial à partir duquel démarrer.

### <a name="return-value"></a>Valeur de retour

Index de base zéro du bouton de barre d’outils si la méthode a réussi ; -1 s’il n’existe aucun bouton avec l’ID spécifié.

### <a name="remarks"></a>Notes

Un objet `CMFCToolBar` gère une liste interne des boutons de la barre d’outils. Appelez cette fonction pour récupérer l’index d’un bouton dans la liste en fonction de l’ID de commande du bouton.

Si *iIndex* est supérieur à 0, cette méthode ignore tous les boutons de la barre d’outils dont l’index est inférieur à *iIndex*.

##  <a name="create"></a>CMFCToolBar :: Create

Crée un objet `CMFCToolBar`.

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
dans Pointeur vers la fenêtre parente de la barre d’outils.

*dwStyle*<br/>
dans Style de la barre d’outils. Consultez les [styles de contrôle et de bouton de barre d’outils](/windows/win32/Controls/toolbar-control-and-button-styles) dans le SDK Windows pour obtenir la liste des styles.

*nID*<br/>
dans ID de la fenêtre enfant de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

TRUE si cette méthode est réussie ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode crée une barre de contrôles et l’attache à la barre d’outils. Elle crée la barre de contrôle avec le style TBSTYLE_FLAT. Appelez [CMFCToolBar :: CreateEx](#createex) si vous souhaitez un style de barre de contrôle différent.

##  <a name="createex"></a>CMFCToolBar :: CreateEx

Crée un objet `CMFCToolBar` qui utilise des options de style supplémentaires, telles que de grandes icônes.

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
dans Pointeur vers la fenêtre parente de la barre d’outils.

*dwCtrlStyle*<br/>
dans Styles supplémentaires pour la création de l’objet de barre de contrôle incorporé.

*dwStyle*<br/>
dans Style de la barre d’outils. Consultez [contrôle ToolBar et styles de bouton](/windows/win32/Controls/toolbar-control-and-button-styles) pour obtenir la liste des styles appropriés.

*rcBorders*<br/>
dans Objet `CRect` qui spécifie les largeurs des bordures de la fenêtre de barre d’outils.

*nID*<br/>
dans ID de la fenêtre enfant de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si cette méthode est réussie ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode crée une barre de contrôles et l’attache à la barre d’outils.

Appelez cette méthode à la place de [CMFCToolBar :: Create](#create) lorsque vous souhaitez fournir des styles spécifiques. Par exemple, affectez à *dwCtrlStyle* la valeur TBSTYLE_FLAT | TBSTYLE_TRANSPARENT pour créer une barre d’outils qui ressemble aux barres d’outils utilisées par Internet Explorer 4.

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser la méthode `CreateEx` de la classe `CMFCToolBar`. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="deactivate"></a>CMFCToolBar ::D eactivate

Désactive la barre d’outils.

```
virtual void Deactivate();
```

### <a name="remarks"></a>Notes

Cette méthode désactive la barre d’outils en supprimant le focus du bouton en surbrillance de la barre d’outils. L’infrastructure appelle cette méthode lorsque la barre d’outils perd le focus ou est détruite.

##  <a name="dopaint"></a>CMFCToolBar ::D oPaint

Repeint une barre d’outils.

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers un contexte de périphérique (Device Context).

### <a name="remarks"></a>Notes

Cette méthode est appelée par l’infrastructure quand une partie de la barre d’outils doit être repeinte.

Substituez cette méthode pour personnaliser l’apparence d’un objet dérivé de `CMFCToolBar`.

##  <a name="drawbutton"></a>CMFCToolBar ::D rawButton

Repeint un bouton de barre d’outils.

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers un contexte de périphérique (Device Context).

*pButton*<br/>
dans Pointeur vers un bouton à dessiner.

*pImages*<br/>
dans Pointeur vers les images de barre d’outils.

*bHighlighted*<br/>
dans TRUE si le bouton est mis en surbrillance ; Sinon, FALSe.

*bDrawDisabledImages*<br/>
dans TRUE si les boutons désactivés sont estompés ; Sinon, FALSe.

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton a été redessiné ; FALSe si le bouton est masqué.

### <a name="remarks"></a>Notes

La méthode [CMFCToolBar ::D rawbutton](#drawbutton) appelle cette méthode lorsqu’un bouton de barre d’outils doit être redessiné.

Substituez cette méthode si vous souhaitez personnaliser l’apparence des boutons sur votre barre d’outils.

##  <a name="drawseparator"></a>CMFCToolBar ::D rawSeparator

Repeint un séparateur sur une barre d’outils.

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers un contexte de périphérique (Device Context).

*rectangulaire*<br/>
dans Rectangle englobant de l’emplacement où le séparateur est dessiné, en pixels.

*bHorz*<br/>
dans TRUE si le séparateur est horizontal ; FALSe si le séparateur est vertical.

### <a name="remarks"></a>Notes

[CMFCToolBar ::D opaint](#dopaint) appelle cette méthode pour chaque objet [CMFCToolBar ::D rawseparator](#drawseparator) qui a le style TBBS_SEPARATOR, au lieu d’appeler [CMFCToolBar ::D rawbutton](#drawbutton) pour ces boutons.

Substituez cette méthode dans une classe dérivée de [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) pour personnaliser l’apparence des séparateurs sur la barre d’outils. L’implémentation par défaut appelle [CMFCVisualManager :: OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator) pour dessiner un séparateur dont l’apparence est déterminée par le gestionnaire visuel actuel.

##  <a name="enablecustomizebutton"></a>CMFCToolBar :: EnableCustomizeButton

Active ou désactive le bouton Personnaliser qui apparaît dans la barre d’outils.

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans Active ou désactive le bouton Personnaliser.

*iCustomizeCmd*<br/>
dans ID de commande du bouton Personnaliser.

*strCustomizeText*<br/>
dans Étiquette de texte du bouton Personnaliser.

*uiCustomizeTextResId*<br/>
dans ID de chaîne de ressource de l’étiquette du bouton Personnaliser.

*bQuickCustomize*<br/>
dans Active ou désactive l’option **Ajouter ou supprimer des boutons** dans le menu qui descend du bouton.

### <a name="remarks"></a>Notes

Si *iCustomizeCmd* est-1, l’infrastructure affiche le bouton Personnaliser lorsque plusieurs boutons de la barre d’outils ne tiennent pas dans la zone de la barre d’outils. Le bouton affiche une flèche pointant vers la gauche ou un chevron, qui indique qu’il y a plus de boutons.

Si *iCustomizeCmd* spécifie un ID de commande valide et que *bEnable* a la valeur true, le bouton Personnaliser est toujours affiché. Le bouton a une petite flèche bas et ouvre un menu qui contient une commande. Cette commande utilise l’étiquette de texte spécifiée par *strCustomizeText*. Si *bQuickCustomize* a également la valeur true, le menu affiche l’option **Ajouter ou supprimer des boutons** .

L’infrastructure ajoute dynamiquement au menu tous les boutons qui ne tiennent pas dans la zone de la barre d’outils avant l’élément spécifié par *iCustomizeCmd*. Le Chevron s’affiche en regard de la flèche vers le bas.

##  <a name="enabledocking"></a>CMFCToolBar :: EnableDocking

Active l’ancrage du volet au frame principal.

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>Paramètres

*dwAlignment*<br/>
dans Spécifie l’alignement d’ancrage à activer.

### <a name="remarks"></a>Notes

Cette méthode étend l’implémentation de la classe de base, [CBasePane :: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking), en affectant la valeur AFX_CBRS_FLOAT au membre de données `CBasePane::m_dwControlBarStyle`. Cette méthode passe ensuite *dwAlignment* à l’implémentation de la classe de base.

##  <a name="enablelargeicons"></a>CMFCToolBar :: EnableLargeIcons

Active ou désactive les grandes icônes sur les boutons de la barre d’outils.

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans TRUE pour activer les grandes icônes, FALSe pour désactiver les grandes icônes.

### <a name="remarks"></a>Notes

Par défaut, les grandes icônes sont activées.

##  <a name="enablequickcustomization"></a>CMFCToolBar :: EnableQuickCustomization

Active ou désactive la personnalisation rapide des barres d’outils afin que l’utilisateur puisse appuyer sur la touche **ALT** et faire glisser un bouton vers un nouvel emplacement.

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans TRUE pour activer la personnalisation rapide, FALSe pour désactiver la personnalisation rapide.

##  <a name="enablereflections"></a>CMFCToolBar :: EnableReflections

Active ou désactive la réflexion de la commande.

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans TRUE pour activer la réflexion de commande ; FALSe pour désactiver la réflexion de la commande.

### <a name="remarks"></a>Notes

Appelez cette méthode pour activer la réflexion de commande pour les boutons de barre d’outils qui contiennent des contrôles incorporés, tels que les zones de liste modifiable.

Pour plus d’informations sur la réflexion de commande, consultez [TN062 : message Reflection for Windows Controls](../../mfc/tn062-message-reflection-for-windows-controls.md).

##  <a name="enabletextlabels"></a>CMFCToolBar :: EnableTextLabels

Active ou désactive les étiquettes de texte sous les images de bouton de barre d’outils.

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
TRUE si les étiquettes de texte apparaissent sous les images de bouton de barre d’outils ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Si les étiquettes de texte sont activées, tous les boutons de la barre d’outils sont agrandis pour fournir de l’espace pour les étiquettes à afficher sous les images. La boîte de dialogue Personnalisation contient une case à cocher **afficher l’étiquette de texte** sur la page **barres d’outils** . Lorsque l’utilisateur sélectionne une barre d’outils et vérifie cette option, le Framework appelle `EnableTextLabels` pour la barre d’outils sélectionnée. Vous pouvez désactiver la case à cocher pour un objet dérivé de [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) en REtournant false à partir de [CMFCToolBar :: AllowChangeTextLabels](#allowchangetextlabels) .

##  <a name="fromhandlepermanent"></a>CMFCToolBar :: FromHandlePermanent

Récupère un pointeur vers l’objet `CMFCToolBar` qui contient le handle de fenêtre donné.

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>Paramètres

*HWND*<br/>
dans Handle de fenêtre à rechercher.

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet `CMFCToolBar` qui contient le handle de fenêtre donné, ou NULL s’il n’existe aucun objet `CMFCToolBar` correspondant.

### <a name="remarks"></a>Notes

Cette méthode partagée examine chaque barre d’outils de l’application pour l’objet `CMFCToolBar` qui contient le handle de fenêtre donné.

##  <a name="getallbuttons"></a>CMFCToolBar :: GetAllButtons

Retourne une liste en lecture seule de boutons dans une barre d’outils.

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Référence constante à un objet de [classe CObList](../../mfc/reference/coblist-class.md) , qui contient une collection d’objets de [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) .

##  <a name="getalltoolbars"></a>CMFCToolBar :: GetAllToolbars

Retourne une liste en lecture seule de toutes les barres d’outils de l’application.

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>Valeur de retour

Référence const à un objet de [classe CObList](../../mfc/reference/coblist-class.md) qui contient une collection d’objets `CMFCToolBar`.

##  <a name="getbasiccommands"></a>CMFCToolBar :: GetBasicCommands

Retourne une liste en lecture seule des commandes de base définies dans l’application.

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>Valeur de retour

Référence const à un objet de [classe CList](../../mfc/reference/clist-class.md) qui contient une collection de commandes de base.

### <a name="remarks"></a>Notes

Ajoutez des commandes de base en appelant [CMFCToolBar :: AddBasicCommand](#addbasiccommand) ou [CMFCToolBar :: SetBasicCommands](#setbasiccommands).

##  <a name="getbutton"></a>CMFCToolBar :: GetButton

Retourne un pointeur vers l’objet de la [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) à un index spécifié.

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>Paramètres

*iIndex*<br/>
dans Spécifie l’index du bouton à retourner.

### <a name="return-value"></a>Valeur de retour

Pointeur vers le bouton de barre d’outils, le cas échéant ; ou NULL s’il n’y a aucun bouton de ce type.

##  <a name="getbuttoninfo"></a>CMFCToolBar :: GetButtonInfo

Retourne l’ID de commande, le style et l’index d’image du bouton à un index spécifié.

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Spécifie l’index du bouton dans la liste des boutons de la barre d’outils.

*nID*<br/>
à ID de commande d’un bouton.

*nStyle*<br/>
à Style du bouton.

*iImage*<br/>
à Index de l’image pour le bouton.

### <a name="remarks"></a>Notes

La méthode `GetButtonInfo` trouve un bouton de barre d’outils à l’index spécifié et récupère l’ID de commande, le style et l’index d’image du bouton.

Si le bouton à l’index spécifié n’existe pas, l’infrastructure affecte à *nid* et à *nStyle* la valeur 0, et *IImage* à-1 lorsque la méthode est retournée.

##  <a name="getbuttonsize"></a>CMFCToolBar :: GetButtonSize

Retourne les dimensions de chaque bouton de la barre d’outils.

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>Valeur de retour

Objet de [classe CSize](../../atl-mfc-shared/reference/csize-class.md) qui spécifie les dimensions de chaque bouton sur la barre d’outils.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar :: SetSizes](#setsizes) ou [CMFCToolBar :: SetLockedSizes](#setlockedsizes) pour définir les dimensions de chaque bouton sur la barre d’outils.

##  <a name="getbuttonstyle"></a>CMFCToolBar :: GetButtonStyle

Retourne le style actuel du bouton de barre d’outils situé à l’index spécifié.

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Spécifie l’index d’un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Valeur qui spécifie le style du bouton de barre d’outils. . Pour obtenir la liste des styles possibles, consultez [styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) .

### <a name="remarks"></a>Notes

Appeler [CMFCToolBar :: SetButtonStyle](#setbuttonstyle) pour définir le style d’un bouton de barre d’outils

##  <a name="getbuttontext"></a>CMFCToolBar :: GetButtonText

Retourne l’étiquette de texte d’un bouton ayant un index spécifié.

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index d’un bouton de barre d’outils.

*rString*<br/>
à Texte de l’étiquette du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Texte de l’étiquette du bouton de barre d’outils.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar :: SetButtonText](#setbuttontext) ou [CMFCToolBar :: SetToolBarBtnText](#settoolbarbtntext) pour définir l’étiquette de texte.

##  <a name="getcoldimages"></a>CMFCToolBar :: GetColdImages

Retourne un pointeur désignant la collection d’images de boutons de barre d’outils froid dans l’application.

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de bouton de barre d’outils froid.

### <a name="remarks"></a>Notes

Les images froidles sont les images utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils. Appelez [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) ou [CMFCToolBar :: LoadBitmap](#loadbitmap) pour charger les images froides.

##  <a name="getcolumnwidth"></a>CMFCToolBar :: GetColumnWidth

Retourne la largeur des boutons de la barre d’outils.

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur qui spécifie la largeur des boutons de la barre d’outils.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour calculer la disposition de la barre d’outils. Substituez cette méthode dans une classe dérivée pour spécifier une largeur de colonne différente pour votre barre d’outils.

##  <a name="getcommandbuttons"></a>CMFCToolBar :: GetCommandButtons

Retourne une liste des boutons qui ont un ID de commande spécifié à partir de toutes les barres d’outils de l’application.

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans ID de commande des boutons.

*listButtons*<br/>
à Référence à un objet de [classe CObList](../../mfc/reference/coblist-class.md) qui reçoit la liste des boutons de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nombre de boutons ayant l’ID de commande spécifié.

##  <a name="getcount"></a>CMFCToolBar :: GetCount

Retourne le nombre de boutons et de séparateurs dans la barre d’outils.

```
int GetCount() const;
```

### <a name="return-value"></a>Valeur de retour

Nombre de boutons et de séparateurs dans la barre d’outils.

##  <a name="getcustomizebutton"></a>CMFCToolBar :: GetCustomizeButton

Récupère un pointeur vers l’objet `CMFCCustomizeButton` associé à la barre d’outils.

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet `CMFCCustomizeButton` associé à la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode récupère le bouton **personnaliser** qui apparaît à la fin de la barre d’outils. Utilisez la méthode [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton) pour ajouter le bouton **personnaliser** à votre barre d’outils.

Vous pouvez appeler la méthode [CMFCToolBar :: IsExistCustomizeButton](#isexistcustomizebutton) pour déterminer si la barre d’outils contient un objet `CMFCCustomizeButton` valide.

##  <a name="getdefaultimage"></a>CMFCToolBar :: GetDefaultImage

Retourne l’index de l’image par défaut d’un bouton de barre d’outils avec un ID de commande spécifié.

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
dans Spécifie l’ID de commande du bouton.

### <a name="return-value"></a>Valeur de retour

Index de l’image de la barre d’outils dans la liste partagée d’images.

### <a name="remarks"></a>Notes

Utilisez cette méthode partagée pour récupérer l’index de l’image par défaut d’un bouton de barre d’outils avec l’ID de commande spécifié. La valeur de retour est un index dans la collection partagée d’images de bouton de barre d’outils pour toutes les barres d’outils de l’application. Appelez la méthode [CMFCToolBar :: GetImages](#getimages) pour obtenir un pointeur vers cette collection.

##  <a name="getdisabledimages"></a>CMFCToolBar :: GetDisabledImages

Retourne un pointeur vers la collection d’images utilisées pour les boutons de barre d’outils désactivés dans l’application.

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de bouton de barre d’outils désactivées.

### <a name="remarks"></a>Notes

Chargez les images de bouton de barre d’outils désactivées à l’aide de la [classe CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md) et des méthodes [CMFCToolBar :: LoadBitmap](#loadbitmap) .

##  <a name="getdisabledmenuimages"></a>CMFCToolBar :: GetDisabledMenuImages

Retourne un pointeur vers la collection d’images utilisées pour les boutons de menu désactivés dans l’application.

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de menu désactivées.

### <a name="remarks"></a>Notes

Chargez les images désactivées à l’aide de la méthode de la [classe CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md) .

##  <a name="getdroppeddownmenu"></a>CMFCToolBar :: GetDroppedDownMenu

Récupère un pointeur vers l’objet de bouton de menu qui affiche actuellement son sous-menu.

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>Paramètres

*pIndex*<br/>
à Reçoit l’index du bouton dans la collection de boutons de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet de bouton de menu qui affiche son sous-menu ou NULL si aucun menu n’affiche son sous-menu.

### <a name="remarks"></a>Notes

Si cette méthode retourne une valeur non NULL et que *pIndex* n’est pas null, la valeur pointée par *pIndex* est définie sur l’index du bouton de menu dans la collection de boutons de barre d’outils.

##  <a name="getgraydisabledbuttons"></a>CMFCToolBar :: GetGrayDisabledButtons

Spécifie si les images de boutons désactivés sont des versions estompées des images de bouton normales ou sont extraites de la collection d’images de bouton désactivées.

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE pour estomper les images des boutons désactivés ; FALSe pour obtenir des images à partir de la collection d’images désactivées.

### <a name="remarks"></a>Notes

Utilisez [CMFCToolBar :: SetGrayDisabledButtons](#setgraydisabledbuttons) pour basculer entre les images grisées et les images à partir de la collection d’images désactivées.

##  <a name="gethighlightedbutton"></a>CMFCToolBar :: GetHighlightedButton

Retourne un pointeur vers le bouton de barre d’outils actuellement mis en surbrillance.

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers un objet bouton de barre d’outils ; ou NULL si aucun bouton n’est mis en surbrillance.

### <a name="remarks"></a>Notes

Un bouton de barre d’outils est mis en surbrillance s’il a le focus clavier. Un bouton de barre d’outils est également mis en surbrillance si les boutons de la barre d’outils sont suivis à chaud dans cette application (pour plus d’informations, consultez [CMFCToolBar :: GetHotBorder](#gethotborder) et [CMFCToolBar :: SetHotBorder](#sethotborder)) et que la souris pointe sur celui-ci quand aucun bouton de barre d’outils ou élément de menu n’a le focus clavier.

##  <a name="gethotborder"></a>CMFCToolBar :: GetHotBorder

Détermine si les boutons de la barre d’outils sont *suivis à chaud*. Si un bouton est suivi à chaud, il est mis en surbrillance lorsque la souris est positionnée sur celui-ci.

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si les boutons de la barre d’outils sont suivis à chaud ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Par défaut, les boutons de la barre d’outils sont suivis à chaud.

##  <a name="gethottextcolor"></a>CMFCToolBar :: GetHotTextColor

Retourne la couleur de texte des boutons de la barre d’outils en surbrillance.

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>Valeur de retour

Valeur [COLORREF](/windows/win32/gdi/colorref) qui représente la couleur de texte en surbrillance actuelle.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar :: SetHotTextColor](#sethottextcolor) pour définir une nouvelle couleur de texte pour les boutons de la barre d’outils en surbrillance.

##  <a name="gethwndlastfocus"></a>CMFCToolBar :: GetHwndLastFocus

Retourne un handle vers la fenêtre qui avait le focus d’entrée juste avant la barre d’outils.

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Handle vers une fenêtre qui n’est pas dérivée de la [classe CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md), qui avait précédemment le focus d’entrée ; ou NULL s’il n’existe aucune fenêtre de ce type.

### <a name="remarks"></a>Notes

Lorsqu’un contrôle `CMFCToolBar` reçoit le focus d’entrée, il stocke un handle vers la fenêtre qui a perdu le focus afin qu’il puisse le restaurer ultérieurement.

##  <a name="getignoresettext"></a>CMFCToolBar :: GetIgnoreSetText

Spécifie si les appels pour définir des étiquettes de bouton sont ignorés.

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si les appels pour définir des étiquettes de bouton sont ignorés ; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="getimages"></a>CMFCToolBar :: GetImages

Retourne un pointeur désignant la collection d’images de bouton par défaut dans l’application.

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet de [classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) qui contient la collection d’images par défaut pour toutes les barres d’outils de l’application.

### <a name="remarks"></a>Notes

Cette méthode partagée fournit l’accès à la collection de toutes les images de barre d’outils par défaut pour l’application. Appelez la méthode [CMFCToolBar :: LoadBitmap](#loadbitmap) pour ajouter des images à la collection.

##  <a name="getimagesize"></a>CMFCToolBar :: GetImageSize

Retourne la taille actuelle des images de bouton de barre d’outils.

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>Valeur de retour

Objet de [classe CSize](../../atl-mfc-shared/reference/csize-class.md) qui représente la taille actuelle des images de bouton de barre d’outils.

##  <a name="getimagesoffset"></a>CMFCToolBar :: GetImagesOffset

Retourne le décalage d’index utilisé pour rechercher les images de bouton de barre d’outils pour cette barre d’outils dans la liste globale des images de bouton de barre d’outils.

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>Valeur de retour

Décalage d’index des images de la barre d’outils.

### <a name="remarks"></a>Notes

Toutes les images par défaut de la barre d’outils sont stockées dans la liste globale de la [classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) . Les images de chaque bouton de la barre d’outils sont stockées de façon consécutive dans cette liste. Pour calculer l’index de l’image, ajoutez l’index du bouton dans la barre d’outils à l’offset du début de la liste d’images pour ce bouton de barre d’outils.

Appelez [CMFCToolBar :: ButtonToIndex](#buttontoindex) pour obtenir l’index d’un bouton de barre d’outils en fonction d’un pointeur vers le bouton.

Appelez [CMFCToolBar :: GetImages](#getimages) pour obtenir un pointeur vers la collection d’images de barre d’outils.

##  <a name="getinvalidateitemrect"></a>CMFCToolBar :: GetInvalidateItemRect

Récupère la région de la zone cliente qui doit être redessinée pour le bouton à l’index donné.

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index du bouton pour lequel récupérer la zone cliente.

*lpRect*<br/>
à Pointeur vers un objet RECT qui reçoit la zone de la zone cliente.

### <a name="remarks"></a>Notes

Le paramètre *lpRect* ne doit pas avoir la valeur null. Si aucun bouton n’existe à l’index fourni, *lpRect* reçoit un objet Rect initialisé à zéro.

##  <a name="getitemid"></a>CMFCToolBar :: GetItemID

Retourne l’ID de commande du bouton de barre d’outils à un index spécifié.

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Spécifie l’index du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

ID de commande du bouton de barre d’outils ; ou zéro si le bouton avec l’index spécifié n’existe pas.

##  <a name="getitemrect"></a>CMFCToolBar :: GetItemRect

Retourne le rectangle englobant du bouton à un index spécifié.

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Spécifie l’index d’un bouton de barre d’outils.

*lpRect*<br/>
à Pointeur vers `CRect` objet qui reçoit les coordonnées du rectangle englobant de l’image.

### <a name="remarks"></a>Notes

Objet `CRect` auquel *lpRect* pointe la valeur 0 si un bouton à l’index spécifié n’existe pas.

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser la méthode `GetItemRect` de la classe `CMFCToolBar`. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

##  <a name="getlargecoldimages"></a>CMFCToolBar :: GetLargeColdImages

Retourne un pointeur vers la collection d’images de boutons de barre d’outils à froid importante dans l’application.

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images froides de grande taille.

### <a name="remarks"></a>Notes

Les images froidles sont les images utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils. Appelez [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les grandes images froides.

##  <a name="getlargedisabledimages"></a>CMFCToolBar :: GetLargeDisabledImages

Retourne un pointeur vers la collection d’images de bouton de barre d’outils désactivées volumineuses dans l’application.

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de bouton de barre d’outils désactivées de grande taille.

### <a name="remarks"></a>Notes

Les images de grande taille sont des versions volumineuses des images de boutons de barre d’outils normales. Appelez [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) ou [CMFCToolBar :: LoadBitmap](#loadbitmap) pour charger les images de grande taille.

##  <a name="getlargeimages"></a>CMFCToolBar :: GetLargeImages

Retourne un pointeur désignant la collection d’images de boutons de barre d’outils volumineuses dans l’application.

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de boutons de barre d’outils volumineuses.

### <a name="remarks"></a>Notes

Les images de grande taille sont des versions volumineuses des images de boutons de barre d’outils normales. Appelez [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les images de grande taille.

##  <a name="getlockedcoldimages"></a>CMFCToolBar :: GetLockedColdImages

Retourne un pointeur vers la collection d’images à froid verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images à froid verrouillées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images de boutons de barre d’outils normales que l’infrastructure utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils. Les images froidles sont les images utilisées lorsque l’utilisateur n’interagit pas avec les boutons de la barre d’outils.

Cette méthode retourne la valeur NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également un échec d’assertion dans les versions Debug si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, consultez [CMFCToolBar :: IsLocked](#islocked).

Appelez la méthode [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les images froidles verrouillées.

##  <a name="getlockeddisabledimages"></a>CMFCToolBar :: GetLockedDisabledImages

Retourne un pointeur vers la collection d’images verrouillées désactivées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images verrouillées désactivées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images de boutons de barre d’outils normales que l’infrastructure utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils. Les images désactivées sont les images que le Framework utilise lorsqu’un bouton a le style TBBS_DISABLED.

Cette méthode retourne la valeur NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également un échec d’assertion dans les versions Debug si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, consultez [CMFCToolBar :: IsLocked](#islocked).

Appelez la méthode [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les images désactivées verrouillées.

##  <a name="getlockedimages"></a>CMFCToolBar :: GetLockedImages

Retourne un pointeur désignant la collection d’images de bouton verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de bouton de barre d’outils verrouillées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images de boutons de barre d’outils normales que l’infrastructure utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode retourne la valeur NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également un échec d’assertion dans les versions Debug si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, consultez [CMFCToolBar :: IsLocked](#islocked).

##  <a name="getlockedimagesize"></a>CMFCToolBar :: GetLockedImageSize

Retourne la taille par défaut des images de barre d’outils verrouillées.

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>Valeur de retour

Structure `CSize` qui spécifie la taille des images de barre d’outils verrouillées ou une structure de `CSize` vide si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images de boutons de barre d’outils normales que l’infrastructure utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode retourne une structure `CSize` avec une largeur nulle et une hauteur zéro si la barre d’outils n’est pas verrouillée. Cette méthode génère également un échec d’assertion dans les versions Debug si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, consultez [CMFCToolBar :: IsLocked](#islocked).

Appelez la méthode [CMFCToolBar :: SetLockedSizes](#setlockedsizes) pour spécifier la taille de l’image verrouillée.

##  <a name="getlockedmenuimages"></a>CMFCToolBar :: GetLockedMenuImages

Retourne un pointeur désignant la collection d’images de menu de barre d’outils verrouillées dans la barre d’outils.

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de menu de barre d’outils verrouillées, ou NULL si la barre d’outils n’est pas verrouillée.

### <a name="remarks"></a>Notes

Les images verrouillées sont des versions des images de menu de barre d’outils normales que le Framework utilise lorsque l’utilisateur ne peut pas personnaliser la barre d’outils.

Cette méthode retourne la valeur NULL si la barre d’outils n’est pas verrouillée. Cette méthode génère également un échec d’assertion dans les versions Debug si la barre d’outils n’est pas verrouillée. Pour plus d’informations sur les barres d’outils verrouillées, consultez [CMFCToolBar :: IsLocked](#islocked).

Appelez la méthode [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les images de menu verrouillées.

##  <a name="getmenubuttonsize"></a>CMFCToolBar :: GetMenuButtonSize

Retourne la taille des boutons de menu dans l’application.

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>Valeur de retour

Objet `CSize` qui représente la taille des boutons de menu, en pixels.

### <a name="remarks"></a>Notes

La taille des boutons de menu sur les barres d’outils est conservée en tant que variable globale et peut être récupérée par cette méthode statique.

Appelez [CMFCToolBar :: SetMenuSizes](#setmenusizes) pour définir cette variable globale.

##  <a name="getmenuimages"></a>CMFCToolBar :: GetMenuImages

Retourne un pointeur désignant la collection d’images de bouton de menu dans l’application.

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de menu.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar :: LoadBitmapEx](#loadbitmapex) pour charger les images de menu.

Appelez la méthode [CMFCToolBar :: SetMenuSizes](#setmenusizes) pour définir la taille des boutons et leurs images.

##  <a name="getmenuimagesize"></a>CMFCToolBar :: GetMenuImageSize

Retourne la taille des images de bouton de menu dans l’application.

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>Valeur de retour

Objet `CSize` qui représente la taille des images de menu.

### <a name="remarks"></a>Notes

Cette méthode retourne la taille des images sur les boutons de menu de la barre d’outils qui est conservée en tant que variable globale. Appelez [CMFCToolBar :: SetMenuSizes](#setmenusizes) pour définir cette variable globale.

##  <a name="getorigbuttons"></a>CMFCToolBar :: GetOrigButtons

Récupère la collection de boutons non personnalisés de la barre d’outils.

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Référence à la liste des boutons non personnalisés de la barre d’outils.

### <a name="remarks"></a>Notes

L’infrastructure crée une copie des boutons de la barre d’outils avant qu’ils ne soient personnalisés par l’utilisateur. La méthode [CMFCToolBar :: SetButtons](#setbuttons) ajoute une copie de chaque bouton du tableau fourni à la liste des boutons d’origine. La méthode [CMFCToolBar :: RestoreOriginalState](#restoreoriginalstate) restaure l’état d’origine de la barre d’outils en la chargeant à partir du fichier de ressources.

Pour définir la liste des boutons d’origine de votre barre d’outils, appelez la méthode [CMFCToolBar :: SetOrigButtons](#setorigbuttons) .

##  <a name="getorigresetbuttons"></a>CMFCToolBar :: GetOrigResetButtons

Récupère la collection de boutons de réinitialisation non personnalisés de la barre d’outils.

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>Valeur de retour

Référence à la liste des boutons de réinitialisation non personnalisés de la barre d’outils.

### <a name="remarks"></a>Notes

Quand l’utilisateur clique sur le bouton **Réinitialiser** pendant le mode de personnalisation, le Framework utilise cette méthode pour restaurer les boutons qui ont été supprimés de la barre d’outils.

La méthode [CMFCToolBar :: SetButtons](#setbuttons) ajoute une copie de chaque bouton de barre d’outils à la liste des boutons de réinitialisation d’origine après avoir appelé la méthode [CMFCToolBar :: OnReset](#onreset) . Vous pouvez substituer la méthode [CMFCToolBar :: OnReset](#onreset) pour personnaliser l’apparence des boutons après que l’utilisateur a appuyé sur le bouton **Réinitialiser** .

##  <a name="getresourceid"></a>CMFCToolBar :: GetResourceID

Récupère l’ID de ressource de la barre d’outils.

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>Valeur de retour

ID de ressource de la barre d’outils.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar :: LoadToolBarEx](#loadtoolbarex) pour définir l’ID de ressource de la barre d’outils.

##  <a name="getroutecommandsviaframe"></a>CMFCToolBar :: GetRouteCommandsViaFrame

Détermine l’objet, le frame parent ou le propriétaire, qui envoie des commandes à la barre d’outils.

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le frame parent envoie des commandes à la barre d’outils ; 0 si le propriétaire envoie des commandes à la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, le frame parent envoie des commandes à la barre d’outils. Appelez [CMFCToolBar :: SetRouteCommandsViaFrame](#setroutecommandsviaframe) pour modifier ce comportement.

Si cette méthode retourne une valeur différente de zéro, vous pouvez récupérer un pointeur vers l’objet de frame parent à l’aide de la méthode `CMFCToolBar::GetCommandTarget`. Consultez l’exemple VisualStudioDemo pour obtenir un exemple qui utilise cette méthode.

##  <a name="getrowheight"></a>CMFCToolBar :: GetRowHeight

Retourne la hauteur des boutons de la barre d’outils.

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>Valeur de retour

Hauteur des boutons de la barre d’outils, en pixels.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour calculer la disposition de la barre d’outils. Substituez cette méthode dans une classe dérivée pour spécifier une hauteur différente pour votre barre d’outils.

##  <a name="getshowtooltips"></a>CMFCToolBar :: GetShowTooltips

Spécifie si les info-bulles sont affichées pour les boutons de barre d’outils.

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>Valeur de retour

TRUE si les info-bulles sont affichées pour les boutons de la barre d’outils ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Par défaut, les info-bulles sont affichées. Vous pouvez modifier cet indicateur statique en appelant [CMFCToolBar :: SetShowTooltips](#setshowtooltips).

##  <a name="getsiblingtoolbar"></a>CMFCToolBar :: GetSiblingToolBar

Récupère le frère de la barre d’outils.

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la barre d’outils frères.

### <a name="remarks"></a>Notes

Pour plus d’informations sur la façon d’activer les boutons **afficher les boutons sur une ligne** et afficher les boutons **sur deux lignes** , consultez [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar).

##  <a name="getuserimages"></a>CMFCToolBar :: GetUserImages

Retourne un pointeur désignant la collection d’images de bouton de barre d’outils définies par l’utilisateur dans l’application.

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la collection d’images de bouton de barre d’outils définies par l’utilisateur pour toutes les barres d’outils de l’application.

### <a name="remarks"></a>Notes

Appelez la méthode [CMFCToolBar :: SetUserImages](#setuserimages) pour définir la collection d’images définies par l’utilisateur dans l’application.

##  <a name="hittest"></a>CMFCToolBar :: HitTest

Retourne l’index du bouton de barre d’outils situé à la position spécifiée.

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>Paramètres

*point*<br/>
dans Point à tester, en coordonnées clientes.

### <a name="return-value"></a>Valeur de retour

Index du bouton situé à la position spécifiée, ou-1 s’il n’y a aucun bouton ou si le bouton est un séparateur.

##  <a name="insertbutton"></a>CMFCToolBar :: InsertButton

Insère un bouton dans la barre d’outils.

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>Paramètres

*bouton*<br/>
dans Spécifie le bouton à insérer.

*iInsertAt*<br/>
dans Spécifie la position de base zéro à laquelle insérer le bouton.

### <a name="return-value"></a>Valeur de retour

Position à laquelle le bouton a été inséré ou-1 si une erreur se produit.

### <a name="remarks"></a>Notes

Si *iInsertAt* a la valeur-1, cette méthode ajoute le bouton à la fin de la liste des boutons de la barre d’outils.

Appelez la méthode [CMFCToolBar :: InsertSeparator](#insertseparator) pour insérer un séparateur dans la barre d’outils.

##  <a name="insertseparator"></a>CMFCToolBar :: InsertSeparator

Insère un séparateur dans la barre d’outils.

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>Paramètres

*iInsertAt*<br/>
dans Spécifie la position de base zéro à laquelle insérer le séparateur. Ce paramètre doit être supérieur à 0.

### <a name="return-value"></a>Valeur de retour

Position à laquelle le séparateur a été inséré ou-1 si une erreur se produit.

### <a name="remarks"></a>Notes

Appelez cette méthode pour insérer un séparateur entre deux boutons existants. Si *iInsertAt* a la valeur-1, cette méthode ajoute le séparateur à la fin de la liste des boutons de la barre d’outils.

Vous ne pouvez pas utiliser cette méthode pour ajouter un séparateur à une barre d’outils vide.

Appelez la méthode [CMFCToolBar :: InsertButton](#insertbutton) pour insérer un bouton dans la barre d’outils.

##  <a name="invalidatebutton"></a>CMFCToolBar :: InvalidateButton

Invalide la zone cliente du bouton de barre d’outils qui existe à l’index fourni.

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index de base zéro du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet `CMFCToolBarButton` qui existe à l’index fourni ou NULL s’il n’existe aucun objet de ce type.

### <a name="remarks"></a>Notes

Le Framework appelle cette méthode lorsqu’il met à jour la zone cliente associée à un bouton de barre d’outils. Elle appelle la méthode [CWnd :: InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect) avec le rectangle client de l’objet `CMFCToolBarButton` qui existe à l’index fourni.

##  <a name="isaddremovequickcustomize"></a>CMFCToolBar :: IsAddRemoveQuickCustomize

Détermine si un utilisateur peut ajouter ou supprimer des boutons de barre d’outils à l’aide de l’option de menu **personnaliser** .

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>Valeur de retour

TRUE si un utilisateur peut utiliser l’option de menu **personnaliser** pour modifier la barre d’outils ; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="isaltcustomizemode"></a>CMFCToolBar :: IsAltCustomizeMode

Spécifie si la *personnalisation rapide* est utilisée pour faire glisser un bouton. Quand la personnalisation rapide est activée, un utilisateur peut appuyer sur la touche Alt et la maintenir enfoncée et faire glisser un bouton vers un nouvel emplacement.

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la personnalisation rapide est utilisée pour faire glisser un bouton ; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="isautograyinactiveimages"></a>CMFCToolBar :: IsAutoGrayInactiveImages

Spécifie si la génération automatique d’images de bouton inactives (non en surbrillance) est activée.

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>Valeur de retour

TRUE si l’option permettant d’estomper automatiquement les images inactives est activée ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Vous pouvez activer ou désactiver la mise en grisé automatique des images inactives en appelant [CMFCToolBar :: AutoGrayInactiveImages](#autograyinactiveimages).

##  <a name="isbasiccommand"></a>CMFCToolBar :: IsBasicCommand

Détermine si une commande est dans la liste des commandes de base.

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans Spécifie la commande à vérifier.

### <a name="return-value"></a>Valeur de retour

TRUE si la commande spécifiée appartient à la liste des commandes de base ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode statique détermine si la commande spécifiée par *uiCmd* appartient à la liste globale des commandes de base. Vous pouvez modifier la liste des commandes de base en appelant [CMFCToolBar :: AddBasicCommand](#addbasiccommand) ou [CMFCToolBar :: SetBasicCommands](#setbasiccommands).

##  <a name="isbuttonextrasizeavailable"></a>CMFCToolBar :: IsButtonExtraSizeAvailable

Détermine si la barre d’outils peut afficher des boutons avec des bordures étendues.

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre peut afficher des boutons avec la taille de bordure supplémentaire ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’objet Toolbar retourne la valeur TRUE s’il peut afficher des boutons avec des bordures étendues. Un bouton de barre d’outils appelle cette méthode lorsqu’il gère la notification [CMFCToolBarButton :: OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd) et définit son indicateur de taille de bordure supplémentaire interne en conséquence. Cet indicateur interne peut être récupéré ultérieurement en appelant [CMFCToolBarButton :: IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize).

Substituez cette méthode dans une classe dérivée de `CMFCToolBar` et retournent la valeur TRUE si votre barre peut afficher les boutons de barre d’outils avec la taille de bordure supplémentaire et retourne FALSe dans le cas contraire. L’implémentation par défaut retourne la valeur TRUE.

##  <a name="isbuttonhighlighted"></a>CMFCToolBar :: IsButtonHighlighted

Détermine si le bouton spécifié est mis en surbrillance.

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>Paramètres

*iButton*<br/>
dans Spécifie l’index d’un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton spécifié est mis en surbrillance ; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="iscommandpermitted"></a>CMFCToolBar :: IsCommandPermitted

Détermine si une commande est autorisée.

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans Spécifie la commande à vérifier.

### <a name="return-value"></a>Valeur de retour

TRUE si la commande spécifiée est autorisée ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode statique détermine si la commande spécifiée par *uiCmd* appartient à la liste globale des commandes non autorisées.

Vous pouvez modifier la liste des commandes non autorisées en appelant [CMFCToolBar :: SetNonPermittedCommands](#setnonpermittedcommands).

##  <a name="iscommandrarelyused"></a>CMFCToolBar :: IsCommandRarelyUsed

Détermine si une commande est rarement utilisée.

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans Spécifie la commande à vérifier.

### <a name="return-value"></a>Valeur de retour

TRUE si la commande spécifiée est rarement utilisée ; Sinon, FALSe.

### <a name="remarks"></a>Notes

La méthode `IsCommandRarelyUsed` retourne la valeur FALSe lorsqu’une ou plusieurs des conditions suivantes sont remplies :

- La commande spécifiée appartient à la liste des commandes de base.

- La commande spécifiée est l’une des commandes standard

- Le Framework est en mode de personnalisation

- La liste des commandes de base est vide

- Plus de 20% des appels de commande sont des appels à la commande spécifiée.

##  <a name="iscustomizemode"></a>CMFCToolBar :: IsCustomizeMode

Spécifie si l’infrastructure de barre d’outils est en mode de personnalisation.

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>Valeur de retour

TRUE si le Framework est en mode de personnalisation ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Vous pouvez activer ou désactiver le mode de personnalisation en appelant [CMFCToolBar :: SetCustomizeMode](#setcustomizemode).

L’infrastructure modifie le mode lorsque l’utilisateur appelle la boîte de dialogue de personnalisation ( [classe CMFCToolBarsCustomizeDialog](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)).

##  <a name="isdragbutton"></a>CMFCToolBar :: IsDragButton

Détermine si un bouton de barre d’outils est glissé.

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers un bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton spécifié est glissé ; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="isexistcustomizebutton"></a>CMFCToolBar :: IsExistCustomizeButton

Détermine si la barre d’outils contient le bouton **personnaliser** .

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils contient le bouton **personnaliser** ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Si cette méthode retourne la valeur TRUE, la méthode [CMFCToolBar :: GetCustomizeButton](#getcustomizebutton) retourne un pointeur vers le bouton **personnaliser** qui apparaît à la fin de la barre d’outils.

Utilisez la méthode [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton) pour ajouter le bouton **personnaliser** à votre barre d’outils.

##  <a name="isfloating"></a>CMFCToolBar :: IsFloating

Détermine si la barre d’outils est flottante.

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils est flottante ; Sinon, FALSe.

##  <a name="islargeicons"></a>CMFCToolBar :: IsLargeIcons

Spécifie si les barres d’outils de l’application affichent actuellement de grandes icônes.

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>Valeur de retour

TRUE si l’application utilise de grandes icônes ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Appelez [CMFCToolBar :: SetLargeIcons](#setlargeicons) pour basculer entre les grandes icônes et les icônes régulières.

Le Framework change automatiquement le mode quand l’utilisateur active la case à cocher **grandes icônes** dans la page **options** de la boîte de dialogue **personnalisation** .

##  <a name="islastcommandfrombutton"></a>CMFCToolBar :: IsLastCommandFromButton

Détermine si la dernière commande exécutée a été envoyée à partir du bouton de barre d’outils spécifié.

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers le bouton.

### <a name="return-value"></a>Valeur de retour

TRUE si la dernière commande a été envoyée à partir du bouton que *pButton* spécifie ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode obtient un pointeur vers une [structure MSG](/windows/win32/api/winuser/ns-winuser-msg) en appelant `CWnd::GetCurrentMessage`. Il compare ensuite le HWND du bouton avec les membres `MSG::lParam` et `MSG::hwnd` pour déterminer si le bouton était la source de la commande.

##  <a name="islocked"></a>CMFCToolBar :: IsLocked

Détermine si la barre d’outils est verrouillée.

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils est verrouillée ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode retourne la valeur TRUE lorsque l’utilisateur ne peut pas effectuer de tâches de personnalisation, telles que le repositionnement des boutons de la barre d’outils.

Les barres d’outils verrouillées utilisent des listes d’images distinctes. Pour plus d’informations sur ces listes d’images, consultez [CMFCToolBar :: LoadBitmapEx](#loadbitmapex).

##  <a name="isonerowwithsibling"></a>CMFCToolBar :: IsOneRowWithSibling

Détermine si la barre d’outils et sa barre d’outils frères sont positionnés sur la même ligne.

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils et son frère sont positionnés sur la même ligne ; Sinon, FALSe.

### <a name="remarks"></a>Notes

La méthode [CMFCCustomizeButton :: CreatePopupMenu](internal-classes.md) appelle cette méthode pour déterminer comment afficher le menu contextuel **personnaliser** . Si cette méthode retourne la valeur TRUE, l’infrastructure affiche le bouton **afficher les boutons sur une ligne** . Dans le cas contraire, le Framework affiche le bouton **afficher les boutons sur deux lignes** .

En règle générale, vous n'avez pas à utiliser cette méthode. Pour activer les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** , appelez [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar).

##  <a name="isresourcechanged"></a>CMFCToolBar :: IsResourceChanged

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="issibling"></a>CMFCToolBar :: IsSibling

```
BOOL IsSibling();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isuserdefined"></a>CMFCToolBar :: IsUserDefined

Spécifie si la barre d’outils est définie par l’utilisateur.

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre d’outils a été créée par l’utilisateur ; Sinon, FALSe.

##  <a name="loadbitmap"></a>CMFCToolBar :: LoadBitmap

Charge les images de barre d’outils à partir des ressources de l’application.

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils actives.

*uiColdResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils froides.

*uiMenuResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de menu normales.

*Obstrué*<br/>
dans TRUE pour verrouiller la barre d’outils ; Sinon, FALSe.

*uiDisabledResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils désactivées.

*uiMenuDisabledResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de menu désactivées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

La méthode [CMFCToolBar::LoadToolBarEx](#loadtoolbarex) appelle cette méthode pour charger les images qui sont associées à la barre d’outils. Surchargez cette méthode pour effectuer un chargement personnalisé des ressources d’images.

Appelez la méthode `LoadBitmapEx` pour charger des images supplémentaires après avoir créé la barre d’outils.

##  <a name="loadbitmapex"></a>CMFCToolBar :: LoadBitmapEx

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>Paramètres

dans *paramètres*<br/>
dans *bloqué*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="loadlargeiconsstate"></a>CMFCToolBar :: LoadLargeIconsState

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>Paramètres

dans *lpszProfileName*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="loadparameters"></a>CMFCToolBar :: LoadParameters

Charge les options globales de la barre d’outils à partir du Registre Windows.

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Spécifie le chemin d’accès relatif de la clé de Registre Windows.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode charge des paramètres globaux tels que le type d’animation de menu, le style d’ombre de menu et indique s’il faut afficher de grandes icônes à partir du Registre Windows.

La méthode [CWinAppEx :: LoadState](../../mfc/reference/cwinappex-class.md#loadstate) appelle cette méthode dans le cadre du processus d’initialisation de l’application.

##  <a name="loadstate"></a>CMFCToolBar :: LoadState

Charge les informations d’état de la barre d’outils à partir du Registre Windows.

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Spécifie le chemin d’accès relatif de la clé de Registre Windows.

*nIndex*<br/>
dans Spécifie l’ID de contrôle de la barre d’outils.

*uiID*<br/>
dans Spécifie l’ID de ressource de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode dans le cadre du processus d’initialisation de l’application. Pour plus d’informations, consultez [CWinAppEx :: LoadState](../../mfc/reference/cwinappex-class.md#loadstate).

##  <a name="loadtoolbar"></a>CMFCToolBar :: LoadToolBar

Charge la barre d’outils à partir des ressources d’application.

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>Paramètres

*uiResID*<br/>
dans ID de ressource de la barre d’outils.

*uiColdResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils froides.

*uiMenuResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de menu normales.

*Obstrué*<br/>
dans Valeur booléenne qui spécifie si la barre d’outils est verrouillée ou non. Si ce paramètre a la *valeur true*, la barre d’outils est verrouillée. Dans le cas contraire, la barre d’outils n’est pas verrouillée.

*uiDisabledResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils désactivées.

*uiMenuDisabledResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de menu désactivées.

*uiHotResID*<br/>
dans ID de ressource de la bitmap qui fait référence aux images de barre d’outils actives.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode au cours de l’initialisation pour charger les images qui sont associées à la barre d’outils.

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser la méthode `LoadToolBar` dans la classe `CMFCToolBar`. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="loadtoolbarex"></a>CMFCToolBar :: LoadToolBarEx

Charge la barre d’outils à partir des ressources d’application à l’aide de la classe d’assistance `CMFCToolBarInfo` pour permettre à l’application d’utiliser des images de grande taille.

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiToolbarResID*<br/>
dans ID de ressource de la barre d’outils.

*params*<br/>
dans Référence à un objet `CMFCToolBarInfo` qui contient les ID de ressource pour les images de barre d’outils.

*Obstrué*<br/>
dans Valeur booléenne qui spécifie si la barre d’outils est verrouillée ou non. Si ce paramètre a la valeur TRUE, la barre d’outils est verrouillée. Dans le cas contraire, la barre d’outils n’est pas verrouillée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez cette méthode pour charger les images de barre d’outils à partir des ressources de l’application.

##  <a name="m_dbllargeimageratio"></a>CMFCToolBar :: m_dblLargeImageRatio

Spécifie le ratio entre la dimension (hauteur ou largeur) des grandes images et la dimension des images normales.

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>Notes

Le ratio par défaut est 2. Vous pouvez modifier cette valeur pour agrandir ou réduire la taille des images de la barre d’outils.

L’infrastructure utilise ce membre de données lorsque vous ne spécifiez pas un ensemble d’images de grande taille. Par exemple, si vous fournissez uniquement le jeu de petites images de taille 16x16 et que vous souhaitez que les grandes images aient la taille 24x24, définissez ce membre de données sur 1,5.

##  <a name="nextmenu"></a>CMFCToolBar :: NextMenu

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onbeforeremovebutton"></a>CMFCToolBar :: OnBeforeRemoveButton

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
[in] Inutilisé.

*dropEffect*<br/>
[in] Inutilisé.

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onchangehot"></a>CMFCToolBar :: OnChangeHot

Appelé par le Framework quand un utilisateur sélectionne un bouton dans la barre d’outils.

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>Paramètres

*iHot*<br/>
dans Spécifie l’index du bouton de barre d’outils sélectionné ; ou-1 si aucun bouton de barre d’outils n’est sélectionné.

### <a name="remarks"></a>Notes

Substituez cette méthode pour traiter les notifications pour lesquelles l’utilisateur a sélectionné un bouton dans une barre d’outils.

##  <a name="onchangevisualmanager"></a>CMFCToolBar :: OnChangeVisualManager

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>Notes

##  <a name="onfillbackground"></a>CMFCToolBar :: OnFillBackground

Appelé par l’infrastructure à partir de [CBasePane ::D opaint](../../mfc/reference/cbasepane-class.md#dopaint) pour remplir l’arrière-plan de la barre d’outils.

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers un contexte de périphérique (Device Context).

### <a name="remarks"></a>Notes

[CMFCToolBar ::D opaint](#dopaint) appelle cette méthode quand l’arrière-plan d’une barre d’outils a été rempli. L'implémentation par défaut n'exécute aucune opération.

Substituez cette méthode pour dessiner un arrière-plan personnalisé dans les classes dérivées.

##  <a name="onglobalfontschanged"></a>CMFCToolBar :: OnGlobalFontsChanged

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Notes

##  <a name="onreset"></a>CMFCToolBar :: OnReset

Restaure l’état d’origine de la barre d’outils.

```
virtual void OnReset();
```

### <a name="remarks"></a>Notes

Substituez cette méthode pour gérer les notifications relatives à la réinitialisation d’une barre d’outils.

L'implémentation par défaut n'exécute aucune opération. Substituez `OnReset` dans une classe dérivée de `CMFCToolBar` lorsque la barre d’outils contient des boutons factices qui doivent être remplacés lorsque la barre d’outils revient à son état d’origine.

##  <a name="onsetaccdata"></a>CMFCToolBar :: OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>Paramètres

dans *lVal*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onsetdefaultbuttontext"></a>CMFCToolBar :: OnSetDefaultButtonText

Rétablit l’État par défaut du texte d’un bouton de barre d’outils.

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointe vers un bouton, dont le texte est défini.

### <a name="return-value"></a>Valeur de retour

La valeur TRUE ifthe Text a été correctement restaurée ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Substituez cette méthode pour traiter les notifications indiquant que le texte d’un bouton de barre d’outils est remplacé par sa valeur par défaut.

L’implémentation par défaut charge le texte d’un bouton à partir des ressources de l’application.

##  <a name="onusertooltip"></a>CMFCToolBar :: OnUserToolTip

Appelée par l’infrastructure lorsque l’info-bulle d’un bouton est sur le paragraphe d’être affichée.

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointe vers un bouton de barre d’outils pour lequel une info-bulle doit être affichée.

*strTTText*<br/>
à Référence à `CString` objet qui reçoit le texte de l’info-bulle.

### <a name="return-value"></a>Valeur de retour

TRUE si *strTTText* a été rempli avec le texte info-bulle ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’info-bulle d’un bouton de barre d’outils va être affichée. Si `OnUserToolTip` retourne la valeur TRUE, l’infrastructure affiche une info-bulle qui contient le texte retourné par `OnUserToolTip` dans *strTTText*. Dans le cas contraire, l’info-bulle contient le texte du bouton.

Substituez `OnUserToolTip` pour personnaliser les info-bulles des boutons de la barre d’outils. L’implémentation par défaut appelle [CMFCToolBar :: OnUserToolTip](#onusertooltip) pour obtenir le texte info-bulle.

##  <a name="prevmenu"></a>CMFCToolBar ::P revMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="processcommand"></a>CMFCToolBar ::P rocessCommand

Publie un message d’WM_COMMAND dans la fenêtre propriétaire de la barre d’outils.

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers un bouton sur la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode doit toujours retourner TRUE. MFC utilise des valeurs FALSe en interne.

### <a name="remarks"></a>Notes

Cette méthode publie un message d’WM_COMMAND dans la fenêtre propriétaire de la barre d’outils en appelant [CWnd ::P ostmessage](../../mfc/reference/cwnd-class.md#postmessage) et en passant l’ID de commande du bouton spécifié comme paramètre *wParam* .

Utilisez la macro [ON_COMMAND](message-map-macros-mfc.md#on_command) pour mapper le message WM_COMMAND à une fonction membre.

##  <a name="removeallbuttons"></a>CMFCToolBar :: RemoveAllButtons

Supprime tous les boutons et séparateurs de la barre d’outils.

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>Notes

Le Framework appelle cette méthode lorsqu’il recrée ou détruit une barre d’outils.

##  <a name="removebutton"></a>CMFCToolBar :: RemoveButton

Supprime de la barre d’outils le bouton qui possède l’index spécifié.

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>Paramètres

*iIndex*<br/>
dans Spécifie l’index de base zéro du bouton à supprimer.

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode est réussie, ou FALSe si l’index spécifié n’est pas valide ou si l’index fait référence au bouton **personnaliser** .

### <a name="remarks"></a>Notes

Cette méthode met à jour les attributs de barre d’outils supplémentaires qui sont affectés par la suppression du bouton. Par exemple, cette méthode supprime les séparateurs non essentiels de la barre d’outils et reconstruit la table des touches de raccourci.

Pour plus d’informations sur le bouton **personnaliser** , consultez [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton).

##  <a name="removestatefromregistry"></a>CMFCToolBar :: RemoveStateFromRegistry

Supprime les informations d’état de la barre d’outils du Registre Windows.

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Spécifie la clé de registre où se trouvent les informations d’État.

*nIndex*<br/>
dans ID de contrôle de la barre d’outils.

*uiID*<br/>
dans ID de ressource de la barre d’outils. Si ce paramètre a la valeur-1, cette méthode utilise la méthode [CWnd :: GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid) pour récupérer l’ID de ressource.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’elle supprime une barre d’outils définie par l’utilisateur.

Substituez cette méthode si vous stockez des informations d’État supplémentaires dans le Registre Windows.

##  <a name="replacebutton"></a>CMFCToolBar :: ReplaceButton

Remplace un bouton de barre d’outils par un autre bouton de barre d’outils.

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
dans ID de commande du bouton à remplacer.

*bouton*<br/>
dans Référence au `CMFCToolBarButton` à insérer.

*Boule*<br/>
dans Valeur booléenne qui spécifie s’il faut remplacer tous les boutons qui ont l’ID de commande spécifié par *uiCmd*. Si ce paramètre a la valeur TRUE, tous les boutons qui ont l’ID de commande spécifié sont remplacés. Dans le cas contraire, le premier bouton est remplacé.

### <a name="return-value"></a>Valeur de retour

Nombre de boutons remplacés. Cette méthode retourne 0 si un bouton avec l’ID de commande spécifié n’existe pas dans la barre d’outils.

### <a name="remarks"></a>Notes

Appelez cette méthode lorsque vous souhaitez ajouter des boutons de barre d’outils qui ne peuvent pas être chargés à partir de ressources. Vous pouvez créer un bouton d’espace réservé au moment de la conception et remplacer ce bouton par un bouton personnalisé lorsque vous initialisez la barre d’outils. Consultez l’exemple VisualStudioDemo pour obtenir un exemple qui utilise cette méthode.

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser la méthode `ReplaceButton` dans la classe `CMFCToolBar`. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

##  <a name="resetall"></a>CMFCToolBar :: ResetAll

Restaure toutes les barres d’outils à leur état d’origine.

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>Notes

Cette méthode appelle la méthode [CMFCToolBar :: RestoreOriginalState](#restoreoriginalstate) sur chaque barre d’outils de l’application qui peut être restaurée. Elle utilise la méthode [CMFCToolBar :: CanBeRestored](#canberestored) pour déterminer si une barre d’outils peut être restaurée.

##  <a name="resetallimages"></a>CMFCToolBar :: ResetAllImages

Efface toutes les collections d’images de la barre d’outils dans l’application.

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>Notes

Cette méthode efface les collections d’images initialisées par les méthodes [CMFCToolBar :: LoadToolBar](#loadtoolbar) et [CMFCToolBar :: LoadBitmap](#loadbitmap) .

##  <a name="resetimages"></a>CMFCToolBar :: ResetImages

```
virtual void ResetImages();
```

### <a name="remarks"></a>Notes

##  <a name="restorefocus"></a>CMFCToolBar :: RestoreFocus

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>Notes

##  <a name="restoreoriginalstate"></a>CMFCToolBar :: RestoreOriginalState

Restaure l'état initial d'une barre d'outils.

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode réussit, ou FALSe si la méthode échoue ou si la barre d’outils est définie par l’utilisateur.

### <a name="remarks"></a>Notes

Cette méthode charge la barre d’outils à partir du fichier de ressources à l’aide de la méthode [CMFCToolBar :: LoadToolBar](#loadtoolbar) .

L’infrastructure appelle cette méthode lorsque l’utilisateur clique sur le bouton **Réinitialiser tout** de la page **barres d’outils** d’une boîte de dialogue de personnalisation.

##  <a name="saveparameters"></a>CMFCToolBar :: SaveParameters

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>Paramètres

dans *lpszProfileName*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="savestate"></a>CMFCToolBar :: saveste

Enregistre les informations d’état de la barre d’outils dans le Registre Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Spécifie le chemin d’accès relatif de la clé de Registre Windows.

*nIndex*<br/>
dans ID de contrôle de la barre d’outils.

*uiID*<br/>
dans ID de ressource de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Le Framework appelle cette méthode lorsqu’il enregistre l’état de l’application dans le registre. Pour plus d’informations, consultez [CWinAppEx :: saveste](../../mfc/reference/cwinappex-class.md#savestate).

##  <a name="setbasiccommands"></a>CMFCToolBar :: SetBasicCommands

Définit la liste des commandes qui sont toujours affichées lorsqu’un utilisateur ouvre un menu.

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>Paramètres

*lstCommands*<br/>
dans Référence à un objet `CList` qui contient une collection de commandes.

### <a name="remarks"></a>Notes

Une commande de base est toujours affichée lorsque le menu est ouvert. Cette méthode est significative lorsque l’utilisateur choisit d’afficher les commandes récemment utilisées.

Utilisez la méthode [CMFCToolBar :: AddBasicCommand](#addbasiccommand) pour ajouter une commande à la liste des commandes de base. Utilisez la méthode [CMFCToolBar :: GetBasicCommands](#getbasiccommands) pour récupérer la liste des commandes de base utilisées par votre application.

Consultez l’exemple Explorer pour obtenir un exemple qui utilise cette méthode.

##  <a name="setbuttoninfo"></a>CMFCToolBar :: SetButtonInfo

Définit l’ID de commande, le style et l’ID d’image d’un bouton de barre d’outils.

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index de base zéro du bouton dont les propriétés sont définies.

*nID*<br/>
dans ID de commande du bouton.

*nStyle*<br/>
dans Style du bouton. Consultez [styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) pour obtenir la liste des styles de boutons de barre d’outils disponibles.

*iImage*<br/>
dans Index d’image de base zéro du bouton (autrement dit, l’index dans la collection d’images de barre d’outils).

### <a name="remarks"></a>Notes

Appelez cette méthode pour définir les propriétés d’un bouton de barre d’outils.

Dans les versions Debug, cette méthode génère un échec d’assertion si l’index spécifié par *nIndex* n’est pas valide.

Appelez la méthode [CMFCToolBar :: SetButtonStyle](#setbuttonstyle) pour définir uniquement le style du bouton.

##  <a name="setbuttons"></a>CMFCToolBar :: SetButtons

Définit les boutons de la barre d’outils.

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>Paramètres

*lpIDArray*<br/>
dans Pointeur vers le tableau d’ID de commande des boutons à insérer.

*nIDCount*<br/>
dans Nombre d’éléments dans *lpIDArray*.

*bRemapImages*<br/>
dans Valeur booléenne qui spécifie s’il faut associer les images de bouton existantes aux boutons insérés. Si ce paramètre a la valeur TRUE, les images sont remappées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode réussit ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez cette méthode pour supprimer des boutons existants d’une barre d’outils et insérer une collection de nouveaux boutons.

Cette méthode ajoute le bouton **personnaliser** à la barre d’outils et envoie le message AFX_WM_RESETTOOLBAR à la fenêtre parente de la barre d’outils. Pour plus d’informations sur le bouton **personnaliser** , consultez [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton).

##  <a name="setbuttonstyle"></a>CMFCToolBar :: SetButtonStyle

Définit le style du bouton de barre d’outils à l’index donné.

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index de base zéro du bouton de barre d’outils dont le style doit être défini.

*nStyle*<br/>
dans Style du bouton. Consultez [styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) pour obtenir la liste des styles de boutons de barre d’outils disponibles.

### <a name="remarks"></a>Notes

Cette méthode supprime le style de TBBS_PRESSED si *nStyle* est TBBS_DISABLED parce que l’utilisateur ne peut pas cliquer sur un bouton désactivé.

##  <a name="setbuttontext"></a>CMFCToolBar :: SetButtonText

Définit l’étiquette de texte d’un bouton de barre d’outils.

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Index du bouton de barre d’outils.

*lpszText*<br/>
dans Étiquette de texte du bouton de la barre d’outils. Doit être non NULL.

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode est réussie ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode retourne FALSe si l’index fourni ne fait pas référence à un bouton de barre d’outils valide.

##  <a name="setcommandusageoptions"></a>CMFCToolBar :: SetCommandUsageOptions

Spécifie si les commandes rarement utilisées n’apparaissent pas dans le menu de l’application.

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>Paramètres

*nStartCount*<br/>
dans Spécifie le nombre de fois où les commandes doivent être exécutées avant que le Framework n’affiche que les commandes de base et récemment utilisées.

*nMinUsagePercentage*<br/>
dans Pourcentage de fois où une commande doit être exécutée pour être considérée comme une commande récemment utilisée.

### <a name="return-value"></a>Valeur de retour

FALSe si *nMinUsagePercentage* est supérieur ou égal à 100 ; Sinon, TRUE.

### <a name="remarks"></a>Notes

Appelez cette méthode pour personnaliser l’algorithme que le Framework utilise pour déterminer l’apparence des éléments de menu de base et récemment utilisés. Pour plus d’informations sur les commandes de base, consultez [CMFCToolBar :: AddBasicCommand](#addbasiccommand).

Cette classe utilise la classe `CMFCCmdUsageCount` pour suivre le nombre d’utilisations des commandes. Pour plus d’informations sur cette classe, consultez [CMFCCmdUsageCount, classe](../../mfc/reference/cmfccmdusagecount-class.md).

##  <a name="setcustomizemode"></a>CMFCToolBar :: SetCustomizeMode

Active ou désactive le mode de personnalisation pour toutes les barres d’outils de l’application.

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet*<br/>
dans Valeur booléenne qui spécifie s’il faut activer ou désactiver le mode de personnalisation. Affectez la valeur TRUE à ce paramètre pour activer le mode de personnalisation ou FALSe pour le désactiver.

### <a name="return-value"></a>Valeur de retour

TRUE si l’appel à cette méthode modifie le mode de personnalisation ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode ajuste la disposition de et redessine chaque barre d’outils dans l’application. Appelez la méthode [CMFCToolBar :: IsCustomizeMode](#iscustomizemode) pour déterminer si l’application est en mode de personnalisation,

##  <a name="setgraydisabledbuttons"></a>CMFCToolBar :: SetGrayDisabledButtons

Spécifie si les boutons non disponibles de la barre d’outils sont estompés ou si des images de bouton non disponible sont utilisées.

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>Paramètres

*bGrayDisabledButtons*<br/>
dans Valeur booléenne qui spécifie comment afficher les boutons non disponibles. Si ce paramètre a la valeur TRUE, le Framework estompe les boutons. Dans le cas contraire, le Framework utilise la collection d’images de bouton non disponibles.

### <a name="remarks"></a>Notes

Par défaut, les boutons non disponibles sont estompés.

##  <a name="setheight"></a>CMFCToolBar :: SetHeight

Définit la hauteur de la barre d’outils.

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>Paramètres

*cyHeight*<br/>
dans Hauteur de la barre d’outils, en pixels.

### <a name="remarks"></a>Notes

Cette méthode redessine la barre d’outils après avoir défini la hauteur.

##  <a name="sethelpmode"></a>CMFCToolBar :: SetHelpMode

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *bon*<br/>

### <a name="remarks"></a>Notes

##  <a name="sethot"></a>CMFCToolBar :: SetHot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>Paramètres

dans *pMenuButton*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="sethotborder"></a>CMFCToolBar :: SetHotBorder

Spécifie si les boutons de barre d’outils sont suivis à chaud.

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>Paramètres

*bShowHotBorder*<br/>
dans Valeur booléenne qui spécifie si les boutons de la barre d’outils doivent être suivis à chaud. Si ce paramètre a la valeur TRUE, la barre d’outils effectue le suivi de ses boutons à chaud. Dans le cas contraire, la barre d’outils n’effectue pas de suivi des boutons à chaud.

### <a name="remarks"></a>Notes

Si un bouton est suivi à chaud, le Framework met en surbrillance le bouton lorsque la souris est positionnée sur celui-ci. Par défaut, chaque barre d’outils effectue le suivi de ses boutons.

Appelez la méthode [CMFCToolBar :: GetHotBorder](#gethotborder) pour déterminer si la barre d’outils effectue le suivi de ses boutons.

##  <a name="sethottextcolor"></a>CMFCToolBar :: SetHotTextColor

Définit la couleur du texte pour les boutons de la barre d’outils active.

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>Paramètres

*clrText*<br/>
dans Spécifie la couleur du texte pour les boutons de la barre d’outils qui sont suivis à chaud.

### <a name="remarks"></a>Notes

Pour plus d’informations sur les boutons de la barre d’outils de suivi à chaud, consultez [CMFCToolBar :: GetHotBorder](#gethotborder) et [CMFCToolBar :: SetHotBorder](#sethotborder).

##  <a name="setignoresettext"></a>CMFCToolBar :: SetIgnoreSetText

```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

dans *bValue*<br/>

### <a name="remarks"></a>Notes

##  <a name="setlargeicons"></a>CMFCToolBar :: SetLargeIcons

Spécifie si les boutons de la barre d’outils affichent de grandes icônes.

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>Paramètres

*bLargeIcons*<br/>
dans Valeur booléenne qui spécifie les icônes à utiliser. Si ce paramètre a la valeur TRUE, le Framework affiche de grandes icônes. Dans le cas contraire, l’infrastructure affiche des icônes régulières.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur modifie l’état de la case à cocher **grandes icônes** sous l’onglet **options** de la boîte de dialogue **personnaliser** . Cette méthode redimensionne toutes les barres d’outils de l’application.

Par défaut, le Framework affiche des icônes régulières.

Pour plus d’informations sur la boîte de dialogue **personnaliser** , consultez [CMFCToolBarsCustomizeDialog, classe](../../mfc/reference/cmfctoolbarscustomizedialog-class.md).

##  <a name="setlockedsizes"></a>CMFCToolBar :: SetLockedSizes

Définit la taille des boutons verrouillés et des images verrouillées dans la barre d’outils.

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>Paramètres

*sizeButton*<br/>
dans Spécifie la taille des boutons verrouillés de la barre d’outils.

*sizeImage*<br/>
dans Spécifie la taille des images de barre d’outils verrouillées.

*bDontScale*<br/>
Spécifie s’il faut mettre à l’échelle ou non les images de barre d’outils en mode haute résolution.

### <a name="remarks"></a>Notes

La taille par défaut des boutons verrouillés est 23x22 pixels. La taille par défaut des images verrouillées est de 16x15 pixels.

Appelez la méthode [CMFCToolBar :: GetLockedImageSize](#getlockedimagesize) pour récupérer la taille des images verrouillées. Appelez la méthode [CMFCToolBar :: GetButtonSize](#getbuttonsize) pour récupérer la taille des boutons verrouillés de la barre d’outils.

##  <a name="setmaskmode"></a>CMFCToolBar :: SetMaskMode

```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>Paramètres

dans *bMasked*<br/>

### <a name="remarks"></a>Notes

##  <a name="setmenusizes"></a>CMFCToolBar :: SetMenuSizes

Définit la taille des boutons de menu de la barre d’outils et leurs images.

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>Paramètres

*sizeButton*<br/>
dans Spécifie la taille des boutons de la barre d’outils, en pixels.

*sizeImage*<br/>
dans Spécifie la taille des images de barre d’outils, en pixels.

### <a name="remarks"></a>Notes

Par défaut, les boutons de menu et leurs images ont une taille non définie.

Appelez la méthode [CMFCToolBar :: GetMenuButtonSize](#getmenubuttonsize) pour déterminer la taille des boutons de menu et la méthode [CMFCToolBar :: GetMenuImageSize](#getmenuimagesize) pour déterminer la taille des images de bouton de menu.

Consultez les exemples IEDemo et MSMoneyDemo pour obtenir des exemples qui utilisent cette méthode.

##  <a name="setnonpermittedcommands"></a>CMFCToolBar :: SetNonPermittedCommands

Définit la liste des commandes qui ne peuvent pas être exécutées par l’utilisateur.

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>Paramètres

*lstCommands*<br/>
dans Référence à un objet `CList` qui contient les commandes qui ne peuvent pas être exécutées par l’utilisateur.

### <a name="remarks"></a>Notes

Appelez cette méthode pour empêcher l’utilisateur de sélectionner certaines commandes. Par exemple, vous souhaiterez peut-être empêcher l’utilisateur de sélectionner certaines commandes pour des raisons de sécurité. Consultez les exemples MDITabsDemo et MenuSubSet pour obtenir des exemples qui utilisent cette méthode.

Cette méthode efface la liste précédente des commandes non autorisées. Par défaut, la liste des commandes non autorisées est vide.

##  <a name="setonerowwithsibling"></a>CMFCToolBar :: SetOneRowWithSibling

Positionne la barre d’outils et son frère sur la même ligne.

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur clique **sur le bouton afficher les boutons sur une ligne** .

Appelez la méthode [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar) pour activer les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** . Si vous appelez [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar) pour cette barre d’outils, la barre d’outils frères est déplacée vers la ligne de cette barre d’outils. Dans le cas contraire, cette barre d’outils est déplacée vers la ligne du frère.

L’infrastructure appelle la méthode [CMFCToolBar :: SetTwoRowsWithSibling](#settworowswithsibling) lorsque l’utilisateur clique **sur le bouton afficher les boutons sur deux lignes** .

##  <a name="setorigbuttons"></a>CMFCToolBar :: SetOrigButtons

```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>Paramètres

dans *lstOrigButtons*<br/>

### <a name="remarks"></a>Notes

##  <a name="setpermament"></a>CMFCToolBar :: SetPermament

Spécifie si un utilisateur peut fermer la barre d’outils.

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>Paramètres

*bPermament*<br/>
dans Valeur booléenne qui spécifie si un utilisateur peut fermer la barre d’outils. Si ce paramètre a la valeur TRUE, l’utilisateur ne peut pas fermer la barre d’outils. Dans le cas contraire, un utilisateur peut fermer la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, un utilisateur peut fermer chaque barre d’outils.

Appelez la méthode [CMFCToolBar :: CanBeClosed](#canbeclosed) pour déterminer si un utilisateur peut fermer la barre d’outils.

##  <a name="setroutecommandsviaframe"></a>CMFCToolBar :: SetRouteCommandsViaFrame

Spécifie si le frame parent ou le propriétaire envoie des commandes à la barre d’outils.

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue*<br/>
dans Si ce paramètre a la valeur TRUE, le frame parent envoie des commandes à la barre d’outils. Dans le cas contraire, le propriétaire envoie des commandes à la barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, le frame parent envoie des commandes à la barre d’outils. Appelez la méthode [CMFCToolBar :: GetRouteCommandsViaFrame](#getroutecommandsviaframe) pour déterminer si le frame parent ou le propriétaire envoie des commandes à la barre d’outils.

##  <a name="setshowtooltips"></a>CMFCToolBar :: SetShowTooltips

Spécifie si l’infrastructure affiche des info-bulles.

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue*<br/>
dans Si ce paramètre a la valeur TRUE, le Framework affiche des info-bulles. Dans le cas contraire, l’infrastructure masque les info-bulles.

### <a name="remarks"></a>Notes

Par défaut, le Framework affiche des info-bulles.

Appelez la méthode [CMFCToolBar :: GetShowTooltips](#getshowtooltips) pour déterminer si le Framework affiche des info-bulles.

##  <a name="setsiblingtoolbar"></a>CMFCToolBar :: SetSiblingToolBar

Spécifie le frère de la barre d’outils.

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>Paramètres

*pBrotherToolbar*<br/>
dans Pointeur vers la barre d’outils frères.

### <a name="remarks"></a>Notes

Cette méthode active les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** qui s’affichent lorsque l’utilisateur affiche le menu contextuel **personnaliser** . Appelez cette méthode lorsque vous souhaitez permettre à l’utilisateur de spécifier si des barres d’outils connexes apparaissent sur la même ligne ou sur des lignes différentes.

Appelez cette méthode après avoir activé le bouton **personnaliser** qui apparaît dans la barre d’outils. Pour activer le bouton **personnaliser** , appelez la méthode [CMFCToolBar :: EnableCustomizeButton](#enablecustomizebutton) .

Pour récupérer le frère d’une barre d’outils, appelez [CMFCToolBar :: GetSiblingToolBar](#getsiblingtoolbar).

##  <a name="setsizes"></a>CMFCToolBar :: SetSizes

Spécifie la taille des boutons et des images sur toutes les barres d’outils.

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>Paramètres

*sizeButton*<br/>
dans Taille des boutons de la barre d’outils, en pixels.

*sizeImage*<br/>
dans Taille des images de bouton de barre d’outils, en pixels.

### <a name="remarks"></a>Notes

La taille par défaut des boutons de la barre d’outils est de 23x22 pixels. La taille par défaut des images de bouton de barre d’outils est de 16x15 pixels.

Appelez la méthode [CMFCToolBar :: GetImageSize](#getimagesize) pour récupérer la taille des images de bouton de barre d’outils. Appelez la méthode [CMFCToolBar :: GetButtonSize](#getbuttonsize) pour récupérer la taille des boutons de la barre d’outils.

##  <a name="settoolbarbtntext"></a>CMFCToolBar :: SetToolBarBtnText

Spécifie les propriétés d’un bouton dans la barre d’outils.

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>Paramètres

*nBtnIndex*<br/>
dans Index de base zéro du bouton de barre d’outils dans la liste des boutons de la barre d’outils.

*szText*<br/>
dans Spécifie l’étiquette de texte du bouton de la barre d’outils.

*bShowText*<br/>
dans Si ce paramètre a la valeur TRUE, l’infrastructure affiche l’étiquette de texte. Dans le cas contraire, l’infrastructure masque l’étiquette de texte.

*bShowImage*<br/>
dans Si ce paramètre a la valeur TRUE, l’infrastructure affiche l’image du bouton de barre d’outils. Dans le cas contraire, l’infrastructure masque l’image du bouton de barre d’outils.

### <a name="remarks"></a>Notes

Par défaut, l’infrastructure affiche les images des boutons de la barre d’outils, mais n’affiche pas l’étiquette de texte des boutons de la barre d’outils.

Dans les versions Debug, cette méthode génère un échec d’assertion si *nBtnIndex* ne fait pas référence à un bouton de barre d’outils valide ou si le bouton de barre d’outils est un séparateur.

##  <a name="settworowswithsibling"></a>CMFCToolBar :: SetTwoRowsWithSibling

Positionne la barre d’outils et son frère sur des lignes distinctes.

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur clique sur le bouton **afficher les boutons sur deux lignes** .

Appelez la méthode [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar) pour activer les boutons **afficher les boutons sur une ligne** ou afficher les boutons **sur deux lignes** . Si vous appelez [CMFCToolBar :: SetSiblingToolBar](#setsiblingtoolbar) pour cette barre d’outils, la barre d’outils sœur est déplacée vers une ligne distincte. Dans le cas contraire, cette barre d’outils est déplacée vers une ligne distincte.

L’infrastructure appelle la méthode [CMFCToolBar :: SetOneRowWithSibling](#setonerowwithsibling) lorsque l’utilisateur clique **sur le bouton afficher les boutons sur une ligne** .

##  <a name="setuserimages"></a>CMFCToolBar :: SetUserImages

Définit la collection d’images définies par l’utilisateur dans l’application.

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>Paramètres

*pUserImages*<br/>
dans Pointeur vers la collection d’images définies par l’utilisateur.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la méthode est réussie ; Sinon, 0 si l’objet `CMFCToolBarImages` spécifié n’est pas valide ou a une taille d’image différente de la taille d’image par défaut de la barre d’outils.

### <a name="remarks"></a>Notes

L’infrastructure utilise des images définies par l’utilisateur pour dessiner des boutons de barre d’outils qui sont personnalisés par l’utilisateur. La liste d’images spécifiée par *pUserImages* est partagée entre toutes les barres d’outils de l’application.

Cette méthode génère un échec d’assertion dans les builds de débogage si l’objet `CMFCToolBarImages` spécifié n’est pas valide ou a une taille d’image qui diffère de la taille d’image par défaut de la barre d’outils.

Les exemples OutlookDemo, ToolTipDemo et VisualStudioDemo utilisent cette méthode pour définir la collection globale d’images définies par l’utilisateur. Ils chargent le fichier nommé UserImages. bmp, qui se trouve dans le répertoire de travail de l’application.

Appelez la méthode [CMFCToolBar :: GetUserImages](#getuserimages) pour récupérer la collection d’images définies par l’utilisateur dans l’application.

##  <a name="stretchpane"></a>CMFCToolBar :: StretchPane

Étire la barre d’outils verticalement ou horizontalement, puis repositionne les boutons si nécessaire.

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>Paramètres

*nLength*<br/>
dans Quantité, en pixels, d’étirement du volet.

*bVert*<br/>
dans Si la valeur est TRUE, étire le volet verticalement. Si la valeur est FALSe, étire le volet horizontalement.

### <a name="return-value"></a>Valeur de retour

Objet `CSize` qui spécifie la taille de la zone cliente de la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode appelle [CMFCToolBar :: WrapToolBar](#wraptoolbar) pour repositionner les boutons dans la barre d’outils étirée.

La valeur de retour est déterminée par l’appel de [CMFCToolBar :: CalcSize](#calcsize).

##  <a name="translatechar"></a>CMFCToolBar :: TranslateChar

Exécute une commande de bouton si le code de clé spécifié correspond à un raccourci clavier valide.

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
dans Spécifie un code de touche virtuelle. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

### <a name="return-value"></a>Valeur de retour

FALSe si le code de clé spécifié n’est pas imprimable ou s’il ne correspond pas à un raccourci clavier valide ; TRUE si le code de clé spécifié correspond à une option de menu déroulant ; Sinon, la valeur de retour de [CMFCToolBar ::P rocesscommand](#processcommand).

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode quand une touche est enfoncée avec la touche Alt.

##  <a name="updatebutton"></a>CMFCToolBar :: UpdateButton

Met à jour l’état du bouton spécifié.

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
dans Spécifie l’index de base zéro du bouton à mettre à jour.

### <a name="remarks"></a>Notes

##  <a name="wraptoolbar"></a>CMFCToolBar :: WrapToolBar

Repositionne les boutons de la barre d’outils dans les dimensions spécifiées.

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>Paramètres

*nWidth*<br/>
dans Largeur maximale de la barre d’outils.

*nHeight*<br/>
dans Hauteur maximale de la barre d’outils. Non utilisé si la barre d’outils est flottante.

*pDC*<br/>
dans Pointeur vers un contexte de périphérique (Device Context). Si la valeur est NULL, le contexte de périphérique de la barre d’outils est utilisé.

*nColumnWidth*<br/>
dans Largeur du bouton. Si-1, la largeur actuelle est utilisée.

[in] hauteur du bouton m *nRowHeight* . Si-1, la hauteur actuelle est utilisée.

### <a name="return-value"></a>Valeur de retour

Nombre de lignes de boutons dans la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode repositionne les boutons dans la barre d’outils, en encapsulant les boutons sur des lignes supplémentaires, si nécessaire.

##  <a name="m_bdontscaleimages"></a>CMFCToolBar :: m_bDontScaleImages

Spécifie si les images de barre d’outils doivent être mises à l’échelle en mode haute résolution.

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>Notes

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar, classe](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar, classe](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar, classe](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[Procédure pas à pas : placement de contrôles dans les barres d’outils](../../mfc/walkthrough-putting-controls-on-toolbars.md)
