---
title: COleIPFrameWndEx, classe
ms.date: 11/04/2016
f1_keywords:
- COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AdjustDockingLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPaneLeftOf
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableAutoHidePanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableDocking
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnablePaneMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetActivePopup
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetContainerFrameWindow
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDefaultResId
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockingManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMainFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMenuBar
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetTearOffBars
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetToolbarButtonToolTipText
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InsertPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsMenuBarAvailable
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsPointNearDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::LoadFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseDockingPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnClosePopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCmdMsg
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuImage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuLogo
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMenuButtonToolHitTest
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMoveMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnSetPreviewMode
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowCustomizePane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnTearOffMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PaneFromPoint
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PreTranslateMessage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RecalcLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RemovePaneFromDockManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetDockState
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetupToolbarMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::ShowPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::WinHelpA
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InitUserToobars
helpviewer_keywords:
- COleIPFrameWndEx [MFC], AddDockSite
- COleIPFrameWndEx [MFC], AddPane
- COleIPFrameWndEx [MFC], AdjustDockingLayout
- COleIPFrameWndEx [MFC], DockPane
- COleIPFrameWndEx [MFC], DockPaneLeftOf
- COleIPFrameWndEx [MFC], EnableAutoHidePanes
- COleIPFrameWndEx [MFC], EnableDocking
- COleIPFrameWndEx [MFC], EnablePaneMenu
- COleIPFrameWndEx [MFC], GetActivePopup
- COleIPFrameWndEx [MFC], GetContainerFrameWindow
- COleIPFrameWndEx [MFC], GetDefaultResId
- COleIPFrameWndEx [MFC], GetDockFrame
- COleIPFrameWndEx [MFC], GetDockingManager
- COleIPFrameWndEx [MFC], GetMainFrame
- COleIPFrameWndEx [MFC], GetMenuBar
- COleIPFrameWndEx [MFC], GetPane
- COleIPFrameWndEx [MFC], GetTearOffBars
- COleIPFrameWndEx [MFC], GetToolbarButtonToolTipText
- COleIPFrameWndEx [MFC], InsertPane
- COleIPFrameWndEx [MFC], IsMenuBarAvailable
- COleIPFrameWndEx [MFC], IsPointNearDockSite
- COleIPFrameWndEx [MFC], LoadFrame
- COleIPFrameWndEx [MFC], OnCloseDockingPane
- COleIPFrameWndEx [MFC], OnCloseMiniFrame
- COleIPFrameWndEx [MFC], OnClosePopupMenu
- COleIPFrameWndEx [MFC], OnCmdMsg
- COleIPFrameWndEx [MFC], OnDrawMenuImage
- COleIPFrameWndEx [MFC], OnDrawMenuLogo
- COleIPFrameWndEx [MFC], OnMenuButtonToolHitTest
- COleIPFrameWndEx [MFC], OnMoveMiniFrame
- COleIPFrameWndEx [MFC], OnSetPreviewMode
- COleIPFrameWndEx [MFC], OnShowCustomizePane
- COleIPFrameWndEx [MFC], OnShowPanes
- COleIPFrameWndEx [MFC], OnShowPopupMenu
- COleIPFrameWndEx [MFC], OnTearOffMenu
- COleIPFrameWndEx [MFC], PaneFromPoint
- COleIPFrameWndEx [MFC], PreTranslateMessage
- COleIPFrameWndEx [MFC], RecalcLayout
- COleIPFrameWndEx [MFC], RemovePaneFromDockManager
- COleIPFrameWndEx [MFC], SetDockState
- COleIPFrameWndEx [MFC], SetupToolbarMenu
- COleIPFrameWndEx [MFC], ShowPane
- COleIPFrameWndEx [MFC], WinHelpA
- COleIPFrameWndEx [MFC], InitUserToobars
ms.assetid: ebff1560-a1eb-4854-af00-95d4a192bd55
ms.openlocfilehash: 71c0db8d059ede0016caf7ceb72c7f3ab7da2718
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78883922"
---
# <a name="coleipframewndex-class"></a>COleIPFrameWndEx, classe

La classe `COleIPFrameWndEx` implémente un conteneur OLE qui prend en charge MFC. Vous devez dériver la classe de fenêtres frames sur place pour votre application depuis la classe `COleIPFrameWndEx` , au lieu de la dériver de la classe [COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md).
Pour plus d’informations, consultez le code source situé dans le dossier **VC\\atlmfc\\src\\MFC** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class COleIPFrameWndEx : public COleIPFrameWnd
```

## <a name="members"></a>Membres

### <a name="public-methods"></a>M&#233;thodes publiques

|Name|Description|
|----------|-----------------|
|[COleIPFrameWndEx::AddDockSite](#adddocksite)||
|[COleIPFrameWndEx::AddPane](#addpane)||
|[COleIPFrameWndEx::AdjustDockingLayout](#adjustdockinglayout)||
|[COleIPFrameWndEx ::D ockPane](#dockpane)||
|[COleIPFrameWndEx ::D ockPaneLeftOf](#dockpaneleftof)|Ancre un volet à gauche d’un autre volet.|
|[COleIPFrameWndEx::EnableAutoHidePanes](#enableautohidepanes)||
|[COleIPFrameWndEx :: EnableDocking](#enabledocking)||
|[COleIPFrameWndEx::EnablePaneMenu](#enablepanemenu)||
|[COleIPFrameWndEx::GetActivePopup](#getactivepopup)|Retourne un pointeur vers le menu contextuel actuellement affiché.|
|[COleIPFrameWndEx::GetContainerFrameWindow](#getcontainerframewindow)||
|[COleIPFrameWndEx::GetDefaultResId](#getdefaultresid)|Retourne l’ID de ressource de la fenêtre frame que vous avez spécifié quand la fenêtre a été chargée.|
|[COleIPFrameWndEx::GetDockFrame](#getdockframe)||
|[COleIPFrameWndEx::GetDockingManager](#getdockingmanager)||
|[COleIPFrameWndEx::GetMainFrame](#getmainframe)||
|[COleIPFrameWndEx::GetMenuBar](#getmenubar)|Retourne un pointeur vers l’objet de barre de menu attaché à la fenêtre frame.|
|[COleIPFrameWndEx::GetPane](#getpane)||
|[COleIPFrameWndEx::GetTearOffBars](#gettearoffbars)|Retourne une liste d’objets de volet qui sont dans un état détachable.|
|[COleIPFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|Appelée par l’infrastructure avant l’affichage de l’info-bulle pour un bouton.|
|[COleIPFrameWndEx::InsertPane](#insertpane)||
|[COleIPFrameWndEx::IsMenuBarAvailable](#ismenubaravailable)|Détermine si le pointeur vers l’objet de barre de menu n’est pas `NULL`.|
|[COleIPFrameWndEx::IsPointNearDockSite](#ispointneardocksite)||
|[COleIPFrameWndEx::LoadFrame](#loadframe)|(Substitue `COleIPFrameWnd::LoadFrame`.)|
|[COleIPFrameWndEx::OnCloseDockingPane](#onclosedockingpane)||
|[COleIPFrameWndEx::OnCloseMiniFrame](#oncloseminiframe)||
|[COleIPFrameWndEx::OnClosePopupMenu](#onclosepopupmenu)|Appelée par l’infrastructure quand un menu contextuel actif traite un message WM_DESTROY.|
|[COleIPFrameWndEx :: OnCmdMsg](#oncmdmsg)|(Substitue `CFrameWnd::OnCmdMsg`.)|
|[COleIPFrameWndEx::OnDrawMenuImage](#ondrawmenuimage)|Appelée par l’infrastructure quand l’image associée à un élément de menu est dessinée.|
|[COleIPFrameWndEx::OnDrawMenuLogo](#ondrawmenulogo)|Appelée par l’infrastructure quand un objet [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)traite un message WM_PAINT.|
|[COleIPFrameWndEx::OnMenuButtonToolHitTest](#onmenubuttontoolhittest)|Appelée par l’infrastructure quand un objet [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)traite un message WM_NCHITTEST.|
|[COleIPFrameWndEx::OnMoveMiniFrame](#onmoveminiframe)||
|[COleIPFrameWndEx::OnSetPreviewMode](#onsetpreviewmode)|Appelez cette fonction membre pour définir la fenêtre frame principale de l’application dans et en dehors du mode Aperçu avant impression. (Substitue [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode).)|
|[COleIPFrameWndEx::OnShowCustomizePane](#onshowcustomizepane)||
|[COleIPFrameWndEx::OnShowPanes](#onshowpanes)||
|[COleIPFrameWndEx::OnShowPopupMenu](#onshowpopupmenu)|Appelée par l’infrastructure quand un menu contextuel est activé.|
|[COleIPFrameWndEx::OnTearOffMenu](#ontearoffmenu)|Appelée par l’infrastructure quand un menu avec une barre détachable est activé.|
|[COleIPFrameWndEx ::P aneFromPoint](#panefrompoint)||
|[COleIPFrameWndEx ::P reTranslateMessage](#pretranslatemessage)|(Substitue `COleIPFrameWnd::PreTranslateMessage`.)|
|[COleIPFrameWndEx :: RecalcLayout](#recalclayout)|(Substitue `COleIPFrameWnd::RecalcLayout`.)|
|[COleIPFrameWndEx::RemovePaneFromDockManager](#removepanefromdockmanager)||
|[COleIPFrameWndEx::SetDockState](#setdockstate)|Applique l’état d’ancrage spécifié aux volets qui appartiennent à la fenêtre frame.|
|[COleIPFrameWndEx::SetupToolbarMenu](#setuptoolbarmenu)|Modifie un objet de barre d’outils en recherchant des objets factices et en les remplaçant par les éléments définis par l’utilisateur spécifiés.|
|[COleIPFrameWndEx :: ShowPane](#showpane)||
|[COleIPFrameWndEx::WinHelpA](#winhelpa)|Appelée par l’infrastructure pour lancer l’application WinHelp ou l’aide contextuelle.|

### <a name="protected-methods"></a>Méthodes protégées

|Name|Description|
|----------|-----------------|
|[COleIPFrameWndEx::InitUserToobars](#initusertoobars)|Indique à l’infrastructure d’initialiser une plage d’ID de contrôle qui sont affectés aux barres d’outils définies par l’utilisateur.|

## <a name="example"></a>Exemple

L’exemple suivant montre comment créer une sous-classe d’une instance de la classe `COleIPFrameWndEx` et surcharger ses méthodes. L’exemple montre comment surcharger la méthode `OnDestory` , la méthode `RepositionFrame` , la méthode `RecalcLayout` et la méthode `CalcWindowRect` . Cet extrait de code fait partie de l’ [exemple Word Pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#1](../../mfc/reference/codesnippet/cpp/coleipframewndex-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)

[COleIPFrameWndEx](../../mfc/reference/coleipframewndex-class.md)

## <a name="requirements"></a>Spécifications

**En-tête :** afxoleipframewndex.h

##  <a name="adddocksite"></a>COleIPFrameWndEx::AddDockSite

```
void AddDockSite();
```

### <a name="remarks"></a>Notes

##  <a name="addpane"></a>COleIPFrameWndEx::AddPane

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *pControlBar*<br/>
dans *bTail*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="adjustdockinglayout"></a>COleIPFrameWndEx::AdjustDockingLayout

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### <a name="parameters"></a>Paramètres

dans *hdwp*<br/>

### <a name="remarks"></a>Notes

##  <a name="dockpane"></a>COleIPFrameWndEx ::D ockPane

```
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### <a name="parameters"></a>Paramètres

dans *pBar*<br/>
dans *nDockBarID*<br/>
dans *lpRect*<br/>

### <a name="remarks"></a>Notes

##  <a name="dockpaneleftof"></a>COleIPFrameWndEx ::D ockPaneLeftOf

Ancre un volet à gauche d’un autre volet.

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>Paramètres

*pBar*<br/>
dans Pointeur vers le volet à ancrer.

*pLeftOf*<br/>
dans Pointeur vers le volet qui sert d’origine.

### <a name="return-value"></a>Valeur de retour

Retourne la valeur TRUE si l’opération réussit. Sinon, retourne la valeur FALSE.

### <a name="remarks"></a>Notes

Appelez cette méthode pour ancrer plusieurs objets Pane dans un ordre prédéfini. Cette méthode ancre le volet spécifié par *pBar* à gauche du volet spécifié par *pLeftOf*.

##  <a name="enableautohidepanes"></a>COleIPFrameWndEx::EnableAutoHidePanes

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>Paramètres

dans *dwDockStyle*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="enabledocking"></a>COleIPFrameWndEx :: EnableDocking

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>Paramètres

dans *dwDockStyle*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="enablepanemenu"></a>COleIPFrameWndEx::EnablePaneMenu

```
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly = FALSE,
    BOOL bViewMenuShowsToolbarsOnly = FALSE);
```

### <a name="parameters"></a>Paramètres

dans *bEnable*<br/>
dans *uiCustomizeCmd*<br/>
dans *strCustomizeLabel*<br/>
dans *uiViewToolbarsMenuEntryID*<br/>
dans *bContextMenuShowsToolbarsOnly*<br/>
dans *bViewMenuShowsToolbarsOnly*<br/>

### <a name="remarks"></a>Notes

##  <a name="getactivepopup"></a>COleIPFrameWndEx::GetActivePopup

Retourne un pointeur vers le menu contextuel actuellement affiché.

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers le menu contextuel actif ; Sinon, NULL.

### <a name="remarks"></a>Notes

Utilisez cette méthode pour obtenir un pointeur vers l’objet de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) qui est actuellement affiché.

##  <a name="getcontainerframewindow"></a>COleIPFrameWndEx::GetContainerFrameWindow

```
COleCntrFrameWndEx* GetContainerFrameWindow();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getdefaultresid"></a>COleIPFrameWndEx::GetDefaultResId

Retourne l’ID de ressource de menu qui a été spécifié quand la fenêtre frame a chargé le menu.

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>Valeur de retour

Retourne l’ID de ressource du menu, ou 0 si la fenêtre frame n’a pas de barre de menus.

### <a name="remarks"></a>Notes

Appelez cette fonction pour récupérer l’ID de ressource qui a été spécifié lorsque la fenêtre frame a chargé la ressource de menu en appelant `COleIPFrameWndEx::LoadFrame`.

##  <a name="getdockframe"></a>COleIPFrameWndEx::GetDockFrame

```
CFrameWnd* GetDockFrame();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getdockingmanager"></a>COleIPFrameWndEx::GetDockingManager

```
CDockingManager* GetDockingManager();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getmainframe"></a>COleIPFrameWndEx::GetMainFrame

```
CFrameWnd* GetMainFrame();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getmenubar"></a>COleIPFrameWndEx::GetMenuBar

Retourne un pointeur vers l’objet de barre de menu attaché à la fenêtre frame.

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet de barre de menus.

### <a name="remarks"></a>Notes

Utilisez cette fonction pour récupérer un pointeur vers l’objet de barre de menus qui appartient à l’objet `COleIPFrameWndEx`.

##  <a name="getpane"></a>COleIPFrameWndEx::GetPane

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>Paramètres

dans *nid*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="gettearoffbars"></a>COleIPFrameWndEx::GetTearOffBars

Retourne une liste d’objets de volet qui sont dans un état détachable.

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>Valeur de retour

Référence à un objet `CObList` qui contient une collection de pointeurs vers les objets dérivés de la [classe CBasePane](../../mfc/reference/cbasepane-class.md).

### <a name="remarks"></a>Notes

L’objet `COleIPFrameWndEx` gère la collection de menus détachés comme une liste d’objets dérivés de la [classe CBasePane](../../mfc/reference/cbasepane-class.md). Utilisez cette méthode pour récupérer une référence à cette liste.

##  <a name="gettoolbarbuttontooltiptext"></a>COleIPFrameWndEx::GetToolbarButtonToolTipText

Appelée par l’infrastructure avant l’affichage de l’info-bulle pour un bouton.

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers le bouton.

*strTTText*<br/>
dans Pointeur vers le texte d’info-bulle.

### <a name="return-value"></a>Valeur de retour

L’implémentation par défaut retourne 0.

### <a name="remarks"></a>Notes

Substituez cette fonction pour personnaliser l’affichage des info-bulles sur les boutons de la barre d’outils.

##  <a name="initusertoobars"></a>COleIPFrameWndEx::InitUserToobars

Spécifie une plage d’ID de contrôle que l’infrastructure assigne aux barres d’outils définies par l’utilisateur.

```
void InitUserToolbars(
    LPCTSTR lpszRegEntry,
    UINT uiUserToolbarFirst,
    UINT uiUserToolbarLast)
```

### <a name="parameters"></a>Paramètres

*lpszRegEntry*<br/>
dans Entrée de registre où la bibliothèque stocke les paramètres de barre d’outils utilisateur.

*uiUserToolbarFirst*<br/>
dans ID de contrôle affecté à la première barre d’outils définie par l’utilisateur.

*uiUserToolbarLast*<br/>
dans ID de contrôle affecté à la dernière barre d’outils définie par l’utilisateur.

### <a name="remarks"></a>Notes

Utilisez cette fonction pour initialiser une plage d’ID de contrôle pour l’assignation aux barres d’outils que les utilisateurs définissent dynamiquement. Les paramètres *uiUserToolbarFirst* et *uiUserToolbarLast* définissent une plage d’ID de contrôle de barre d’outils autorisés. Pour désactiver la création de barres d’outils définies par l’utilisateur, affectez la valeur-1 à *uiUserToolbarFirst* ou *uiUserToolbarLast* .

##  <a name="insertpane"></a>COleIPFrameWndEx::InsertPane

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *pControlBar*<br/>
dans *pTarget*<br/>
dans *bAfter*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="ismenubaravailable"></a>COleIPFrameWndEx::IsMenuBarAvailable

Détermine si le pointeur vers l’objet de barre de menus n’a pas la valeur NULL

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>Valeur de retour

Retourne une valeur différente de zéro si la fenêtre frame a une barre de menus ; Sinon, retourne 0.

### <a name="remarks"></a>Notes

Appelez cette méthode pour déterminer si la fenêtre frame conserve un pointeur non NULL vers son objet de barre de menus.

##  <a name="ispointneardocksite"></a>COleIPFrameWndEx::IsPointNearDockSite

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>Paramètres

dans *point*<br/>
dans *dwBarAlignment*<br/>
dans *bOuterEdge*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="loadframe"></a>COleIPFrameWndEx::LoadFrame

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>Paramètres

dans *nIDResource*<br/>
dans *dwDefaultStyle*<br/>
dans *pParentWnd*<br/>
dans *pContext*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onclosedockingpane"></a>COleIPFrameWndEx::OnCloseDockingPane

```
virtual BOOL OnCloseDockingPane(CDockablePane*);
```

### <a name="parameters"></a>Paramètres

dans *CDockablePane&#42;*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="oncloseminiframe"></a>COleIPFrameWndEx::OnCloseMiniFrame

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>Paramètres

dans *CPaneFrameWnd&#42;*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onclosepopupmenu"></a>COleIPFrameWndEx::OnClosePopupMenu

Appelée par l’infrastructure quand un menu contextuel actif traite un message WM_DESTROY.

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>Paramètres

*pMenuPopup*<br/>
dans Pointeur vers l’objet de menu contextuel.

### <a name="remarks"></a>Notes

Substituez cette méthode pour recevoir des notifications des objets `CMFCPopupMenu` lorsqu’ils traitent les messages WM_DESTROY.

##  <a name="oncmdmsg"></a>COleIPFrameWndEx :: OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>Paramètres

dans *nid*<br/>
dans *nCode*<br/>
dans *pExtra*<br/>
dans *pHandlerInfo*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="ondrawmenuimage"></a>COleIPFrameWndEx::OnDrawMenuImage

Appelé par l’infrastructure quand l’image associée à un élément de menu est dessinée.

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers le contexte de périphérique (Device Context).

*pMenuButton*<br/>
dans Pointeur vers le bouton de menu.

*rectImage*<br/>
dans Image associée à l’élément de menu.

### <a name="return-value"></a>Valeur de retour

L’implémentation par défaut ne fait rien et retourne 0.

### <a name="remarks"></a>Notes

Substituez cette méthode si vous souhaitez personnaliser le dessin d’images pour les éléments de menu qui appartiennent à la barre de menus appartenant à l’objet dérivé de `COleIPFrameWndEx`.

##  <a name="ondrawmenulogo"></a>COleIPFrameWndEx::OnDrawMenuLogo

Appelée par l’infrastructure quand un objet [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)traite un message WM_PAINT.

```
virtual void OnDrawMenuLogo(
    CDC* pDC,
    CMFCPopupMenu* pMenu,
    const CRect& rectLogo);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Pointeur vers le contexte de périphérique (Device Context).

*pMenu*<br/>
dans Pointeur vers l’objet de menu contextuel.

*rectLogo*<br/>
dans Pointeur vers le logo à afficher.

### <a name="remarks"></a>Notes

Substituez cette méthode pour afficher un logo dans le menu contextuel associé à la barre de menus détenue par l’objet dérivé de `COleIPFrameWndEx`. L'implémentation par défaut n'exécute aucune opération.

##  <a name="onmenubuttontoolhittest"></a>COleIPFrameWndEx::OnMenuButtonToolHitTest

Appelée par l’infrastructure quand un objet [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)traite un message de WM_NCHITTEST.

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Paramètres

[in] pointeur pButton vers un bouton de menu.

[out] pointeur pTI vers une structure `TOOLINFO`.

### <a name="return-value"></a>Valeur de retour

L’implémentation par défaut ne fait rien et retourne 0. Votre implémentation de doit retourner une valeur différente de zéro si elle remplit le paramètre *pTI* .

### <a name="remarks"></a>Notes

Substituez cette méthode pour fournir des informations d’info-bulle sur un élément de menu spécifique.

##  <a name="onmoveminiframe"></a>COleIPFrameWndEx::OnMoveMiniFrame

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>Paramètres

dans *pFrame*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onsetpreviewmode"></a>COleIPFrameWndEx::OnSetPreviewMode

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>Paramètres

dans *bPreview*<br/>
dans *pState*<br/>

### <a name="remarks"></a>Notes

##  <a name="onshowcustomizepane"></a>COleIPFrameWndEx::OnShowCustomizePane

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>Paramètres

dans *pMenuPane*<br/>
dans *uiToolbarID*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onshowpanes"></a>COleIPFrameWndEx::OnShowPanes

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>Paramètres

dans *bShow*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onshowpopupmenu"></a>COleIPFrameWndEx::OnShowPopupMenu

Appelé par le Framework lorsqu’un menu contextuel s’affiche.

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>Paramètres

*pMenuPopup*<br/>
dans Pointeur vers le menu contextuel à afficher.

### <a name="return-value"></a>Valeur de retour

L’implémentation par défaut ne fait rien et retourne une valeur différente de zéro. Votre implémentation de doit retourner FALSe si le menu contextuel ne peut pas être affiché.

### <a name="remarks"></a>Notes

Substituez cette méthode pour personnaliser l’affichage d’un menu contextuel. Par exemple, vous pouvez modifier les boutons de menu pour colorier les boutons de menu ou initialiser les barres détachées.

##  <a name="ontearoffmenu"></a>COleIPFrameWndEx::OnTearOffMenu

Appelé par le Framework lorsque l’utilisateur sélectionne un menu qui a une barre détachable.

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>Paramètres

*pMenuPopup*<br/>
dans Pointeur vers le menu contextuel que l’utilisateur A sélectionné.

*pBar*<br/>
dans Pointeur vers le volet qui héberge le menu.

### <a name="return-value"></a>Valeur de retour

TRUE si vous souhaitez que le Framework active le menu contextuel ; Sinon, FALSe. La valeur par défaut est TRUE.

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez personnaliser la configuration de la barre détachée.

##  <a name="panefrompoint"></a>COleIPFrameWndEx ::P aneFromPoint

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>Paramètres

dans *point*<br/>
dans *nSensitivity*<br/>
dans *bExactBar*<br/>
dans *pRTCBarType*<br/>
dans *dwAlignment*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="pretranslatemessage"></a>COleIPFrameWndEx ::P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Paramètres

dans *PMSG*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="recalclayout"></a>COleIPFrameWndEx :: RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *bNotify*<br/>

### <a name="remarks"></a>Notes

##  <a name="removepanefromdockmanager"></a>COleIPFrameWndEx::RemovePaneFromDockManager

```
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>Paramètres

dans *pControlBar*<br/>
dans *bDestroy*<br/>
dans *bAdjustLayout*<br/>
dans *bAutoHide*<br/>
dans *pBarReplacement*<br/>

### <a name="remarks"></a>Notes

##  <a name="setdockstate"></a>COleIPFrameWndEx::SetDockState

Applique l’état d’ancrage spécifié aux volets qui appartiennent à la fenêtre frame.

```
void SetDockState(const CDockState& state);
```

### <a name="parameters"></a>Paramètres

*state*<br/>
dans Spécifie l’état d’ancrage.

### <a name="remarks"></a>Notes

Utilisez cette fonction pour spécifier un nouvel état d’ancrage pour les volets qui appartiennent à l’objet `COleIPFrameWndEx`.

##  <a name="setuptoolbarmenu"></a>COleIPFrameWndEx::SetupToolbarMenu

Modifie un objet de barre d’outils en recherchant des objets factices et en les remplaçant par les éléments définis par l’utilisateur spécifiés.

```
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>Paramètres

*menus*<br/>
dans Référence à un objet [CMenu](../../mfc/reference/cmenu-class.md) à modifier.

*uiViewUserToolbarCmdFirst*<br/>
dans Spécifie la première commande définie par l’utilisateur.

*uiViewUserToolbarCmdLast*<br/>
dans Spécifie la dernière commande définie par l’utilisateur.

### <a name="remarks"></a>Notes

##  <a name="showpane"></a>COleIPFrameWndEx :: ShowPane

```
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>Paramètres

dans *pBar*<br/>
dans *bShow*<br/>
dans *bDelay*<br/>
dans *bActivate*<br/>

### <a name="remarks"></a>Notes

##  <a name="winhelpa"></a>COleIPFrameWndEx::WinHelpA

Appelée par l’infrastructure pour lancer l’application WinHelp ou l’aide contextuelle.

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>Paramètres

[in] dwData spécifie les données requises pour le type d’aide spécifié par *nCmd*.

*nCmd*<br/>
dans Spécifie le type d’aide demandé. Pour obtenir la liste des valeurs possibles et savoir comment elles affectent le paramètre *dwData* , consultez la [fonction WinHelp](/windows/win32/api/winuser/nf-winuser-winhelpw) dans le SDK Windows.

### <a name="remarks"></a>Notes

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CFrameWndEx, classe](../../mfc/reference/cframewndex-class.md)<br/>
[CMDIFrameWndEx, classe](../../mfc/reference/cmdiframewndex-class.md)
