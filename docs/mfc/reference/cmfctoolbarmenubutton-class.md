---
title: Cmfctoolbarmenubutton, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: ed786f3449f172f1aa4255a4ca677a400b767e83
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/31/2018
ms.locfileid: "50429365"
---
# <a name="cmfctoolbarmenubutton-class"></a>Cmfctoolbarmenubutton, classe

Bouton de barre d'outils qui contient un menu contextuel.
Pour plus d’informations, consultez le code source situé dans le **VC\\atlmfc\\src\\mfc** dossier de votre installation de Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|Construit un objet `CMFCToolBarMenuButton`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|Compare cette instance avec le paramètre `CMFCToolBarButton` objet. (Substitue [CMFCToolBarButton::CompareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).)|
|[CMFCToolBarMenuButton::CopyFrom](#copyfrom)|Copie les propriétés d’un autre bouton de barre d’outils pour le bouton en cours. (Substitue [CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom).)|
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|Initialise le menu de barre d’outils à partir d’un handle de menu Windows.|
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|Crée un menu Windows qui se compose des commandes dans le menu de barre d’outils. Retourne un handle vers le menu Windows.|
|[CMFCToolBarMenuButton::CreatePopupMenu](#createpopupmenu)|Crée un objet de menu contextuel ( [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md)) pour afficher le menu de barre d’outils.|
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton::GetCommands](#getcommands)|Permet d’accéder en lecture seule à la liste des commandes dans le menu de barre d’outils.|
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|Récupère le rectangle englobant pour l’image du bouton.|
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|Retourne le nombre de lignes dans le menu contextuel quand le menu est en mode de palette.|
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|Retourne un pointeur vers l’objet de menu contextuel qui est associée au bouton.|
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|Détermine si une bordure du bouton est affichée lorsqu’un utilisateur sélectionne le bouton. (Substitue [CMFCToolBarButton::HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|
|[CMFCToolBarMenuButton::IsBorder](#isborder)||
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|Détermine si le menu contextuel s’affiche.|
|[CMFCToolBarMenuButton::IsEmptyMenuAllowed](#isemptymenuallowed)|Appelé par l’infrastructure pour déterminer si un utilisateur peut ouvrir un sous-menu à partir de l’élément de menu sélectionné.|
|[CMFCToolBarMenuButton::IsExclusive](#isexclusive)|Détermine si le bouton est en mode exclusif, autrement dit, si le menu contextuel reste ouvert même lorsque l’utilisateur déplace le pointeur sur une autre barre d’outils ou un bouton.|
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|Détermine si le menu contextuel est en mode de palette.|
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|Détermine si le menu contextuel a une barre détachable.|
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|Spécifie si le bouton peut être déplacé. (Substitue [CMFCToolBarButton::OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag).)|
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique spécifié et l’état d’ancrage. (Substitue [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).)|
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|Appelé par l’infrastructure pour gérer la [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) message. (Substitue [CMFCToolBarButton::OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).)|
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|Appelé par le framework lorsque le bouton est inséré dans une nouvelle barre d’outils. (Substitue [CMFCToolBarButton::OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd).)|
|[CMFCToolBarMenuButton::OnClick](#onclick)|Appelé par le framework lorsque l’utilisateur clique sur le bouton de la souris. (Substitue [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|Appelé par le framework lorsque l’utilisateur sélectionne un élément dans le menu contextuel.|
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|Appelé par l’infrastructure lors de la barre d’outils parent gère un message WM_HELPHITTEST. (Substitue [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).)|
|[CMFCToolBarMenuButton::OnDraw](#ondraw)|Appelé par l’infrastructure pour dessiner le bouton en utilisant les options et les styles spécifiés. (Substitue [CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Appelé par l’infrastructure pour dessiner le bouton dans le **commandes** volet de la **personnaliser** boîte de dialogue. (Substitue [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).)|
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|Appelé par le framework lorsque l’utilisateur ouvre le menu contextuel.|
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|Définit la valeur par défaut de l’image qui est associée au bouton. (Substitue [CMFCToolBarButton::ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).)|
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|Enregistre l’état du bouton de barre d’outils. (Substitue [CMFCToolBarButton::SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|
|[CMFCToolBarMenuButton::Serialize](#serialize)|Lit de cet objet à partir d’une archive ou écrit dans une archive. (Substitue [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|Remplit le fourni `CAccessibilityData` objet avec les données d’accessibilité à partir du bouton de barre d’outils. (Substitue [CMFCToolBarButton::SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|Spécifie si le bouton peut être ajouté à une barre d’outils.|
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|Spécifie si le menu contextuel est en mode de palette.|
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton::SetRadio](#setradio)|Force le bouton de menu de barre d’outils pour afficher une icône indiquant qu’elle est sélectionnée.|
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|Spécifie un détachable barre ID pour le menu contextuel.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|Dessine une icône sur le bouton de menu.|

### <a name="data-members"></a>Membres de données

|Name|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|Si la valeur est TRUE, le framework appelle toujours [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) qu’un bouton est dessiné.|

## <a name="remarks"></a>Notes

Un `CMFCToolBarMenuButton` peut apparaître comme un menu, un élément de menu qui a un sous-menu, un bouton qui exécute une commande ou affiche un menu ou un bouton qui affiche uniquement un menu. Vous déterminer le comportement et l’apparence du bouton de menu en spécifiant des paramètres tels que le handle de menu image, texte et l’ID est associé avec le bouton dans le constructeur `CMFCToolbarMenuButton::CMFCToolbarMenuButton`.

Une classe personnalisée dérivée de la `CMFCToolbarMenuButton` classe doit utiliser le [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial) macro. Le [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate) macro génère une erreur lors de l’application se ferme.

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un `CMFCToolBarMenuButton` objet. Le code illustre comment spécifier que le menu déroulant est en mode de palette et spécifiez l’ID de la barre détachable est créée lorsque l’utilisateur fait glisser le bouton de menu sur une barre de menus. Cet extrait de code fait partie de l’ [exemple Word Pad](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>Configuration requise

**En-tête :** afxtoolbarmenubutton.h

##  <a name="cmfctoolbarmenubutton"></a>  CMFCToolBarMenuButton::CMFCToolBarMenuButton

Construit un objet `CMFCToolBarMenuButton`.

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>Paramètres

*src*<br/>
[in] Un existant `CMFCToolBarMenuButton` objet doit être copié dans ce `CMFCToolBarMenuButton` objet.

*uiID*<br/>
[in] L’ID de la commande à exécuter quand un utilisateur clique sur le bouton ; ou (UINT) -1 pour un bouton de menu qui n’exécute pas directement une commande.

*hMenu*<br/>
[in] Un handle à un menu ; ou NULL si le bouton n’a pas d’un menu.

*iImage*<br/>
[in] Index de l’image pour le bouton ; ou -1 si ce bouton n’a pas d’une icône ou qu’il utilise l’icône de la commande spécifiée par *uiID*. L’index est la même pour chacun `CMFCToolBarImages` objet dans votre application.

*lpszText*<br/>
[in] Le texte du bouton de menu de barre d’outils.

*bUserButton*<br/>
[in] TRUE si le bouton affiche une image défini par l’utilisateur ; FALSE si le bouton affiche une image prédéfinie associée à la commande spécifiée par *uiID*.

### <a name="remarks"></a>Notes

Si *uiID* n’est valide ID de commande, le bouton exécute cette commande lorsque l’utilisateur clique dessus. Si *hMenu* est un handle de menu valide, le bouton fournit un menu déroulant lorsqu’il apparaît dans une barre d’outils ou un sous-menu lorsqu’il apparaît dans un menu. Si les deux *uiID* et *hMenu* sont valides, le bouton est un bouton partagé avec une partie qui effectuera la commande lorsque l’utilisateur clique dessus et une partie avec une flèche vers le bas qui sera déroulant un menu lorsque l’utilisateur clique dessus. Toutefois, si *hMenu* est valide, un utilisateur ne sera pas en mesure de cliquer sur le bouton pour exécuter une commande lorsque le bouton est inséré dans un menu.

### <a name="example"></a>Exemple

L’exemple suivant montre comment construire un objet de la `CMFCToolBarMenuButton` classe. Cet extrait de code fait partie de l’ [exemple Word Pad](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

##  <a name="comparewith"></a>  CMFCToolBarMenuButton::CompareWith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Paramètres

[in] *autres*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="copyfrom"></a>  CMFCToolBarMenuButton::CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Paramètres

[in] *src*<br/>

### <a name="remarks"></a>Notes

##  <a name="createfrommenu"></a>  CMFCToolBarMenuButton::CreateFromMenu

Initialise le menu de barre d’outils à partir d’un handle de menu Windows.

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>Paramètres

*hMenu*<br/>
[in] Un handle à un menu.

### <a name="remarks"></a>Notes

Un bouton de menu de barre d’outils peut afficher un sous-menu de la liste déroulante.

L’infrastructure appelle cette méthode pour initialiser les commandes dans le sous-menu dans un menu.

##  <a name="createmenu"></a>  CMFCToolBarMenuButton::CreateMenu

Crée un menu qui se compose des commandes dans le menu de barre d’outils. Retourne un handle vers le menu.

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>Valeur de retour

Un handle vers le menu si réussite. NULL si la liste de commandes associé au bouton de menu de barre d’outils est vide.

### <a name="remarks"></a>Notes

Vous pouvez substituer cette méthode dans une classe dérivée pour personnaliser la façon dont le menu est généré.

##  <a name="createpopupmenu"></a>  CMFCToolBarMenuButton::CreatePopupMenu

Crée un `CMFCPopupMenu` objet pour afficher le menu de barre d’outils.

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un `CMFCPopupMenu` objet qui affiche le menu déroulant associé au bouton de menu de barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode est appelée par l’infrastructure pour préparer l’affichage du menu déroulant associé au bouton.

L’implémentation par défaut simplement construit et retourne un nouvel `CMFCPopupMenu` objet. Substituez cette méthode si vous souhaitez utiliser un type dérivé de [cmfcpopupmenu, classe](cmfcpopupmenu-class.md) ou pour effectuer une initialisation supplémentaire.

##  <a name="drawdocumenticon"></a>  CMFCToolBarMenuButton::DrawDocumentIcon

Dessine une icône de document sur le bouton de menu.

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Pointeur vers le contexte de périphérique.

*rectImage*<br/>
[in] Coordonnées de l’image du rectangle englobant.

*hIcon*<br/>
[in] Handle vers l’icône.

### <a name="remarks"></a>Notes

Cette méthode prend une icône de document et il dessine sur le bouton de menu, centré dans la zone spécifiée par *rectImage*.

##  <a name="enablequickcustomize"></a>  CMFCToolBarMenuButton::EnableQuickCustomize

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>Notes

##  <a name="hasbutton"></a>  CMFCToolBarMenuButton::HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="havehotborder"></a>  CMFCToolBarMenuButton::HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isborder"></a>  CMFCToolBarMenuButton::IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isclickedonmenu"></a>  CMFCToolBarMenuButton::IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isquickmode"></a>  CMFCToolBarMenuButton::IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getcommands"></a>  CMFCToolBarMenuButton::GetCommands

Permet d’accéder en lecture seule à la liste des commandes dans le menu de barre d’outils.

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>Valeur de retour

Une référence const à un [CObList, classe](../../mfc/reference/coblist-class.md) objet qui constituée une collection de [cmfctoolbarbutton, classe](../../mfc/reference/cmfctoolbarbutton-class.md) objets.

### <a name="remarks"></a>Notes

Un bouton de menu de barre d’outils peut afficher un sous-menu. Vous pouvez fournir la liste des commandes dans le sous-menu dans le constructeur ou en [CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu) en tant que handle à un menu (HMENU). Le menu est converti en une liste d’objets dérivés de [cmfctoolbarbutton, classe](../../mfc/reference/cmfctoolbarbutton-class.md) et stockées dans le texte interne `CObList` objet. Vous pouvez accéder à cette liste en appelant cette méthode.

##  <a name="getimagerect"></a>  CMFCToolBarMenuButton::GetImageRect

Récupère le rectangle englobant pour l’image du bouton.

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>Paramètres

*rectImage*<br/>
[out] Une référence à un `CRect` objet qui reçoit les coordonnées de l’image de rectangle englobant.

##  <a name="getpaletterows"></a>  CMFCToolBarMenuButton::GetPaletteRows

Retourne le nombre de lignes dans le menu déroulant lorsque le menu est en mode de palette.

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre de lignes dans la palette.

### <a name="remarks"></a>Notes

Lorsque le bouton de menu est défini en mode de palette, les éléments de menu seront affiche dans plusieurs colonnes avec uniquement un nombre limité de lignes. Appelez cette méthode pour obtenir le nombre de lignes. Vous pouvez activer ou désactiver le mode de palette et spécifiez le nombre de lignes à l’aide [CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode).

##  <a name="getpopupmenu"></a>  CMFCToolBarMenuButton::GetPopupMenu

Retourne un pointeur vers le [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md) objet qui représente le menu déroulant du bouton.

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md) objet qui a été créé lors de l’infrastructure dessiné le sous-menu du bouton de menu de barre d’outils ; NULL si aucun sous-menu n’est affichée.

### <a name="remarks"></a>Notes

Lorsqu’un bouton de menu de barre d’outils affiche un menu déroulant, le bouton crée un [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md) objet pour représenter le menu. Appelez cette méthode pour obtenir un pointeur vers le `CMFCPopupMenu` objet. Vous ne devez pas stocker le pointeur retourné, car elle est temporaire et devient non valide lorsque l’utilisateur ferme le menu déroulant.

##  <a name="isdroppeddown"></a>  CMFCToolBarMenuButton::IsDroppedDown

Indique si le menu contextuel est actuellement affiché.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton de menu de barre d’outils affiche son sous-menu ; Sinon, FALSE.

##  <a name="isemptymenuallowed"></a>  CMFCToolBarMenuButton::IsEmptyMenuAllowed

Spécifie si les éléments de menu affiche les sous-menus vides.

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le framework ouvre un sous-menu à partir de l’élément de menu actuellement sélectionné, même lorsque le sous-menu est vide. Sinon, FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’un utilisateur tente d’ouvrir le sous-menu à partir de l’élément de menu actuellement sélectionné. Si le sous-menu est vide et `IsEmptyMenuAllowed` retourne FALSE, le sous-menu s’ouvre pas.

L’implémentation par défaut retourne FALSE. Substituez cette méthode pour personnaliser ce comportement.

##  <a name="isexclusive"></a>  CMFCToolBarMenuButton::IsExclusive

Indique si le bouton est en mode exclusif.

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton fonctionne en mode exclusif ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Lorsqu’un utilisateur ouvre un menu contextuel pour un bouton, puis déplace le pointeur de la souris sur un autre bouton de barre d’outils ou un menu, le menu contextuel se ferme, sauf si le bouton est en mode exclusif.

L’implémentation par défaut toujours retourne FALSE. Substituez cette méthode dans une classe dérivée si vous souhaitez activer le mode exclusif.

##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode

Détermine si le menu déroulant est en mode de palette.

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le mode de palette est activé, sinon FALSE.

### <a name="remarks"></a>Notes

Lorsque le bouton de menu est défini en mode de palette, éléments de menu apparaissent dans plusieurs colonnes avec uniquement un nombre limité de lignes. Appelez cette méthode pour obtenir le nombre de lignes. Vous pouvez activer ou désactiver le mode de palette en appelant [CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode).

##  <a name="istearoffmenu"></a>  CMFCToolBarMenuButton::IsTearOffMenu

Indique si le menu déroulant a une barre détachable.

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton de menu de barre d’outils a une barre détachable. Sinon, FALSE.

### <a name="remarks"></a>Notes

Pour activer la fonctionnalité détachable et définir le détachable barre ID, appelez [CMFCToolBarMenuButton::SetTearOff](#settearoff).

##  <a name="m_balwayscallownerdraw"></a>  CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw

Spécifie si le framework appelle toujours [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) qu’un bouton est dessiné.

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>Notes

Lorsque cette variable de membre est définie sur TRUE, le bouton appelle toujours [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) méthode pour afficher l’image sur le bouton. Lorsque `m_bAlwaysCallOwnerDraw` est FALSE, le bouton lui-même Dessine l’image si l’image est prédéfinie. Sinon, elle appelle `OnDrawMenuImage`.

##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>Notes

##  <a name="onbeforedrag"></a>  CMFCToolBarMenuButton::OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="oncalculatesize"></a>  CMFCToolBarMenuButton::OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>
[in] *sizeDefault*<br/>
[in] *bHorz*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="oncancelmode"></a>  CMFCToolBarMenuButton::OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Notes

##  <a name="onchangeparentwnd"></a>  CMFCToolBarMenuButton::OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Paramètres

[in] *pWndParent*<br/>

### <a name="remarks"></a>Notes

##  <a name="onclick"></a>  CMFCToolBarMenuButton::OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>Paramètres

[in] *pWnd*<br/>
[in] *bDelay*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="onclickmenuitem"></a>  CMFCToolBarMenuButton::OnClickMenuItem

Appelé par le framework lorsque l’utilisateur sélectionne un élément dans le menu déroulant.

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>Valeur de retour

FALSE si le framework doit continuer le menu par défaut élément traitement ; Sinon, TRUE. L’implémentation par défaut toujours retourne FALSE.

### <a name="remarks"></a>Notes

Lorsque l’utilisateur clique sur un élément de menu, l’infrastructure exécute une commande qui est associée à cet élément.

Pour personnaliser le traitement des éléments de menu, substituez `OnClickMenuItem` dans une classe dérivée de `CMFCToolBarMenuButton` classe. Vous devez également substituer [CFrameWndEx::OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) et remplacer les boutons de menu qui nécessitent un traitement spécial avec des instances de la classe dérivée.

##  <a name="oncontexthelp"></a>  CMFCToolBarMenuButton::OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

[in] *pWnd*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="ondraw"></a>  CMFCToolBarMenuButton::OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>
[in] *rect*<br/>
[in] *pImages*<br/>
[in] *bHorz*<br/>
[in] *bCustomizeMode*<br/>
[in] *bHighlight*<br/>
[in] *bDrawBorder*<br/>
[in] *bGrayDisabledButtons*<br/>

### <a name="remarks"></a>Notes

##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarMenuButton::OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>
[in] *rect*<br/>
[in] *bSelected*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu

Appelé par le framework lorsque l’utilisateur ouvre le menu déroulant d’un bouton de menu de barre d’outils.

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] Spécifie la fenêtre qui reçoit les commandes de menu déroulant. Il peut être NULL uniquement si le bouton de menu de barre d’outils a une fenêtre parente.

### <a name="return-value"></a>Valeur de retour

TRUE lorsque un [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md) objet a été créé et ouvert avec succès ; sinon, FALSE.

### <a name="remarks"></a>Notes

Cette fonction est appelée par l’infrastructure quand l’utilisateur ouvre un menu déroulant à partir d’un bouton de menu de barre d’outils.

##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Notes

##  <a name="savebarstate"></a>  CMFCToolBarMenuButton::SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’il crée un bouton de barre d’outils comme le résultat d’une opération de glisser-déplacer. Cette méthode appelle la [CMFCPopupMenu::SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate) méthode du menu contextuel niveau supérieur, ce qui provoque le bouton parent du menu contextuel pour recréer son menu.

##  <a name="serialize"></a>  CMFCToolBarMenuButton::Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

[in] *ar*<br/>

### <a name="remarks"></a>Notes

##  <a name="setaccdata"></a>  CMFCToolBarMenuButton::SetACCData

Définit les données d’accessibilité de l’élément ruban.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
La fenêtre parente de l’élément ruban.

*data*<br/>
Les données d’accessibilité de l’élément ruban.

### <a name="return-value"></a>Valeur de retour

Renvoie toujours TRUE.

### <a name="remarks"></a>Notes

Par défaut, cette méthode définit les données d’accessibilité pour l’élément de ruban et retourne toujours la valeur TRUE. Remplacez cette méthode pour définir l’accessibilité des données et retourner une valeur qui indique la réussite ou l’échec.

##  <a name="setmenuonly"></a>  CMFCToolBarMenuButton::SetMenuOnly

Spécifie si le bouton est dessiné comme un bouton de menu ou un bouton partagé lorsqu’il a un ID de commande valide et un sous-menu.

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>Paramètres

*bMenuOnly*<br/>
[in] TRUE pour afficher ce bouton comme un bouton de menu lorsqu’il a un ID de commande valide et un sous-menu, FALSE pour afficher ce bouton comme un bouton partagé lorsqu’il a un ID de commande valide et un sous-menu.

### <a name="remarks"></a>Notes

En règle générale, lorsqu’un bouton de menu de barre d’outils a un sous-menu et un ID de commande, le menu s’affiche pour être un bouton partagé qui a un bouton principal et un joint le bouton flèche bas. Si vous appelez cette méthode et *bMenuOnly* a la valeur TRUE, le bouton au lieu de cela semble être un bouton de menu unique avec une flèche vers le bas dans le bouton. Lorsque l’utilisateur clique sur la flèche dans les deux modes, le sous-menu s’ouvre, et lorsque l’utilisateur clique sur la partie non flèche du bouton en mode de l’infrastructure exécute la commande.

##  <a name="setmenupalettemode"></a>  CMFCToolBarMenuButton::SetMenuPaletteMode

Spécifie si le menu déroulant est en mode de palette.

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>Paramètres

*bMenuPaletteMode*<br/>
[in] Spécifie si le menu déroulant est en mode de palette.

*nPaletteRows*<br/>
[in] Nombre de lignes dans la palette.

### <a name="remarks"></a>Notes

Dans le mode de palette, tous les éléments de menu sont affichés sous une palette multicolonne. Vous spécifiez le nombre de lignes à l’aide de *nPaletteRows*.

##  <a name="setmessagewnd"></a>  CMFCToolBarMenuButton::SetMessageWnd

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>Paramètres

[in] *pWndMessage*<br/>

### <a name="remarks"></a>Notes

##  <a name="setradio"></a>  CMFCToolBarMenuButton::SetRadio

Définit le bouton de menu de barre d’outils pour afficher une icône de style du bouton radio lorsqu’il est activé.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Notes

Lorsque le bouton de menu est dessiné lorsqu’il est extrait, il appelle [CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) pour dessiner une icône de coche. Par défaut, `OnDrawMenuCheck` demandes que le Gestionnaire visuel actuel Dessine une case à cocher style coche sur le bouton de menu. Après avoir appelé cette méthode, le Gestionnaire visuel actuel dessine à la place une coche de style du bouton radio sur le bouton de menu. Cette modification ne peut pas être annulée.

Lorsque vous appelez cette méthode et le bouton de menu est affiché, elle sera actualisée.

##  <a name="settearoff"></a>  CMFCToolBarMenuButton::SetTearOff

Spécifie l’ID de la barre détachable pour le menu déroulant.

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>Paramètres

*uiBarID*<br/>
[in] Spécifie un nouveau à détacher barre ID.

### <a name="remarks"></a>Notes

Appelez cette méthode pour spécifier l’ID de la barre détachable est créée lorsque l’utilisateur fait glisser le bouton de menu sur une barre de menus. Si le *uiBarID* paramètre est 0, l’utilisateur ne peut pas détacher le bouton de menu.

Appelez [CWinAppEx::EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) pour activer la fonctionnalité de menu volant dans votre application.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton, classe](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar, classe](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu, classe](../../mfc/reference/cmfcpopupmenu-class.md)