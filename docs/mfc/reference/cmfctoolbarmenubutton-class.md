---
description: 'En savoir plus sur : classe CMFCToolBarMenuButton'
title: CMFCToolBarMenuButton, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 84ab09d78863d72c26c62fdcb4e9cf5656d8418f
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97331727"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton, classe

Bouton de barre d'outils qui contient un menu contextuel.
Pour plus d’informations, consultez le code source situé dans le dossier **VC \\ ATLMFC \\ src \\ MFC** de votre installation de Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton :: CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|Construit un objet `CMFCToolBarMenuButton`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton :: compareWith (](#comparewith)|Compare cette instance avec l' `CMFCToolBarButton` objet fourni. (Substitue [CMFCToolBarButton :: compareWith (](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).)|
|[CMFCToolBarMenuButton :: CopyFrom](#copyfrom)|Copie les propriétés d’un autre bouton de barre d’outils sur le bouton actuel. (Substitue [CMFCToolBarButton :: CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom).)|
|[CMFCToolBarMenuButton :: CreateFromMenu](#createfrommenu)|Initialise le menu de la barre d’outils à partir d’un handle de menu Windows.|
|[CMFCToolBarMenuButton :: CreateMenu](#createmenu)|Crée un menu Windows qui se compose des commandes du menu de la barre d’outils. Retourne un handle au menu Windows.|
|[CMFCToolBarMenuButton :: CreatePopupMenu](#createpopupmenu)|Crée un objet de menu contextuel ( [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)) pour afficher le menu de la barre d’outils.|
|[CMFCToolBarMenuButton :: EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton :: GetCommands](#getcommands)|Donne un accès en lecture seule à la liste des commandes dans le menu de la barre d’outils.|
|[CMFCToolBarMenuButton :: GetImageRect](#getimagerect)|Récupère le rectangle englobant pour l’image du bouton.|
|[CMFCToolBarMenuButton :: GetPaletteRows](#getpaletterows)|Retourne le nombre de lignes dans le menu contextuel lorsque le menu est en mode palette.|
|[CMFCToolBarMenuButton :: GetPopupMenu](#getpopupmenu)|Retourne un pointeur vers l’objet de menu contextuel associé au bouton.|
|[CMFCToolBarMenuButton :: HasButton](#hasbutton)||
|[CMFCToolBarMenuButton :: HaveHotBorder](#havehotborder)|Détermine si une bordure du bouton s’affiche lorsqu’un utilisateur sélectionne le bouton. (Substitue [CMFCToolBarButton :: HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|
|[CMFCToolBarMenuButton :: IsBorder](#isborder)||
|[CMFCToolBarMenuButton :: IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton :: IsDroppedDown](#isdroppeddown)|Détermine si le menu contextuel s’affiche.|
|[CMFCToolBarMenuButton :: IsEmptyMenuAllowed](#isemptymenuallowed)|Appelée par l’infrastructure pour déterminer si un utilisateur peut ouvrir un sous-menu à partir de l’élément de menu sélectionné.|
|[CMFCToolBarMenuButton :: IsExclusive](#isexclusive)|Détermine si le bouton est en mode exclusif, c’est-à-dire si le menu contextuel reste ouvert même lorsque l’utilisateur déplace le pointeur sur une autre barre d’outils ou un autre bouton.|
|[CMFCToolBarMenuButton :: IsMenuPaletteMode](#ismenupalettemode)|Détermine si le menu contextuel est en mode palette.|
|[CMFCToolBarMenuButton :: IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton :: IsTearOffMenu](#istearoffmenu)|Détermine si le menu contextuel a une barre détachée.|
|[CMFCToolBarMenuButton :: OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton :: OnBeforeDrag](#onbeforedrag)|Spécifie si le bouton peut être glissé. (Substitue [CMFCToolBarButton :: OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag).)|
|[CMFCToolBarMenuButton :: OnCalculateSize](#oncalculatesize)|Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique et l’état d’ancrage spécifiés. (Substitue [CMFCToolBarButton :: OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).)|
|[CMFCToolBarMenuButton :: OnCancelMode](#oncancelmode)|Appelé par l’infrastructure pour gérer le message de [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) . (Substitue [CMFCToolBarButton :: OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).)|
|[CMFCToolBarMenuButton :: OnChangeParentWnd](#onchangeparentwnd)|Appelée par l’infrastructure quand le bouton est inséré dans une nouvelle barre d’outils. (Substitue [CMFCToolBarButton :: OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd).)|
|[CMFCToolBarMenuButton :: OnClick](#onclick)|Appelée par l’infrastructure quand l’utilisateur clique sur le bouton de la souris. (Substitue [CMFCToolBarButton :: OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|
|[CMFCToolBarMenuButton :: OnClickMenuItem](#onclickmenuitem)|Appelé par le Framework lorsque l’utilisateur sélectionne un élément dans le menu contextuel.|
|[CMFCToolBarMenuButton :: OnContextHelp](#oncontexthelp)|Appelé par le Framework lorsque la barre d’outils parente gère un message de WM_HELPHITTEST. (Substitue [CMFCToolBarButton :: OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).)|
|[CMFCToolBarMenuButton :: OnDraw](#ondraw)|Appelé par l’infrastructure pour dessiner le bouton à l’aide des styles et options spécifiés. (Substitue [CMFCToolBarButton :: OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|
|[CMFCToolBarMenuButton :: OnDrawOnCustomizeList](#ondrawoncustomizelist)|Appelée par l’infrastructure pour dessiner le bouton dans le volet **commandes** de la boîte de dialogue **personnaliser** . (Substitue [CMFCToolBarButton :: OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).)|
|[CMFCToolBarMenuButton :: OpenPopupMenu](#openpopupmenu)|Appelée par l’infrastructure quand l’utilisateur ouvre le menu contextuel.|
|[CMFCToolBarMenuButton :: ResetImageToDefault](#resetimagetodefault)|Affecte à la valeur par défaut l’image associée au bouton. (Substitue [CMFCToolBarButton :: ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).)|
|[CMFCToolBarMenuButton :: SaveBarState](#savebarstate)|Enregistre l’état du bouton de barre d’outils. (Substitue [CMFCToolBarButton :: SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|
|[CMFCToolBarMenuButton :: Serialize](#serialize)|Lit cet objet à partir d’une archive ou l’écrit dans une archive. (Substitue [CMFCToolBarButton :: Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|
|[CMFCToolBarMenuButton :: SetACCData](#setaccdata)|Remplit l’objet fourni `CAccessibilityData` avec les données d’accessibilité à partir du bouton de barre d’outils. (Substitue [CMFCToolBarButton :: SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|
|[CMFCToolBarMenuButton :: SetMenuOnly](#setmenuonly)|Spécifie si le bouton peut être ajouté à une barre d’outils.|
|[CMFCToolBarMenuButton :: SetMenuPaletteMode](#setmenupalettemode)|Spécifie si le menu contextuel est en mode palette.|
|[CMFCToolBarMenuButton :: SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton :: SetRadio](#setradio)|Force le bouton de menu de la barre d’outils à afficher une icône indiquant qu’il est sélectionné.|
|[CMFCToolBarMenuButton :: SetTearOff](#settearoff)|Spécifie un ID de barre détachée pour le menu contextuel.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton ::D rawDocumentIcon](#drawdocumenticon)|Dessine une icône sur le bouton de menu.|

### <a name="data-members"></a>Données membres

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarMenuButton :: m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|Si la valeur est TRUE, le Framework appelle toujours [CFrameWndEx :: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quand un bouton est dessiné.|

## <a name="remarks"></a>Notes

Un `CMFCToolBarMenuButton` peut apparaître comme un menu, un élément de menu qui possède un sous-menu, un bouton qui exécute une commande ou affiche un menu, ou un bouton qui affiche uniquement un menu. Vous déterminez le comportement et l’apparence du bouton de menu en spécifiant des paramètres tels que l’image, le texte, le handle de menu et l’ID de commande associé au bouton dans le constructeur `CMFCToolbarMenuButton::CMFCToolbarMenuButton` .

Une classe personnalisée dérivée de la `CMFCToolbarMenuButton` classe doit utiliser la macro [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial) . La macro [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate) génère une erreur lors de la fermeture de l’application.

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un `CMFCToolBarMenuButton` objet. Le code illustre comment spécifier que le menu déroulant est en mode palette et spécifier l’ID de la barre détachée qui est créée lorsque l’utilisateur fait glisser le bouton de menu hors d’une barre de menus. Cet extrait de code fait partie de l’ [exemple Word Pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>Spécifications

**En-tête :** afxtoolbarmenubutton.h

## <a name="cmfctoolbarmenubuttoncmfctoolbarmenubutton"></a><a name="cmfctoolbarmenubutton"></a> CMFCToolBarMenuButton :: CMFCToolBarMenuButton

Construit un objet `CMFCToolBarMenuButton`.

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>Paramètres

*src*<br/>
dans Objet existant `CMFCToolBarMenuButton` à copier dans cet `CMFCToolBarMenuButton` objet.

*uiID*<br/>
dans ID de la commande à exécuter lorsqu’un utilisateur clique sur le bouton. ou (UINT)-1 pour un bouton de menu qui n’exécute pas directement une commande.

*hMenu*<br/>
dans Handle d’un menu ; ou NULL si le bouton n’a pas de menu.

*iImage*<br/>
dans Index de l’image du bouton ; ou-1 si ce bouton n’a pas d’icône ou utilise l’icône de la commande spécifiée par *uiID*. L’index est le même pour chaque `CMFCToolBarImages` objet de votre application.

*lpszText*<br/>
dans Texte du bouton de menu de la barre d’outils.

*bUserButton*<br/>
dans TRUE si le bouton affiche une image définie par l’utilisateur ; FALSe si le bouton affiche une image prédéfinie associée à la commande spécifiée par *uiID*.

### <a name="remarks"></a>Notes

Si *uiID* est un ID de commande valide, le bouton exécute cette commande lorsque l’utilisateur clique dessus. Si *HMENU* est un handle de menu valide, le bouton fournit un menu déroulant lorsqu’il apparaît dans une barre d’outils ou dans un sous-menu lorsqu’il apparaît dans un menu. Si *uiID* et *HMENU* sont valides, le bouton est un bouton partagé avec une partie qui exécute la commande lorsque l’utilisateur clique dessus et une partie avec une flèche vers le bas qui affiche un menu lorsque l’utilisateur clique dessus. Toutefois, si *HMENU* est valide, un utilisateur ne peut pas cliquer sur le bouton pour exécuter une commande lorsque le bouton est inséré dans un menu.

### <a name="example"></a>Exemple

L’exemple suivant montre comment construire un objet de la `CMFCToolBarMenuButton` classe. Cet extrait de code fait partie de l’ [exemple Word Pad](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

## <a name="cmfctoolbarmenubuttoncomparewith"></a><a name="comparewith"></a> CMFCToolBarMenuButton :: compareWith (

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Paramètres

dans *autres*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttoncopyfrom"></a><a name="copyfrom"></a> CMFCToolBarMenuButton :: CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Paramètres

dans *src*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttoncreatefrommenu"></a><a name="createfrommenu"></a> CMFCToolBarMenuButton :: CreateFromMenu

Initialise le menu de la barre d’outils à partir d’un handle de menu Windows.

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>Paramètres

*hMenu*<br/>
dans Handle d’un menu.

### <a name="remarks"></a>Notes

Un bouton de menu de barre d’outils peut afficher un sous-menu déroulant.

L’infrastructure appelle cette méthode pour initialiser les commandes du sous-menu à partir d’un menu.

## <a name="cmfctoolbarmenubuttoncreatemenu"></a><a name="createmenu"></a> CMFCToolBarMenuButton :: CreateMenu

Crée un menu qui se compose des commandes dans le menu de la barre d’outils. Retourne un handle au menu.

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle du menu en cas de réussite. NULL si la liste de commandes associée au bouton de menu de la barre d’outils est vide.

### <a name="remarks"></a>Notes

Vous pouvez substituer cette méthode dans une classe dérivée pour personnaliser la façon dont le menu est généré.

## <a name="cmfctoolbarmenubuttoncreatepopupmenu"></a><a name="createpopupmenu"></a> CMFCToolBarMenuButton :: CreatePopupMenu

Crée un `CMFCPopupMenu` objet pour afficher le menu de la barre d’outils.

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un `CMFCPopupMenu` objet qui affiche le menu déroulant associé au bouton de menu de la barre d’outils.

### <a name="remarks"></a>Notes

Cette méthode est appelée par l’infrastructure pour préparer l’affichage du menu déroulant associé au bouton.

L’implémentation par défaut construit et retourne simplement un nouvel `CMFCPopupMenu` objet. Substituez cette méthode si vous souhaitez utiliser un type dérivé de la [classe CMFCPopupMenu](cmfcpopupmenu-class.md) ou pour effectuer une initialisation supplémentaire.

## <a name="cmfctoolbarmenubuttondrawdocumenticon"></a><a name="drawdocumenticon"></a> CMFCToolBarMenuButton ::D rawDocumentIcon

Dessine une icône de document sur le bouton de menu.

```cpp
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
dans Pointeur vers le contexte de périphérique (Device Context).

*rectImage*<br/>
dans Coordonnées du rectangle englobant de l’image.

*hIcon*<br/>
dans Handle de l’icône.

### <a name="remarks"></a>Notes

Cette méthode prend une icône de document et la dessine sur le bouton de menu, centré dans la zone spécifiée par *rectImage*.

## <a name="cmfctoolbarmenubuttonenablequickcustomize"></a><a name="enablequickcustomize"></a> CMFCToolBarMenuButton :: EnableQuickCustomize

```cpp
void EnableQuickCustomize();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonhasbutton"></a><a name="hasbutton"></a> CMFCToolBarMenuButton :: HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonhavehotborder"></a><a name="havehotborder"></a> CMFCToolBarMenuButton :: HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonisborder"></a><a name="isborder"></a> CMFCToolBarMenuButton :: IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonisclickedonmenu"></a><a name="isclickedonmenu"></a> CMFCToolBarMenuButton :: IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonisquickmode"></a><a name="isquickmode"></a> CMFCToolBarMenuButton :: IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttongetcommands"></a><a name="getcommands"></a> CMFCToolBarMenuButton :: GetCommands

Donne un accès en lecture seule à la liste des commandes dans le menu de la barre d’outils.

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>Valeur renvoyée

Référence const à un objet de [classe CObList](../../mfc/reference/coblist-class.md) , qui contient une collection d’objets de [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) .

### <a name="remarks"></a>Notes

Un bouton de menu de barre d’outils peut afficher un sous-menu. Vous pouvez fournir la liste des commandes dans le sous-menu du constructeur ou dans [CMFCToolBarMenuButton :: CreateFromMenu](#createfrommenu) en tant que handle d’un menu (HMENU). Le menu est converti en une liste d’objets dérivés de la [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) et stockés dans l' `CObList` objet interne. Vous pouvez accéder à cette liste en appelant cette méthode.

## <a name="cmfctoolbarmenubuttongetimagerect"></a><a name="getimagerect"></a> CMFCToolBarMenuButton :: GetImageRect

Récupère le rectangle englobant pour l’image du bouton.

```cpp
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>Paramètres

*rectImage*<br/>
à Référence à un `CRect` objet qui reçoit les coordonnées du rectangle englobant de l’image.

## <a name="cmfctoolbarmenubuttongetpaletterows"></a><a name="getpaletterows"></a> CMFCToolBarMenuButton :: GetPaletteRows

Retourne le nombre de lignes dans le menu déroulant lorsque le menu est en mode palette.

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre de lignes dans la palette.

### <a name="remarks"></a>Notes

Quand le bouton de menu est défini sur le mode palette, les éléments de menu s’affichent dans plusieurs colonnes avec un nombre limité de lignes. Appelez cette méthode pour obtenir le nombre de lignes. Vous pouvez activer ou désactiver le mode palette et spécifier le nombre de lignes à l’aide de [CMFCToolBarMenuButton :: SetMenuPaletteMode](#setmenupalettemode).

## <a name="cmfctoolbarmenubuttongetpopupmenu"></a><a name="getpopupmenu"></a> CMFCToolBarMenuButton :: GetPopupMenu

Retourne un pointeur vers l’objet de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) qui représente le menu déroulant du bouton.

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) qui a été créé lorsque l’infrastructure dessine le sous-menu du bouton de menu de la barre d’outils ; NULL si aucun sous-menu n’est affiché.

### <a name="remarks"></a>Notes

Quand un bouton de menu de barre d’outils affiche un menu déroulant, le bouton crée un objet de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) pour représenter le menu. Appelez cette méthode pour obtenir un pointeur vers l' `CMFCPopupMenu` objet. Vous ne devez pas stocker le pointeur retourné, car il est temporaire et devient non valide lorsque l’utilisateur ferme le menu déroulant.

## <a name="cmfctoolbarmenubuttonisdroppeddown"></a><a name="isdroppeddown"></a> CMFCToolBarMenuButton :: IsDroppedDown

Indique si le menu contextuel est actuellement affiché.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le bouton de menu de la barre d’outils affiche son sous-menu ; Sinon, FALSe.

## <a name="cmfctoolbarmenubuttonisemptymenuallowed"></a><a name="isemptymenuallowed"></a> CMFCToolBarMenuButton :: IsEmptyMenuAllowed

Spécifie si les éléments de menu affichent des sous-menus vides.

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le Framework ouvre un sous-menu à partir de l’élément de menu actuellement sélectionné, même si le sous-menu est vide. Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’un utilisateur tente d’ouvrir le sous-menu à partir de l’élément de menu actuellement sélectionné. Si le sous-menu est vide et `IsEmptyMenuAllowed` retourne la valeur false, le sous-menu ne s’ouvre pas.

L’implémentation par défaut retourne FALSe. Substituez cette méthode pour personnaliser ce comportement.

## <a name="cmfctoolbarmenubuttonisexclusive"></a><a name="isexclusive"></a> CMFCToolBarMenuButton :: IsExclusive

Indique si le bouton est en mode exclusif.

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le bouton fonctionne en mode exclusif ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Quand un utilisateur ouvre un menu contextuel pour un bouton, puis déplace le pointeur de la souris sur une autre barre d’outils ou bouton de menu, le menu contextuel se ferme, sauf si le bouton est en mode exclusif.

L’implémentation par défaut retourne toujours FALSe. Substituez cette méthode dans une classe dérivée si vous souhaitez activer le mode exclusif.

## <a name="cmfctoolbarmenubuttonismenupalettemode"></a><a name="ismenupalettemode"></a> CMFCToolBarMenuButton :: IsMenuPaletteMode

Détermine si le menu déroulant est en mode palette.

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le mode de palette est activé ; sinon, FALSe.

### <a name="remarks"></a>Notes

Quand le bouton de menu est défini sur le mode palette, les éléments de menu s’affichent dans plusieurs colonnes avec un nombre limité de lignes. Appelez cette méthode pour obtenir le nombre de lignes. Vous pouvez activer ou désactiver le mode palette en appelant [CMFCToolBarMenuButton :: SetMenuPaletteMode](#setmenupalettemode).

## <a name="cmfctoolbarmenubuttonistearoffmenu"></a><a name="istearoffmenu"></a> CMFCToolBarMenuButton :: IsTearOffMenu

Indique si le menu déroulant a une barre détachée.

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le bouton de menu de la barre d’outils comporte une barre détachable ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Pour activer la fonctionnalité de destruction et définir l’ID de la barre détachée, appelez [CMFCToolBarMenuButton :: SetTearOff](#settearoff).

## <a name="cmfctoolbarmenubuttonm_balwayscallownerdraw"></a><a name="m_balwayscallownerdraw"></a> CMFCToolBarMenuButton :: m_bAlwaysCallOwnerDraw

Spécifie si le Framework appelle toujours [CFrameWndEx :: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) lorsqu’un bouton est dessiné.

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>Notes

Quand cette variable membre est définie sur TRUE, le bouton appelle toujours la méthode [CFrameWndEx :: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) pour afficher l’image sur le bouton. Quand `m_bAlwaysCallOwnerDraw` a la valeur false, le bouton lui-même dessine l’image si l’image est prédéfinie. Sinon, elle appelle `OnDrawMenuImage` .

## <a name="cmfctoolbarmenubuttononaftercreatepopupmenu"></a><a name="onaftercreatepopupmenu"></a> CMFCToolBarMenuButton :: OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononbeforedrag"></a><a name="onbeforedrag"></a> CMFCToolBarMenuButton :: OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononcalculatesize"></a><a name="oncalculatesize"></a> CMFCToolBarMenuButton :: OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

dans *contrôleur de domaine principal*<br/>
dans *sizeDefault*<br/>
dans *bHorz*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononcancelmode"></a><a name="oncancelmode"></a> CMFCToolBarMenuButton :: OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a> CMFCToolBarMenuButton :: OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Paramètres

dans *pWndParent*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononclick"></a><a name="onclick"></a> CMFCToolBarMenuButton :: OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *pwnd*<br/>
dans *bDelay*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttononclickmenuitem"></a><a name="onclickmenuitem"></a> CMFCToolBarMenuButton :: OnClickMenuItem

Appelé par le Framework lorsque l’utilisateur sélectionne un élément dans le menu déroulant.

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>Valeur renvoyée

FALSe si l’infrastructure doit continuer le traitement par défaut de l’élément de menu ; Sinon, TRUE. L’implémentation par défaut retourne toujours FALSe.

### <a name="remarks"></a>Notes

Quand l’utilisateur clique sur un élément de menu, l’infrastructure exécute une commande associée à cet élément.

Pour personnaliser le traitement de l’élément de menu, substituez `OnClickMenuItem` dans une classe dérivée de la `CMFCToolBarMenuButton` classe. Vous devez également substituer [CFrameWndEx :: OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) et remplacer les boutons de menu qui nécessitent un traitement spécial avec les instances de la classe dérivée.

## <a name="cmfctoolbarmenubuttononcontexthelp"></a><a name="oncontexthelp"></a> CMFCToolBarMenuButton :: OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

dans *pwnd*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonondraw"></a><a name="ondraw"></a> CMFCToolBarMenuButton :: OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>Paramètres

dans *contrôleur de domaine principal*<br/>
dans *Rect*<br/>
dans *pImages*<br/>
dans *bHorz*<br/>
dans *bCustomizeMode*<br/>
dans *bHighlight*<br/>
dans *bDrawBorder*<br/>
dans *bGrayDisabledButtons*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a> CMFCToolBarMenuButton :: OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Paramètres

dans *contrôleur de domaine principal*<br/>
dans *Rect*<br/>
dans *bSelected*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonopenpopupmenu"></a><a name="openpopupmenu"></a> CMFCToolBarMenuButton :: OpenPopupMenu

Appelée par l’infrastructure quand l’utilisateur ouvre le menu déroulant d’un bouton de menu de barre d’outils.

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
dans Spécifie la fenêtre qui reçoit les commandes de menu déroulant. Il peut être NULL uniquement si le bouton de menu de la barre d’outils a une fenêtre parente.

### <a name="return-value"></a>Valeur renvoyée

TRUE lorsqu’un objet de [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) a été créé et ouvert avec succès ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette fonction est appelée par l’infrastructure quand l’utilisateur ouvre un menu déroulant à partir d’un bouton de menu de barre d’outils.

## <a name="cmfctoolbarmenubuttonresetimagetodefault"></a><a name="resetimagetodefault"></a> CMFCToolBarMenuButton :: ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonsavebarstate"></a><a name="savebarstate"></a> CMFCToolBarMenuButton :: SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode quand elle crée un bouton de barre d’outils à la suite d’une opération de glisser-déplacer. Cette méthode appelle la méthode [CMFCPopupMenu :: Savestest](../../mfc/reference/cmfcpopupmenu-class.md#savestate) du menu contextuel de niveau supérieur, ce qui amène le bouton parent du menu contextuel à recréer son menu.

## <a name="cmfctoolbarmenubuttonserialize"></a><a name="serialize"></a> CMFCToolBarMenuButton :: Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

dans *AR*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonsetaccdata"></a><a name="setaccdata"></a> CMFCToolBarMenuButton :: SetACCData

Définit les données d’accessibilité de l’élément ruban.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
La fenêtre parente de l’élément ruban.

*data*<br/>
Les données d’accessibilité de l’élément ruban.

### <a name="return-value"></a>Valeur renvoyée

Retourne toujours la valeur TRUE.

### <a name="remarks"></a>Notes

Par défaut, cette méthode définit les données d’accessibilité de l’élément de ruban et retourne toujours la valeur TRUE. Remplacez cette méthode pour définir l’accessibilité des données et retourner une valeur qui indique la réussite ou l’échec.

## <a name="cmfctoolbarmenubuttonsetmenuonly"></a><a name="setmenuonly"></a> CMFCToolBarMenuButton :: SetMenuOnly

Spécifie si le bouton est dessiné comme un bouton de menu ou un bouton partagé lorsqu’il a à la fois un ID de commande et un sous-menu valides.

```cpp
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>Paramètres

*bMenuOnly*<br/>
dans TRUE pour afficher ce bouton sous la forme d’un bouton de menu lorsqu’il a un ID de commande et un sous-menu valides, FALSe pour afficher ce bouton sous la forme d’un bouton partagé lorsqu’il a un ID de commande et un sous-menu valides.

### <a name="remarks"></a>Notes

En règle générale, lorsqu’un bouton de menu de barre d’outils contient à la fois un sous-menu et un ID de commande, le menu apparaît comme un bouton partagé qui a un bouton principal et un bouton de flèche vers le bas attaché. Si vous appelez cette méthode et que *bMenuOnly* a la valeur true, le bouton apparaît à la place comme un bouton de menu unique avec une flèche vers le bas dans le bouton. Quand l’utilisateur clique sur la flèche dans l’un des deux modes, le sous-menu s’ouvre et, lorsque l’utilisateur clique sur la partie non-flèche du bouton dans l’un ou l’autre mode, l’infrastructure exécute la commande.

## <a name="cmfctoolbarmenubuttonsetmenupalettemode"></a><a name="setmenupalettemode"></a> CMFCToolBarMenuButton :: SetMenuPaletteMode

Spécifie si le menu déroulant est en mode palette.

```cpp
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>Paramètres

*bMenuPaletteMode*<br/>
dans Spécifie si le menu déroulant est en mode palette.

*nPaletteRows*<br/>
dans Nombre de lignes dans la palette.

### <a name="remarks"></a>Notes

En mode palette, tous les éléments de menu s’affichent sous la forme d’une palette multicolonne. Vous spécifiez le nombre de lignes à l’aide de *nPaletteRows*.

## <a name="cmfctoolbarmenubuttonsetmessagewnd"></a><a name="setmessagewnd"></a> CMFCToolBarMenuButton :: SetMessageWnd

```cpp
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>Paramètres

dans *pWndMessage*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfctoolbarmenubuttonsetradio"></a><a name="setradio"></a> CMFCToolBarMenuButton :: SetRadio

Définit le bouton de menu de la barre d’outils pour afficher une icône de style de case d’option lorsqu’elle est activée.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Notes

Quand le bouton de menu est dessiné alors qu’il est activé, il appelle [CMFCVisualManager :: OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) pour dessiner une icône de coche. Par défaut, `OnDrawMenuCheck` demande que le gestionnaire visuel actuel dessine une coche de style de case à cocher dans le bouton de menu. Après avoir appelé cette méthode, le gestionnaire visuel actuel affiche à la place une coche de style de case d’option sur le bouton de menu. Cette modification ne peut pas être annulée.

Lorsque vous appelez cette méthode et que le bouton de menu est actuellement affiché, elle est actualisée.

## <a name="cmfctoolbarmenubuttonsettearoff"></a><a name="settearoff"></a> CMFCToolBarMenuButton :: SetTearOff

Spécifie l’ID de la barre détachée pour le menu déroulant.

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>Paramètres

*uiBarID*<br/>
dans Spécifie un nouvel ID de barre détachée.

### <a name="remarks"></a>Notes

Appelez cette méthode pour spécifier l’ID de la barre détachée qui est créée lorsque l’utilisateur fait glisser le bouton de menu d’une barre de menus. Si le paramètre *uiBarID* a la valeur 0, l’utilisateur ne peut pas détacher le bouton de menu.

Appelez [CWinAppEx :: EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) pour activer la fonctionnalité de menu détachable dans votre application.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton, classe](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar, classe](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu, classe](../../mfc/reference/cmfcpopupmenu-class.md)
