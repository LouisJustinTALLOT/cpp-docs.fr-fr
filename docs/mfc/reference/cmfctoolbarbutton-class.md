---
title: Cmfctoolbarbutton, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: 94d7ba14e01b2965a0fe788162726d1019e847de
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/04/2019
ms.locfileid: "57275231"
---
# <a name="cmfctoolbarbutton-class"></a>Cmfctoolbarbutton, classe

Fournit les fonctionnalités de bouton aux barres d’outils.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|Construit et initialise un objet `CMFCToolBarButton`.|
|`CMFCToolBarButton::~CMFCToolBarButton`|Destructeur.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|Spécifie si un utilisateur peut positionner un bouton dans un menu ou une barre d’outils au cours de personnalisation.|
|[CMFCToolBarButton::CanBeStored](#canbestored)|Spécifie si le bouton peut être stocké.|
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|Spécifie si un utilisateur permet d’étendre le bouton au cours de personnalisation.|
|[CMFCToolBarButton::CompareWith](#comparewith)|Compare cette instance avec le paramètre `CMFCToolBarButton` objet.|
|[CMFCToolBarButton::CopyFrom](#copyfrom)|Copie les propriétés d’un autre bouton de barre d’outils pour le bouton en cours.|
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|Crée un `CMFCToolBarButton` objet fourni `COleDataObject` objet.|
|`CMFCToolBarButton::CreateObject`|Utilisé par l'infrastructure pour créer une instance dynamique de ce type de classe.|
|[CMFCToolBarButton::EnableWindow](#enablewindow)|Active ou désactive les entrées de souris et de clavier.|
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|Copie le texte à partir du bouton de barre d’outils dans un menu.|
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|Récupère le format de Presse-papiers global de l’application.|
|[CMFCToolBarButton::GetHwnd](#gethwnd)|Récupère le handle de fenêtre qui est associé au bouton de barre d’outils.|
|[CMFCToolBarButton::GetImage](#getimage)|Récupère l’index de l’image du bouton.|
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|Récupère la région de la zone cliente du bouton qui doit être redessiné.|
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|Récupère la fenêtre parent du bouton.|
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.|
|[CMFCToolBarButton::GetTextSize](#gettextsize)|Récupère la taille du texte du bouton.|
|[CMFCToolBarButton::HasFocus](#hasfocus)|Détermine si le bouton a le focus d’entrée actuel.|
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|Détermine si une bordure du bouton est affichée lorsqu’un utilisateur sélectionne le bouton.|
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|Détermine si une image est affichée sur le bouton.|
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|Détermine si une étiquette de texte est affichée sur le bouton.|
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|Détermine si le bouton affiche un sous-menu.|
|[CMFCToolBarButton::IsEditable](#iseditable)|Détermine si le bouton peut être personnalisé.|
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|Détermine si le bouton peut être affiché avec une bordure étendue.|
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|Détermine si le bouton est dans la première position dans son groupe.|
|[CMFCToolBarButton::IsHidden](#ishidden)|Détermine si le bouton est masqué.|
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|Détermine si le bouton se trouve sur une barre horizontale.|
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|Spécifie si le bouton est dans la dernière position dans son groupe.|
|[CMFCToolBarButton::IsLocked](#islocked)|Détermine si le bouton est dans une barre d’outils (non personnalisable) verrouillé.|
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|Détermine si le bouton est le propriétaire du handle de fenêtre fourni.|
|[CMFCToolBarButton::IsVisible](#isvisible)|Détermine si le bouton de barre d’outils est visible.|
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|Détermine si le handle de fenêtre sous-jacent du bouton est visible.|
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|Spécifie si le bouton traite le [WM_COMMAND](/windows/desktop/menurc/wm-command) message.|
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|Appelé par le framework lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.|
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|Spécifie si le bouton peut être déplacé.|
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|Spécifie si un utilisateur peut déposer le bouton sur la barre d’outils de la cible.|
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique spécifié et l’état d’ancrage.|
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|Appelé par l’infrastructure pour gérer la [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) message.|
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|Appelé par le framework lorsque le bouton est inséré dans une nouvelle barre d’outils.|
|[CMFCToolBarButton::OnClick](#onclick)|Appelé par le framework lorsque l’utilisateur clique sur le bouton de la souris.|
|[CMFCToolBarButton::OnClickUp](#onclickup)|Appelé par l’infrastructure lorsque l’utilisateur relâche le bouton de la souris.|
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|Appelé par l’infrastructure lors de la barre d’outils parent gère un message WM_HELPHITTEST.|
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|Appelé par l’infrastructure lors de la barre d’outils parent gère un message WM_CTLCOLOR.|
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|Permet le bouton Modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parent.|
|[CMFCToolBarButton::OnDblClk](#ondblclk)|Appelé par l’infrastructure lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) message.|
|[CMFCToolBarButton::OnDraw](#ondraw)|Appelé par l’infrastructure pour dessiner le bouton en utilisant les options et les styles spécifiés.|
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Appelé par l’infrastructure pour dessiner le bouton dans le **commandes** volet de la **personnaliser** boîte de dialogue.|
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|Appelé par l’infrastructure pour récupérer le texte d’info-bulle personnalisée pour le bouton.|
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|Appelé par le framework lorsque la police globale a été modifiée.|
|[CMFCToolBarButton::OnMove](#onmove)|Appelé par le framework lorsque la barre d’outils parent se déplace.|
|[CMFCToolBarButton::OnShow](#onshow)|Appelé par le framework lorsque le bouton est visible ou invisible.|
|[CMFCToolBarButton::OnSize](#onsize)|Appelé par l’infrastructure lors de la barre d’outils parent change sa taille ou la position et cette modification nécessite le bouton pour modifier la taille.|
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|Appelé par l’infrastructure lors de la barre d’outils parent doit déterminer si un point est dans le rectangle englobant du bouton.|
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|Appelé par l’infrastructure lors de la barre d’outils parent met à jour son texte d’info-bulle.|
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|Appelé par le framework lorsque le bouton est sur le point d’effectuer une opération de glisser-déplacer.|
|[CMFCToolBarButton::Rect](#rect)|Récupère le rectangle englobant du bouton.|
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|Définit la valeur par défaut de l’image qui est associée au bouton.|
|[CMFCToolBarButton::SaveBarState](#savebarstate)|Enregistre l’état du bouton de barre d’outils.|
|[CMFCToolBarButton::Serialize](#serialize)|Lit de cet objet à partir d’une archive ou écrit dans une archive. (Substitue [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).)|
|[CMFCToolBarButton::SetACCData](#setaccdata)|Remplit le fourni `CAccessibilityData` objet avec les données d’accessibilité à partir du bouton de barre d’outils.|
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|Renomme le format de Presse-papiers global.|
|[CMFCToolBarButton::SetImage](#setimage)|Définit l’index d’image du bouton.|
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.|
|[CMFCToolBarButton::SetRadio](#setradio)|Appelé par l’infrastructure quand un bouton change son état activé.|
|[CMFCToolBarButton::SetRect](#setrect)|Définit le rectangle englobant du bouton.|
|[CMFCToolBarButton::SetStyle](#setstyle)|Définit le style du bouton.|
|[CMFCToolBarButton::SetVisible](#setvisible)|Spécifie si le bouton est visible.|
|[CMFCToolBarButton::Show](#show)|Affiche ou masque le bouton.|

### <a name="data-members"></a>Membres de données

|Name|Description|
|----------|-----------------|
|[CMFCToolBarButton::m_bImage](#m_bimage)|Spécifie si une image est affichée sur le bouton.|
|[CMFCToolBarButton::m_bText](#m_btext)|Spécifie si une étiquette de texte est affichée sur le bouton.|
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|Spécifie si l’étiquette de texte est affiché sous l’image sur le bouton.|
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|Spécifie si le bouton a une image défini par l’utilisateur.|
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|Spécifie si le bouton affiche son étiquette de texte intégral, même si elle ne tient pas dans le rectangle englobant.|
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|Spécifie si le bouton en regard d’un séparateur est placé sur la ligne suivante.|
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|Spécifie si les étiquettes de texte multilignes sont activées.|
|[CMFCToolBarButton::m_nID](#m_nid)|L’ID de commande du bouton.|
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|Le style du bouton.|
|[CMFCToolBarButton::m_strText](#m_strtext)|L’étiquette de texte du bouton.|

## <a name="remarks"></a>Notes

Un `CMFCToolbarButton` objet est un contrôle qui réside sur une barre d’outils. Son comportement ressemble à celle d’un bouton ordinaire. Vous pouvez affecter une image et une étiquette de texte à cet objet. Un bouton de barre d’outils peut également avoir un ID de commande. Lorsque l’utilisateur clique sur le bouton de barre d’outils, l’infrastructure exécute la commande spécifie cet ID.

En règle générale, les boutons de barre d’outils peuvent être personnalisés : l’utilisateur peut faire glisser des boutons dans une barre d’outils vers un autre, copier, coller, supprimer et modifier des étiquettes de texte et images. Pour empêcher l’utilisateur de personnaliser la barre d’outils, vous pouvez verrouiller la barre d’outils de deux manières. Définir le `bLocked` indicateur sur TRUE lorsque vous appelez [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar), ou ajoutez l’ID de commande d’un bouton individuel à la liste globale des commandes protégés à l’aide de la [CMFCToolBarButton :: SetProtectedCommands](#setprotectedcommands) (méthode).

`CMFCToolBarButton` objets affichent des images à partir de collections globales des images de barre d’outils dans l’application. Ces collections sont gérées par la barre d’outils parent, [cmfctoolbar, classe](../../mfc/reference/cmfctoolbar-class.md). Pour plus d’informations, consultez [cmfctoolbarimages, classe](../../mfc/reference/cmfctoolbarimages-class.md).

Lorsque l’utilisateur clique sur un bouton de barre d’outils, sa barre d’outils parent traite le message de la souris et communique les actions appropriées pour le bouton. Si le bouton a un ID de commande valide, la barre d’outils parent envoie le message WM_COMMAND vers le frame parent.

Le `CMFCToolBarButton` classe est la classe de base pour les autres classes de bouton de barre d’outils, tels que [cmfctoolbarmenubutton, classe](../../mfc/reference/cmfctoolbarmenubutton-class.md), [cmfctoolbareditboxbutton, classe](../../mfc/reference/cmfctoolbareditboxbutton-class.md), et [ Cmfctoolbarcomboboxbutton, classe](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un `CMFCToolBarButton` objet à l’aide de différentes méthodes de la `CMFCToolBarButton` classe. L’exemple illustre comment activer la souris et l’entrée au clavier, définissez l’index d’image du bouton, le rectangle englobant du bouton et que le bouton soit visible. Cet extrait de code fait partie de la [exemple de contrôle d’onglet](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>Spécifications

**En-tête :** afxtoolbarbutton.h

##  <a name="canbedropped"></a>  CMFCToolBarButton::CanBeDropped

Spécifie si un utilisateur peut positionner un bouton dans un menu ou une barre d’outils au cours de personnalisation.

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>Paramètres

*pToolbar*<br/>
[in] Inutilisé.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne la valeur TRUE.

### <a name="remarks"></a>Notes

Par défaut, un bouton de barre d’outils peut être déplacé sur chaque personnalisable (c'est-à-dire, non verrouillée) barre d’outils.

L’implémentation par défaut de cette méthode retourne la valeur TRUE. Substituez cette méthode et retourne FALSE si vous souhaitez empêcher l’utilisateur de repositionnement du bouton.

##  <a name="canbestored"></a>  CMFCToolBarButton::CanBeStored

Détermine si le bouton peut être stocké.

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne la valeur TRUE.

### <a name="remarks"></a>Notes

Le framework utilise cette méthode pour déterminer si le bouton peut participer à une opération de glisser-déplacer.

L’implémentation par défaut retourne la valeur TRUE. Substituez cette méthode si votre bouton ne peut pas être stocké en tant que partie d’une opération de glisser-déplacer. Pour plus d’informations sur les opérations de glisser-déplacer, consultez [glisser-déposer (OLE)](../../mfc/drag-and-drop-ole.md).

##  <a name="canbestretched"></a>  CMFCToolBarButton::CanBeStretched

Spécifie si un utilisateur permet d’étendre le bouton au cours de personnalisation.

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

Cette méthode est utilisée par l’infrastructure pour déterminer si le bouton peut être étiré dans le mode de personnalisation.

L’implémentation par défaut de cette méthode retourne FALSE. Substituez cette méthode pour retourner la valeur TRUE pour un contrôle de la largeur de la variable tel qu’une zone de liste modifiable ou un curseur.

Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).

##  <a name="cmfctoolbarbutton"></a>  CMFCToolBarButton::CMFCToolBarButton

Construit et initialise un objet `CMFCToolBarButton`.

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
[in] L’ID de commande du bouton.

*iImage*<br/>
[in] L’index d’image du bouton dans la collection d’images.

*lpszText*<br/>
[in] L’étiquette de texte du bouton. Peut être NULL.

*bUserButton*<br/>
[in] Valeur booléenne qui détermine si le bouton est défini par l’utilisateur. Si ce paramètre est TRUE, le bouton est défini par l’utilisateur. Sinon, l’image du bouton est chargée à partir d’une ressource.

*bLocked*<br/>
[in] Valeur booléenne qui détermine si le bouton peut être personnalisé. Si ce paramètre est TRUE, le bouton ne peuvent pas être personnalisé. Sinon, le bouton peut être personnalisé.

##  <a name="comparewith"></a>  CMFCToolBarButton::CompareWith

Compare cette instance avec le paramètre `CMFCToolBarButton` objet.

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Paramètres

*other*<br/>
[in] Référence à l’objet à comparer à cette instance.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’objet fourni est égal à la valeur de cette instance ; Sinon, 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut détermine si l’ID de commande de l’objet fourni est égal à l’ID de commande de cette instance. Substituez cette méthode si vous devez effectuer un traitement supplémentaire pour déterminer si deux `CMFCToolBarButton` objets sont égaux.

##  <a name="copyfrom"></a>  CMFCToolBarButton::CopyFrom

Copie les propriétés d’un autre bouton de barre d’outils pour le bouton en cours.

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Paramètres

*src*<br/>
[in] Une référence au bouton de la source à partir duquel copier.

### <a name="remarks"></a>Notes

Appelez cette méthode pour copier un autre bouton de barre d’outils sur ce bouton de barre d’outils.

##  <a name="createfromoledata"></a>  CMFCToolBarButton::CreateFromOleData

Crée un `CMFCToolBarButton` objet fourni `COleDataObject` objet.

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
[in] L’objet de données source OLE.

### <a name="return-value"></a>Valeur de retour

Objet `CMFCToolBarButton` créé.

### <a name="remarks"></a>Notes

Cette méthode est utilisée par l’infrastructure pour effectuer le transfert de données dans différents formats. Par exemple, le `CMFCOutlookBarPane::OnDragOver` méthode utilise cette méthode pour effectuer des opérations de glisser-déplacer.

##  <a name="enablewindow"></a>  CMFCToolBarButton::EnableWindow

Active ou désactive les entrées de souris et de clavier.

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[in] Définissez ce paramètre à True pour activer l’entrée, ou False pour désactiver l’entrée.

### <a name="remarks"></a>Notes

Cette méthode appelle la `EnableWindow` (fonction) pour activer ou désactiver l’entrée. Pour plus d’informations, consultez [EnableWindow](/windows/desktop/api/winuser/nf-winuser-enablewindow) dans le SDK Windows.

##  <a name="exporttomenubutton"></a>  CMFCToolBarButton::ExportToMenuButton

Copie le texte à partir du bouton de barre d’outils dans un menu.

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>Paramètres

*menuButton*<br/>
[in] Une référence au bouton de menu cible.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne la valeur TRUE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour copier le texte à partir d’un bouton de barre d’outils à un bouton de menu. L’implémentation par défaut copie l’étiquette de texte du bouton. Si l’étiquette de texte est vide, cette méthode copie le texte d’info-bulle du bouton.

L’implémentation par défaut de cette méthode retourne la valeur TRUE. Substituez cette méthode si vous souhaitez exécuter des actions supplémentaires lorsque l’infrastructure convertit un objet qui est dérivé de [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) à un bouton de menu.

##  <a name="getclipboardformat"></a>  CMFCToolBarButton::GetClipboardFormat

Récupère le format de Presse-papiers global de l’application.

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>Valeur de retour

La valeur CLIPFORMAT globale pour l’application.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour récupérer le format de Presse-papiers pour les opérations de transfert de données OLE. Par exemple, le [CMFCToolBarButton::CreateFromOleData](#createfromoledata) méthode utilise cette méthode pour copier des données à partir d’un objet de données de source OLE.

Cette méthode définit l’heure de la valeur du premier CLIPFORMAT globale, que cette méthode est appelée. Tous les appels ultérieurs à cette méthode retournent cette valeur.

Pour autoriser les opérations de glisser-déplacer doit se produire entre les applications, appeler le [CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname) (méthode).

Pour plus d’informations sur le Presse-papiers dans MFC, consultez [Presse-papiers](../../mfc/clipboard.md).

##  <a name="gethwnd"></a>  CMFCToolBarButton::GetHwnd

Récupère le handle de fenêtre qui est associé au bouton de barre d’outils.

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>Valeur de retour

Le handle de fenêtre qui est associé au bouton de barre d’outils ou NULL si le bouton de barre d’outils n’a aucun handle de fenêtre associée.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne la valeur NULL. Substituez cette méthode pour retourner le handle de fenêtre de votre contrôle spécifique.

##  <a name="getimage"></a>  CMFCToolBarButton::GetImage

Récupère l’index de l’image du bouton.

```
int GetImage() const;
```

### <a name="return-value"></a>Valeur de retour

Index de l’image associée à ce bouton.

### <a name="remarks"></a>Notes

Si le bouton possède une image défini par l’utilisateur (autrement dit, si *bUserButton* a la valeur TRUE dans le constructeur), l’index retourné spécifie une image dans la collection d’images définies par l’utilisateur (consultez [CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). Sinon, l’index spécifie une image dans la collection d’images qui sont chargés à partir d’un fichier de ressources (consultez [CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Pour plus d’informations sur les fichiers de ressources, consultez [Working with Resource Files](../../windows/working-with-resource-files.md).

##  <a name="getinvalidaterect"></a>  CMFCToolBarButton::GetInvalidateRect

Récupère la région de la zone cliente du bouton qui doit être redessiné.

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>Valeur de retour

Un `CRect` objet qui spécifie la région qui doit être redessinée.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne toute la zone cliente. Substituez cette méthode si vous souhaitez une autre zone à redessiner.

##  <a name="getparentwnd"></a>  CMFCToolBarButton::GetParentWnd

Récupère la fenêtre parent du bouton.

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>Valeur de retour

La fenêtre parent du bouton.

##  <a name="getprotectedcommands"></a>  CMFCToolBarButton::GetProtectedCommands

Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>Valeur de retour

La liste des commandes protégés.

### <a name="remarks"></a>Notes

En mode de personnalisation, le framework désactive les commandes de bouton de barre d’outils qui sont protégées. L’utilisateur ne peut pas effectuer de glisser-déplacer et modifier des opérations sur les boutons de barre d’outils désactivées.

Utilisez le [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) méthode pour définir la liste de protégée des commandes.

##  <a name="gettextsize"></a>  CMFCToolBarButton::GetTextSize

Récupère la taille du texte du bouton.

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>Valeur de retour

Objet taille qui contient la taille, en pixels, du texte du bouton.

##  <a name="hasfocus"></a>  CMFCToolBarButton::HasFocus

Détermine si le bouton a le focus d’entrée actuel.

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton a le focus d’entrée ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne zéro si le bouton a le focus d’entrée ou est une fenêtre enfant ou descendant de la fenêtre qui a le focus d’entrée. Vous pouvez remplacer cette fonction pour personnaliser ce comportement.

##  <a name="havehotborder"></a>  CMFCToolBarButton::HaveHotBorder

Détermine si une bordure du bouton est affichée lorsqu’un utilisateur sélectionne le bouton.

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne la valeur TRUE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si le bouton de barre d’outils doit afficher sa bordure lorsque l’utilisateur le sélectionne.

L’implémentation par défaut retourne la valeur TRUE. Vous pouvez remplacer cette méthode pour personnaliser ce comportement.

##  <a name="isdrawimage"></a>  CMFCToolBarButton::IsDrawImage

Détermine si une image est affichée sur le bouton.

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une image est affichée sur le bouton ; sinon 0.

### <a name="remarks"></a>Notes

Cette méthode retourne FALSE si le bouton de barre d’outils n’a aucune image associée ( [CMFCToolBarButton::GetImage](#getimage) retourne -1) ou si [CMFCToolBarButton::m_bImage](#m_bimage) est définie sur FALSE.

##  <a name="isdrawtext"></a>  CMFCToolBarButton::IsDrawText

Détermine si une étiquette de texte est affichée sur le bouton.

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une étiquette de texte est affichée ; sinon 0.

### <a name="remarks"></a>Notes

Cette méthode retourne FALSE si le bouton de barre d’outils n’a aucune étiquette de texte associée ( [CMFCToolBarButton::m_strText](#m_strtext) est vide) ou [CMFCToolBarButton::m_bText](#m_btext) est définie sur FALSE.

##  <a name="isdroppeddown"></a>  CMFCToolBarButton::IsDroppedDown

Détermine si le bouton affiche un sous-menu.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne FALSE. Substituez cette méthode pour retourner la valeur TRUE si votre contrôle affiche un sous-menu.

##  <a name="iseditable"></a>  CMFCToolBarButton::IsEditable

Détermine si le bouton peut être personnalisé.

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un bouton peut être personnalisé par l’utilisateur ; sinon 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide de glisser-déplacer ou modifier les opérations.

L’implémentation par défaut retourne FALSE si l’ID de commande du bouton est une commande standard (vous pouvez le déterminer en appelant le `IsStandardCommand` (fonction)) ou si la commande ID figure dans la liste de protégé des commandes. Pour plus d’informations sur les commandes protégés, consultez [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) et [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands).

Substituez cette méthode pour personnaliser son comportement.

##  <a name="isextrasize"></a>  CMFCToolBarButton::IsExtraSize

Détermine si le bouton peut être affiché avec une bordure étendue.

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton de barre d’outils peut être affiché avec une bordure étendue ; sinon 0.

### <a name="remarks"></a>Notes

Plusieurs apparences utilisent taille supplémentaire pour les bordures des boutons de barre d’outils (par exemple, les boutons round).

Si l’utilisateur déplace ce bouton à partir d’une barre d’outils vers un autre, l’infrastructure appelle la [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) (méthode). Le [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) méthode définit l’indicateur de taille supplémentaire à celle de la nouvelle barre d’outils parent (pour plus d’informations, consultez [CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).

##  <a name="isfirstingroup"></a>  CMFCToolBarButton::IsFirstInGroup

Détermine si le bouton est dans la première position dans son groupe.

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton est le premier bouton dans son groupe ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Cette méthode définit un *groupe* comme un ensemble voisin de boutons qui sont placés sur la même ligne et sont délimités par des séparateurs ou de la bordure de la barre d’outils. Cette méthode retourne FALSE si le bouton de barre d’outils fait référence à la **personnaliser** bouton. Pour plus d’informations sur la **personnaliser** bouton, consultez [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Appelez le [CMFCToolBarButton::IsLastInGroup](#islastingroup) méthode pour déterminer si le bouton est dans la dernière position dans son groupe.

##  <a name="ishidden"></a>  CMFCToolBarButton::IsHidden

Détermine si le bouton est masqué.

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton est masqué (invisible) ; sinon 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lors de la barre d’outils parent est étirée pour déterminer si le bouton de barre d’outils est visible.

Si vous définissez le bouton soit invisible à l’aide de la [CMFCToolBarButton::SetVisible](#setvisible) (méthode), utilisez [CMFCToolBarButton::IsVisible](#isvisible) pour déterminer si le bouton de barre d’outils est visible.

Par défaut, tous les boutons de barre d’outils sont visibles. Utilisez le [CMFCToolBarButton::Show](#show) méthode pour masquer ou afficher des boutons de barre d’outils.

##  <a name="ishorizontal"></a>  CMFCToolBarButton::IsHorizontal

Détermine si le bouton se trouve sur une barre horizontale.

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un bouton de barre d’outils se trouve sur une barre d’outils horizontale ; sinon 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer la disposition des boutons de barre d’outils.

Cette méthode retourne le `m_bHorz` membre de données. La valeur par défaut de la `m_bHorz` membre de données a la valeur TRUE ; elle est réinitialisée à chaque appel à la [CMFCToolBarButton::OnDraw](#ondraw) (méthode).

##  <a name="islastingroup"></a>  CMFCToolBarButton::IsLastInGroup

Spécifie si le bouton est dans la dernière position dans son groupe.

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton est le dernier bouton dans son groupe ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Cette méthode définit un *groupe* comme un ensemble de voisinage des boutons qui sont placés sur la même ligne et sont délimités par des séparateurs ou de la bordure de la barre d’outils de cette méthode retourne FALSE si le bouton de barre d’outils n’a aucune barre d’outils parent ou le bouton de barre d’outils fait référence à la **personnaliser** bouton. Pour plus d’informations sur la **personnaliser** bouton, consultez [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Appelez le [CMFCToolBarButton::IsFirstInGroup](#isfirstingroup) méthode pour déterminer si le bouton est dans la première position dans son groupe.

##  <a name="islocked"></a>  CMFCToolBarButton::IsLocked

Détermine si le bouton est dans une barre d’outils (non personnalisable) verrouillé.

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton se trouve sur une barre d’outils verrouillée ; sinon 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide de glisser-déplacer ou modifier les opérations. Définir l’attribut verrouillée sur la barre d’outils parent à l’aide de la [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) (méthode). L’infrastructure transmet la valeur de cet attribut au constructeur de chaque bouton de barre d’outils ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) qui il insère dans la barre d’outils parent.

##  <a name="isownerof"></a>  CMFCToolBarButton::IsOwnerOf

Détermine si le bouton est le propriétaire du handle de fenêtre fourni.

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>Paramètres

*hwnd*<br/>
[in] Un handle de fenêtre.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton est le propriétaire du handle de fenêtre fourni ; sinon 0.

### <a name="remarks"></a>Notes

Cette méthode retourne différente de zéro si *hwnd* fait référence au handle de fenêtre direct ou est un enfant de handle de fenêtre qui est associé au bouton. Cette méthode retourne 0 si *hwnd* a la valeur NULL.

##  <a name="isvisible"></a>  CMFCToolBarButton::IsVisible

Détermine si le bouton de barre d’outils est visible.

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton de barre d’outils est visible ; sinon 0.

### <a name="remarks"></a>Notes

Vous pouvez afficher ou masquer le bouton de barre d’outils à l’aide de la [CMFCToolBarButton::SetVisible](#setvisible) (méthode). Appelez le [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) méthode sur la barre d’outils parent une fois que vous appelez [CMFCToolBarButton::SetVisible](#setvisible) pour recalculer la disposition d’une barre d’outils parent.

##  <a name="iswindowvisible"></a>  CMFCToolBarButton::IsWindowVisible

Détermine si le handle de fenêtre sous-jacent du bouton est visible.

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le handle de fenêtre sous-jacent du bouton est visible ; sinon 0.

### <a name="remarks"></a>Notes

Cette méthode retourne une valeur différente de zéro si l’attribut de styles de handle de fenêtre sous-jacent contient le style WS_VISIBLE. Cette méthode retourne FALSE si le handle de fenêtre sous-jacent du bouton a la valeur NULL.

##  <a name="m_bimage"></a>  CMFCToolBarButton::m_bImage

Spécifie si une image est affichée sur le bouton.

```
BOOL m_bImage;
```

### <a name="remarks"></a>Notes

Si ce membre de données est défini sur TRUE, l’infrastructure affiche l’image qui est associé avec le bouton de barre d’outils ; Sinon, le framework n’affiche pas l’image. Ce membre affecte la valeur de retour de la [CMFCToolBarButton::m_bImage](#m_bimage) (méthode).

##  <a name="m_btext"></a>  CMFCToolBarButton::m_bText

Spécifie si une étiquette de texte est affichée sur le bouton.

```
BOOL m_bText;
```

### <a name="remarks"></a>Notes

Si ce membre de données est défini sur TRUE, l’infrastructure affiche l’étiquette de texte du bouton de barre d’outils ; Sinon, le framework n’affiche pas l’étiquette de texte. Ce membre affecte la valeur de retour de la [CMFCToolBarButton::m_bText](#m_btext) (méthode).

##  <a name="m_btextbelow"></a>  CMFCToolBarButton::m_bTextBelow

Spécifie si l’étiquette de texte est affiché sous l’image sur le bouton.

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>Notes

Si cette variable de membre est définie sur TRUE, l’infrastructure affiche le texte du bouton sous l’image. La valeur par défaut de ce membre a la valeur FALSE.

##  <a name="m_buserbutton"></a>  CMFCToolBarButton::m_bUserButton

Spécifie si le bouton a une image défini par l’utilisateur

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>Notes

Ce membre de données est défini sur TRUE lorsque le bouton a une image défini par l’utilisateur associée.

##  <a name="m_bwholetext"></a>  CMFCToolBarButton::m_bWholeText

Spécifie si le bouton affiche son étiquette de texte intégral, même si elle ne tient pas dans le rectangle englobant.

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>Notes

Si ce membre de données est défini sur TRUE, l’infrastructure affiche l’étiquette de texte intégral en agrandissant le bouton. Sinon, le framework tronque et ajoute les points de suspension ( **...** ) à l’étiquette de texte.

##  <a name="m_bwrap"></a>  CMFCToolBarButton::m_bWrap

Spécifie si le bouton en regard d’un séparateur est placé sur la ligne suivante.

```
BOOL m_bWrap;
```

### <a name="remarks"></a>Notes

Le framework définit ce membre de données sur la valeur TRUE si le bouton de barre d’outils ne tiennent pas sur la ligne actuelle ou lorsque vous spécifiez une mise en page (par exemple, un nombre spécifique de boutons de barre d’outils par ligne).

Le framework place ce bouton sur la ligne suivante si ce membre de données est défini sur TRUE et que la barre d’outils est ancrée horizontalement ou flottant.

La valeur par défaut de ce membre de données a la valeur FALSE.

##  <a name="m_bwraptext"></a>  CMFCToolBarButton::m_bWrapText

Spécifie si les étiquettes de texte multilignes sont activées.

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>Notes

Si cette variable membre statique est TRUE, l’infrastructure permet toutes les barres d’outils afficher les étiquettes de texte multiligne sur les boutons de barre d’outils.

La valeur par défaut de ce membre de données a la valeur FALSE.

##  <a name="m_nid"></a>  CMFCToolBarButton::m_nID

L’ID de commande du bouton.

```
UINT m_nID;
```

### <a name="remarks"></a>Notes

Un ID de commande de -1 indique que le bouton est un séparateur. Tous les séparateurs de boutons ont le style TBBS_SEPARATOR. Consultez [CMFCToolBarButton::m_nStyle](#m_nstyle) pour plus d’informations sur les styles de bouton.

##  <a name="m_nstyle"></a>  CMFCToolBarButton::m_nStyle

Le style du bouton.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Notes

Consultez [Styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) pour obtenir la liste des styles de bouton de barre d’outils disponibles.

##  <a name="m_strtext"></a>  CMFCToolBarButton::m_strText

L’étiquette de texte du bouton.

```
CString m_strText;
```

### <a name="remarks"></a>Notes

Ce membre de données contient l’étiquette de texte du bouton. L’étiquette de texte peut être vide.

##  <a name="notifycommand"></a>  CMFCToolBarButton::NotifyCommand

Spécifie si le bouton traite le [WM_COMMAND](/windows/desktop/menurc/wm-command) message.

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>Paramètres

*iNotifyCode*<br/>
[in] Le message de notification qui est associé à la commande.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’il est sur le point d’envoyer un [WM_COMMAND](/windows/desktop/menurc/wm-command) message vers la fenêtre parente.

Par défaut, cette méthode retourne FALSE. Substituez cette méthode pour retourner la valeur TRUE si vous souhaitez traiter le message WM_COMMAND ou FALSE pour indiquer que la barre d’outils parent doit gérer le message.

##  <a name="onaddtocustomizepage"></a>  CMFCToolBarButton::OnAddToCustomizePage

Appelé par le framework lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez effectuer une action lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.

##  <a name="onbeforedrag"></a>  CMFCToolBarButton::OnBeforeDrag

Spécifie si le bouton peut être déplacé.

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton peut être déplacé ; Sinon, FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode avant que l’utilisateur commence à faire glisser le bouton.

L’implémentation par défaut de cette méthode retourne la valeur TRUE. Substituez cette méthode pour retourner la valeur FALSE pour désactiver le faisant glisser du bouton.

##  <a name="onbeforedrop"></a>  CMFCToolBarButton::OnBeforeDrop

Spécifie si un utilisateur peut déposer le bouton sur la barre d’outils de la cible.

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>Paramètres

*pTarget*<br/>
[in] La cible de l’opération de glisser-déplacer.

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton peut être déposé sur la barre d’outils cible fourni ; Sinon, FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode avant le bouton est déposé sur une barre d’outils.

L’implémentation par défaut de cette méthode retourne la valeur TRUE. Substituez cette méthode pour retourner la valeur FALSE pour désactiver l’opération de déplacement sur la cible spécifiée.

##  <a name="oncalculatesize"></a>  CMFCToolBarButton::OnCalculateSize

Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique spécifié et l’état d’ancrage.

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Le contexte de périphérique qui affiche le bouton.

*sizeDefault*<br/>
[in] La taille par défaut du bouton.

*bHorz*<br/>
[in] L’état d’ancrage de la barre d’outils parent. Ce paramètre est TRUE si la barre d’outils est ancrée horizontalement ou est flottant, ou FALSE si la barre d’outils est ancrée verticalement.

### <a name="return-value"></a>Valeur de retour

Un `SIZE` structure qui contient les dimensions du bouton, en pixels.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer la taille du bouton de barre d’outils pour le contexte de périphérique spécifié et l’état d’ancrage.

L’implémentation par défaut prend en compte l’état d’ancrage de la taille du texte et image (si elles sont affichées), les positions de texte et image (le texte ci-dessous ou dans la partie droite de l’image) et la barre d’outils.

Substituez cette méthode si vous souhaitez fournir la taille d’un bouton non standard (par exemple, un bouton de la zone Modifier).

##  <a name="oncancelmode"></a>  CMFCToolBarButton::OnCancelMode

Appelé par l’infrastructure pour gérer la [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) message.

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez gérer le [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) message.

##  <a name="onchangeparentwnd"></a>  CMFCToolBarButton::OnChangeParentWnd

Appelé par le framework lorsque le bouton est inséré dans une nouvelle barre d’outils.

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
[in] La nouvelle fenêtre parente.

### <a name="remarks"></a>Notes

Le bouton est inséré dans une barre d’outils, par exemple, lorsque l’utilisateur fait glisser à partir d’une barre d’outils vers une autre barre d’outils.

L’implémentation par défaut de cette méthode ne fait rien.

##  <a name="onclick"></a>  CMFCToolBarButton::OnClick

Appelé par le framework lorsque l’utilisateur clique sur le bouton de la souris.

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] La fenêtre parent du bouton de barre d’outils.

*bDelay*<br/>
[in] TRUE si le message doit être géré avec un délai.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur clique sur le bouton de barre d’outils.

L’implémentation par défaut ne fait rien et retourne FALSE. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message de clic.

##  <a name="onclickup"></a>  CMFCToolBarButton::OnClickUp

Appelé par l’infrastructure lorsque l’utilisateur relâche le bouton de la souris.

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur relâche le bouton de barre d’outils.

L’implémentation par défaut ne fait rien et retourne FALSE. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message de clic.

##  <a name="oncontexthelp"></a>  CMFCToolBarButton::OnContextHelp

Appelé par l’infrastructure lors de la barre d’outils parent gère un message WM_HELPHITTEST.

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] La fenêtre parent du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien et retourne FALSE. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message d’aide.

Pour plus d’informations sur le message WM_HELPHITTEST, consultez [TN028 : Prise en charge de l’aide contextuelle](../../mfc/tn028-context-sensitive-help-support.md).

##  <a name="onctlcolor"></a>  CMFCToolBarButton::OnCtlColor

Appelé par l’infrastructure lors de la barre d’outils parent gère un message WM_CTLCOLOR.

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Le contexte de périphérique qui affiche le bouton.

*nCtlColor*<br/>
[in] La notification de couleur spécifique.

### <a name="return-value"></a>Valeur de retour

Handle vers l’objet brush que l’infrastructure utilise pour peindre l’arrière-plan du bouton.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque la barre d’outils parent traite le message WM_CTLCOLOR pour un bouton de barre d’outils qui contient un contrôle Windows. Le framework n’appelle pas cette méthode si le bouton de barre d’outils est sans fenêtre.

L’infrastructure appelle cette méthode lorsque l’infrastructure de la barre d’outils est en mode de personnalisation et le bouton de barre d’outils est déverrouillé. Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Pour plus d’informations sur les boutons de barre d’outils de verrouillage, consultez [CMFCToolBarButton::IsLocked](#islocked).

L’implémentation par défaut ne fait rien et retourne la valeur NULL.

##  <a name="oncustomizemenu"></a>  CMFCToolBarButton::OnCustomizeMenu

Permet le bouton Modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parent.

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>Paramètres

*pMenu*<br/>
[in] Menu Personnaliser.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’implémentation par défaut ne fait rien et retourne FALSE. Substituez cette méthode et retourner une valeur différente de zéro si vous souhaitez modifier le contenu du menu fourni.

##  <a name="ondblclk"></a>  CMFCToolBarButton::OnDblClk

Appelé par l’infrastructure lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) message.

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] - la fenêtre parent du bouton.

### <a name="remarks"></a>Notes

Cette méthode est appelée par le `CMFCToolBar::OnLButtonDblClk` méthode lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) message.

L’implémentation par défaut de cette méthode ne fait rien.

##  <a name="ondraw"></a>  CMFCToolBarButton::OnDraw

Appelé par l’infrastructure pour dessiner le bouton en utilisant les options et les styles spécifiés.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Le contexte de périphérique qui affiche le bouton.

*rect*<br/>
[in] Le rectangle englobant du bouton.

*pImages*<br/>
[in] La collection d’images de barre d’outils qui est associée au bouton.

*bHorz*<br/>
[in] L’état d’ancrage de la barre d’outils parent. Ce paramètre a la valeur TRUE lorsque le bouton est ancré horizontalement et FALSE lorsque le bouton est ancré verticalement.

*bCustomizeMode*<br/>
[in] Spécifie si la barre d’outils est en mode de personnalisation. Ce paramètre a la valeur TRUE lorsque la barre d’outils est en mode de personnalisation et FALSE lorsque la barre d’outils n’est pas en mode de personnalisation.

*bHighlight*<br/>
[in] Spécifie si le bouton est mis en surbrillance. Ce paramètre est la valeur TRUE lorsque le bouton est mis en surbrillance et FALSE lorsque le bouton n’est pas mis en surbrillance.

*bDrawBorder*<br/>
[in] Spécifie si le bouton doit afficher sa bordure. Ce paramètre a la valeur TRUE lorsque le bouton doit afficher sa bordure et la valeur FALSE lorsque le bouton ne doit pas afficher sa bordure.

*bGrayDisabledButtons*<br/>
[in] Spécifie s’il faut ombrer les boutons désactivés ou utiliser la collection d’images désactivé. Ce paramètre a la valeur TRUE lorsque les boutons désactivés doivent être grisée et FALSE lorsque cette méthode doit utiliser la collection d’images désactivé.

### <a name="remarks"></a>Notes

Substituez cette méthode pour personnaliser le dessin de bouton de barre d’outils.

##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarButton::OnDrawOnCustomizeList

Appelé par l’infrastructure pour dessiner le bouton dans le **commandes** volet de la **personnaliser** boîte de dialogue.

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Le contexte de périphérique qui affiche le bouton.

*rect*<br/>
[in] Le rectangle englobant du bouton.

*bSelected*<br/>
[in] Spécifie si le bouton est sélectionné. Si ce paramètre est TRUE, le bouton est sélectionné. Si ce paramètre est FALSE, le bouton n’est pas sélectionné.

### <a name="return-value"></a>Valeur de retour

La largeur, en pixels, du bouton sur le contexte de périphérique spécifié.

### <a name="remarks"></a>Notes

Cette méthode est appelée par la boîte de dialogue de personnalisation ( **commandes** onglet) lorsque le bouton est sur le point d’affiche dans la zone de liste owner-draw.

L’implémentation par défaut de cette méthode affiche l’étiquette d’image et le texte du bouton si elles sont disponibles. Si l’étiquette de texte du bouton n’est pas disponible, la méthode affiche le texte d’info-bulle.

Substituez cette méthode pour effectuer le dessin personnalisé.

##  <a name="ongetcustomtooltiptext"></a>  CMFCToolBarButton::OnGetCustomToolTipText

Appelé par l’infrastructure pour récupérer le texte d’info-bulle personnalisée pour le bouton.

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>Paramètres

*strToolTip*<br/>
[out] Un `CString` objet qui reçoit le texte d’info-bulle personnalisée.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’il affiche l’info-bulle pour le bouton de barre d’outils. Si cette méthode retourne FALSE, l’infrastructure utilise une info-bulle par défaut.

L’implémentation par défaut ne fait rien et retourne FALSE. Substituez cette méthode et retourner une valeur différente de zéro pour fournir le texte d’info-bulle personnalisée pour le bouton de barre d’outils.

##  <a name="onglobalfontschanged"></a>  CMFCToolBarButton::OnGlobalFontsChanged

Appelé par le framework lorsque la police globale a été modifiée.

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour de la police utilisée pour afficher le texte du bouton.

##  <a name="onmove"></a>  CMFCToolBarButton::OnMove

Appelé par le framework lorsque la barre d’outils parent se déplace.

```
virtual void OnMove();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour repositionner le bouton lorsque la barre d’outils parent se déplace.

##  <a name="onshow"></a>  CMFCToolBarButton::OnShow

Appelé par le framework lorsque le bouton est visible ou invisible.

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
[in] Spécifie si le bouton est visible. Si ce paramètre est TRUE, le bouton est visible. Sinon, le bouton n’est pas visible.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour la visibilité du bouton.

##  <a name="onsize"></a>  CMFCToolBarButton::OnSize

Appelé par l’infrastructure lors de la barre d’outils parent change sa taille ou la position et cette modification entraîne le bouton Modifier la taille.

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>Paramètres

*iSize*<br/>
[in] La nouvelle largeur du bouton.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour redimensionner le bouton lorsque la taille ou la position de la barre d’outils parent est modifié.

##  <a name="ontoolhittest"></a>  CMFCToolBarButton::OnToolHitTest

Appelé par l’infrastructure lors de la barre d’outils parent doit déterminer si un point est dans le rectangle englobant du bouton.

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] La fenêtre parent du bouton. Peut être NULL.

*pTI*<br/>
[in] Un `TOOLINFO` structure qui contient des informations sur un outil dans un contrôle d’info-bulle.

### <a name="return-value"></a>Valeur de retour

Le résultat de `OnMenuButtonToolHitTest` si le bouton peut récupérer un pointeur vers la fenêtre frame parente ; sinon, FALSE.

### <a name="remarks"></a>Notes

Cette méthode appelle l’une des méthodes suivantes si elle peut convertir la fenêtre parente en un objet de frame valide :

- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>  CMFCToolBarButton::OnUpdateToolTip

Appelé par l’infrastructure lors de la barre d’outils parent met à jour son texte d’info-bulle.

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
[in] La fenêtre parente.

*iButtonIndex*<br/>
[in] Index de base zéro du bouton dans la collection de boutons de parent.

*wndToolTip*<br/>
[in] Le contrôle qui affiche le texte d’info-bulle.

*str*<br/>
[out] Un `CString` objet qui reçoit le texte d’info-bulle mis à jour.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSE.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien et retourne FALSE. Substituez cette méthode pour retourner une valeur différente de zéro si vous fournissez une chaîne de texte d’info-bulle.

##  <a name="preparedrag"></a>  CMFCToolBarButton::PrepareDrag

Appelé par le framework lorsque le bouton est sur le point d’effectuer une opération de glisser-déplacer.

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>Paramètres

*srcItem*<br/>
[in] Un `COleDataSource` objet qui stocke les informations d’état de l’opération de glisser-déplacer.

### <a name="return-value"></a>Valeur de retour

TRUE si l’opération aboutit ; Sinon, FALSE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour préparer le bouton de barre d’outils pour stocker son état dans la liste fournie `COleDataSource` objet. Cette méthode stocke son état par lui-même sérialisation vers un fichier partagé, puis en passant ce fichier à la [COleDataSource::CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) (méthode). Pour plus d’informations sur la sérialisation de bouton de barre d’outils, consultez [CMFCToolBarButton::Serialize](#serialize).

Cette méthode ne fait rien et retourne la valeur TRUE si le bouton ne peut pas être stocké (le [CMFCToolBarButton::CanBeStored](#canbestored) méthode retourne la valeur FALSE). Elle retourne FALSE si une exception se produit pendant la sérialisation de l’objet.

Pour plus d’informations sur les opérations de glisser-déplacer OLE, consultez [glisser-déposer (OLE)](../../mfc/drag-and-drop-ole.md).

##  <a name="rect"></a>  CMFCToolBarButton::Rect

Récupère le rectangle englobant du bouton.

```
const CRect& Rect() const;
```

### <a name="return-value"></a>Valeur de retour

Un `CRect` objet qui contient le rectangle englobant d’un bouton.

##  <a name="resetimagetodefault"></a>  CMFCToolBarButton::ResetImageToDefault

Définit la valeur par défaut de l’image qui est associée au bouton.

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Notes

Cette méthode extrait l’image par défaut à partir de sa barre d’outils parent à l’aide de la [CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) (méthode). Si le bouton n’a aucune image par défaut associé, cette méthode définit l’étiquette de texte du bouton en fonction de ses ressources de chaîne à l’aide de la [CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) (méthode). Pour plus d’informations sur les ressources de type chaîne, consultez [Working with Resource Files](../../windows/working-with-resource-files.md).

Cette méthode ne fait rien si le bouton possède une image défini par l’utilisateur.

##  <a name="savebarstate"></a>  CMFCToolBarButton::SaveBarState

Enregistre l’état du bouton de barre d’outils.

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’il crée un `CMFCToolBarButton` objet en tant que le résultat d’une opération de glisser-déplacer.

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour enregistrer l’état du bouton de barre d’outils dans une source de données externe.

##  <a name="serialize"></a>  CMFCToolBarButton::Serialize

Lit de cet objet à partir d’une archive ou écrit dans une archive.

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*ar*<br/>
[in] Le `CArchive` objet à partir duquel ou de sérialisation.

### <a name="remarks"></a>Notes

Cette méthode prend en charge les processus de transfert de données telles que le Presse-papiers ou d’opérations de glisser-déplacer. Il lit ou écrit des propriétés du bouton telles que l’ID, étiquette de texte et ID de l’image à partir ou à la collection `CArchive` objet.

Pour des exemples de sérialisation, consultez [sérialisation : Sérialisation d’un objet](../../mfc/serialization-serializing-an-object.md).

##  <a name="setaccdata"></a>  CMFCToolBarButton::SetACCData

Remplit le fourni `CAccessibilityData` objet avec les données d’accessibilité à partir du bouton de barre d’outils.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
[in] La fenêtre parent du bouton de barre d’outils.

*data*<br/>
[in] Un `CAccessibilityData` objet qui est rempli avec les données d’accessibilité du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne la valeur TRUE.

### <a name="remarks"></a>Notes

Substituez cette méthode pour retourner FALSE si votre bouton de barre d’outils ne fournit pas de données d’accessibilité.

##  <a name="setclipboardformatname"></a>  CMFCToolBarButton::SetClipboardFormatName

Renomme le format de Presse-papiers global.

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Paramètres

*lpszName*<br/>
[in] Le nouveau nom du format de Presse-papiers global. Ne peut pas être Null.

### <a name="remarks"></a>Notes

Cette méthode rend possible pour les opérations de glisser-déplacer se produire entre plusieurs applications. Chaque application doit fournir le même nom de format de Presse-papiers.

Vous devez appeler cette méthode avant le framework appelle [CMFCToolBarButton::GetClipboardFormat](#getclipboardformat).

##  <a name="setimage"></a>  CMFCToolBarButton::SetImage

Définit l’index d’image du bouton.

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>Paramètres

*iImage*<br/>
[in] L’index de l’image dans la collection d’images de barre d’outils.

### <a name="remarks"></a>Notes

Si le bouton de barre d’outils est un séparateur, *iImage* fait référence à la nouvelle largeur du bouton séparateur.

Si *iImage* est inférieur à zéro, cette méthode désactive le dessin de l’image et permet le dessin de l’étiquette de texte du bouton.

##  <a name="setprotectedcommands"></a>  CMFCToolBarButton::SetProtectedCommands

Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>Paramètres

*lstCmds*<br/>
[in] La liste des commandes protégés.

### <a name="remarks"></a>Notes

En mode de personnalisation, le framework désactive les commandes de bouton de barre d’outils qui sont protégées. L’utilisateur ne peut pas effectuer de glisser-déplacer et modifier des opérations sur les boutons de barre d’outils désactivées.

Utilisez le [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) méthode pour récupérer la liste de protégée des commandes.

##  <a name="setradio"></a>  CMFCToolBarButton::SetRadio

Appelé par l’infrastructure quand un bouton change son état activé.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour effectuer une action personnalisée lorsque le bouton change son état activé.

##  <a name="setrect"></a>  CMFCToolBarButton::SetRect

Définit le rectangle englobant du bouton.

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>Paramètres

*rect*<br/>
[in] Le nouveau rectangle englobant du bouton.

### <a name="remarks"></a>Notes

Cette méthode appelle la [CMFCToolBarButton::OnMove](#onmove) méthode une fois qu’il a le nouveau rectangle englobant.

##  <a name="setstyle"></a>  CMFCToolBarButton::SetStyle

Définit le style du bouton.

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>Paramètres

*nStyle*<br/>
[in] Le nouveau style du bouton.

### <a name="remarks"></a>Notes

L’implémentation par défaut définit les [CMFCToolBarButton::m_nStyle](#m_nstyle) données membres à *nStyle*. Substituez cette méthode si vous souhaitez effectuer un traitement supplémentaire pour gérer le changement de style. Consultez [Styles de contrôle de barre d’outils](toolbar-control-styles.md) pour obtenir la liste des indicateurs de style valide.

##  <a name="setvisible"></a>  CMFCToolBarButton::SetVisible

Spécifie si le bouton est visible.

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
[in] Une valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre est TRUE, le bouton est affiché. Si le paramètre est FALSE, le bouton est masqué.

### <a name="remarks"></a>Notes

Cette fonction permet de masquer ou afficher un bouton de barre d’outils particulier. Appelez le [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) méthode après avoir appelé cette méthode.

##  <a name="show"></a>  CMFCToolBarButton::Show

Affiche ou masque le bouton.

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
[in] Une valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre est TRUE, le bouton est affiché. Si le paramètre est FALSE, le bouton est masqué.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour mettre à jour la visibilité des boutons de barre d’outils lorsque leur barre d’outils parent est redimensionné. L’infrastructure appelle cette méthode avec *bShow* définie sur FALSE lorsque le bouton ne tient plus dans les limites de la barre d’outils. L’infrastructure appelle cette méthode avec *bShow* la valeur TRUE lorsque après le redimensionnement du bouton Nouveau s’intègre dans les limites de la barre d’outils.

Utilisez le [CMFCToolBarButton::SetVisible](#setvisible) méthode pour définir la visibilité générale du bouton.

Cette méthode appelle la [CMFCToolBarButton::OnShow](#onshow) méthode une fois, il met à jour l’état de visibilité du bouton.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar, classe](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarImages, classe](../../mfc/reference/cmfctoolbarimages-class.md)
