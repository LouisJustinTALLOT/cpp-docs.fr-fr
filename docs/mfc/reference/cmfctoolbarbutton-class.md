---
title: CMFCToolBarButton, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: cfdde6aea42ff96957c18ef73f62a4e4f49292ff
ms.sourcegitcommit: a8ef52ff4a4944a1a257bdaba1a3331607fb8d0f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/11/2020
ms.locfileid: "77127442"
---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton, classe

Fournit la fonctionnalité de bouton aux barres d’outils.

## <a name="syntax"></a>Syntaxe

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Name|Description|
|----------|-----------------|
|[CMFCToolBarButton :: CMFCToolBarButton](#cmfctoolbarbutton)|Construit et initialise un objet `CMFCToolBarButton`.|
|`CMFCToolBarButton::~CMFCToolBarButton`|Destructor.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Name|Description|
|----------|-----------------|
|[CMFCToolBarButton :: CanBeDropped](#canbedropped)|Spécifie si un utilisateur peut positionner un bouton sur une barre d’outils ou un menu pendant la personnalisation.|
|[CMFCToolBarButton :: CanBeStored](#canbestored)|Spécifie si le bouton peut être stocké.|
|[CMFCToolBarButton :: CanBeStretched](#canbestretched)|Spécifie si un utilisateur peut étirer le bouton pendant la personnalisation.|
|[CMFCToolBarButton :: compareWith (](#comparewith)|Compare cette instance avec l’objet `CMFCToolBarButton` fourni.|
|[CMFCToolBarButton :: CopyFrom](#copyfrom)|Copie les propriétés d’un autre bouton de barre d’outils sur le bouton actuel.|
|[CMFCToolBarButton :: CreateFromOleData](#createfromoledata)|Crée un objet `CMFCToolBarButton` à partir de l’objet `COleDataObject` fourni.|
|`CMFCToolBarButton::CreateObject`|Utilisé par l'infrastructure pour créer une instance dynamique de ce type de classe.|
|[CMFCToolBarButton :: EnableWindow](#enablewindow)|Active ou désactive les entrées de souris et de clavier.|
|[CMFCToolBarButton :: ExportToMenuButton](#exporttomenubutton)|Copie le texte du bouton de barre d’outils dans un menu.|
|[CMFCToolBarButton :: GetClipboardFormat](#getclipboardformat)|Récupère le format de presse-papiers global pour l’application.|
|[CMFCToolBarButton :: GetHwnd](#gethwnd)|Récupère le handle de fenêtre associé au bouton de barre d’outils.|
|[CMFCToolBarButton :: GetImage](#getimage)|Récupère l’index d’image du bouton.|
|[CMFCToolBarButton :: GetInvalidateRect](#getinvalidaterect)|Récupère la zone de la zone cliente du bouton qui doit être redessinée.|
|[CMFCToolBarButton :: GetParentWnd](#getparentwnd)|Récupère la fenêtre parente du bouton.|
|[CMFCToolBarButton :: GetProtectedCommands](#getprotectedcommands)|Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.|
|[CMFCToolBarButton :: GetTextSize](#gettextsize)|Récupère la taille du texte du bouton.|
|[CMFCToolBarButton :: HasFocus](#hasfocus)|Détermine si le bouton a le focus d’entrée actuel.|
|[CMFCToolBarButton :: HaveHotBorder](#havehotborder)|Détermine si une bordure du bouton s’affiche lorsqu’un utilisateur sélectionne le bouton.|
|[CMFCToolBarButton :: IsDrawImage](#isdrawimage)|Détermine si une image est affichée sur le bouton.|
|[CMFCToolBarButton :: IsDrawText](#isdrawtext)|Détermine si une étiquette de texte est affichée sur le bouton.|
|[CMFCToolBarButton :: IsDroppedDown](#isdroppeddown)|Détermine si le bouton affiche un sous-menu.|
|[CMFCToolBarButton :: IsEditable](#iseditable)|Détermine si le bouton peut être personnalisé.|
|[CMFCToolBarButton :: IsExtraSize](#isextrasize)|Détermine si le bouton peut être affiché avec une bordure étendue.|
|[CMFCToolBarButton :: IsFirstInGroup](#isfirstingroup)|Détermine si le bouton se trouve à la première position dans son groupe de boutons.|
|[CMFCToolBarButton :: IsHidden](#ishidden)|Détermine si le bouton est masqué.|
|[CMFCToolBarButton :: IsHorizontal](#ishorizontal)|Détermine si le bouton se trouve dans une barre d’outils horizontale.|
|[CMFCToolBarButton :: IsLastInGroup](#islastingroup)|Spécifie si le bouton se trouve à la dernière position dans son groupe de boutons.|
|[CMFCToolBarButton :: IsLocked](#islocked)|Détermine si le bouton se trouve sur une barre d’outils verrouillée (non personnalisable).|
|[CMFCToolBarButton :: IsOwnerOf](#isownerof)|Détermine si le bouton est le propriétaire du handle de fenêtre fourni.|
|[CMFCToolBarButton :: IsVisible](#isvisible)|Détermine si le bouton de barre d’outils est visible.|
|[CMFCToolBarButton :: IsWindowVisible](#iswindowvisible)|Détermine si le handle de fenêtre sous-jacent du bouton est visible.|
|[CMFCToolBarButton :: NotifyCommand](#notifycommand)|Spécifie si le bouton traite le message de [WM_COMMAND](/windows/win32/menurc/wm-command) .|
|[CMFCToolBarButton :: OnAddToCustomizePage](#onaddtocustomizepage)|Appelée par l’infrastructure quand le bouton est ajouté à une boîte de dialogue **personnaliser** .|
|[CMFCToolBarButton :: OnBeforeDrag](#onbeforedrag)|Spécifie si le bouton peut être glissé.|
|[CMFCToolBarButton :: OnBeforeDrop](#onbeforedrop)|Spécifie si un utilisateur peut déposer le bouton dans la barre d’outils cible.|
|[CMFCToolBarButton :: OnCalculateSize](#oncalculatesize)|Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique et l’état d’ancrage spécifiés.|
|[CMFCToolBarButton :: OnCancelMode](#oncancelmode)|Appelé par l’infrastructure pour gérer le message de [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .|
|[CMFCToolBarButton :: OnChangeParentWnd](#onchangeparentwnd)|Appelée par l’infrastructure quand le bouton est inséré dans une nouvelle barre d’outils.|
|[CMFCToolBarButton :: OnClick](#onclick)|Appelée par l’infrastructure quand l’utilisateur clique sur le bouton de la souris.|
|[CMFCToolBarButton :: OnClickUp](#onclickup)|Appelée par l’infrastructure quand l’utilisateur relâche le bouton de la souris.|
|[CMFCToolBarButton :: OnContextHelp](#oncontexthelp)|Appelé par le Framework lorsque la barre d’outils parente gère un message de WM_HELPHITTEST.|
|[CMFCToolBarButton :: OnCtlColor](#onctlcolor)|Appelé par le Framework lorsque la barre d’outils parente gère un message de WM_CTLCOLOR.|
|[CMFCToolBarButton :: OnCustomizeMenu](#oncustomizemenu)|Permet au bouton de modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parente.|
|[CMFCToolBarButton :: OnDblClk](#ondblclk)|Appelé par le Framework lorsque la barre d’outils parente gère un message de [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .|
|[CMFCToolBarButton :: OnDraw](#ondraw)|Appelé par l’infrastructure pour dessiner le bouton à l’aide des styles et options spécifiés.|
|[CMFCToolBarButton :: OnDrawOnCustomizeList](#ondrawoncustomizelist)|Appelée par l’infrastructure pour dessiner le bouton dans le volet **commandes** de la boîte de dialogue **personnaliser** .|
|[CMFCToolBarButton :: OnGetCustomToolTipText](#ongetcustomtooltiptext)|Appelé par l’infrastructure pour récupérer le texte d’info-bulle personnalisé pour le bouton.|
|[CMFCToolBarButton :: OnGlobalFontsChanged](#onglobalfontschanged)|Appelé par le Framework lorsque la police globale a changé.|
|[CMFCToolBarButton :: OnMove](#onmove)|Appelé par le Framework lorsque la barre d’outils parente se déplace.|
|[CMFCToolBarButton :: OnShow](#onshow)|Appelé par le Framework lorsque le bouton devient visible ou invisible.|
|[CMFCToolBarButton :: OnSize](#onsize)|Appelé par le Framework lorsque la barre d’outils parente modifie sa taille ou sa position et que cette modification nécessite que le bouton change de taille.|
|[CMFCToolBarButton :: OnToolHitTest](#ontoolhittest)|Appelé par le Framework lorsque la barre d’outils parente doit déterminer si un point se trouve dans le rectangle englobant du bouton.|
|[CMFCToolBarButton :: OnUpdateToolTip](#onupdatetooltip)|Appelé par le Framework lorsque la barre d’outils parente met à jour son texte d’info-bulle.|
|[CMFCToolBarButton ::P repareDrag](#preparedrag)|Appelée par l’infrastructure quand le bouton est sur le paragraphe d’effectuer une opération de glisser-déplacer.|
|[CMFCToolBarButton :: Rect](#rect)|Récupère le rectangle englobant du bouton.|
|[CMFCToolBarButton :: ResetImageToDefault](#resetimagetodefault)|Affecte à la valeur par défaut l’image associée au bouton.|
|[CMFCToolBarButton :: SaveBarState](#savebarstate)|Enregistre l’état du bouton de barre d’outils.|
|[CMFCToolBarButton :: Serialize](#serialize)|Lit cet objet à partir d’une archive ou l’écrit dans une archive. (Substitue [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).)|
|[CMFCToolBarButton :: SetACCData](#setaccdata)|Remplit l’objet `CAccessibilityData` fourni avec les données d’accessibilité à partir du bouton de barre d’outils.|
|[CMFCToolBarButton :: SetClipboardFormatName](#setclipboardformatname)|Renomme le format de presse-papiers global.|
|[CMFCToolBarButton :: SetImage](#setimage)|Définit l’index d’image du bouton.|
|[CMFCToolBarButton :: SetProtectedCommands](#setprotectedcommands)|Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.|
|[CMFCToolBarButton :: SetRadio](#setradio)|Appelé par le Framework quand un bouton change son état activé.|
|[CMFCToolBarButton :: SetRect](#setrect)|Définit le rectangle englobant du bouton.|
|[CMFCToolBarButton :: SetStyle](#setstyle)|Définit le style du bouton.|
|[CMFCToolBarButton :: SetVisible](#setvisible)|Spécifie si le bouton est visible.|
|[CMFCToolBarButton :: Show](#show)|Affiche ou masque le bouton.|

### <a name="data-members"></a>Données membres

|Name|Description|
|----------|-----------------|
|[CMFCToolBarButton :: m_bImage](#m_bimage)|Spécifie si une image est affichée sur le bouton.|
|[CMFCToolBarButton :: m_bText](#m_btext)|Spécifie si une étiquette de texte est affichée sur le bouton.|
|[CMFCToolBarButton :: m_bTextBelow](#m_btextbelow)|Spécifie si l’étiquette de texte est affichée sous l’image sur le bouton.|
|[CMFCToolBarButton :: m_bUserButton](#m_buserbutton)|Spécifie si le bouton a une image définie par l’utilisateur.|
|[CMFCToolBarButton :: m_bWholeText](#m_bwholetext)|Spécifie si le bouton affiche l’étiquette de texte intégral même si elle ne tient pas dans le rectangle englobant.|
|[CMFCToolBarButton :: m_bWrap](#m_bwrap)|Spécifie si le bouton en regard d’un séparateur sera placé sur la ligne suivante.|
|[CMFCToolBarButton :: m_bWrapText](#m_bwraptext)|Spécifie si les étiquettes de texte sur plusieurs lignes sont activées.|
|[CMFCToolBarButton :: m_nID](#m_nid)|ID de commande du bouton.|
|[CMFCToolBarButton :: m_nStyle](#m_nstyle)|Style du bouton.|
|[CMFCToolBarButton :: m_strText](#m_strtext)|Étiquette de texte du bouton.|

## <a name="remarks"></a>Notes

Un objet `CMFCToolbarButton` est un contrôle qui réside dans une barre d’outils. Son comportement ressemble à celui d’un bouton ordinaire. Vous pouvez assigner une image et une étiquette de texte à cet objet. Un bouton de barre d’outils peut également avoir un ID de commande. Quand l’utilisateur clique sur le bouton de barre d’outils, l’infrastructure exécute la commande que cet ID spécifie.

En règle générale, les boutons de barre d’outils peuvent être personnalisés : l’utilisateur peut faire glisser des boutons d’une barre d’outils vers une autre, et copier, coller, supprimer et modifier des étiquettes et des images de texte. Pour empêcher l’utilisateur de personnaliser la barre d’outils, vous pouvez verrouiller la barre d’outils de l’une des deux façons suivantes. Affectez la valeur TRUE à l’indicateur `bLocked` lorsque vous appelez [CMFCToolBar :: LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar), ou bien ajoutez l’ID de commande d’un bouton individuel à la liste globale des commandes protégées à l’aide de la méthode [CMFCToolBarButton :: SetProtectedCommands](#setprotectedcommands) .

`CMFCToolBarButton` objets affichent des images à partir des collections globales d’images de barre d’outils dans l’application. Ces collections sont gérées par la barre d’outils parent, la [classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md). Pour plus d’informations, consultez [CMFCToolBarImages, classe](../../mfc/reference/cmfctoolbarimages-class.md).

Quand l’utilisateur clique sur un bouton de barre d’outils, sa barre d’outils parente traite le message de souris et communique les actions appropriées au bouton. Si le bouton possède un ID de commande valide, la barre d’outils parente envoie le WM_COMMAND message au frame parent.

La classe `CMFCToolBarButton` est la classe de base pour d’autres classes de bouton de barre d’outils, telles que la classe [CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md), la classe [CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md)et la [classe CMFCToolBarComboBoxButton](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un objet `CMFCToolBarButton` à l’aide de diverses méthodes de la classe `CMFCToolBarButton`. L’exemple montre comment activer la souris et l’entrée au clavier, définir l’index d’image du bouton, définir le rectangle englobant du bouton et rendre le bouton visible. Cet extrait de code fait partie de l' [exemple de contrôle Tab](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>Spécifications

**En-tête :** afxtoolbarbutton. h

##  <a name="canbedropped"></a>CMFCToolBarButton :: CanBeDropped

Spécifie si un utilisateur peut positionner un bouton sur une barre d’outils ou un menu pendant la personnalisation.

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>Paramètres

*pToolbar*<br/>
[in] Inutilisé.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne TRUE.

### <a name="remarks"></a>Notes

Par défaut, un bouton de barre d’outils peut être supprimé sur chaque barre d’outils personnalisable (c’est-à-dire non verrouillée).

L’implémentation par défaut de cette méthode retourne TRUE. Substituez cette méthode et retournez la valeur FALSe si vous souhaitez empêcher l’utilisateur de repositionner le bouton.

##  <a name="canbestored"></a>CMFCToolBarButton :: CanBeStored

Détermine si le bouton peut être stocké.

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne TRUE.

### <a name="remarks"></a>Notes

L’infrastructure utilise cette méthode pour déterminer si le bouton peut participer à une opération de glisser-déplacer.

L’implémentation par défaut retourne la valeur TRUE. Substituez cette méthode si votre bouton ne peut pas être stocké dans le cadre d’une opération de glisser-déplacer. Pour plus d’informations sur les opérations de glisser-déplacer, consultez glisser-déplacer [OLE](../../mfc/drag-and-drop-ole.md).

##  <a name="canbestretched"></a>CMFCToolBarButton :: CanBeStretched

Spécifie si un utilisateur peut étirer le bouton pendant la personnalisation.

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

Cette méthode est utilisée par l’infrastructure pour déterminer si le bouton peut être étiré en mode de personnalisation.

L’implémentation par défaut de cette méthode retourne FALSe. Substituez cette méthode pour retourner la valeur TRUE pour un contrôle de largeur variable, tel qu’une zone de liste déroulante ou un curseur.

Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar :: SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).

##  <a name="cmfctoolbarbutton"></a>CMFCToolBarButton :: CMFCToolBarButton

Construit et initialise un objet `CMFCToolBarButton`.

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
dans ID de commande du bouton.

*iImage*<br/>
dans Index d’image du bouton dans la collection d’images.

*lpszText*<br/>
dans Étiquette de texte du bouton. Sa valeur peut être NULL.

*bUserButton*<br/>
dans Valeur booléenne qui détermine si le bouton est défini par l’utilisateur. Si ce paramètre a la valeur TRUE, le bouton est défini par l’utilisateur. Dans le cas contraire, l’image de bouton est chargée à partir d’une ressource.

*Obstrué*<br/>
dans Valeur booléenne qui détermine si le bouton peut être personnalisé. Si ce paramètre a la valeur TRUE, le bouton ne peut pas être personnalisé. Dans le cas contraire, le bouton peut être personnalisé.

##  <a name="comparewith"></a>CMFCToolBarButton :: compareWith (

Compare cette instance avec l’objet `CMFCToolBarButton` fourni.

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Paramètres

*other*<br/>
dans Référence à l’objet à comparer à cette instance.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’objet fourni est égal à la valeur de cette instance ; Sinon, 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut détermine si l’ID de commande de l’objet fourni est égal à l’ID de commande de cette instance. Substituez cette méthode si vous devez effectuer un traitement supplémentaire pour déterminer si deux objets `CMFCToolBarButton` sont égaux.

##  <a name="copyfrom"></a>CMFCToolBarButton :: CopyFrom

Copie les propriétés d’un autre bouton de barre d’outils sur le bouton actuel.

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Paramètres

*src*<br/>
dans Référence au bouton source à partir duquel effectuer la copie.

### <a name="remarks"></a>Notes

Appelez cette méthode pour copier un autre bouton de barre d’outils sur ce bouton de barre d’outils.

##  <a name="createfromoledata"></a>CMFCToolBarButton :: CreateFromOleData

Crée un objet `CMFCToolBarButton` à partir de l’objet `COleDataObject` fourni.

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
dans Objet de données OLE source.

### <a name="return-value"></a>Valeur de retour

Objet `CMFCToolBarButton` créé.

### <a name="remarks"></a>Notes

Cette méthode est utilisée par l’infrastructure pour effectuer un transfert de données dans différents formats. Par exemple, la méthode `CMFCOutlookBarPane::OnDragOver` utilise cette méthode pour effectuer des opérations de glisser-déplacer.

##  <a name="enablewindow"></a>CMFCToolBarButton :: EnableWindow

Active ou désactive les entrées de souris et de clavier.

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans Définissez ce paramètre sur TRUE pour activer l’entrée, ou sur FALSe pour désactiver l’entrée.

### <a name="remarks"></a>Notes

Cette méthode appelle la fonction `EnableWindow` pour activer ou désactiver l’entrée. Pour plus d’informations, consultez [EnableWindow](/windows/win32/api/winuser/nf-winuser-enablewindow) dans le SDK Windows.

##  <a name="exporttomenubutton"></a>CMFCToolBarButton :: ExportToMenuButton

Copie le texte du bouton de barre d’outils dans un menu.

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>Paramètres

*menuButton*<br/>
dans Référence au bouton de menu cible.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne TRUE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour copier le texte d’un bouton de barre d’outils sur un bouton de menu. L’implémentation par défaut copie l’étiquette de texte du bouton. Si l’étiquette de texte est vide, cette méthode copie le texte d’info-bulle du bouton.

L’implémentation par défaut de cette méthode retourne TRUE. Substituez cette méthode si vous souhaitez effectuer des actions supplémentaires lorsque l’infrastructure convertit un objet dérivé de [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) en bouton de menu.

##  <a name="getclipboardformat"></a>CMFCToolBarButton :: GetClipboardFormat

Récupère le format de presse-papiers global pour l’application.

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>Valeur de retour

Valeur CLIPFORMAT globale de l’application.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour récupérer le format du presse-papiers pour les opérations de transfert de données OLE. Par exemple, la méthode [CMFCToolBarButton :: CreateFromOleData](#createfromoledata) utilise cette méthode pour copier des données à partir d’un objet de données OLE source.

Cette méthode définit la valeur CLIPFORMAT globale la première fois que cette méthode est appelée. Tous les appels suivants à cette méthode retournent cette valeur.

Pour permettre l’exécution d’opérations de glisser-déplacer entre des applications, appelez la méthode [CMFCToolBarButton :: SetClipboardFormatName](#setclipboardformatname) .

Pour plus d’informations sur les presse-papiers dans MFC, consultez [presse-papiers](../../mfc/clipboard.md).

##  <a name="gethwnd"></a>CMFCToolBarButton :: GetHwnd

Récupère le handle de fenêtre associé au bouton de barre d’outils.

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>Valeur de retour

Handle de fenêtre qui est associé au bouton de barre d’outils ou NULL si le bouton de barre d’outils n’est associé à aucun handle de fenêtre.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne la valeur NULL. Substituez cette méthode pour retourner le handle de fenêtre de votre contrôle spécifique.

##  <a name="getimage"></a>CMFCToolBarButton :: GetImage

Récupère l’index d’image du bouton.

```
int GetImage() const;
```

### <a name="return-value"></a>Valeur de retour

Index de l’image associée à ce bouton.

### <a name="remarks"></a>Notes

Si le bouton a une image définie par l’utilisateur (autrement dit, si *bUserButton* a la valeur true dans le constructeur), l’index retourné spécifie une image dans la collection d’images définies par l’utilisateur (consultez [CMFCToolBar :: GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). Dans le cas contraire, l’index spécifie une image dans la collection d’images qui sont chargées à partir d’un fichier de ressources (consultez [CMFCToolBar :: GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Pour plus d’informations sur les fichiers de ressources, consultez [utilisation des fichiers de ressources](../../windows/working-with-resource-files.md).

##  <a name="getinvalidaterect"></a>CMFCToolBarButton :: GetInvalidateRect

Récupère la zone de la zone cliente du bouton qui doit être redessinée.

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>Valeur de retour

Objet `CRect` qui spécifie la région qui doit être redessinée.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne la zone cliente entière. Substituez cette méthode si vous souhaitez qu’une autre zone soit redessinée.

##  <a name="getparentwnd"></a>CMFCToolBarButton :: GetParentWnd

Récupère la fenêtre parente du bouton.

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>Valeur de retour

Fenêtre parente du bouton.

##  <a name="getprotectedcommands"></a>CMFCToolBarButton :: GetProtectedCommands

Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>Valeur de retour

Liste des commandes protégées.

### <a name="remarks"></a>Notes

En mode de personnalisation, l’infrastructure désactive les commandes de bouton de barre d’outils qui sont protégées. L’utilisateur ne peut pas effectuer les opérations glisser-déplacer et modifier sur les boutons de la barre d’outils désactivés.

Utilisez la méthode [CMFCToolBarButton :: SetProtectedCommands](#setprotectedcommands) pour définir la liste des commandes protégées.

##  <a name="gettextsize"></a>CMFCToolBarButton :: GetTextSize

Récupère la taille du texte du bouton.

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>Valeur de retour

Objet de taille qui contient la taille, en pixels, du texte du bouton.

##  <a name="hasfocus"></a>CMFCToolBarButton :: HasFocus

Détermine si le bouton a le focus d’entrée actuel.

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton a le focus d’entrée ; Sinon, 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne une valeur différente de zéro si le bouton a le focus d’entrée ou s’il s’agit d’une fenêtre enfant ou descendante de la fenêtre qui a le focus d’entrée. Vous pouvez remplacer cette fonction pour personnaliser ce comportement.

##  <a name="havehotborder"></a>CMFCToolBarButton :: HaveHotBorder

Détermine si une bordure du bouton s’affiche lorsqu’un utilisateur sélectionne le bouton.

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne TRUE.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si le bouton de barre d’outils doit afficher sa bordure lorsqu’un utilisateur le sélectionne.

L’implémentation par défaut retourne la valeur TRUE. Vous pouvez substituer cette méthode pour personnaliser ce comportement.

##  <a name="isdrawimage"></a>CMFCToolBarButton :: IsDrawImage

Détermine si une image est affichée sur le bouton.

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une image est affichée sur le bouton ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode retourne FALSe si le bouton de barre d’outils n’a pas d’image associée ( [CMFCToolBarButton :: GetImage](#getimage) retourne-1) ou si [CMFCToolBarButton :: m_bImage](#m_bimage) a la valeur false.

##  <a name="isdrawtext"></a>CMFCToolBarButton :: IsDrawText

Détermine si une étiquette de texte est affichée sur le bouton.

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une étiquette de texte est affichée ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode retourne FALSe si le bouton de barre d’outils n’a pas d’étiquette de texte associée ( [CMFCToolBarButton :: m_strText](#m_strtext) est vide) ou [CMFCToolBarButton :: m_bText](#m_btext) a la valeur false.

##  <a name="isdroppeddown"></a>CMFCToolBarButton :: IsDroppedDown

Détermine si le bouton affiche un sous-menu.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode retourne FALSe. Substituez cette méthode pour retourner la valeur TRUE si votre contrôle affiche un sous-menu.

##  <a name="iseditable"></a>CMFCToolBarButton :: IsEditable

Détermine si le bouton peut être personnalisé.

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un bouton peut être personnalisé par l’utilisateur ; Sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide d’opérations de glisser-déplacer ou de modification.

L’implémentation par défaut retourne FALSe si l’ID de commande du bouton est une commande standard (vous pouvez le déterminer en appelant la fonction `IsStandardCommand`) ou si l’ID de commande est dans la liste des commandes protégées. Pour plus d’informations sur les commandes protégées, consultez [CMFCToolBarButton :: GetProtectedCommands](#getprotectedcommands) et [CMFCToolBarButton :: SetProtectedCommands](#setprotectedcommands).

Substituez cette méthode pour personnaliser son comportement.

##  <a name="isextrasize"></a>CMFCToolBarButton :: IsExtraSize

Détermine si le bouton peut être affiché avec une bordure étendue.

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton de barre d’outils peut être affiché avec une bordure étendue ; Sinon, 0.

### <a name="remarks"></a>Notes

Plusieurs apparences utilisent une taille supplémentaire pour les bordures des boutons de la barre d’outils (par exemple, les boutons arrondis).

Si l’utilisateur déplace ce bouton d’une barre d’outils à une autre, l’infrastructure appelle la méthode [CMFCToolBarButton :: OnChangeParentWnd](#onchangeparentwnd) . La méthode [CMFCToolBarButton :: OnChangeParentWnd](#onchangeparentwnd) affecte à l’indicateur de taille supplémentaire la valeur de la nouvelle barre d’outils parente (pour plus d’informations, consultez [CMFCToolBar :: IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).

##  <a name="isfirstingroup"></a>CMFCToolBarButton :: IsFirstInGroup

Détermine si le bouton se trouve à la première position dans son groupe de boutons.

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton est le premier bouton dans son groupe de boutons ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode définit un *groupe* de boutons sous la forme d’un ensemble de boutons voisins positionnés sur la même ligne et délimités par des séparateurs ou par la bordure de la barre d’outils. Cette méthode retourne FALSe si le bouton de barre d’outils fait référence au bouton **personnaliser** . Pour plus d’informations sur le bouton **personnaliser** , consultez [CMFCToolBar :: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Appelez la méthode [CMFCToolBarButton :: IsLastInGroup](#islastingroup) pour déterminer si le bouton se trouve à la dernière position dans son groupe de boutons.

##  <a name="ishidden"></a>CMFCToolBarButton :: IsHidden

Détermine si le bouton est masqué.

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton est masqué (invisible); Sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque la barre d’outils parente est étirée pour déterminer si le bouton de barre d’outils est visible.

Si vous définissez le bouton comme étant invisible à l’aide de la méthode [CMFCToolBarButton :: setVisible](#setvisible) , utilisez [CMFCToolBarButton :: IsVisible](#isvisible) pour déterminer si le bouton de barre d’outils est visible.

Par défaut, tous les boutons de la barre d’outils sont visibles. Utilisez la méthode [CMFCToolBarButton :: Show](#show) pour masquer ou afficher les boutons de la barre d’outils.

##  <a name="ishorizontal"></a>CMFCToolBarButton :: IsHorizontal

Détermine si le bouton se trouve dans une barre d’outils horizontale.

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un bouton de barre d’outils se trouve dans une barre d’outils horizontale ; Sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer la disposition des boutons de la barre d’outils.

Cette méthode retourne le membre de données `m_bHorz`. La valeur par défaut du membre de données `m_bHorz` est TRUE ; elle est réinitialisée à chaque appel à la méthode [CMFCToolBarButton :: OnDraw](#ondraw) .

##  <a name="islastingroup"></a>CMFCToolBarButton :: IsLastInGroup

Spécifie si le bouton se trouve à la dernière position dans son groupe de boutons.

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton est le dernier bouton dans son groupe de boutons ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode définit un *groupe* de boutons sous la forme d’un ensemble de boutons voisins positionnés sur la même ligne et délimités par des séparateurs ou par la bordure de la barre d’outils. cette méthode renvoie la valeur false si le bouton de barre d’outils n’a pas de barre d’outils parente ou si le bouton de barre d’outils fait référence au bouton **personnaliser** . Pour plus d’informations sur le bouton **personnaliser** , consultez [CMFCToolBar :: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Appelez la méthode [CMFCToolBarButton :: IsFirstInGroup](#isfirstingroup) pour déterminer si le bouton se trouve à la première position dans son groupe de boutons.

##  <a name="islocked"></a>CMFCToolBarButton :: IsLocked

Détermine si le bouton se trouve sur une barre d’outils verrouillée (non personnalisable).

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton se trouve dans une barre d’outils verrouillée ; Sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide d’opérations de glisser-déplacer ou de modification. Définissez l’attribut Locked sur la barre d’outils parente à l’aide de la méthode [CMFCToolBar :: LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) . L’infrastructure passe la valeur de cet attribut au constructeur de chaque bouton de barre d’outils ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) qu’elle insère dans la barre d’outils parente.

##  <a name="isownerof"></a>CMFCToolBarButton :: IsOwnerOf

Détermine si le bouton est le propriétaire du handle de fenêtre fourni.

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>Paramètres

*HWND*<br/>
dans Handle de fenêtre.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton est le propriétaire du handle de fenêtre fourni ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode retourne une valeur différente de zéro si *HWND* fait référence au handle de fenêtre directe ou s’il s’agit d’un enfant du handle de fenêtre associé au bouton. Cette méthode retourne 0 si *HWND* a la valeur null.

##  <a name="isvisible"></a>CMFCToolBarButton :: IsVisible

Détermine si le bouton de barre d’outils est visible.

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le bouton de barre d’outils est visible ; Sinon, 0.

### <a name="remarks"></a>Notes

Vous pouvez afficher ou masquer le bouton de barre d’outils à l’aide de la méthode [CMFCToolBarButton :: setVisible](#setvisible) . Appelez la méthode [CPane :: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) sur la barre d’outils parente après avoir appelé [CMFCToolBarButton :: setVisible](#setvisible) pour recalculer la disposition d’une barre d’outils parente.

##  <a name="iswindowvisible"></a>CMFCToolBarButton :: IsWindowVisible

Détermine si le handle de fenêtre sous-jacent du bouton est visible.

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le handle de fenêtre sous-jacent du bouton est visible ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode retourne une valeur différente de zéro si l’attribut styles du handle de fenêtre sous-jacent contient le style WS_VISIBLE. Cette méthode retourne FALSe si le handle de fenêtre sous-jacent du bouton a la valeur NULL.

##  <a name="m_bimage"></a>CMFCToolBarButton :: m_bImage

Spécifie si une image est affichée sur le bouton.

```
BOOL m_bImage;
```

### <a name="remarks"></a>Notes

Si ce membre de données a la valeur TRUE, l’infrastructure affiche l’image associée au bouton de barre d’outils ; dans le cas contraire, le Framework n’affiche pas l’image. Ce membre affecte la valeur de retour de la méthode [CMFCToolBarButton :: m_bImage](#m_bimage) .

##  <a name="m_btext"></a>CMFCToolBarButton :: m_bText

Spécifie si une étiquette de texte est affichée sur le bouton.

```
BOOL m_bText;
```

### <a name="remarks"></a>Notes

Si ce membre de données est défini sur TRUE, l’infrastructure affiche l’étiquette de texte du bouton de barre d’outils ; dans le cas contraire, le Framework n’affiche pas l’étiquette de texte. Ce membre affecte la valeur de retour de la méthode [CMFCToolBarButton :: m_bText](#m_btext) .

##  <a name="m_btextbelow"></a>CMFCToolBarButton :: m_bTextBelow

Spécifie si l’étiquette de texte est affichée sous l’image sur le bouton.

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>Notes

Si cette variable membre est définie sur TRUE, l’infrastructure affiche le texte du bouton sous l’image. La valeur par défaut de ce membre est FALSe.

##  <a name="m_buserbutton"></a>CMFCToolBarButton :: m_bUserButton

Spécifie si le bouton a une image définie par l’utilisateur

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>Notes

Ce membre de données est défini sur TRUE lorsque le bouton est associé à une image définie par l’utilisateur.

##  <a name="m_bwholetext"></a>CMFCToolBarButton :: m_bWholeText

Spécifie si le bouton affiche l’étiquette de texte intégral même si elle ne tient pas dans le rectangle englobant.

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>Notes

Si ce membre de données est défini sur TRUE, l’infrastructure affiche l’étiquette de texte intégral en agrandissant le bouton. Dans le cas contraire, le Framework tronque et ajoute des points de suspension ( **...** ) à l’étiquette de texte.

##  <a name="m_bwrap"></a>CMFCToolBarButton :: m_bWrap

Spécifie si le bouton en regard d’un séparateur sera placé sur la ligne suivante.

```
BOOL m_bWrap;
```

### <a name="remarks"></a>Notes

L’infrastructure définit ce membre de données sur TRUE lorsque le bouton de la barre d’outils ne tient pas sur la ligne actuelle ou lorsque vous spécifiez une disposition (par exemple, un nombre spécifique de boutons de la barre d’outils par ligne).

L’infrastructure place ce bouton sur la ligne suivante si ce membre de données est défini sur TRUE et que la barre d’outils est ancrée horizontalement ou flottante.

La valeur par défaut de cette donnée membre est FALSe.

##  <a name="m_bwraptext"></a>CMFCToolBarButton :: m_bWrapText

Spécifie si les étiquettes de texte sur plusieurs lignes sont activées.

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>Notes

Si cette variable membre statique a la valeur TRUE, l’infrastructure permet à toutes les barres d’outils d’afficher des étiquettes de texte sur plusieurs lignes sur les boutons de la barre d’outils.

La valeur par défaut de cette donnée membre est FALSe.

##  <a name="m_nid"></a>CMFCToolBarButton :: m_nID

ID de commande du bouton.

```
UINT m_nID;
```

### <a name="remarks"></a>Notes

L’ID de commande-1 indique que le bouton est un séparateur. Tous les séparateurs de boutons ont le style TBBS_SEPARATOR. Pour plus d’informations sur les styles de bouton, consultez [CMFCToolBarButton :: m_nStyle](#m_nstyle) .

##  <a name="m_nstyle"></a>CMFCToolBarButton :: m_nStyle

Style du bouton.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Notes

Consultez [styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) pour obtenir la liste des styles de boutons de barre d’outils disponibles.

##  <a name="m_strtext"></a>CMFCToolBarButton :: m_strText

Étiquette de texte du bouton.

```
CString m_strText;
```

### <a name="remarks"></a>Notes

Ce membre de données contient l’étiquette de texte du bouton. L’étiquette de texte peut être vide.

##  <a name="notifycommand"></a>CMFCToolBarButton :: NotifyCommand

Spécifie si le bouton traite le message de [WM_COMMAND](/windows/win32/menurc/wm-command) .

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>Paramètres

*iNotifyCode*<br/>
dans Message de notification associé à la commande.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’il est sur le paragraphe d’envoyer un message [WM_COMMAND](/windows/win32/menurc/wm-command) à la fenêtre parente.

Par défaut, cette méthode retourne FALSe. Substituez cette méthode pour retourner la valeur TRUE si vous souhaitez traiter le message WM_COMMAND ou FALSe pour indiquer que la barre d’outils parente doit gérer le message.

##  <a name="onaddtocustomizepage"></a>CMFCToolBarButton :: OnAddToCustomizePage

Appelée par l’infrastructure quand le bouton est ajouté à une boîte de dialogue **personnaliser** .

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez effectuer une action lorsque le bouton est ajouté à une boîte de dialogue **personnaliser** .

##  <a name="onbeforedrag"></a>CMFCToolBarButton :: OnBeforeDrag

Spécifie si le bouton peut être glissé.

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton peut être glissé ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode avant que l’utilisateur commence à faire glisser le bouton.

L’implémentation par défaut de cette méthode retourne TRUE. Substituez cette méthode pour retourner FALSe afin de désactiver le glissement du bouton.

##  <a name="onbeforedrop"></a>CMFCToolBarButton :: OnBeforeDrop

Spécifie si un utilisateur peut déposer le bouton dans la barre d’outils cible.

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>Paramètres

*pTarget*<br/>
dans Cible de l’opération de glisser-déplacer.

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton peut être déposé dans la barre d’outils cible fournie ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode avant la suppression du bouton sur une barre d’outils.

L’implémentation par défaut de cette méthode retourne TRUE. Substituez cette méthode pour retourner la valeur FALSe afin de désactiver l’opération de déplacement sur la cible spécifiée.

##  <a name="oncalculatesize"></a>CMFCToolBarButton :: OnCalculateSize

Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique et l’état d’ancrage spécifiés.

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Contexte de périphérique qui affiche le bouton.

*sizeDefault*<br/>
dans Taille par défaut du bouton.

*bHorz*<br/>
dans État d’ancrage de la barre d’outils parente. Ce paramètre a la valeur TRUE si la barre d’outils est ancrée horizontalement ou est flottante, ou FALSe si la barre d’outils est ancrée verticalement.

### <a name="return-value"></a>Valeur de retour

Structure `SIZE` qui contient les dimensions du bouton, en pixels.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour déterminer la taille du bouton de barre d’outils pour le contexte de périphérique et l’état d’ancrage spécifiés.

L’implémentation par défaut prend en compte les tailles de texte et d’image (si elles sont affichées), les positions de texte et d’image (le texte ci-dessous ou le côté droit de l’image) et l’état d’ancrage de la barre d’outils.

Substituez cette méthode si vous souhaitez fournir la taille d’un bouton non standard (par exemple, un bouton de zone d’édition).

##  <a name="oncancelmode"></a>CMFCToolBarButton :: OnCancelMode

Appelé par l’infrastructure pour gérer le message de [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez gérer le message de [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode) .

##  <a name="onchangeparentwnd"></a>CMFCToolBarButton :: OnChangeParentWnd

Appelée par l’infrastructure quand le bouton est inséré dans une nouvelle barre d’outils.

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
dans Nouvelle fenêtre parente.

### <a name="remarks"></a>Notes

Le bouton est inséré dans une barre d’outils, par exemple lorsque l’utilisateur le fait glisser d’une barre d’outils vers une autre.

L’implémentation par défaut de cette méthode ne fait rien.

##  <a name="onclick"></a>CMFCToolBarButton :: OnClick

Appelée par l’infrastructure quand l’utilisateur clique sur le bouton de la souris.

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
dans Fenêtre parente du bouton de barre d’outils.

*bDelay*<br/>
dans TRUE si le message doit être traité avec un délai.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur clique sur le bouton de barre d’outils.

L’implémentation par défaut ne fait rien et retourne FALSe. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message Click.

##  <a name="onclickup"></a>CMFCToolBarButton :: OnClickUp

Appelée par l’infrastructure quand l’utilisateur relâche le bouton de la souris.

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque l’utilisateur relâche le bouton de la barre d’outils.

L’implémentation par défaut ne fait rien et retourne FALSe. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message Click.

##  <a name="oncontexthelp"></a>CMFCToolBarButton :: OnContextHelp

Appelé par le Framework lorsque la barre d’outils parente gère un message de WM_HELPHITTEST.

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
dans Fenêtre parente du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien et retourne FALSe. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message d’aide.

Pour plus d’informations sur le message de WM_HELPHITTEST, consultez [TN028 : prise en charge de l’aide](../../mfc/tn028-context-sensitive-help-support.md)contextuelle.

##  <a name="onctlcolor"></a>CMFCToolBarButton :: OnCtlColor

Appelé par le Framework lorsque la barre d’outils parente gère un message de WM_CTLCOLOR.

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Contexte de périphérique qui affiche le bouton.

*nCtlColor*<br/>
dans Notification de couleur spécifique.

### <a name="return-value"></a>Valeur de retour

Handle de l’objet Brush utilisé par l’infrastructure pour peindre l’arrière-plan du bouton.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsque la barre d’outils parente traite le message WM_CTLCOLOR pour un bouton de barre d’outils qui contient un contrôle Windows. L’infrastructure n’appelle pas cette méthode si le bouton de barre d’outils est sans fenêtre.

L’infrastructure appelle cette méthode lorsque l’infrastructure de la barre d’outils est en mode de personnalisation et que le bouton de la barre d’outils est déverrouillé. Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar :: SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Pour plus d’informations sur le verrouillage des boutons de la barre d’outils, consultez [CMFCToolBarButton :: IsLocked](#islocked).

L’implémentation par défaut ne fait rien et retourne la valeur NULL.

##  <a name="oncustomizemenu"></a>CMFCToolBarButton :: OnCustomizeMenu

Permet au bouton de modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parente.

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>Paramètres

*pMenu*<br/>
dans Menu à personnaliser.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’implémentation par défaut ne fait rien et retourne FALSe. Substituez cette méthode et retournez une valeur différente de zéro si vous souhaitez modifier le contenu du menu fourni.

##  <a name="ondblclk"></a>CMFCToolBarButton :: OnDblClk

Appelé par le Framework lorsque la barre d’outils parente gère un message de [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
[in] : fenêtre parente du bouton.

### <a name="remarks"></a>Notes

Cette méthode est appelée par la méthode `CMFCToolBar::OnLButtonDblClk` lorsque la barre d’outils parente gère un message [WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk) .

L’implémentation par défaut de cette méthode ne fait rien.

##  <a name="ondraw"></a>CMFCToolBarButton :: OnDraw

Appelé par l’infrastructure pour dessiner le bouton à l’aide des styles et options spécifiés.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Contexte de périphérique qui affiche le bouton.

*rectangulaire*<br/>
dans Rectangle englobant du bouton.

*pImages*<br/>
dans Collection d’images de barre d’outils qui est associée au bouton.

*bHorz*<br/>
dans État d’ancrage de la barre d’outils parente. Ce paramètre a la valeur TRUE lorsque le bouton est ancré horizontalement et FALSe lorsque le bouton est ancré verticalement.

*bCustomizeMode*<br/>
dans Spécifie si la barre d’outils est en mode de personnalisation. Ce paramètre a la valeur TRUE lorsque la barre d’outils est en mode de personnalisation et FALSe lorsque la barre d’outils n’est pas en mode de personnalisation.

*bHighlight*<br/>
dans Spécifie si le bouton est mis en surbrillance. Ce paramètre a la valeur TRUE lorsque le bouton est mis en surbrillance et FALSe lorsque le bouton n’est pas mis en surbrillance.

*bDrawBorder*<br/>
dans Spécifie si le bouton doit afficher sa bordure. Ce paramètre a la valeur TRUE lorsque le bouton doit afficher sa bordure et FALSe lorsque le bouton ne doit pas afficher sa bordure.

*bGrayDisabledButtons*<br/>
dans Spécifie s’il faut ombrer les boutons désactivés ou utiliser la collection d’images désactivées. Ce paramètre a la valeur TRUE lorsque les boutons désactivés doivent être grisés et FALSe lorsque cette méthode doit utiliser la collection d’images désactivées.

### <a name="remarks"></a>Notes

Substituez cette méthode pour personnaliser le dessin du bouton de barre d’outils.

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarButton :: OnDrawOnCustomizeList

Appelée par l’infrastructure pour dessiner le bouton dans le volet **commandes** de la boîte de dialogue **personnaliser** .

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
dans Contexte de périphérique qui affiche le bouton.

*rectangulaire*<br/>
dans Rectangle englobant du bouton.

*bSelected*<br/>
dans Spécifie si le bouton est sélectionné. Si ce paramètre a la valeur TRUE, le bouton est sélectionné. Si ce paramètre a la valeur FALSe, le bouton n’est pas sélectionné.

### <a name="return-value"></a>Valeur de retour

Largeur, en pixels, du bouton sur le contexte de périphérique spécifié.

### <a name="remarks"></a>Notes

Cette méthode est appelée par la boîte de dialogue de personnalisation (onglet **commandes** ) quand le bouton est sur le point de s’afficher dans la zone de liste owner-draw.

L’implémentation par défaut de cette méthode affiche l’image et l’étiquette de texte du bouton si elles sont disponibles. Si l’étiquette de texte du bouton n’est pas disponible, la méthode affiche le texte d’info-bulle.

Substituez cette méthode pour effectuer un dessin personnalisé.

##  <a name="ongetcustomtooltiptext"></a>CMFCToolBarButton :: OnGetCustomToolTipText

Appelé par l’infrastructure pour récupérer le texte d’info-bulle personnalisé pour le bouton.

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>Paramètres

*strToolTip*<br/>
à Objet `CString` qui reçoit le texte d’info-bulle personnalisé.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

Le Framework appelle cette méthode lorsqu’il affiche l’info-bulle pour le bouton de barre d’outils. Si cette méthode retourne la valeur FALSe, l’infrastructure utilise une info-bulle par défaut.

L’implémentation par défaut ne fait rien et retourne FALSe. Substituez cette méthode et retournez une valeur différente de zéro pour fournir un texte d’info-bulle personnalisé pour le bouton de barre d’outils.

##  <a name="onglobalfontschanged"></a>CMFCToolBarButton :: OnGlobalFontsChanged

Appelé par le Framework lorsque la police globale a changé.

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour la police utilisée pour afficher le texte du bouton.

##  <a name="onmove"></a>CMFCToolBarButton :: OnMove

Appelé par le Framework lorsque la barre d’outils parente se déplace.

```
virtual void OnMove();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour repositionner le bouton lorsque la barre d’outils parente se déplace.

##  <a name="onshow"></a>CMFCToolBarButton :: OnShow

Appelé par le Framework lorsque le bouton devient visible ou invisible.

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
dans Spécifie si le bouton est visible. Si ce paramètre a la valeur TRUE, le bouton est visible. Dans le cas contraire, le bouton n’est pas visible.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour la visibilité du bouton.

##  <a name="onsize"></a>CMFCToolBarButton :: OnSize

Appelé par l’infrastructure quand la barre d’outils parente modifie sa taille ou sa position et que cette modification entraîne la modification de la taille du bouton.

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>Paramètres

*iSize*<br/>
dans Nouvelle largeur du bouton.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour redimensionner le bouton lorsque la taille ou la position de la barre d’outils parente change.

##  <a name="ontoolhittest"></a>CMFCToolBarButton :: OnToolHitTest

Appelé par le Framework lorsque la barre d’outils parente doit déterminer si un point se trouve dans le rectangle englobant du bouton.

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
dans Fenêtre parente du bouton. Sa valeur peut être NULL.

*pTI*<br/>
dans Structure `TOOLINFO` qui contient des informations à propos d’un outil dans un contrôle ToolTip.

### <a name="return-value"></a>Valeur de retour

Résultat de `OnMenuButtonToolHitTest` si le bouton peut récupérer un pointeur vers la fenêtre frame parente ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode appelle l’une des méthodes suivantes si elle peut convertir la fenêtre parente en un objet de frame valide :

- [CMDIFrameWndEx :: OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx :: OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>CMFCToolBarButton :: OnUpdateToolTip

Appelé par le Framework lorsque la barre d’outils parente met à jour son texte d’info-bulle.

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
dans Fenêtre parente.

*iButtonIndex*<br/>
dans Index de base zéro du bouton dans la collection de boutons parents.

*wndToolTip*<br/>
dans Contrôle qui affiche le texte d’info-bulle.

*str*<br/>
à Objet `CString` qui reçoit le texte info-bulle mis à jour.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne FALSe.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien et retourne FALSe. Substituez cette méthode pour retourner une valeur différente de zéro si vous fournissez une chaîne de texte d’info-bulle.

##  <a name="preparedrag"></a>CMFCToolBarButton ::P repareDrag

Appelée par l’infrastructure quand le bouton est sur le paragraphe d’effectuer une opération de glisser-déplacer.

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>Paramètres

*srcItem*<br/>
dans Objet `COleDataSource` qui stocke des informations d’État sur l’opération de glisser-déplacer.

### <a name="return-value"></a>Valeur de retour

TRUE si l’opération a échoué ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour préparer le bouton de barre d’outils afin de stocker son état dans l’objet `COleDataSource` fourni. Cette méthode stocke son état en la sérialisant dans un fichier partagé, puis en passant ce fichier à la méthode [COleDataSource :: CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) . Pour plus d’informations sur la sérialisation des boutons de barre d’outils, consultez [CMFCToolBarButton :: Serialize](#serialize).

Cette méthode ne fait rien et retourne TRUE si le bouton ne peut pas être stocké (la méthode [CMFCToolBarButton :: CanBeStored](#canbestored) retourne false). Elle retourne la valeur FALSe si une exception se produit pendant la sérialisation de l’objet.

Pour plus d’informations sur les opérations de glisser-déplacer OLE, consultez [glisser-déplacer OLE](../../mfc/drag-and-drop-ole.md).

##  <a name="rect"></a>CMFCToolBarButton :: Rect

Récupère le rectangle englobant du bouton.

```
const CRect& Rect() const;
```

### <a name="return-value"></a>Valeur de retour

Objet `CRect` qui contient le rectangle englobant d’un bouton.

##  <a name="resetimagetodefault"></a>CMFCToolBarButton :: ResetImageToDefault

Affecte à la valeur par défaut l’image associée au bouton.

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Notes

Cette méthode récupère l’image par défaut de sa barre d’outils parente à l’aide de la méthode [CMFCToolBar :: GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) . Si le bouton n’a pas d’image par défaut associée, cette méthode définit l’étiquette de texte du bouton en fonction de sa ressource de chaîne à l’aide de la méthode [CStringT :: LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) . Pour plus d’informations sur les ressources de type chaîne, consultez [Working with Resource Files](../../windows/working-with-resource-files.md).

Cette méthode ne fait rien si le bouton a une image définie par l’utilisateur.

##  <a name="savebarstate"></a>CMFCToolBarButton :: SaveBarState

Enregistre l’état du bouton de barre d’outils.

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode lorsqu’elle crée un objet `CMFCToolBarButton` à la suite d’une opération de glisser-déplacer.

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour enregistrer l’état du bouton de barre d’outils dans une source de données externe.

##  <a name="serialize"></a>CMFCToolBarButton :: Serialize

Lit cet objet à partir d’une archive ou l’écrit dans une archive.

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*AR*<br/>
dans Objet `CArchive` à partir duquel ou à laquelle sérialiser.

### <a name="remarks"></a>Notes

Cette méthode prend en charge les processus de transfert de données tels que le presse-papiers ou les opérations de glisser-déplacer. Il lit ou écrit les propriétés du bouton, telles que l’ID, l’étiquette de texte et l’ID d’image à partir de ou vers l’objet `CArchive` fourni.

Pour obtenir des exemples de sérialisation, consultez [sérialisation : sérialisation d’un objet](../../mfc/serialization-serializing-an-object.md).

##  <a name="setaccdata"></a>CMFCToolBarButton :: SetACCData

Remplit l’objet `CAccessibilityData` fourni avec les données d’accessibilité à partir du bouton de barre d’outils.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
dans Fenêtre parente du bouton de barre d’outils.

*data*<br/>
dans Objet `CAccessibilityData` rempli avec les données d’accessibilité du bouton de barre d’outils.

### <a name="return-value"></a>Valeur de retour

Cette méthode retourne TRUE.

### <a name="remarks"></a>Notes

Substituez cette méthode pour retourner la valeur FALSe si le bouton de barre d’outils ne fournit pas de données d’accessibilité.

##  <a name="setclipboardformatname"></a>CMFCToolBarButton :: SetClipboardFormatName

Renomme le format de presse-papiers global.

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Paramètres

*lpszName*<br/>
dans Nouveau nom du format de presse-papiers global. Ne peut pas avoir la valeur NULL.

### <a name="remarks"></a>Notes

Cette méthode permet d’effectuer des opérations de glisser-déplacer entre plusieurs applications. Chaque application doit fournir le même nom de format de presse-papiers.

Vous devez appeler cette méthode avant que le Framework appelle [CMFCToolBarButton :: GetClipboardFormat](#getclipboardformat).

##  <a name="setimage"></a>CMFCToolBarButton :: SetImage

Définit l’index d’image du bouton.

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>Paramètres

*iImage*<br/>
dans Index de l’image dans la collection d’images de barre d’outils.

### <a name="remarks"></a>Notes

Si le bouton de barre d’outils est un séparateur, *IImage* fait référence à la nouvelle largeur du bouton séparateur.

Si *IImage* est inférieur à zéro, cette méthode désactive le dessin de l’image et active le dessin de l’étiquette de texte du bouton.

##  <a name="setprotectedcommands"></a>CMFCToolBarButton :: SetProtectedCommands

Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>Paramètres

*lstCmds*<br/>
dans Liste des commandes protégées.

### <a name="remarks"></a>Notes

En mode de personnalisation, l’infrastructure désactive les commandes de bouton de barre d’outils qui sont protégées. L’utilisateur ne peut pas effectuer les opérations glisser-déplacer et modifier sur les boutons de la barre d’outils désactivés.

Utilisez la méthode [CMFCToolBarButton :: GetProtectedCommands](#getprotectedcommands) pour récupérer la liste des commandes protégées.

##  <a name="setradio"></a>CMFCToolBarButton :: SetRadio

Appelé par le Framework quand un bouton change son état activé.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour exécuter une action personnalisée lorsque le bouton modifie son état activé.

##  <a name="setrect"></a>CMFCToolBarButton :: SetRect

Définit le rectangle englobant du bouton.

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>Paramètres

*rectangulaire*<br/>
dans Nouveau rectangle englobant du bouton.

### <a name="remarks"></a>Notes

Cette méthode appelle la méthode [CMFCToolBarButton :: OnMove](#onmove) après avoir défini le nouveau rectangle englobant.

##  <a name="setstyle"></a>CMFCToolBarButton :: SetStyle

Définit le style du bouton.

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>Paramètres

*nStyle*<br/>
dans Nouveau style du bouton.

### <a name="remarks"></a>Notes

L’implémentation par défaut définit le membre de données [CMFCToolBarButton :: m_nStyle](#m_nstyle) sur *nStyle*. Substituez cette méthode si vous souhaitez effectuer un traitement supplémentaire pour gérer la modification du style. Pour obtenir la liste des indicateurs de style valides, consultez [styles de contrôle de barre d’outils](toolbar-control-styles.md) .

##  <a name="setvisible"></a>CMFCToolBarButton :: SetVisible

Spécifie si le bouton est visible.

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
dans Valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre a la valeur TRUE, le bouton est affiché. Si le paramètre a la valeur FALSe, le bouton est masqué.

### <a name="remarks"></a>Notes

Utilisez cette fonction pour masquer ou afficher un bouton de barre d’outils particulier. Appelez la méthode [CPane :: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) après avoir appelé cette méthode.

##  <a name="show"></a>CMFCToolBarButton :: Show

Affiche ou masque le bouton.

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
dans Valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre a la valeur TRUE, le bouton est affiché. Si le paramètre a la valeur FALSe, le bouton est masqué.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette méthode pour mettre à jour la visibilité des boutons de la barre d’outils lorsque leur barre d’outils parente est redimensionnée. L’infrastructure appelle cette méthode avec *bShow* défini sur false lorsque le bouton ne s’ajuste plus dans les limites de la barre d’outils. L’infrastructure appelle cette méthode avec *bShow* défini sur true lorsque, après le redimensionnement du bouton, s’ajuste aux limites de la barre d’outils.

Utilisez la méthode [CMFCToolBarButton :: setVisible](#setvisible) pour définir la visibilité générale du bouton.

Cette méthode appelle la méthode [CMFCToolBarButton :: onshow](#onshow) après avoir mis à jour l’état de visibilité du bouton.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar, classe](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarImages, classe](../../mfc/reference/cmfctoolbarimages-class.md)
