---
title: Classe de CMFCToolBarButton | Documents Microsoft
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarButton class
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
caps.latest.revision: 34
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 4fafe461008e3545243d693e0d9e34acd57163e0
ms.openlocfilehash: 0139779cd00a514684c20b2c589d96247a532733
ms.contentlocale: fr-fr
ms.lasthandoff: 02/24/2017

---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton (classe)
Fournit la fonctionnalité des boutons aux barres d’outils.  
  
## <a name="syntax"></a>Syntaxe  
  
```  
class CMFCToolBarButton : public CObject  
```  
  
## <a name="members"></a>Membres  
  
### <a name="public-constructors"></a>Constructeurs publics  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|Construit et initialise un objet `CMFCToolBarButton`.|  
|`CMFCToolBarButton::~CMFCToolBarButton`|Destructeur.|  
  
### <a name="public-methods"></a>M&#233;thodes publiques  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|Spécifie si un utilisateur peut placer un bouton dans un menu ou une barre d’outils pendant la personnalisation.|  
|[CMFCToolBarButton::CanBeStored](#canbestored)|Spécifie si le bouton peut être stocké.|  
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|Spécifie si un utilisateur peut étendre le bouton pendant la personnalisation.|  
|[CMFCToolBarButton::CompareWith](#comparewith)|Compare cette instance avec le paramètre `CMFCToolBarButton` objet.|  
|[CMFCToolBarButton::CopyFrom](#copyfrom)|Copie les propriétés d’un autre bouton de barre d’outils sur le bouton en cours.|  
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|Crée un `CMFCToolBarButton` objet fourni `COleDataObject` objet.|  
|`CMFCToolBarButton::CreateObject`|Utilisé par l'infrastructure pour créer une instance dynamique de ce type de classe.|  
|[CMFCToolBarButton::EnableWindow](#enablewindow)|Active ou désactive les entrées de souris et de clavier.|  
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|Copie le texte à partir du bouton de barre d’outils à un menu.|  
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|Récupère le format de Presse-papiers global de l’application.|  
|[CMFCToolBarButton::GetHwnd](#gethwnd)|Récupère le handle de fenêtre qui est associé au bouton de barre d’outils.|  
|[CMFCToolBarButton::GetImage](#getimage)|Récupère l’index de l’image du bouton.|  
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|Récupère la région de la zone cliente du bouton qui doit être redessiné.|  
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|Récupère la fenêtre parent du bouton.|  
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.|  
|[CMFCToolBarButton::GetTextSize](#gettextsize)|Récupère la taille du texte du bouton.|  
|[CMFCToolBarButton::HasFocus](#hasfocus)|Détermine si le bouton a le focus d’entrée actuel.|  
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|Détermine si une bordure du bouton s’affiche lorsqu’un utilisateur sélectionne le bouton.|  
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|Détermine si une image est affichée sur le bouton.|  
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|Détermine si une étiquette de texte est affichée sur le bouton.|  
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|Détermine si le bouton affiche un sous-menu.|  
|[CMFCToolBarButton::IsEditable](#iseditable)|Détermine si le bouton peut être personnalisé.|  
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|Détermine si le bouton peut être affiché avec une bordure étendue.|  
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|Détermine si le bouton est dans la première position dans son groupe.|  
|[CMFCToolBarButton::IsHidden](#ishidden)|Détermine si le bouton est masqué.|  
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|Détermine si le bouton se trouve sur une barre horizontale.|  
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|Spécifie si le bouton est à la dernière position dans son groupe.|  
|[CMFCToolBarButton::IsLocked](#islocked)|Détermine si le bouton est une barre d’outils (non personnalisable) verrouillé.|  
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|Détermine si le bouton est le propriétaire du handle de fenêtre fourni.|  
|[CMFCToolBarButton::IsVisible](#isvisible)|Détermine si le bouton de barre d’outils est visible.|  
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|Détermine si le handle de fenêtre sous-jacent du bouton est visible.|  
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|Spécifie si le bouton traite la [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) message.|  
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|Appelé par l’infrastructure lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.|  
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|Spécifie si le bouton peut être déplacé.|  
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|Spécifie si un utilisateur peut supprimer le bouton sur la barre d’outils cible.|  
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique spécifié et l’état d’ancrage.|  
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|Appelé par l’infrastructure pour gérer la [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) message.|  
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|Appelé par l’infrastructure lorsque le bouton est inséré dans une barre d’outils.|  
|[CMFCToolBarButton::OnClick](#onclick)|Appelé par l’infrastructure lorsque l’utilisateur clique sur le bouton de la souris.|  
|[CMFCToolBarButton::OnClickUp](#onclickup)|Appelé par l’infrastructure lorsque l’utilisateur relâche le bouton de la souris.|  
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|Appelé par l’infrastructure lors de la barre d’outils parent gère un `WM_HELPHITTEST` message.|  
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|Appelé par l’infrastructure lors de la barre d’outils parent gère un `WM_CTLCOLOR` message.|  
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|Permet le bouton Modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parent.|  
|[CMFCToolBarButton::OnDblClk](#ondblclk)|Appelé par l’infrastructure lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) message.|  
|[CMFCToolBarButton::OnDraw](#ondraw)|Appelée par l’infrastructure pour dessiner le bouton en utilisant les options et les styles spécifiés.|  
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Appelé par l’infrastructure pour dessiner le bouton dans le **commandes** volet de la **personnaliser** boîte de dialogue.|  
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|Appelé par l’infrastructure pour récupérer le texte info-bulle personnalisée pour le bouton.|  
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|Appelé par l’infrastructure lorsque la police globale a été modifiée.|  
|[CMFCToolBarButton::OnMove](#onmove)|Appelé par l’infrastructure lorsque la barre d’outils parent se déplace.|  
|[CMFCToolBarButton::OnShow](#onshow)|Appelé par l’infrastructure lorsque le bouton est visible ou invisible.|  
|[CMFCToolBarButton::OnSize](#onsize)|Appelé par l’infrastructure lors de la barre d’outils parent change sa taille ou la position et cette modification nécessite le bouton pour modifier la taille.|  
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|Appelé par l’infrastructure lors de la barre d’outils parent doit déterminer si un point est dans le rectangle englobant du bouton.|  
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|Appelé par l’infrastructure lors de la barre d’outils parent met à jour son texte d’info-bulle.|  
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|Appelé par l’infrastructure lorsque le bouton est sur le point d’effectuer une opération de glisser-déplacer.|  
|[CMFCToolBarButton::Rect](#rect)|Récupère le rectangle englobant du bouton.|  
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|Définit la valeur par défaut de l’image qui est associée au bouton.|  
|[CMFCToolBarButton::SaveBarState](#savebarstate)|Enregistre l’état du bouton de barre d’outils.|  
|[CMFCToolBarButton::Serialize](#serialize)|Lit de cet objet dans une archive ou écrit dans une archive. (Substitue [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).)|  
|[CMFCToolBarButton::SetACCData](#setaccdata)|Remplit les `CAccessibilityData` avec accessibilité des données à partir du bouton de barre d’outils.|  
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|Renomme le format de Presse-papiers global.|  
|[CMFCToolBarButton::SetImage](#setimage)|Définit l’index de l’image du bouton.|  
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.|  
|[CMFCToolBarButton::SetRadio](#setradio)|Appelé par l’infrastructure lorsqu’un bouton modifie son état d’activation.|  
|[CMFCToolBarButton::SetRect](#setrect)|Définit le rectangle englobant du bouton.|  
|[CMFCToolBarButton::SetStyle](#setstyle)|Définit le style du bouton.|  
|[CMFCToolBarButton::SetVisible](#setvisible)|Spécifie si le bouton est visible.|  
|[CMFCToolBarButton::Show](#show)|Affiche ou masque le bouton.|  
  
### <a name="data-members"></a>Membres de données  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCToolBarButton::m_bImage](#m_bimage)|Spécifie si une image est affichée sur le bouton.|  
|[CMFCToolBarButton::m_bText](#m_btext)|Spécifie si une étiquette est affichée sur le bouton.|  
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|Spécifie si l’étiquette de texte s’affiche sous l’image sur le bouton.|  
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|Spécifie si le bouton possède une image définie par l’utilisateur.|  
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|Spécifie si le bouton affiche son étiquette de texte intégral, même si elle ne tient pas dans le rectangle englobant.|  
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|Spécifie si le bouton en regard d’un séparateur sera placé sur la ligne suivante.|  
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|Spécifie si les étiquettes de texte de plusieurs lignes sont activées.|  
|[CMFCToolBarButton::m_nID](#m_nid)|L’ID de commande du bouton.|  
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|Le style du bouton.|  
|[CMFCToolBarButton::m_strText](#m_strtext)|L’étiquette de texte du bouton.|  
  
## <a name="remarks"></a>Remarques  
 Un `CMFCToolbarButton` objet est un contrôle qui se trouve sur une barre d’outils. Son comportement semblable à celui d’un bouton ordinaire. Vous pouvez affecter une image et une étiquette à cet objet. Un bouton de barre d’outils peut également avoir un ID de commande. Lorsque l’utilisateur clique sur le bouton de barre d’outils, l’infrastructure exécute la commande qui spécifie ce code.  
  
 En règle générale, les boutons de barre d’outils peuvent être personnalisés : l’utilisateur peut faire glisser des boutons d’une barre d’outils vers un autre, copier, coller, supprimer et modifier les étiquettes de texte et des images. Pour empêcher l’utilisateur de personnaliser la barre d’outils, vous pouvez verrouiller la barre d’outils de deux manières. Définir le `bLocked` indicateur `TRUE` lorsque vous appelez [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar), ou ajoutez l’ID de commande de des boutons à la liste globale des commandes protégés à l’aide de la [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) (méthode).  
  
 `CMFCToolBarButton`objets affichent des images à partir des collections globales des images de barre d’outils dans l’application. Ces collections sont gérées par la barre d’outils parent, [CMFCToolBar classe](../../mfc/reference/cmfctoolbar-class.md). Pour plus d’informations, consultez [CMFCToolBarImages classe](../../mfc/reference/cmfctoolbarimages-class.md).  
  
 Lorsque l’utilisateur clique sur un bouton de barre d’outils, la barre d’outils parent traite le message de la souris et communique les mesures appropriées pour le bouton. Si le bouton a un ID de commande valide, le parent envoie les `WM_COMMAND` message vers le frame parent.  
  
 Le `CMFCToolBarButton` classe est la classe de base pour d’autres classes de bouton de barre d’outils, tels que [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md), [CMFCToolBarEditBoxButton classe](../../mfc/reference/cmfctoolbareditboxbutton-class.md), et [CMFCToolBarComboBoxButton classe](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).  
  
## <a name="example"></a>Exemple  
 L’exemple suivant montre comment configurer un `CMFCToolBarButton` à l’aide de différentes méthodes dans la `CMFCToolBarButton` classe. L’exemple montre comment activer la souris et l’entrée au clavier, définir l’index de l’image du bouton Définir le rectangle englobant du bouton et que le bouton soit visible. Cet extrait de code fait partie de la [exemple de contrôle onglet](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_TabControl n °&1;](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]  
[!code-cpp[NVC_MFC_TabControl n °&2;](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Hiérarchie d’héritage  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  
  
## <a name="requirements"></a>Spécifications  
 **En-tête :** afxtoolbarbutton.h  
  
##  <a name="canbedropped"></a>CMFCToolBarButton::CanBeDropped  
 Spécifie si un utilisateur peut placer un bouton dans un menu ou une barre d’outils pendant la personnalisation.  
  
```  
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pToolbar`  
 Non utilisé.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `TRUE`.  
  
### <a name="remarks"></a>Remarques  
 Par défaut, un bouton de barre d’outils peut être déposé sur chaque personnalisable (c'est-à-dire, non verrouillée) barre d’outils.  
  
 L’implémentation par défaut de cette méthode retourne `TRUE`. Substituez cette méthode et renvoyer `FALSE` si vous souhaitez empêcher l’utilisateur de repositionner le bouton.  
  
##  <a name="canbestored"></a>CMFCToolBarButton::CanBeStored  
 Détermine si le bouton peut être stocké.  
  
```  
virtual BOOL CanBeStored() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `TRUE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure utilise cette méthode pour déterminer si le bouton peut participer à une opération de glisser-déplacer.  
  
 L'implémentation par défaut retourne la valeur `TRUE`. Substituez cette méthode si votre bouton ne peut pas être stocké en tant que partie d’une opération de glisser-déplacer. Pour plus d’informations sur les opérations de glisser-déplacer, consultez [glisser-déplacer (OLE)](../../mfc/drag-and-drop-ole.md).  
  
##  <a name="canbestretched"></a>CMFCToolBarButton::CanBeStretched  
 Spécifie si un utilisateur peut étendre le bouton pendant la personnalisation.  
  
```  
virtual BOOL CanBeStretched() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode est utilisée par l’infrastructure pour déterminer si le bouton peut être étiré dans le mode de personnalisation.  
  
 L’implémentation par défaut de cette méthode retourne `FALSE`. Substituez cette méthode pour retourner `TRUE` pour un contrôle de largeur variable tel qu’une zone de liste déroulante ou d’un curseur.  
  
 Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).  
  
##  <a name="cmfctoolbarbutton"></a>CMFCToolBarButton::CMFCToolBarButton  
 Construit et initialise un objet `CMFCToolBarButton`.  
  
```  
CMFCToolBarButton(
    UINT uiID,  
    int iImage,  
    LPCTSTR lpszText=NULL,  
    BOOL bUserButton=FALSE,  
    BOOL bLocked=FALSE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `uiID`  
 L’ID de commande du bouton.  
  
 [in] `iImage`  
 L’index de l’image du bouton dans la collection d’images.  
  
 [in] `lpszText`  
 L’étiquette de texte du bouton. Peut être `NULL`.  
  
 [in] `bUserButton`  
 Valeur booléenne qui détermine si le bouton est défini par l’utilisateur. Si ce paramètre est `TRUE`, le bouton est défini par l’utilisateur. Dans le cas contraire, l’image du bouton est chargé à partir d’une ressource.  
  
 [in] `bLocked`  
 Valeur booléenne qui détermine si le bouton peut être personnalisé. Si ce paramètre est `TRUE`, le bouton ne peut pas être personnalisé. Dans le cas contraire, le bouton peut être personnalisé.  
  
##  <a name="comparewith"></a>CMFCToolBarButton::CompareWith  
 Compare cette instance avec le paramètre `CMFCToolBarButton` objet.  
  
```  
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `other`  
 Référence à l’objet à comparer à cette instance.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’objet fourni est égal à la valeur de cette instance ; Sinon, 0.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut détermine si l’ID de commande de l’objet fourni est égal à l’ID de commande de cette instance. Substituez cette méthode si vous devez effectuer un traitement supplémentaire pour déterminer si deux `CMFCToolBarButton` objets sont égaux.  
  
##  <a name="copyfrom"></a>CMFCToolBarButton::CopyFrom  
 Copie les propriétés d’un autre bouton de barre d’outils sur le bouton en cours.  
  
```  
virtual void CopyFrom(const CMFCToolBarButton& src);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `src`  
 Une référence au bouton source à partir duquel copier.  
  
### <a name="remarks"></a>Remarques  
 Appelez cette méthode pour copier un autre bouton de barre d’outils sur ce bouton de barre d’outils.  
  
##  <a name="createfromoledata"></a>CMFCToolBarButton::CreateFromOleData  
 Crée un `CMFCToolBarButton` objet fourni `COleDataObject` objet.  
  
```  
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pDataObject`  
 L’objet de données source OLE.  
  
### <a name="return-value"></a>Valeur de retour  
 Objet `CMFCToolBarButton` créé.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode est utilisée par l’infrastructure pour effectuer le transfert de données dans différents formats. Par exemple, le `CMFCOutlookBarPane::OnDragOver` méthode utilise cette méthode pour effectuer des opérations de glisser-déplacer.  
  
##  <a name="enablewindow"></a>CMFCToolBarButton::EnableWindow  
 Active ou désactive les entrées de souris et de clavier.  
  
```  
virtual void EnableWindow(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bEnable`  
 Définissez ce paramètre sur `TRUE` pour activer l’entrée, ou à `FALSE` désactiver l’entrée.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode appelle la `EnableWindow` fonction pour activer ou désactiver l’entrée. Pour plus d’informations, consultez [EnableWindow](http://msdn.microsoft.com/library/windows/desktop/ms646291) dans les [!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)].  
  
##  <a name="exporttomenubutton"></a>CMFCToolBarButton::ExportToMenuButton  
 Copie le texte à partir du bouton de barre d’outils à un menu.  
  
```  
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `menuButton`  
 Une référence au bouton de menu cible.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `TRUE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour copier le texte à partir d’un bouton de barre d’outils à un bouton de menu. L’implémentation par défaut copie l’étiquette de texte du bouton. Si l’étiquette de texte est vide, cette méthode copie le texte d’info-bulle du bouton.  
  
 L’implémentation par défaut de cette méthode retourne `TRUE`. Substituez cette méthode si vous souhaitez exécuter des actions supplémentaires lorsque l’infrastructure convertit un objet qui est dérivé de [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) à un bouton de menu.  
  
##  <a name="getclipboardformat"></a>CMFCToolBarButton::GetClipboardFormat  
 Récupère le format de Presse-papiers global de l’application.  
  
```  
static CLIPFORMAT __stdcall GetClipboardFormat();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Global `CLIPFORMAT` valeur pour l’application.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour récupérer le format de Presse-papiers pour les opérations de transfert de données OLE. Par exemple, le [CMFCToolBarButton::CreateFromOleData](#createfromoledata) méthode utilise cette méthode pour copier les données d’un objet de données source OLE.  
  
 Cette méthode définit global `CLIPFORMAT` valeur de la première fois que cette méthode est appelée. Cette valeur de retour de tous les appels suivants à cette méthode.  
  
 Pour que les opérations de glisser-déplacer entre applications, appelez le [CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname) (méthode).  
  
 Pour plus d’informations sur le Presse-papiers dans MFC, consultez [Presse-papiers](../../mfc/clipboard.md).  
  
##  <a name="gethwnd"></a>CMFCToolBarButton::GetHwnd  
 Récupère le handle de fenêtre qui est associé au bouton de barre d’outils.  
  
```  
virtual HWND GetHwnd();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Le handle de fenêtre qui est associé au bouton de barre d’outils ou `NULL` si le bouton de barre d’outils ne comporte aucun handle de fenêtre associée.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode retourne `NULL`. Substituez cette méthode pour retourner le handle de fenêtre de votre contrôle spécifique.  
  
##  <a name="getimage"></a>CMFCToolBarButton::GetImage  
 Récupère l’index de l’image du bouton.  
  
```  
int GetImage() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Index de l’image associée à ce bouton.  
  
### <a name="remarks"></a>Remarques  
 Si le bouton possède une image définie par l’utilisateur (autrement dit, si `bUserButton` a `TRUE` dans le constructeur), l’index retourné spécifie une image dans la collection d’images défini par l’utilisateur (voir [CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). Dans le cas contraire, l’index spécifie une image dans la collection d’images qui sont chargés à partir d’un fichier de ressources (voir [CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Pour plus d’informations sur les fichiers de ressources, consultez [utilisation de fichiers de ressources](../../windows/working-with-resource-files.md).  
  
##  <a name="getinvalidaterect"></a>CMFCToolBarButton::GetInvalidateRect  
 Récupère la région de la zone cliente du bouton qui doit être redessiné.  
  
```  
virtual const CRect GetInvalidateRect() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un `CRect` objet qui spécifie la région qui doit être redessinée.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode retourne toute la zone cliente. Substituez cette méthode si vous souhaitez une autre zone à redessiner.  
  
##  <a name="getparentwnd"></a>CMFCToolBarButton::GetParentWnd  
 Récupère la fenêtre parent du bouton.  
  
```  
CWnd* GetParentWnd() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 La fenêtre parent du bouton.  
  
##  <a name="getprotectedcommands"></a>CMFCToolBarButton::GetProtectedCommands  
 Récupère la liste des commandes que l’utilisateur ne peut pas personnaliser.  
  
```  
static const CList<UINT,UINT>& GetProtectedCommands();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La liste des commandes protégés.  
  
### <a name="remarks"></a>Notes  
 Dans le mode de personnalisation, le framework désactive les commandes de bouton de barre d’outils qui sont protégés. L’utilisateur ne peut pas effectuer de glisser-déplacer et modifier des opérations sur les boutons de barre d’outils désactivés.  
  
 Utilisez le [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) méthode pour définir la liste de protégée des commandes.  
  
##  <a name="gettextsize"></a>CMFCToolBarButton::GetTextSize  
 Récupère la taille du texte du bouton.  
  
```  
SIZE GetTextSize() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un `SIZE` objet qui contient la taille, en pixels, du texte du bouton.  
  
##  <a name="hasfocus"></a>CMFCToolBarButton::HasFocus  
 Détermine si le bouton a le focus d’entrée actuel.  
  
```  
virtual BOOL HasFocus() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton a le focus d’entrée ; sinon 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut de cette méthode retourne zéro si le bouton a le focus d’entrée ou une fenêtre enfant ou un descendant de la fenêtre qui a le focus d’entrée. Vous pouvez remplacer cette fonction pour personnaliser ce comportement.  
  
##  <a name="havehotborder"></a>CMFCToolBarButton::HaveHotBorder  
 Détermine si une bordure du bouton s’affiche lorsqu’un utilisateur sélectionne le bouton.  
  
```  
virtual BOOL HaveHotBorder() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `TRUE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour déterminer si le bouton de barre d’outils doit afficher sa bordure lorsqu’un utilisateur le sélectionne.  
  
 L'implémentation par défaut retourne la valeur `TRUE`. Vous pouvez substituer cette méthode pour personnaliser ce comportement.  
  
##  <a name="isdrawimage"></a>CMFCToolBarButton::IsDrawImage  
 Détermine si une image est affichée sur le bouton.  
  
```  
BOOL IsDrawImage() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si une image est affichée sur le bouton ; sinon 0.  
  
### <a name="remarks"></a>Notes  
 Cette méthode retourne `FALSE` si le bouton de barre d’outils n’a aucune image associée ( [CMFCToolBarButton::GetImage](#getimage) retourne -1) ou si [CMFCToolBarButton::m_bImage](#m_bimage) est défini sur `FALSE`.  
  
##  <a name="isdrawtext"></a>CMFCToolBarButton::IsDrawText  
 Détermine si une étiquette de texte est affichée sur le bouton.  
  
```  
BOOL IsDrawText() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si une étiquette de texte s’affiche. sinon 0.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode retourne `FALSE` si le bouton de barre d’outils n’a aucune étiquette de texte associée ( [CMFCToolBarButton::m_strText](#m_strtext) est vide) ou [CMFCToolBarButton::m_bText](#m_btext) est défini sur `FALSE`.  
  
##  <a name="isdroppeddown"></a>CMFCToolBarButton::IsDroppedDown  
 Détermine si le bouton affiche un sous-menu.  
  
```  
virtual BOOL IsDroppedDown() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode retourne `FALSE`. Substituez cette méthode pour retourner `TRUE` si votre contrôle affiche un sous-menu.  
  
##  <a name="iseditable"></a>CMFCToolBarButton::IsEditable  
 Détermine si le bouton peut être personnalisé.  
  
```  
virtual BOOL IsEditable() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un bouton peut être personnalisé par l’utilisateur ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide de glisser-déplacer ou modifier des opérations.  
  
 L’implémentation par défaut retourne `FALSE` si l’ID de commande du bouton est une commande standard (vous pouvez le déterminer en appelant le `IsStandardCommand` fonction) ou si la commande ID figure dans la liste de protégé des commandes. Pour plus d’informations sur les commandes protégés, consultez [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) et [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands).  
  
 Substituez cette méthode pour personnaliser son comportement.  
  
##  <a name="isextrasize"></a>CMFCToolBarButton::IsExtraSize  
 Détermine si le bouton peut être affiché avec une bordure étendue.  
  
```  
virtual BOOL IsExtraSize() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton de barre d’outils peut être affiché avec une bordure étendue ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 Plusieurs apparences utilisent taille supplémentaire pour les bordures des boutons de barre d’outils (par exemple, les boutons arrondis).  
  
 Si l’utilisateur déplace ce bouton à partir d’une barre d’outils vers un autre, l’infrastructure appelle la [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) (méthode). Le [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) méthode définit l’indicateur de taille supplémentaire à celui de la nouvelle barre d’outils parent (pour plus d’informations, consultez [CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).  
  
##  <a name="isfirstingroup"></a>CMFCToolBarButton::IsFirstInGroup  
 Détermine si le bouton est dans la première position dans son groupe.  
  
```  
virtual BOOL IsFirstInGroup() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le bouton est le premier bouton dans son groupe ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Notes  
 Cette méthode définit un *groupe* comme un ensemble de voisinage de boutons qui sont placés sur la même ligne et comportent des séparateurs ou de la bordure de la barre d’outils. Cette méthode retourne `FALSE` si le bouton de barre d’outils fait référence à la **personnaliser** bouton. Pour plus d’informations sur la **personnaliser** bouton, consultez [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).  
  
 Appelez le [CMFCToolBarButton::IsLastInGroup](#islastingroup) méthode pour déterminer si le bouton est à la dernière position dans son groupe.  
  
##  <a name="ishidden"></a>CMFCToolBarButton::IsHidden  
 Détermine si le bouton est masqué.  
  
```  
BOOL IsHidden() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton est masqué (invisible) ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode lorsque la barre d’outils parent est étirée pour déterminer si le bouton de barre d’outils est visible.  
  
 Si vous définissez le bouton soit invisible à l’aide de la [CMFCToolBarButton::SetVisible](#setvisible) méthode, utilisez [CMFCToolBarButton::IsVisible](#isvisible) pour déterminer si le bouton de barre d’outils est visible.  
  
 Par défaut, tous les boutons de barre d’outils sont visibles. Utilisez le [CMFCToolBarButton::Show](#show) méthode pour masquer ou afficher des boutons de barre d’outils.  
  
##  <a name="ishorizontal"></a>CMFCToolBarButton::IsHorizontal  
 Détermine si le bouton se trouve sur une barre horizontale.  
  
```  
BOOL IsHorizontal() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un bouton de barre d’outils se trouve sur une barre d’outils horizontale ; sinon 0.  
  
### <a name="remarks"></a>Notes  
 L’infrastructure appelle cette méthode pour déterminer la disposition des boutons de barre d’outils.  
  
 Cette méthode retourne le `m_bHorz` membre de données. La valeur par défaut de la `m_bHorz` membre de données est `TRUE`; il est réinitialisé à chaque appel à la [CMFCToolBarButton::OnDraw](#ondraw) (méthode).  
  
##  <a name="islastingroup"></a>CMFCToolBarButton::IsLastInGroup  
 Spécifie si le bouton est à la dernière position dans son groupe.  
  
```  
virtual BOOL IsLastInGroup() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le bouton est le dernier bouton dans son groupe ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Notes  
 Cette méthode définit un *groupe* comme un ensemble de voisinage de boutons qui sont placés sur la même ligne et comportent des séparateurs ou de la bordure de la barre d’outils, cette méthode retourne `FALSE` si le bouton de barre d’outils n’a aucune barre d’outils parent ou le bouton de barre d’outils fait référence à la **personnaliser** bouton. Pour plus d’informations sur la **personnaliser** bouton, consultez [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).  
  
 Appelez le [CMFCToolBarButton::IsFirstInGroup](#isfirstingroup) méthode pour déterminer si le bouton est dans la première position dans son groupe.  
  
##  <a name="islocked"></a>CMFCToolBarButton::IsLocked  
 Détermine si le bouton est une barre d’outils (non personnalisable) verrouillé.  
  
```  
BOOL IsLocked() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton de barre d’outils verrouillées ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour déterminer si l’utilisateur peut personnaliser le bouton de barre d’outils à l’aide de glisser-déplacer ou modifier des opérations. Définissez l’attribut verrouillé dans la barre d’outils parent à l’aide de la [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) (méthode). L’infrastructure transmet la valeur de cet attribut au constructeur de chaque bouton de barre d’outils ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) insérés dans la barre d’outils parent.  
  
##  <a name="isownerof"></a>CMFCToolBarButton::IsOwnerOf  
 Détermine si le bouton est le propriétaire du handle de fenêtre fourni.  
  
```  
virtual BOOL IsOwnerOf(HWND hwnd);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `hwnd`  
 Un handle de fenêtre.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton est le propriétaire du handle de fenêtre fourni ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode retourne zéro si `hwnd` fait référence au handle de fenêtre directe ou est un enfant de handle de fenêtre qui est associé au bouton. Cette méthode retourne 0 si `hwnd` est `NULL`.  
  
##  <a name="isvisible"></a>CMFCToolBarButton::IsVisible  
 Détermine si le bouton de barre d’outils est visible.  
  
```  
BOOL IsVisible() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le bouton de barre d’outils est visible ; sinon 0.  
  
### <a name="remarks"></a>Notes  
 Vous pouvez afficher ou masquer le bouton de barre d’outils à l’aide de la [CMFCToolBarButton::SetVisible](#setvisible) (méthode). Appelez le [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) méthode sur la barre d’outils parent après l’appel de [CMFCToolBarButton::SetVisible](#setvisible) pour recalculer la disposition d’une barre d’outils parent.  
  
##  <a name="iswindowvisible"></a>CMFCToolBarButton::IsWindowVisible  
 Détermine si le handle de fenêtre sous-jacent du bouton est visible.  
  
```  
virtual BOOL IsWindowVisible();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le handle de fenêtre sous-jacent du bouton est visible ; sinon 0.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode retourne zéro si l’attribut de styles de handle de fenêtre sous-jacent contient le `WS_VISIBLE` style. Cette méthode retourne `FALSE` si le handle de fenêtre sous-jacent du bouton est `NULL`.  
  
##  <a name="m_bimage"></a>CMFCToolBarButton::m_bImage  
 Spécifie si une image est affichée sur le bouton.  
  
```  
BOOL m_bImage;  
```  
  
### <a name="remarks"></a>Remarques  
 Si ce membre de données est défini sur `TRUE`, le framework affiche l’image qui est associé au bouton de barre d’outils ; sinon, le framework n’affiche pas l’image. Ce membre a une incidence sur la valeur de retour de la [CMFCToolBarButton::m_bImage](#m_bimage) (méthode).  
  
##  <a name="m_btext"></a>CMFCToolBarButton::m_bText  
 Spécifie si une étiquette est affichée sur le bouton.  
  
```  
BOOL m_bText;  
```  
  
### <a name="remarks"></a>Remarques  
 Si ce membre de données est défini sur `TRUE`, le framework affiche l’étiquette de texte du bouton de barre d’outils ; sinon, le framework n’affiche pas l’étiquette de texte. Ce membre a une incidence sur la valeur de retour de la [CMFCToolBarButton::m_bText](#m_btext) (méthode).  
  
##  <a name="m_btextbelow"></a>CMFCToolBarButton::m_bTextBelow  
 Spécifie si l’étiquette de texte s’affiche sous l’image sur le bouton.  
  
```  
BOOL m_bTextBelow;  
```  
  
### <a name="remarks"></a>Remarques  
 Si cette variable membre est définie sur `TRUE`, le framework affiche le texte du bouton sous l’image. La valeur par défaut de ce membre est `FALSE`.  
  
##  <a name="m_buserbutton"></a>CMFCToolBarButton::m_bUserButton  
 Spécifie si le bouton possède une image définie par l’utilisateur  
  
```  
BOOL m_bUserButton;  
```  
  
### <a name="remarks"></a>Remarques  
 Ce membre de données a la valeur `TRUE` lorsque le bouton a une image définie par l’utilisateur associée.  
  
##  <a name="m_bwholetext"></a>CMFCToolBarButton::m_bWholeText  
 Spécifie si le bouton affiche son étiquette de texte intégral, même si elle ne tient pas dans le rectangle englobant.  
  
```  
BOOL m_bWholeText;  
```  
  
### <a name="remarks"></a>Notes  
 Si ce membre de données est défini sur `TRUE`, le framework affiche l’étiquette de texte intégral par en augmentant la taille du bouton. Sinon, le framework tronque et ajoute les points de suspension ( **... **) à l’étiquette de texte.  
  
##  <a name="m_bwrap"></a>CMFCToolBarButton::m_bWrap  
 Spécifie si le bouton en regard d’un séparateur sera placé sur la ligne suivante.  
  
```  
BOOL m_bWrap;  
```  
  
### <a name="remarks"></a>Notes  
 L’infrastructure définit ce membre de données `TRUE` lorsque le bouton de barre d’outils ne tient pas sur la ligne actuelle ou lorsque vous spécifiez une mise en page (par exemple, un nombre spécifique de boutons de barre d’outils par ligne).  
  
 L’infrastructure place ce bouton sur la ligne suivante si ce membre de données est défini sur `TRUE` et la barre d’outils est ancrée horizontalement ou flottant.  
  
 La valeur par défaut de ce membre de données est `FALSE`.  
  
##  <a name="m_bwraptext"></a>CMFCToolBarButton::m_bWrapText  
 Spécifie si les étiquettes de texte de plusieurs lignes sont activées.  
  
```  
AFX_IMPORT_DATA static BOOL m_bWrapText;  
```  
  
### <a name="remarks"></a>Remarques  
 Si cette variable membre statique est `TRUE`, l’infrastructure permet de toutes les barres d’outils afficher les étiquettes de texte multiligne sur les boutons de barre d’outils.  
  
 La valeur par défaut de ce membre de données est `FALSE`.  
  
##  <a name="m_nid"></a>CMFCToolBarButton::m_nID  
 L’ID de commande du bouton.  
  
```  
UINT m_nID;  
```  
  
### <a name="remarks"></a>Remarques  
 ID de commande de -1 indique que le bouton est un séparateur. Tous les séparateurs de boutons ont les `TBBS_SEPARATOR` style. Consultez la page [CMFCToolBarButton::m_nStyle](#m_nstyle) pour plus d’informations sur les styles de bouton.  
  
##  <a name="m_nstyle"></a>CMFCToolBarButton::m_nStyle  
 Le style du bouton.  
  
```  
UINT m_nStyle;  
```  
  
### <a name="remarks"></a>Notes  
 Consultez la page [les Styles de contrôle de barre d’outils](../../mfc/reference/toolbar-control-styles.md) pour la liste des styles de bouton de barre d’outils disponibles.  
  
##  <a name="m_strtext"></a>CMFCToolBarButton::m_strText  
 L’étiquette de texte du bouton.  
  
```  
CString m_strText;  
```  
  
### <a name="remarks"></a>Remarques  
 Ce membre de données contient l’étiquette de texte du bouton. L’étiquette de texte peut être vide.  
  
##  <a name="notifycommand"></a>CMFCToolBarButton::NotifyCommand  
 Spécifie si le bouton traite la [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) message.  
  
```  
virtual BOOL NotifyCommand(int iNotifyCode);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iNotifyCode`  
 Le message de notification qui est associé à la commande.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode lorsqu’il doit envoyer un [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) message de la fenêtre parente.  
  
 Par défaut, cette méthode retourne `FALSE`. Substituez cette méthode pour retourner `TRUE` si vous souhaitez traiter les `WM_COMMAND` message ou `FALSE` pour indiquer que la barre d’outils parent doit traiter le message.  
  
##  <a name="onaddtocustomizepage"></a>CMFCToolBarButton::OnAddToCustomizePage  
 Appelé par l’infrastructure lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.  
  
```  
virtual void OnAddToCustomizePage();
```  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez effectuer une action lorsque le bouton est ajouté à un **personnaliser** boîte de dialogue.  
  
##  <a name="onbeforedrag"></a>CMFCToolBarButton::OnBeforeDrag  
 Spécifie si le bouton peut être déplacé.  
  
```  
virtual BOOL OnBeforeDrag() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le bouton peut être déplacé ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode avant que l’utilisateur commence à faire glisser le bouton.  
  
 L’implémentation par défaut de cette méthode retourne `TRUE`. Substituez cette méthode pour retourner `FALSE` pour désactiver le glissement du bouton.  
  
##  <a name="onbeforedrop"></a>CMFCToolBarButton::OnBeforeDrop  
 Spécifie si un utilisateur peut supprimer le bouton sur la barre d’outils cible.  
  
```  
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pTarget`  
 La cible de l’opération de glisser-déplacer.  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le bouton peut être déposé sur la barre d’outils cible fourni ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode avant que le bouton est déposé sur une barre d’outils.  
  
 L’implémentation par défaut de cette méthode retourne `TRUE`. Substituez cette méthode pour retourner `FALSE` pour désactiver l’opération de suppression sur la cible spécifiée.  
  
##  <a name="oncalculatesize"></a>CMFCToolBarButton::OnCalculateSize  
 Appelé par l’infrastructure pour calculer la taille du bouton pour le contexte de périphérique spécifié et l’état d’ancrage.  
  
```  
virtual SIZE OnCalculateSize(
    CDC* pDC,  
    const CSize& sizeDefault,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pDC`  
 Le contexte de périphérique qui affiche le bouton.  
  
 [in] `sizeDefault`  
 La taille par défaut du bouton.  
  
 [in] `bHorz`  
 L’état d’ancrage de la barre d’outils parent. Ce paramètre est `TRUE` si la barre d’outils est ancrée horizontalement ou est flottant, ou `FALSE` si la barre d’outils est ancrée verticalement.  
  
### <a name="return-value"></a>Valeur de retour  
 Un `SIZE` structure qui contient les dimensions du bouton, en pixels.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour déterminer la taille du bouton de barre d’outils pour le contexte de périphérique spécifié et l’état d’ancrage.  
  
 L’implémentation par défaut prend en compte l’état d’ancrage de la barre d’outils, les positions text et image (le texte au-dessous ou à droite de l’image) et la taille de texte et image (si elles sont affichées).  
  
 Substituez cette méthode si vous souhaitez fournir la taille d’un bouton non standard (par exemple, un bouton de la zone Modifier).  
  
##  <a name="oncancelmode"></a>CMFCToolBarButton::OnCancelMode  
 Appelé par l’infrastructure pour gérer la [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) message.  
  
```  
virtual void OnCancelMode();
```  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode si vous souhaitez gérer les [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) message.  
  
##  <a name="onchangeparentwnd"></a>CMFCToolBarButton::OnChangeParentWnd  
 Appelé par l’infrastructure lorsque le bouton est inséré dans une barre d’outils.  
  
```  
virtual void OnChangeParentWnd(CWnd* pWndParent);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWndParent`  
 La nouvelle fenêtre parent.  
  
### <a name="remarks"></a>Notes  
 Le bouton est inséré dans une barre d’outils, par exemple, lorsque l’utilisateur fait glisser à partir d’une barre d’outils vers une autre barre d’outils.  
  
 L’implémentation par défaut de cette méthode ne fait rien.  
  
##  <a name="onclick"></a>CMFCToolBarButton::OnClick  
 Appelé par l’infrastructure lorsque l’utilisateur clique sur le bouton de la souris.  
  
```  
virtual BOOL OnClick(
    CWnd* pWnd,  
    BOOL bDelay=TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWnd`  
 La fenêtre parente de la barre d’outils.  
  
 [in] `bDelay`  
 `TRUE`Si le message doit être géré avec un délai.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode lorsque l’utilisateur clique sur le bouton de barre d’outils.  
  
 L’implémentation par défaut ne fait rien et retourne `FALSE`. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message de clic.  
  
##  <a name="onclickup"></a>CMFCToolBarButton::OnClickUp  
 Appelé par l’infrastructure lorsque l’utilisateur relâche le bouton de la souris.  
  
```  
virtual BOOL OnClickUp();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode lorsque l’utilisateur relâche le bouton de barre d’outils.  
  
 L’implémentation par défaut ne fait rien et retourne `FALSE`. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message de clic.  
  
##  <a name="oncontexthelp"></a>CMFCToolBarButton::OnContextHelp  
 Appelé par l’infrastructure lors de la barre d’outils parent gère un `WM_HELPHITTEST` message.  
  
```  
virtual BOOL OnContextHelp(CWnd* pWnd);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWnd`  
 La fenêtre parente de la barre d’outils.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien et retourne `FALSE`. Substituez cette méthode pour retourner une valeur différente de zéro si le bouton traite le message d’aide.  
  
 Pour plus d’informations sur la `WM_HELPHITTEST` de messages, consultez [TN028 : prise en charge d’aide contextuelle](../../mfc/tn028-context-sensitive-help-support.md).  
  
##  <a name="onctlcolor"></a>CMFCToolBarButton::OnCtlColor  
 Appelé par l’infrastructure lors de la barre d’outils parent gère un `WM_CTLCOLOR` message.  
  
```  
virtual HBRUSH OnCtlColor(
    CDC* pDC,  
    UINT nCtlColor);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pDC`  
 Le contexte de périphérique qui affiche le bouton.  
  
 [in] `nCtlColor`  
 La notification de couleur spécifique.  
  
### <a name="return-value"></a>Valeur de retour  
 Handle vers l’objet brush par le framework pour peindre l’arrière-plan du bouton.  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode lorsque la barre d’outils parent traite le `WM_CTLCOLOR` message pour un bouton de barre d’outils qui contient un contrôle Windows. Le framework n’appelle pas cette méthode si le bouton de barre d’outils est sans fenêtre.  
  
 L’infrastructure appelle cette méthode lorsque l’infrastructure de la barre d’outils dans le mode de personnalisation et le bouton de barre d’outils est déverrouillé. Pour plus d’informations sur le mode de personnalisation, consultez [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Pour plus d’informations sur le verrouillage des boutons de barre d’outils, consultez [CMFCToolBarButton::IsLocked](#islocked).  
  
 L’implémentation par défaut ne fait rien et retourne `NULL`.  
  
##  <a name="oncustomizemenu"></a>CMFCToolBarButton::OnCustomizeMenu  
 Permet le bouton Modifier le menu fourni lorsque l’application affiche un menu contextuel dans la barre d’outils parent.  
  
```  
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pMenu`  
 Menu Personnaliser.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut ne fait rien et retourne `FALSE`. Substituez cette méthode et retourner une valeur différente de zéro si vous souhaitez modifier le contenu du menu fourni.  
  
##  <a name="ondblclk"></a>CMFCToolBarButton::OnDblClk  
 Appelé par l’infrastructure lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) message.  
  
```  
virtual void OnDblClk(CWnd* pWnd);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWnd`  
 -   La fenêtre parent du bouton.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode est appelée par le `CMFCToolBar::OnLButtonDblClk` méthode lors de la barre d’outils parent gère un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) message.  
  
 L’implémentation par défaut de cette méthode ne fait rien.  
  
##  <a name="ondraw"></a>CMFCToolBarButton::OnDraw  
 Appelée par l’infrastructure pour dessiner le bouton en utilisant les options et les styles spécifiés.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rect,  
    CMFCToolBarImages* pImages,  
    BOOL bHorz=TRUE,  
    BOOL bCustomizeMode=FALSE,  
    BOOL bHighlight=FALSE,  
    BOOL bDrawBorder=TRUE,  
    BOOL bGrayDisabledButtons=TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pDC`  
 Le contexte de périphérique qui affiche le bouton.  
  
 [in] `rect`  
 Le rectangle englobant du bouton.  
  
 [in] `pImages`  
 La collection d’images de barre d’outils qui est associée au bouton.  
  
 [in] `bHorz`  
 L’état d’ancrage de la barre d’outils parent. Ce paramètre est `TRUE` lorsque le bouton est ancré horizontalement et `FALSE` lorsque le bouton est ancré verticalement.  
  
 [in] `bCustomizeMode`  
 Spécifie si la barre d’outils est en mode de personnalisation. Ce paramètre est `TRUE` lorsque la barre d’outils est en mode de personnalisation et `FALSE` lorsque la barre d’outils n’est pas en mode de personnalisation.  
  
 [in] `bHighlight`  
 Spécifie si le bouton est mis en surbrillance. Ce paramètre est `TRUE` lorsque le bouton est mis en surbrillance et `FALSE` lorsque le bouton n’est pas mis en surbrillance.  
  
 [in] `bDrawBorder`  
 Spécifie si le bouton doit afficher sa bordure. Ce paramètre est `TRUE` lorsque le bouton doit afficher sa bordure et `FALSE` lorsque le bouton ne doit pas afficher sa bordure.  
  
 [in] `bGrayDisabledButtons`  
 Spécifie s’il faut ombrer boutons désactivés ou utiliser la collection d’images désactivé. Ce paramètre est `TRUE` lorsque les boutons désactivés doit être grisé et `FALSE` lorsque cette méthode doivent utiliser la collection d’images désactivé.  
  
### <a name="remarks"></a>Notes  
 Substituez cette méthode pour personnaliser le dessin de bouton de barre d’outils.  
  
##  <a name="ondrawoncustomizelist"></a>CMFCToolBarButton::OnDrawOnCustomizeList  
 Appelé par l’infrastructure pour dessiner le bouton dans le **commandes** volet de la **personnaliser** boîte de dialogue.  
  
```  
virtual int OnDrawOnCustomizeList(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bSelected);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pDC`  
 Le contexte de périphérique qui affiche le bouton.  
  
 [in] `rect`  
 Le rectangle englobant du bouton.  
  
 [in] `bSelected`  
 Spécifie si le bouton est sélectionné. Si ce paramètre est `TRUE`, le bouton est sélectionné. Si ce paramètre est `FALSE`, le bouton n’est pas sélectionné.  
  
### <a name="return-value"></a>Valeur de retour  
 La largeur, en pixels, du bouton sur le contexte de périphérique spécifié.  
  
### <a name="remarks"></a>Notes  
 Cette méthode est appelée par la boîte de dialogue Personnalisation ( **commandes** onglet) lorsque le bouton est sur le point de s’afficher dans la zone de liste owner-draw.  
  
 L’implémentation par défaut de cette méthode affiche l’image et l’intitulé du bouton si elles sont disponibles. Si l’étiquette de texte du bouton n’est pas disponible, la méthode affiche le texte d’info-bulle.  
  
 Substituez cette méthode pour effectuer un dessin personnalisé.  
  
##  <a name="ongetcustomtooltiptext"></a>CMFCToolBarButton::OnGetCustomToolTipText  
 Appelé par l’infrastructure pour récupérer le texte info-bulle personnalisée pour le bouton.  
  
```  
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```  
  
### <a name="parameters"></a>Paramètres  
 [out] `strToolTip`  
 Un `CString` objet qui reçoit le texte d’info-bulle personnalisée.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode lorsqu’il affiche l’info-bulle pour le bouton de barre d’outils. Si cette méthode retourne `FALSE`, le framework utilise une info-bulle par défaut.  
  
 L’implémentation par défaut ne fait rien et retourne `FALSE`. Substituez cette méthode et retourner une valeur différente de zéro pour fournir le texte d’info-bulle personnalisée pour le bouton de barre d’outils.  
  
##  <a name="onglobalfontschanged"></a>CMFCToolBarButton::OnGlobalFontsChanged  
 Appelé par l’infrastructure lorsque la police globale a été modifiée.  
  
```  
virtual void OnGlobalFontsChanged();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour la police utilisée pour afficher le texte du bouton.  
  
##  <a name="onmove"></a>CMFCToolBarButton::OnMove  
 Appelé par l’infrastructure lorsque la barre d’outils parent se déplace.  
  
```  
virtual void OnMove();
```  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour repositionner le bouton lorsque la barre d’outils parent se déplace.  
  
##  <a name="onshow"></a>CMFCToolBarButton::OnShow  
 Appelé par l’infrastructure lorsque le bouton est visible ou invisible.  
  
```  
virtual void OnShow(BOOL bShow);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bShow`  
 Spécifie si le bouton est visible. Si ce paramètre est `TRUE`, le bouton est visible. Dans le cas contraire, le bouton n’est pas visible.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour mettre à jour la visibilité du bouton.  
  
##  <a name="onsize"></a>CMFCToolBarButton::OnSize  
 Appelé par l’infrastructure lors de la barre d’outils parent change sa taille ou la position et cette modification entraîne le bouton pour modifier la taille.  
  
```  
virtual void OnSize(int iSize);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iSize`  
 La nouvelle largeur du bouton.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour redimensionner le bouton lorsque la taille ou la position de la barre d’outils parent est modifiée.  
  
##  <a name="ontoolhittest"></a>CMFCToolBarButton::OnToolHitTest  
 Appelé par l’infrastructure lors de la barre d’outils parent doit déterminer si un point est dans le rectangle englobant du bouton.  
  
```  
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,  
    TOOLINFO* pTI);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWnd`  
 La fenêtre parent du bouton. Peut être `NULL`.  
  
 [in] `pTI`  
 Un `TOOLINFO` structure qui contient des informations sur un outil dans un contrôle d’info-bulle.  
  
### <a name="return-value"></a>Valeur de retour  
 Le résultat de `OnMenuButtonToolHitTest` si le bouton peut récupérer un pointeur vers la fenêtre frame parente ; sinon `FALSE`.  
  
### <a name="remarks"></a>Notes  
 Cette méthode appelle l’une des méthodes suivantes si elle peut convertir la fenêtre parente à un objet d’image valide :  
  
- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)  
  
- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)  
  
- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)  
  
##  <a name="onupdatetooltip"></a>CMFCToolBarButton::OnUpdateToolTip  
 Appelé par l’infrastructure lors de la barre d’outils parent met à jour son texte d’info-bulle.  
  
```  
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,  
    int iButtonIndex,  
    CToolTipCtrl& wndToolTip,  
    CString& str);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWndParent`  
 La fenêtre parente.  
  
 [in] `iButtonIndex`  
 Index de base zéro du bouton dans la collection de boutons parent.  
  
 [in] `wndToolTip`  
 Contrôle qui affiche le texte d’info-bulle.  
  
 [out] `str`  
 Un `CString` objet qui reçoit le texte d’info-bulle mise à jour.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien et retourne `FALSE`. Substituez cette méthode pour retourner une valeur différente de zéro si vous fournissez une chaîne de texte d’info-bulle.  
  
##  <a name="preparedrag"></a>CMFCToolBarButton::PrepareDrag  
 Appelé par l’infrastructure lorsque le bouton est sur le point d’effectuer une opération de glisser-déplacer.  
  
```  
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `srcItem`  
 Un `COleDataSource` objet qui stocke les informations d’état sur l’opération de glisser-déplacer.  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si l’opération aboutit ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode pour préparer le bouton de barre d’outils pour stocker son état dans les `COleDataSource` objet. Cette méthode stocke son état par lui-même sérialisation vers un fichier partagé, puis en passant ce fichier à la [COleDataSource::CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) méthode. Pour plus d’informations sur la sérialisation de bouton de barre d’outils, consultez [CMFCToolBarButton::Serialize](#serialize).  
  
 Cette méthode ne fait rien et retourne `TRUE` si le bouton ne peuvent pas être stocké (le [CMFCToolBarButton::CanBeStored](#canbestored) méthode `FALSE`). Elle retourne `FALSE` si une exception se produit pendant la sérialisation de l’objet.  
  
 Pour plus d’informations sur les opérations de glisser-déplacer OLE, consultez [glisser-déplacer (OLE)](../../mfc/drag-and-drop-ole.md).  
  
##  <a name="rect"></a>CMFCToolBarButton::Rect  
 Récupère le rectangle englobant du bouton.  
  
```  
const CRect& Rect() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un `CRect` objet qui contient le rectangle englobant d’un bouton.  
  
##  <a name="resetimagetodefault"></a>CMFCToolBarButton::ResetImageToDefault  
 Définit la valeur par défaut de l’image qui est associée au bouton.  
  
```  
virtual void ResetImageToDefault();
```  
  
### <a name="remarks"></a>Remarques  
 Cette méthode extrait l’image par défaut à partir de sa barre d’outils parent à l’aide de la [CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) (méthode). Si le bouton n’a aucune image associé par défaut, cette méthode définit l’étiquette de texte du bouton en fonction de ses ressources de chaîne à l’aide de la [CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) (méthode). Pour plus d’informations sur les ressources de chaîne, consultez la page [utilisation de fichiers de ressources](../../windows/working-with-resource-files.md).  
  
 Cette méthode ne fait rien si le bouton possède une image définie par l’utilisateur.  
  
##  <a name="savebarstate"></a>CMFCToolBarButton::SaveBarState  
 Enregistre l’état du bouton de barre d’outils.  
  
```  
virtual void SaveBarState();
```  
  
### <a name="remarks"></a>Remarques  
 Le framework appelle cette méthode lorsqu’il crée un `CMFCToolBarButton` objet comme le résultat d’une opération de glisser-déplacer.  
  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour enregistrer l’état du bouton de barre d’outils à une source de données externe.  
  
##  <a name="serialize"></a>CMFCToolBarButton::Serialize  
 Lit de cet objet dans une archive ou écrit dans une archive.  
  
```  
virtual void Serialize(CArchive& ar);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `ar`  
 Le `CArchive` objet à partir duquel ou auquel vous souhaitez sérialiser.  
  
### <a name="remarks"></a>Notes  
 Cette méthode prend en charge le processus de transfert de données telles que les opérations du Presse-papiers ou par glisser-déplacer. Il lit ou écrit des propriétés du bouton telles que l’ID, étiquette de texte et ID de l’image à partir d’ou à la collection `CArchive` objet.  
  
 Pour des exemples de sérialisation, consultez [sérialisation : sérialisation d’un objet](../../mfc/serialization-serializing-an-object.md).  
  
##  <a name="setaccdata"></a>CMFCToolBarButton::SetACCData  
 Remplit les `CAccessibilityData` avec accessibilité des données à partir du bouton de barre d’outils.  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,  
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pParent`  
 La fenêtre parente de la barre d’outils.  
  
 [in] `data`  
 Un `CAccessibilityData` objet qui est rempli avec les données d’accessibilité de la barre d’outils.  
  
### <a name="return-value"></a>Valeur de retour  
 Cette méthode retourne `TRUE`.  
  
### <a name="remarks"></a>Notes  
 Substituez cette méthode pour retourner `FALSE` si le bouton de barre d’outils ne fournit pas de données de l’accessibilité.  
  
##  <a name="setclipboardformatname"></a>CMFCToolBarButton::SetClipboardFormatName  
 Renomme le format de Presse-papiers global.  
  
```  
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `lpszName`  
 Le nouveau nom du format de Presse-papiers global. Ne peut pas être `NULL`.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode rend possible pour les opérations de glisser-déplacer entre plusieurs applications. Chaque application doit fournir le même nom de format de Presse-papiers.  
  
 Vous devez appeler cette méthode avant le framework appelle [CMFCToolBarButton::GetClipboardFormat](#getclipboardformat).  
  
##  <a name="setimage"></a>CMFCToolBarButton::SetImage  
 Définit l’index de l’image du bouton.  
  
```  
virtual void SetImage(int iImage);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iImage`  
 L’index de l’image dans la collection d’images de barre d’outils.  
  
### <a name="remarks"></a>Remarques  
 Si le bouton de barre d’outils est un séparateur, `iImage` fait référence à la nouvelle largeur du bouton séparateur.  
  
 Si `iImage` est inférieur à zéro, cette méthode désactive le dessin de l’image et dessin de l’étiquette de texte du bouton.  
  
##  <a name="setprotectedcommands"></a>CMFCToolBarButton::SetProtectedCommands  
 Définit la liste des commandes que l’utilisateur ne peut pas personnaliser.  
  
```  
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `lstCmds`  
 La liste des commandes protégés.  
  
### <a name="remarks"></a>Remarques  
 Dans le mode de personnalisation, le framework désactive les commandes de bouton de barre d’outils qui sont protégés. L’utilisateur ne peut pas effectuer de glisser-déplacer et modifier des opérations sur les boutons de barre d’outils désactivés.  
  
 Utilisez le [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) méthode pour récupérer la liste de protégée des commandes.  
  
##  <a name="setradio"></a>CMFCToolBarButton::SetRadio  
 Appelé par l’infrastructure lorsqu’un bouton modifie son état d’activation.  
  
```  
virtual void SetRadio();
```  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut de cette méthode ne fait rien. Substituez cette méthode pour effectuer une action personnalisée lorsque le bouton modifie son état d’activation.  
  
##  <a name="setrect"></a>CMFCToolBarButton::SetRect  
 Définit le rectangle englobant du bouton.  
  
```  
void SetRect(const CRect rect);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `rect`  
 Le nouveau rectangle englobant du bouton.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode appelle la [CMFCToolBarButton::OnMove](#onmove) méthode après avoir défini le nouveau rectangle englobant.  
  
##  <a name="setstyle"></a>CMFCToolBarButton::SetStyle  
 Définit le style du bouton.  
  
```  
virtual void SetStyle(UINT nStyle);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `nStyle`  
 Le nouveau style du bouton.  
  
### <a name="remarks"></a>Remarques  
 L’implémentation par défaut définit les [CMFCToolBarButton::m_nStyle](#m_nstyle) membre de données `nStyle`. Substituez cette méthode si vous souhaitez effectuer un traitement supplémentaire pour gérer le changement de style. Consultez la page [les Styles de contrôle de barre d’outils](toolbar-control-styles.md) pour obtenir la liste des indicateurs de style valide.  
  
##  <a name="setvisible"></a>CMFCToolBarButton::SetVisible  
 Spécifie si le bouton est visible.  
  
```  
void SetVisible(BOOL bShow=TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bShow`  
 Valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre est `TRUE`, le bouton s’affiche. Si le paramètre est `FALSE`, le bouton est masqué.  
  
### <a name="remarks"></a>Remarques  
 Cette fonction permet d’afficher ou masquer un bouton de barre d’outils spécifique. Appelez le [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) méthode après avoir appelé cette méthode.  
  
##  <a name="show"></a>CMFCToolBarButton::Show  
 Affiche ou masque le bouton.  
  
```  
void Show(BOOL bShow);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bShow`  
 Valeur booléenne qui spécifie s’il faut afficher ou masquer le bouton. Si ce paramètre est `TRUE`, le bouton s’affiche. Si le paramètre est `FALSE`, le bouton est masqué.  
  
### <a name="remarks"></a>Remarques  
 L’infrastructure appelle cette méthode pour mettre à jour la visibilité des boutons de barre d’outils lors du redimensionnement de la barre d’outils de leur parent. L’infrastructure appelle cette méthode avec `bShow` la valeur `FALSE` lorsque le bouton ne tient plus dans les limites de la barre d’outils. L’infrastructure appelle cette méthode avec `bShow` la valeur `TRUE` lorsque après le redimensionnement du bouton correspond à nouveau dans les limites de la barre d’outils.  
  
 Utilisez le [CMFCToolBarButton::SetVisible](#setvisible) pour définir la visibilité du bouton générale.  
  
 Cette méthode appelle la [CMFCToolBarButton::OnShow](#onshow) méthode une fois qu’il met à jour l’état de visibilité du bouton.  
  
## <a name="see-also"></a>Voir aussi  
 [Graphique de la hiérarchie](../../mfc/hierarchy-chart.md)   
 [Classes](../../mfc/reference/mfc-classes.md)   
 [CMFCToolBar (classe)](../../mfc/reference/cmfctoolbar-class.md)   
 [CMFCToolBarImages (classe)](../../mfc/reference/cmfctoolbarimages-class.md)

