---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 6a824aceae39d5aa6685176354c48a9457a40e9e
ms.sourcegitcommit: ec6dd97ef3d10b44e0fedaa8e53f41696f49ac7b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/25/2020
ms.locfileid: "88837617"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Fournit les fonctionnalités du contrôle commun d’arborescence Windows.

## <a name="syntax"></a>Syntaxe

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CTreeCtrl :: CTreeCtrl](#ctreectrl)|Construit un objet `CTreeCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CTreeCtrl :: Create](#create)|Crée un contrôle Tree View et l’attache à un `CTreeCtrl` objet.|
|[CTreeCtrl :: CreateDragImage](#createdragimage)|Crée une image bitmap de glissement pour l’élément d’arborescence spécifié.|
|[CTreeCtrl :: CreateEx](#createex)|Crée un contrôle d’arborescence avec les styles étendus Windows spécifiés et l’attache à un `CTreeCtrl` objet.|
|[CTreeCtrl ::D eleteAllItems](#deleteallitems)|Supprime tous les éléments dans un contrôle TreeView.|
|[CTreeCtrl ::D eleteItem](#deleteitem)|Supprime un nouvel élément dans un contrôle Tree View.|
|[CTreeCtrl :: EditLabel](#editlabel)|Modifie un élément d’arborescence spécifié sur place.|
|[CTreeCtrl :: EndEditLabelNow](#endeditlabelnow)|Annule l’opération de modification sur l’étiquette d’un élément d’arborescence dans le contrôle d’arborescence actuel.|
|[CTreeCtrl :: EnsureVisible](#ensurevisible)|Garantit qu’un élément d’arborescence est visible dans son contrôle Tree View.|
|[CTreeCtrl :: Expand](#expand)|Développe ou réduit les éléments enfants de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetBkColor](#getbkcolor)|Récupère la couleur d’arrière-plan actuelle du contrôle.|
|[CTreeCtrl :: GetCheck](#getcheck)|Récupère l’état d’activation d’un élément de contrôle d’arborescence.|
|[CTreeCtrl :: GetChildItem](#getchilditem)|Récupère l’enfant d’un élément d’arborescence spécifié.|
|[CTreeCtrl :: GetCount](#getcount)|Récupère le nombre d’éléments d’arborescence associés à un contrôle Tree View.|
|[CTreeCtrl :: GetDropHilightItem](#getdrophilightitem)|Récupère la cible d’une opération de glisser-déplacer.|
|[CTreeCtrl :: GetEditControl](#geteditcontrol)|Récupère le handle du contrôle d’édition utilisé pour modifier l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetExtendedStyle](#getextendedstyle)|Récupère les styles étendus que le contrôle d’arborescence actuel utilise.|
|[CTreeCtrl :: GetFirstVisibleItem](#getfirstvisibleitem)|Récupère le premier élément visible de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetImageList](#getimagelist)|Récupère le handle de la liste d’images associée à un contrôle Tree View.|
|[CTreeCtrl :: GetIndent](#getindent)|Récupère le décalage (en pixels) d’un élément d’arborescence par rapport à son parent.|
|[CTreeCtrl :: GetInsertMarkColor](#getinsertmarkcolor)|Récupère la couleur utilisée pour dessiner la marque d’insertion pour l’arborescence.|
|[CTreeCtrl :: GetItem](#getitem)|Récupère les attributs d’un élément d’arborescence spécifié.|
|[CTreeCtrl :: GetItemData](#getitemdata)|Retourne la valeur spécifique à l’application associée à un élément.|
|[CTreeCtrl :: GetItemExpandedImageIndex](#getitemexpandedimageindex)|Récupère l’index de l’image à afficher lorsque l’élément spécifié du contrôle d’arborescence actuel est dans l’état développé.|
|[CTreeCtrl :: GetItemHeight](#getitemheight)|Récupère la hauteur actuelle des éléments de l’arborescence.|
|[CTreeCtrl :: GetItemImage](#getitemimage)|Récupère les images associées à un élément.|
|[CTreeCtrl :: GetItemPartRect](#getitempartrect)|Récupère le rectangle englobant pour une partie spécifiée d’un élément spécifié dans le contrôle TreeView actuel.|
|[CTreeCtrl :: GetItemRect](#getitemrect)|Récupère le rectangle englobant d’un élément d’arborescence.|
|[CTreeCtrl :: GetItemState](#getitemstate)|Retourne l’état d’un élément.|
|[CTreeCtrl :: GetItemStateEx](#getitemstateex)|Récupère l’état étendu de l’élément spécifié dans le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: GetItemText](#getitemtext)|Retourne le texte d’un élément.|
|[CTreeCtrl :: GetLastVisibleItem](#getlastvisibleitem)|Récupère le dernier élément développé dans le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: GetLineColor](#getlinecolor)|Récupère la couleur de ligne actuelle pour le contrôle TreeView.|
|[CTreeCtrl :: GetNextItem](#getnextitem)|Récupère l’élément d’arborescence suivant qui correspond à une relation spécifiée.|
|[CTreeCtrl :: GetNextSiblingItem](#getnextsiblingitem)|Récupère le frère suivant de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetNextVisibleItem](#getnextvisibleitem)|Récupère l’élément visible suivant de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetParentItem](#getparentitem)|Récupère le parent de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetPrevSiblingItem](#getprevsiblingitem)|Récupère le frère précédent de l’élément d’affichage d’arborescence spécifié.|
|[CTreeCtrl :: GetPrevVisibleItem](#getprevvisibleitem)|Récupère l’élément visible précédent de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetRootItem](#getrootitem)|Récupère la racine de l’élément d’arborescence spécifié.|
|[CTreeCtrl :: GetScrollTime](#getscrolltime)|Récupère le temps de défilement maximal pour le contrôle d’arborescence.|
|[CTreeCtrl :: GetSelectedCount](#getselectedcount)|Récupère le nombre d’éléments sélectionnés dans le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: GetSelectedItem](#getselecteditem)|Récupère l’élément d’arborescence actuellement sélectionné.|
|[CTreeCtrl :: GetTextColor](#gettextcolor)|Récupère la couleur de texte actuelle du contrôle.|
|[CTreeCtrl :: GetToolTips](#gettooltips)|Récupère le handle du contrôle ToolTip enfant utilisé par un contrôle Tree View.|
|[CTreeCtrl :: GetVisibleCount](#getvisiblecount)|Récupère le nombre d’éléments d’arborescence visibles associés à un contrôle Tree View.|
|[CTreeCtrl :: HitTest](#hittest)|Retourne la position actuelle du curseur associé à l' `CTreeCtrl` objet.|
|[CTreeCtrl :: InsertItem](#insertitem)|Insère un nouvel élément dans un contrôle Tree View.|
|[CTreeCtrl :: ItemHasChildren](#itemhaschildren)|Retourne une valeur différente de zéro si l’élément spécifié a des éléments enfants.|
|[CTreeCtrl :: MapAccIdToItem](#mapaccidtoitem)|Mappe l’identificateur d’accessibilité spécifié au handle d’un élément d’arborescence dans le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: MapItemToAccID](#mapitemtoaccid)|Mappe le handle spécifié à un élément d’arborescence dans le contrôle d’arborescence actuel à un identificateur d’accessibilité.|
|[CTreeCtrl :: SELECT](#select)|Sélectionne, fait défiler l’affichage ou redessine un élément d’arborescence spécifié.|
|[CTreeCtrl :: SelectDropTarget](#selectdroptarget)|Redessine l’élément d’arborescence en tant que cible d’une opération de glisser-déplacer.|
|[CTreeCtrl :: SelectItem](#selectitem)|Sélectionne un élément d’arborescence spécifié.|
|[CTreeCtrl :: SelectSetFirstVisible](#selectsetfirstvisible)|Sélectionne un élément d’arborescence spécifié comme premier élément visible.|
|[CTreeCtrl :: SetAutoscrollInfo](#setautoscrollinfo)|Définit le taux de défilement automatique du contrôle d’arborescence actuel.|
|[CTreeCtrl :: SetBkColor](#setbkcolor)|Définit la couleur d’arrière-plan du contrôle.|
|[CTreeCtrl :: SetCheck](#setcheck)|Définit l’état d’activation d’un élément de contrôle d’arborescence.|
|[CTreeCtrl :: SetExtendedStyle](#setextendedstyle)|Définit les styles étendus pour le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: SetImageList](#setimagelist)|Définit le handle de la liste d’images associée à un contrôle Tree View.|
|[CTreeCtrl :: SetIndent](#setindent)|Définit le décalage (en pixels) d’un élément d’arborescence par rapport à son parent.|
|[CTreeCtrl :: SetInsertMark](#setinsertmark)|Définit la marque d’insertion dans un contrôle TreeView.|
|[CTreeCtrl :: SetInsertMarkColor](#setinsertmarkcolor)|Définit la couleur utilisée pour dessiner la marque d’insertion pour l’arborescence.|
|[CTreeCtrl :: SetItem](#setitem)|Définit les attributs d’un élément d’arborescence spécifié.|
|[CTreeCtrl :: SetItemData](#setitemdata)|Définit la valeur spécifique à l’application associée à un élément.|
|[CTreeCtrl :: SetItemExpandedImageIndex](#setitemexpandedimageindex)|Définit l’index de l’image à afficher lorsque l’élément spécifié du contrôle d’arborescence actuel est dans l’état développé.|
|[CTreeCtrl :: SetItemHeight](#setitemheight)|Définit la hauteur des éléments de l’arborescence.|
|[CTreeCtrl :: SetItemImage](#setitemimage)|Associe des images à un élément.|
|[CTreeCtrl :: SetItemState](#setitemstate)|Définit l’état d’un élément.|
|[CTreeCtrl :: SetItemStateEx](#setitemstateex)|Définit l’état étendu de l’élément spécifié dans le contrôle d’affichage d’arborescence actuel.|
|[CTreeCtrl :: SetItemText](#setitemtext)|Définit le texte d’un élément.|
|[CTreeCtrl :: SetLineColor](#setlinecolor)|Définit la couleur de la ligne active pour le contrôle TreeView.|
|[CTreeCtrl :: SetScrollTime](#setscrolltime)|Définit la durée maximale de défilement pour le contrôle TreeView.|
|[CTreeCtrl :: SetTextColor](#settextcolor)|Définit la couleur du texte du contrôle.|
|[CTreeCtrl :: SetToolTips](#settooltips)|Définit le contrôle d’info-bulle enfant d’un contrôle Tree View.|
|[CTreeCtrl :: ShowInfoTip](#showinfotip)|Affiche l’info-bulle de l’élément spécifié dans le contrôle d’arborescence actuel.|
|[CTreeCtrl :: SortChildren](#sortchildren)|Trie les enfants d’un élément parent donné.|
|[CTreeCtrl :: SortChildrenCB](#sortchildrencb)|Trie les enfants d’un élément parent donné à l’aide d’une fonction de tri définie par l’application.|

## <a name="remarks"></a>Notes

Un « contrôle d’arborescence » est une fenêtre qui affiche une liste hiérarchique d’éléments, tels que les en-têtes d’un document, les entrées dans un index ou les fichiers et répertoires sur un disque. Chaque élément est constitué d’une étiquette et d’une image bitmap facultative, et chaque élément peut être associé à une liste de sous-éléments. En cliquant sur un élément, l’utilisateur peut développer et réduire la liste associée de sous-éléments.

Ce contrôle (et par conséquent la `CTreeCtrl` classe) est uniquement disponible pour les programmes qui s’exécutent sous windows 98 et Windows NT version 4 et versions ultérieures.

Pour plus d’informations sur l’utilisation de `CTreeCtrl` , consultez :

- [Contrôles](../../mfc/controls-mfc.md)

- [Utilisation de CTreeCtrl](../../mfc/using-ctreectrl.md)

- [Référence de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-reference) dans l’SDK Windows.

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>Configuration requise

**En-tête :** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a> CTreeCtrl :: Create

Si vous spécifiez le contrôle d’arborescence dans un modèle de boîte de dialogue ou si vous utilisez [CTreeView](../../mfc/reference/ctreeview-class.md), votre contrôle d’arborescence est créé automatiquement lors de la création de la boîte de dialogue ou de la vue.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle*<br/>
Spécifie le style du contrôle TreeView. Appliquez les styles de fenêtre, décrits dans [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)et toute combinaison de [styles de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-styles) comme décrit dans la SDK Windows.

*rectangulaire*<br/>
Spécifie la taille et la position du contrôle TreeView. Il peut s’agir d’un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou d’une structure [Rect](/windows/win32/api/windef/ns-windef-rect) .

*pParentWnd*<br/>
Spécifie la fenêtre parente du contrôle Tree View, généralement `CDialog` . Il ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si l’initialisation a réussi ; Sinon, 0.

### <a name="remarks"></a>Notes

Si vous souhaitez créer le contrôle d’arborescence en tant que fenêtre enfant d’une autre fenêtre, utilisez la `Create` fonction membre. Si vous créez le contrôle d’arborescence à l’aide de `Create` , vous devez le passer WS_VISIBLE, en plus des autres styles d’arborescence.

Vous construisez un `CTreeCtrl` en deux étapes. Appelez d’abord le constructeur, puis appelez `Create` , qui crée le contrôle TreeView et l’attache à l' `CTreeCtrl` objet.

Pour créer un contrôle d’arborescence avec des styles de fenêtre étendus, appelez [CreateEx](#createex) au lieu de `Create` .

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a> CTreeCtrl :: CreateEx

Appelez cette fonction pour créer un contrôle (une fenêtre enfant) et l’associer à l' `CTreeCtrl` objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour obtenir la liste des styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le SDK Windows.

*dwStyle*<br/>
Spécifie le style du contrôle TreeView. Appliquez les styles de fenêtre, décrits dans [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)et toute combinaison de [styles de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-styles) comme décrit dans la SDK Windows.

*rectangulaire*<br/>
Référence à une structure [Rect](/windows/win32/api/windef/ns-windef-rect) décrivant la taille et la position de la fenêtre à créer, en coordonnées clientes de *pParentWnd*.

*pParentWnd*<br/>
Pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
ID de la fenêtre enfant du contrôle.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au lieu de [Create](#create) pour appliquer des styles Windows étendus, spécifiés par la préversion de style étendu Windows **WS_EX_**.

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a> CTreeCtrl :: CreateDragImage

Appelez cette fonction pour créer une image bitmap de glissement pour l’élément donné dans un contrôle Tree View, créer une liste d’images pour l’image bitmap et ajouter l’image bitmap à la liste d’images.

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence à faire glisser.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la liste d’images à laquelle la bitmap glissante a été ajoutée, en cas de réussite ; Sinon, NULL.

### <a name="remarks"></a>Notes

Une application utilise les fonctions image-List pour afficher l’image lorsque l’élément est glissé.

L' `CImageList` objet est permanent et vous devez le supprimer une fois l’opération terminée. Par exemple :

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a> CTreeCtrl :: CTreeCtrl

Construit un objet `CTreeCtrl`.

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a> CTreeCtrl ::D eleteAllItems

Appelez cette fonction pour supprimer tous les éléments du contrôle TreeView.

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a> CTreeCtrl ::D eleteItem

Appelez cette fonction pour supprimer un élément du contrôle TreeView.

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence à supprimer. Si *hitem* a la valeur TVI_ROOT, tous les éléments sont supprimés du contrôle Tree View.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a> CTreeCtrl :: EditLabel

Appelez cette fonction pour commencer la modification sur place du texte de l’élément spécifié.

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence à modifier.

### <a name="return-value"></a>Valeur renvoyée

En cas de réussite, pointeur vers l' `CEdit` objet qui est utilisé pour modifier le texte de l’élément ; sinon, null.

### <a name="remarks"></a>Notes

La modification est effectuée en remplaçant le texte de l’élément par un contrôle d’édition sur une seule ligne contenant le texte.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a> CTreeCtrl :: EndEditLabelNow

Termine l’opération de modification sur l’étiquette d’un élément d’arborescence dans le contrôle d’arborescence actuel.

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>Paramètres

*fCancelWithoutSave*\
dans TRUE pour abandonner les modifications apportées à l’élément d’affichage d’arborescence avant de conclure la modification, ou FALSe pour enregistrer les modifications apportées à l’élément d’arborescence avant de conclure l’opération.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow) , qui est décrit dans le SDK Windows.

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a> CTreeCtrl :: EnsureVisible

Appelez cette fonction pour vous assurer qu’un élément d’arborescence est visible.

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence en cours de rendu visible.

### <a name="return-value"></a>Valeur renvoyée

Retourne la valeur TRUE si le système a fait défiler les éléments du contrôle Tree-View pour s’assurer que l’élément spécifié est visible. Dans le cas contraire, la valeur de retour est FALSe.

### <a name="remarks"></a>Notes

Si nécessaire, la fonction développe l’élément parent ou fait défiler le contrôle TreeView afin que l’élément soit visible.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a> CTreeCtrl :: Expand

Appelez cette fonction pour développer ou réduire la liste des éléments enfants, le cas échéant, associés à l’élément parent donné.

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence en cours de développement.

*nCode*<br/>
Indicateur qui spécifie le type d’action à entreprendre. Cet indicateur peut avoir l’une des valeurs suivantes :

- TVE_COLLAPSE réduit la liste.

- TVE_COLLAPSERESET réduit la liste et supprime les éléments enfants. L’indicateur d’État TVIS_EXPANDEDONCE est réinitialisé. Cet indicateur doit être utilisé avec l’indicateur TVE_COLLAPSE.

- TVE_EXPAND développe la liste.

- TVE_TOGGLE réduit la liste si elle est actuellement développée ou la développe si elle est actuellement réduite.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a> CTreeCtrl :: GetBkColor

Cette fonction membre implémente le comportement de la [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui représente la couleur d’arrière-plan de la fenêtre actuelle pour le contrôle. Si cette valeur est-1, le contrôle utilise la couleur de la fenêtre système. Dans ce cas, vous pouvez utiliser `::GetSysColor(COLOR_WINDOW)` pour récupérer la couleur système actuelle utilisée par le contrôle.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetTextColor](#settextcolor).

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a> CTreeCtrl :: GetCheck

Appelez cette fonction membre pour récupérer l’état d’activation d’un élément.

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
HTREEITEM sur lequel les informations d’État doivent être reçues.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’élément de contrôle d’arborescence est activé ; Sinon, 0.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetCheck](#setcheck).

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a> CTreeCtrl :: GetChildItem

Appelez cette fonction pour récupérer l’élément d’arborescence qui est l’enfant de l’élément spécifié par *hitem*.

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément enfant en cas de réussite ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a> CTreeCtrl :: GetCount

Appelez cette fonction pour récupérer le nombre d’éléments dans un contrôle TreeView.

```
UINT GetCount() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre d’éléments dans le contrôle TreeView.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a> CTreeCtrl :: GetDropHilightItem

Appelez cette fonction pour récupérer l’élément qui est la cible d’une opération de glisser-déplacer.

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément supprimé en cas de réussite ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a> CTreeCtrl :: GetEditControl

Appelez cette fonction pour récupérer le handle du contrôle d’édition utilisé pour modifier le texte d’un élément de l’arborescence.

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers le contrôle d’édition utilisé pour modifier le texte de l’élément, en cas de réussite ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a> CTreeCtrl :: GetExtendedStyle

Récupère les styles étendus que le contrôle d’arborescence actuel utilise.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur qui contient une combinaison au niveau du bit (ou) des styles étendus du contrôle d’arborescence actuel. Pour plus d’informations, consultez [styles étendus de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-extended-styles).

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle) , qui est décrit dans le SDK Windows.

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a> CTreeCtrl :: GetFirstVisibleItem

Appelez cette fonction pour récupérer le premier élément visible du contrôle TreeView.

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle du premier élément visible ; Sinon, NULL.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetCheck](#setcheck).

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a> CTreeCtrl :: GetImageList

Appelez cette fonction pour récupérer le handle de la liste d’images normale ou d’État associée au contrôle TreeView.

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>Paramètres

*nImageList*<br/>
Type de liste d’images à récupérer. La liste d’images peut prendre l’une des valeurs suivantes :

- TVSIL_NORMAL récupère la liste d’images normale, qui contient les images sélectionnées et non sélectionnées pour l’élément d’arborescence.

- TVSIL_STATE récupère la liste d’images d’État, qui contient les images pour les éléments d’arborescence qui sont dans un état défini par l’utilisateur.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la liste d’images du contrôle en cas de réussite ; Sinon, NULL.

### <a name="remarks"></a>Notes

Chaque élément d’un contrôle d’arborescence peut avoir une paire d’images bitmap qui lui sont associées. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Pour plus d’informations sur les listes d’images, consultez la classe [CImageList](../../mfc/reference/cimagelist-class.md) .

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a> CTreeCtrl :: GetIndent

Appelez cette fonction pour récupérer la quantité, en pixels, que les éléments enfants sont mis en retrait par rapport à leurs éléments parents.

```
UINT GetIndent() const;
```

### <a name="return-value"></a>Valeur renvoyée

Quantité de mise en retrait mesurée en pixels.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CTreeCtrl :: GetInsertMarkColor

Cette fonction membre implémente le comportement de la [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui contient la couleur de la marque d’insertion actuelle.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a> CTreeCtrl :: GetItem

Appelez cette fonction pour récupérer les attributs de l’élément d’arborescence spécifié.

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>Paramètres

*pItem*<br/>
Pointeur vers une structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) , comme décrit dans la SDK Windows.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl ::D eleteitem](#deleteitem).

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a> CTreeCtrl :: GetItemData

Appelez cette fonction pour récupérer la valeur spécifique à l’application associée à l’élément spécifié.

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont les données doivent être récupérées.

### <a name="return-value"></a>Valeur renvoyée

Valeur spécifique à l’application de taille pointeur associée à l’élément spécifié par *hitem*.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a> CTreeCtrl :: GetItemExpandedImageIndex

Récupère l’index de l’image à afficher lorsque l’élément spécifié du contrôle d’arborescence actuel est dans l’état développé.

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle vers un élément de contrôle d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Index de l’image à afficher lorsque l’élément spécifié est dans l’état développé.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) , qui est décrit dans le SDK Windows. Ce message retourne la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) qui décrit l’élément de contrôle Tree-View, puis cette méthode récupère le `iExpandedImage` membre à partir de cette structure.

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a> CTreeCtrl :: GetItemHeight

Cette fonction membre implémente le comportement de la [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)de message Win32, comme décrit dans le SDK Windows.

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>Valeur renvoyée

Hauteur de l’élément, en pixels.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a> CTreeCtrl :: GetItemImage

Chaque élément d’un contrôle d’arborescence peut avoir une paire d’images bitmap qui lui sont associées.

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont l’image doit être récupérée.

*nImage*<br/>
Entier qui reçoit l’index de l’image de l’élément dans la liste d’images du contrôle TreeView.

*nSelectedImage*<br/>
Entier qui reçoit l’index de l’image sélectionnée de l’élément dans la liste d’images du contrôle TreeView.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Les images apparaissent à gauche de l'étiquette d'un élément. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Appelez cette fonction pour récupérer l’index de l’image de l’élément et de son image sélectionnée dans la liste d’images du contrôle TreeView.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a> CTreeCtrl :: GetItemPartRect

Récupère le rectangle englobant pour une partie spécifiée d’un élément spécifié dans le contrôle TreeView actuel.

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle vers un élément de contrôle d’arborescence.

*Référence*\
dans Identificateur du composant. Doit être défini sur TVGIPR_BUTTON.

*lpRect*\
à Pointeur vers une structure [Rect](/windows/win32/api/windef/ns-windef-rect) . Si cette méthode réussit, la structure reçoit les coordonnées du rectangle du composant spécifié par *hitem* et *NLA*.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Chaque élément de contrôle d’arborescence est délimité par un rectangle graphique. Chaque fois qu’un utilisateur clique sur un point de ce rectangle, l’élément est considéré comme étant *atteint*. Cette méthode retourne le plus grand rectangle de manière à ce que, lorsque vous cliquez sur un point du rectangle, l’élément identifié par le paramètre *hitem* soit atteint.

Cette méthode envoie le message TVM_GETITEMPARTRECT, qui est décrit dans le SDK Windows. Pour plus d’informations, consultez la macro [TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect) .

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant utilise un identificateur d’accessibilité et la méthode [CTreeCtrl :: MapAccIdToItem](#mapaccidtoitem) pour récupérer un handle de l’élément d’arborescence racine. L’exemple utilise ensuite le handle et la méthode [CTreeCtrl :: GetItemPartRect](#getitempartrect) pour dessiner un rectangle 3D autour de cet élément. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Nous avons utilisé la méthode [CTreeCtrl :: MapItemToAccID](#mapitemtoaccid) pour associer l’élément d’arborescence racine à un identificateur d’accessibilité.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a> CTreeCtrl :: GetItemRect

Appelez cette fonction pour récupérer le rectangle englobant pour *hitem* et déterminer s’il est visible ou non.

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément de contrôle d’arborescence.

*lpRect*<br/>
Pointeur vers une structure [Rect](/windows/win32/api/windef/ns-windef-rect) qui reçoit le rectangle englobant. Les coordonnées sont relatives au coin supérieur gauche du contrôle TreeView.

*bTextOnly*<br/>
Si ce paramètre est différent de zéro, le rectangle englobant comprend uniquement le texte de l’élément. Dans le cas contraire, elle comprend la ligne entière occupée par l’élément dans le contrôle TreeView.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’élément est visible, avec le rectangle englobant contenu dans *lpRect*. Sinon, 0 avec *lpRect* non initialisé.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a> CTreeCtrl :: GetItemState

Retourne l’état de l’élément spécifié par *hitem*.

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont l’État doit être récupéré.

*nStateMask*<br/>
Masque indiquant un ou plusieurs États à récupérer. Pour plus d’informations sur les valeurs possibles pour *nStateMask*, consultez la discussion sur les `state` `stateMask` membres et de la structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) dans le SDK Windows.

### <a name="return-value"></a>Valeur renvoyée

UINT qui contient l’opérateur or au niveau du bit des valeurs spécifiées par nStateMask. Pour plus d’informations sur les valeurs possibles, consultez [CTreeCtrl :: GetItem](#getitem). Pour rechercher la valeur d’un état spécifique, effectuez une opération and au niveau du bit de la valeur d’État et de la valeur de retour, comme indiqué dans l’exemple suivant.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a> CTreeCtrl :: GetItemStateEx

Récupère l’état étendu de l’élément spécifié dans le contrôle d’affichage d’arborescence actuel.

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle vers un élément de contrôle d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

État étendu de l’élément. Pour plus d’informations, consultez le `uStateEx` membre de la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_GETITEM](/windows/win32/Controls/tvm-getitem) , qui est décrit dans le SDK Windows. Ce message retourne la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) qui décrit l’élément de contrôle d’arborescence, et cette méthode récupère le `uStateEx` membre de cette structure.

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a> CTreeCtrl :: GetItemText

Retourne le texte de l’élément spécifié par *hitem*.

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont le texte doit être récupéré.

### <a name="return-value"></a>Valeur renvoyée

`CString`Objet contenant le texte de l’élément.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetNextItem](#getnextitem).

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a> CTreeCtrl :: GetLastVisibleItem

Récupère le dernier élément de nœud non développé dans le contrôle d’affichage d’arborescence actuel.

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle vers le dernier élément de nœud non développé si la méthode réussit ; Sinon, NULL.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem) , qui est décrit dans le SDK Windows. Pour plus d’informations, consultez l’indicateur TVGN_LASTVISIBLE dans le paramètre *Flag* de ce message.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Une ou plusieurs de ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant récupère un handle vers le dernier élément de nœud d’affichage d’arborescence non développé, puis dessine un rectangle 3D autour de cet élément. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a> CTreeCtrl :: GetLineColor

Cette fonction membre implémente le comportement de la [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>Valeur renvoyée

Couleur de la ligne active.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a> CTreeCtrl :: GetNextItem

Appelez cette fonction pour récupérer l’élément d’arborescence qui a la relation spécifiée, indiquée par le paramètre *nCode* , à *hitem*.

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

*nCode*<br/>
Indicateur qui spécifie le type de relation à *hitem*. Cet indicateur peut prendre l’une des valeurs suivantes :

- TVGN_CARET récupère l’élément actuellement sélectionné.

- TVGN_CHILD récupère le premier élément enfant de l’élément spécifié par le paramètre *hitem* .

- TVGN_DROPHILITE récupère l’élément qui est la cible d’une opération de glisser-déplacer.

- TVGN_FIRSTVISIBLE récupère le premier élément visible.

- TVGN_LASTVISIBLE récupère le dernier élément développé dans l’arborescence. Cela ne récupère pas le dernier élément visible dans la fenêtre d’arborescence.

- TVGN_NEXT récupère l’élément frère suivant.

- TVGN_NEXTVISIBLE récupère l’élément visible suivant qui suit l’élément spécifié.

- TVGN_PARENT récupère le parent de l’élément spécifié.

- TVGN_PREVIOUS récupère l’élément frère précédent.

- TVGN_PREVIOUSVISIBLE récupère le premier élément visible qui précède l’élément spécifié.

- TVGN_ROOT récupère le premier élément enfant de l’élément racine dont l’élément spécifié fait partie.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément suivant en cas de réussite ; Sinon, NULL.

### <a name="remarks"></a>Notes

Cette fonction retournera la valeur NULL si l’élément récupéré est le nœud racine de l’arborescence. Par exemple, si vous utilisez ce message avec l’indicateur TVGN_PARENT sur un enfant de premier niveau du nœud racine de la vue d’arborescence, le message retourne la valeur NULL.

### <a name="example"></a>Exemple

Pour obtenir un exemple d’utilisation de `GetNextItem` dans une boucle, consultez [CTreeCtrl ::D eleteitem](#deleteitem).

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a> CTreeCtrl :: GetNextSiblingItem

Appelez cette fonction pour récupérer le frère suivant de *hitem*.

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément frère suivant ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a> CTreeCtrl :: GetNextVisibleItem

Appelez cette fonction pour récupérer l’élément visible suivant de *hitem*.

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément visible suivant ; Sinon, NULL.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetCheck](#setcheck).

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a> CTreeCtrl :: GetParentItem

Appelez cette fonction pour récupérer le parent de *hitem*.

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément parent ; Sinon, NULL.

### <a name="remarks"></a>Notes

Cette fonction retournera la valeur NULL si le parent de l’élément spécifié est le nœud racine de l’arborescence.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a> CTreeCtrl :: GetPrevSiblingItem

Appelez cette fonction pour récupérer le frère précédent de *hitem*.

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle du frère précédent ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a> CTreeCtrl :: GetPrevVisibleItem

Appelez cette fonction pour récupérer l’élément visible précédent de *hitem*.

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément visible précédent ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a> CTreeCtrl :: GetRootItem

Appelez cette fonction pour récupérer l’élément racine du contrôle TreeView.

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément racine ; Sinon, NULL.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: EditLabel](#editlabel).

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a> CTreeCtrl :: GetScrollTime

Appelez cette fonction membre pour récupérer la durée de défilement maximale pour le contrôle TreeView.

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>Valeur renvoyée

Durée maximale de défilement, en millisecondes.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a> CTreeCtrl :: GetSelectedCount

Récupère le nombre d’éléments sélectionnés dans le contrôle d’affichage d’arborescence actuel.

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>Valeur renvoyée

Nombre d’éléments sélectionnés.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount) , qui est décrit dans le SDK Windows.

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a> CTreeCtrl :: GetSelectedItem

Appelez cette fonction pour récupérer l’élément actuellement sélectionné du contrôle TreeView.

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément sélectionné ; Sinon, NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a> CTreeCtrl :: GetTextColor

Cette fonction membre implémente le comportement de la [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui représente la couleur de texte actuelle. Si cette valeur est-1, le contrôle utilise la couleur système pour la couleur du texte.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetTextColor](#settextcolor).

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a> CTreeCtrl :: GetToolTips

Cette fonction membre implémente le comportement de la [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)de message Win32, comme décrit dans le SDK Windows.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) à utiliser par le contrôle d’arborescence. Si la fonction membre [Create](#create) utilise le style TVS_NOTOOLTIPS, aucune info-bulle n’est utilisée et la valeur null est retournée.

### <a name="remarks"></a>Notes

L’implémentation MFC de `GetToolTips` retourne un `CToolTipCtrl` objet, qui est utilisé par le contrôle d’arborescence, plutôt qu’un handle vers un contrôle ToolTip.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a> CTreeCtrl :: GetVisibleCount

Appelez cette fonction pour récupérer le nombre d’éléments visibles dans un contrôle TreeView.

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre d’éléments visibles dans le contrôle TreeView ; sinon-1.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetCheck](#setcheck).

## <a name="ctreectrlhittest"></a><a name="hittest"></a> CTreeCtrl :: HitTest

Appelez cette fonction pour déterminer l’emplacement du point spécifié par rapport à la zone cliente d’un contrôle TreeView.

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>Paramètres

*pt*<br/>
Coordonnées clientes du point à tester.

*pFlags*<br/>
Pointeur vers un entier qui reçoit des informations sur les résultats du test de positionnement. Il peut s’agir d’une ou plusieurs des valeurs listées sous le `flags` membre dans la section Notes.

*pHitTestInfo*<br/>
Adresse d’une structure [TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) qui contient la position à laquelle effectuer un test de positionnement et qui reçoit des informations sur les résultats du test de positionnement.

### <a name="return-value"></a>Valeur renvoyée

Handle de l’élément d’arborescence qui occupe le point spécifié ou NULL si aucun élément n’occupe le point.

### <a name="remarks"></a>Notes

Lorsque cette fonction est appelée, le paramètre *PT* spécifie les coordonnées du point à tester. La fonction retourne le handle de l’élément au point spécifié ou NULL si aucun élément n’occupe le point. En outre, le paramètre *pFlags* contient une valeur qui indique l’emplacement du point spécifié. Les valeurs possibles sont les suivantes :

|Valeur|Description|
|-|-|
|TVHT_ABOVE|Au-dessus de la zone cliente.|
|TVHT_BELOW|Sous la zone cliente.|
|TVHT_NOWHERE|Dans la zone cliente, mais sous le dernier élément.|
|TVHT_ONITEM|Sur l’image bitmap ou l’étiquette associée à un élément.|
|TVHT_ONITEMBUTTON|Sur le bouton associé à un élément.|
|TVHT_ONITEMICON|Sur l’image bitmap associée à un élément.|
|TVHT_ONITEMINDENT|Dans la mise en retrait associée à un élément.|
|TVHT_ONITEMLABEL|Sur l’étiquette (chaîne) associée à un élément.|
|TVHT_ONITEMRIGHT|Dans la zone située à droite d’un élément.|
|TVHT_ONITEMSTATEICON|Sur l’icône d’État pour un élément d’arborescence qui est dans un état défini par l’utilisateur.|
|TVHT_TOLEFT|À gauche de la zone cliente.|
|TVHT_TORIGHT|À droite de la zone cliente.|

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a> CTreeCtrl :: InsertItem

Appelez cette fonction pour insérer un nouvel élément dans un contrôle Tree View.

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>Paramètres

*lpInsertStruct*<br/>
Pointeur vers un `TVINSERTSTRUCT` qui spécifie les attributs de l’élément d’arborescence à insérer.

*nMask*<br/>
Entier spécifiant les attributs à définir. Consultez la `TVITEM` structure dans le SDK Windows.

*lpszItem*<br/>
Adresse d’une chaîne contenant le texte de l’élément.

*nImage*<br/>
Index de l’image de l’élément dans la liste d’images du contrôle TreeView.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle TreeView.

*nState*<br/>
Spécifie des valeurs pour les États de l’élément. Consultez les États des éléments de contrôle d’arborescence dans le SDK Windows pour obtenir la liste des États appropriés.

*nStateMask*<br/>
Spécifie les États à définir. Consultez la `TVITEM` structure dans le SDK Windows.

*lParam*<br/>
Valeur spécifique à l’application de taille pointeur associée à l’élément.

*hParent*<br/>
Handle du parent de l’élément inséré.

*hInsertAfter*<br/>
Handle de l’élément après lequel le nouvel élément doit être inséré.

### <a name="return-value"></a>Valeur renvoyée

Handle du nouvel élément en cas de réussite ; Sinon, NULL.

### <a name="remarks"></a>Notes

L’exemple montre des situations dans lesquelles vous pouvez souhaiter utiliser chaque version de la fonction lors de l’insertion d’un élément de contrôle d’arborescence.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a> CTreeCtrl :: ItemHasChildren

Utilisez cette fonction pour déterminer si l’élément d’arborescence spécifié par *hitem* a des éléments enfants.

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’élément d’arborescence spécifié par *hitem* a des éléments enfants ; 0 dans le cas contraire.

### <a name="remarks"></a>Notes

Dans ce cas, vous pouvez utiliser [CTreeCtrl :: GetChildItem](#getchilditem) pour récupérer ces éléments enfants.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetSelectedItem](#getselecteditem).

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a> CTreeCtrl :: MapAccIdToItem

Mappe l’identificateur d’accessibilité spécifié au handle d’un élément d’arborescence dans le contrôle d’affichage d’arborescence actuel.

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>Paramètres

*uAccId*\
dans Identificateur d’accessibilité pour un élément dans l’élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Handle d’un élément d’arborescence ( `HTREEITEM` ) qui correspond au paramètre *uAccId* . Pour plus d’informations, consultez le membre *hitem* de la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Notes

Les aides à l’accessibilité sont des applications qui aident les personnes handicapées à utiliser des ordinateurs. Un identificateur d’accessibilité est utilisé par l' `IAccessible` interface pour spécifier de manière unique un élément dans une fenêtre. Pour plus d’informations sur les identificateurs d’accessibilité, recherchez la rubrique « à propos de la prise en charge de Active Accessibility » sur [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le message [TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant utilise un identificateur d’accessibilité et la méthode [CTreeCtrl :: MapAccIdToItem](#mapaccidtoitem) pour récupérer un handle de l’élément d’arborescence racine. L’exemple utilise le handle et la méthode [CTreeCtrl :: GetItemPartRect](#getitempartrect) pour dessiner un rectangle 3D autour de cet élément. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Nous avons utilisé la méthode [CTreeCtrl :: MapItemToAccID](#mapitemtoaccid) pour associer l’élément d’arborescence racine à un identificateur d’accessibilité.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a> CTreeCtrl :: MapItemToAccID

Mappe le handle spécifié d’un élément d’arborescence dans le contrôle d’arborescence actuel à un identificateur d’accessibilité.

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle d’un élément d’arborescence dans le contrôle. Pour plus d’informations, consultez le membre *hitem* de la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="return-value"></a>Valeur renvoyée

Identificateur d’accessibilité qui correspond au paramètre *hitem* .

### <a name="remarks"></a>Notes

Les aides à l’accessibilité sont des applications qui aident les personnes handicapées à utiliser des ordinateurs. Un identificateur d’accessibilité est utilisé par l' `IAccessible` interface pour spécifier de manière unique un élément dans une fenêtre. Pour plus d’informations sur les identificateurs d’accessibilité, recherchez la rubrique « à propos de la prise en charge de Active Accessibility » sur [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le message [TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant obtient un numéro d’identification pour un élément de contrôle d’arborescence. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Cet exemple de code obtient un numéro d’identification unique pour le nœud de pays/région racine.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a> CTreeCtrl :: SELECT

Appelez cette fonction pour sélectionner l’élément d’arborescence donné, faire défiler l’élément dans l’affichage ou redessiner l’élément dans le style utilisé pour indiquer la cible d’une opération de glisser-déplacer.

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

*nCode*<br/>
Type d’action à effectuer. Ce paramètre peut prendre l’une des valeurs suivantes :

- TVGN_CARET définit la sélection sur l’élément donné.

- TVGN_DROPHILITE redessine l’élément donné dans le style utilisé pour indiquer la cible d’une opération de glisser-déplacer.

- TVGN_FIRSTVISIBLE fait défiler verticalement l’affichage de l’arborescence afin que l’élément donné soit le premier élément visible.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si *nCode* contient la valeur TVGN_CARET, la fenêtre parente reçoit les messages de notification TVN_SELCHANGING et TVN_SELCHANGED. De plus, si l’élément spécifié est l’enfant d’un élément parent réduit, la liste des éléments enfants du parent est développée pour révéler l’élément spécifié. Dans ce cas, la fenêtre parente reçoit les messages de notification TVN_ITEMEXPANDING et TVN_ITEMEXPANDED.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: HitTest](#hittest).

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a> CTreeCtrl :: SelectDropTarget

Appelez cette fonction pour redessiner l’élément dans le style utilisé pour indiquer la cible d’une opération de glisser-déplacer.

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a> CTreeCtrl :: SelectItem

Appelez cette fonction pour sélectionner l’élément d’arborescence donné.

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle d’un élément d’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si *hitem* a la valeur null, cette fonction ne sélectionne aucun élément.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a> CTreeCtrl :: SelectSetFirstVisible

Appelez cette fonction pour faire défiler verticalement l’affichage de l’arborescence afin que l’élément donné soit le premier élément visible.

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément d’arborescence à définir comme premier élément visible.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction envoie un message à la fenêtre avec les paramètres de message TVM_SELECTITEM et TVGN_FIRSTVISIBLE.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a> CTreeCtrl :: SetAutoscrollInfo

Définit le taux de défilement automatique du contrôle d’arborescence actuel.

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>Paramètres

*uPixelsPerSec*\
dans Nombre de pixels par seconde à faire défiler.

*uUpdateTime*\
dans Intervalle de temps entre les mises à jour du contrôle.

### <a name="return-value"></a>Valeur renvoyée

Retourne toujours la valeur TRUE.

### <a name="remarks"></a>Notes

Les paramètres de défilement automatique permettent de faire défiler l’affichage d’un élément qui n’est pas visible actuellement. Le contrôle Tree-View doit avoir le TVS_EX_AUTOHSCROLL style étendu, qui est décrit dans la section [styles étendus de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-extended-styles).

Cette méthode envoie le message [TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant définit le comportement de défilement automatique du contrôle TreeView actuel. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Nous avons volontairement rendu le contrôle d’arborescence étroit afin qu’il doive défiler automatiquement pour afficher l’élément d’arborescence qui a le focus. L’exemple de code définit le contrôle d’arborescence pour faire défiler automatiquement 30 pixels par seconde toutes les 5 secondes jusqu’à ce que l’élément d’arborescence soit affiché.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a> CTreeCtrl :: SetBkColor

Cette fonction membre implémente le comportement de la [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>Paramètres

*Language*<br/>
Valeur COLORREF qui contient la nouvelle couleur d’arrière-plan. Si cette valeur est-1, le contrôle revient à l’utilisation de la couleur système pour la couleur d’arrière-plan.

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui représente la couleur de texte actuelle. Si cette valeur est-1, le contrôle utilise la couleur système pour la couleur du texte.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: SetTextColor](#settextcolor).

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a> CTreeCtrl :: SetCheck

Appelez cette fonction membre pour définir l’état d’activation d’un élément de contrôle d’arborescence.

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
HTREEITEM pour recevoir la modification de l’état d’activation.

*Consultez*<br/>
Indique si l’élément de contrôle d’arborescence doit être activé ou désactivé. Par défaut, `SetCheck` définit l’élément à vérifier.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Lorsque l’élément de contrôle d’arborescence est activé ( *consultez* défini sur true), l’élément apparaît avec une coche adjacente.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>Exemple

Pour utiliser les cases à cocher, définissez TVS_CHECKBOXES avant de remplir le contrôle d’arborescence.

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a> CTreeCtrl :: SetExtendedStyle

Définit les styles étendus pour le contrôle d’affichage d’arborescence actuel.

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>Paramètres

*dwExMask*\
dans Masque de bits qui spécifie les styles du contrôle d’arborescence actuel qui sont affectés par cette méthode. Si ce paramètre est égal à zéro, il est ignoré et la valeur du paramètre *dwExStyles* est assignée au contrôle Tree-View. Spécifiez zéro ou une combinaison d’opérations de bits (ou) de styles décrits dans [les styles étendus de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-extended-styles).

*dwExStyles*\
dans Masque de bits qui spécifie les styles du contrôle d’affichage d’arborescence actuel à définir ou à décocher. Pour définir une combinaison de styles, spécifiez une combinaison au niveau du bit (ou) des styles décrits dans [les styles étendus de contrôle d’arborescence](/windows/win32/Controls/tree-view-control-window-extended-styles). Pour effacer un ensemble de styles, spécifiez zéro.

### <a name="return-value"></a>Valeur renvoyée

Valeur qui contient les styles de contrôle étendu précédents.

### <a name="remarks"></a>Notes

Cette méthode efface les styles spécifiés dans le paramètre *dwExMask* , puis définit les styles spécifiés dans le paramètre *dwExStyles* . Seuls les styles étendus qui correspondent aux bits dans *dwExMask* changent.

Cette méthode envoie le message [TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant ajoute le TVS_EX_AUTOHSCROLL style étendu au contrôle d’arborescence actuel. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Nous avons volontairement rendu le contrôle d’arborescence étroit afin qu’il doive défiler automatiquement pour afficher l’élément d’arborescence qui a le focus.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a> CTreeCtrl :: SetImageList

Appelez cette fonction pour définir la liste d’images normale ou d’État pour un contrôle d’arborescence et redessiner le contrôle à l’aide des nouvelles images.

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>Paramètres

*pImageList*<br/>
Pointeur vers la liste d’images à assigner. Si *pImageList* a la valeur null, toutes les images sont supprimées du contrôle TreeView.

*nImageListType*<br/>
Type de liste d’images à définir. La liste d’images peut prendre l’une des valeurs suivantes :

- TVSIL_NORMAL définit la liste d’images normale, qui contient les images sélectionnées et non sélectionnées pour l’élément d’arborescence. Vous devez utiliser cet État pour les images de superposition.

- TVSIL_STATE définit la liste d’images d’État, qui contient les images pour les éléments d’arborescence qui sont dans un état défini par l’utilisateur.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la liste d’images précédente, le cas échéant ; Sinon, NULL.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetImageList](#getimagelist).

## <a name="ctreectrlsetindent"></a><a name="setindent"></a> CTreeCtrl :: SetIndent

Appelez cette fonction pour définir la largeur de la mise en retrait d’un contrôle Tree View et redessiner le contrôle pour qu’il reflète la nouvelle largeur.

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>Paramètres

*nIndent*<br/>
Largeur, en pixels, de la mise en retrait. Si *nIndent* est inférieur à la largeur minimale définie par le système, la nouvelle largeur est définie sur la valeur minimale définie par le système.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetIndent](#getindent).

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a> CTreeCtrl :: SetInsertMark

Cette fonction membre implémente le comportement de la [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)de message Win32, comme décrit dans le SDK Windows.

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
HTREEITEM qui spécifie à quel élément la marque d’insertion sera placée. Si cet argument a la valeur NULL, la marque d’insertion est supprimée.

*fAfter*<br/>
Valeur BOOLÉENNE qui spécifie si la marque d’insertion est placée avant ou après l’élément spécifié. Si cet argument est différent de zéro, la marque d’insertion sera placée après l’élément. Si cet argument est égal à zéro, la marque d’insertion sera placée avant l’élément.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CTreeCtrl :: SetInsertMarkColor

Cette fonction membre implémente le comportement de la [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
Valeur COLORREF qui contient la nouvelle couleur de la marque d’insertion.

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui contient la couleur de la marque d’insertion précédente.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetInsertMarkColor](#getinsertmarkcolor).

## <a name="ctreectrlsetitem"></a><a name="setitem"></a> CTreeCtrl :: SetItem

Appelez cette fonction pour définir les attributs de l’élément d’arborescence spécifié.

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>Paramètres

*pItem*<br/>
Pointeur vers une structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) qui contient les nouveaux attributs d’élément, comme décrit dans la SDK Windows.

*hItem*<br/>
Handle de l’élément dont les attributs doivent être définis. Consultez le `hItem` membre de la `TVITEM` structure dans la SDK Windows.

*nMask*<br/>
Entier spécifiant les attributs à définir. Consultez le membre `mask` de la structure `TVITEM`.

*lpszItem*<br/>
Adresse d’une chaîne contenant le texte de l’élément.

*nImage*<br/>
Index de l’image de l’élément dans la liste d’images du contrôle TreeView. Consultez le membre `iImage` de la structure `TVITEM`.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle TreeView. Consultez le membre `iSelectedImage` de la structure `TVITEM`.

*nState*<br/>
Spécifie des valeurs pour les États de l’élément. Consultez le membre `State` de la structure `TVITEM`.

*nStateMask*<br/>
Spécifie les États à définir. Consultez le membre `stateMask` de la structure `TVITEM`.

*lParam*<br/>
Valeur spécifique à l’application de taille pointeur associée à l’élément.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Dans la `TVITEM` structure, le `hItem` membre identifie l’élément et le `mask` membre spécifie les attributs à définir.

Si le `mask` membre ou le paramètre *nMask* spécifie la valeur TVIF_TEXT, le `pszText` membre ou le *lpszItem* est l’adresse d’une chaîne terminée par le caractère null et le `cchTextMax` membre est ignoré. Si `mask` (ou *nMask*) spécifie la valeur TVIF_STATE, le `stateMask` membre ou le paramètre *nStateMask* spécifie l’état des éléments à modifier et le `state` paramètre member ou *nState* contient les valeurs de ces États.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a> CTreeCtrl :: SetItemData

Appelez cette fonction pour définir la valeur spécifique à l’application associée à l’élément spécifié.

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont les données doivent être récupérées.

*dwData*<br/>
Valeur spécifique à l’application de taille pointeur associée à l’élément spécifié par *hitem*.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a> CTreeCtrl :: SetItemExpandedImageIndex

Définit l’index de l’image à afficher lorsque l’élément spécifié du contrôle d’arborescence actuel est dans l’état développé.

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle vers un élément de contrôle d’arborescence.

*iExpandedImage*\
dans Index de l’image à afficher lorsque l’élément spécifié est dans l’état développé.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) , qui est décrit dans le SDK Windows. Cette méthode affecte le paramètre *iExpandedImage* au `iExpandedImage` membre d’une structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) , puis utilise cette structure dans le message.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant est un test trivial pour déterminer si la méthode [CTreeCtrl :: GetItemExpandedImageIndex](#getitemexpandedimageindex) retourne la valeur définie par la méthode [CTreeCtrl :: SetItemExpandedImageIndex](#setitemexpandedimageindex) . Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a> CTreeCtrl :: SetItemHeight

Cette fonction membre implémente le comportement de la [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)de message Win32, comme décrit dans le SDK Windows.

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>Paramètres

*cyHeight*<br/>
Spécifie la nouvelle hauteur de chaque élément de l’arborescence, en pixels. Si cet argument est inférieur à la hauteur des images, il prend la valeur de la hauteur des images. Si cet argument n’est pas pair, il sera arrondi à la valeur paire la plus proche. Si cet argument a la valeur-1, le contrôle revient à l’utilisation de sa hauteur d’élément par défaut.

### <a name="return-value"></a>Valeur renvoyée

Hauteur précédente des éléments, en pixels.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetItemHeight](#getitemheight).

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a> CTreeCtrl :: SetItemImage

Associe des images à un élément.

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont l’image doit être définie.

*nImage*<br/>
Index de l’image de l’élément dans la liste d’images du contrôle TreeView.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle TreeView.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Chaque élément d’un contrôle d’arborescence peut avoir une paire d’images bitmap qui lui sont associées. Les images apparaissent à gauche de l'étiquette d'un élément. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Appelez cette fonction pour définir l’index de l’image de l’élément et de son image sélectionnée dans la liste d’images du contrôle TreeView.

Pour plus d’informations sur les images, consultez [CImageList](../../mfc/reference/cimagelist-class.md).

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetItemImage](#getitemimage).

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a> CTreeCtrl :: SetItemState

Définit l’état de l’élément spécifié par *hitem*.

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont l’État doit être défini.

*nState*<br/>
Spécifie de nouveaux États pour l’élément.

*nStateMask*<br/>
Spécifie les États à modifier.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations sur les États, consultez [CTreeCtrl :: GetItem](#getitem).

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetItemState](#getitemstate).

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a> CTreeCtrl :: SetItemStateEx

Définit l’état étendu de l’élément spécifié dans le contrôle d’affichage d’arborescence actuel.

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle vers un élément de contrôle d’arborescence.

*uStateEx*\
dans État étendu de l’élément. Pour plus d’informations, consultez le `uStateEx` membre de la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TVM_SETITEM](/windows/win32/Controls/tvm-setitem) , qui est décrit dans le SDK Windows. Cette méthode affecte le paramètre *uStateEx* au `uStateEx` membre d’une structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) , puis utilise cette structure dans le message.

### <a name="example"></a>Exemple

L’exemple de code suivant définit une variable, `m_treeCtrl` , qui est utilisée pour accéder au contrôle Tree-View actuel. L’exemple de code définit également un entier non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant définit un élément d’affichage d’arborescence à l’état désactivé. Dans une section précédente de l’exemple de code, qui n’est pas affichée, nous avons créé une arborescence qui se compose d’un nœud racine de pays/région pour la États-Unis, de sous-nœuds pour les États de Pennsylvanie et de Washington, et d’éléments d’arborescence pour les villes dans ces États. Cet exemple de code affecte à l’état désactivé le nœud Pennsylvanie.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a> CTreeCtrl :: SetItemText

Définit le texte de l’élément spécifié par *hitem*.

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément dont le texte doit être défini.

*lpszItem*<br/>
Adresse d’une chaîne contenant le nouveau texte de l’élément

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a> CTreeCtrl :: SetLineColor

Appelez cette fonction membre pour définir la couleur de ligne actuelle pour le contrôle TreeView.

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
Nouvelle couleur de ligne.

### <a name="return-value"></a>Valeur renvoyée

Couleur de ligne précédente.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)de message Win32, comme décrit dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a> CTreeCtrl :: SetScrollTime

Appelez cette fonction membre pour définir la durée maximale de défilement pour le contrôle TreeView.

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>Paramètres

*uScrollTime*<br/>
Nouvelle durée maximale de défilement, en millisecondes. Si cette valeur est inférieure à 100, elle est arrondie à 100.

### <a name="return-value"></a>Valeur renvoyée

Temps de défilement maximal précédent, en millisecondes.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a> CTreeCtrl :: SetTextColor

Cette fonction membre implémente le comportement de la [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)de message Win32, comme décrit dans le SDK Windows.

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>Paramètres

*Language*<br/>
Valeur COLORREF qui contient la nouvelle couleur de texte. Si cet argument a la valeur-1, le contrôle revient à l’utilisation de la couleur système pour la couleur du texte.

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui représente la couleur de texte précédente. Si cette valeur est-1, le contrôle utilisait la couleur système pour la couleur du texte.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a> CTreeCtrl :: SetToolTips

Cette fonction membre implémente le comportement de la [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)de message Win32, comme décrit dans le SDK Windows.

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>Paramètres

*pWndTip*<br/>
Pointeur vers un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) que le contrôle d’arborescence utilisera.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) contenant l’info-bulle précédemment utilisée par le contrôle, ou null si aucune info-bulle n’a été précédemment utilisée.

### <a name="remarks"></a>Notes

Pour utiliser des info-bulles, indiquez le style de TVS_NOTOOLTIPS lorsque vous créez l' `CTreeCtrl` objet.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CTreeCtrl :: GetToolTips](#gettooltips).

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a> CTreeCtrl :: ShowInfoTip

Affiche l’info-bulle de l’élément spécifié dans le contrôle d’arborescence actuel.

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*\
dans Handle d’un élément d’arborescence dans le contrôle. Pour plus d’informations, consultez le `hItem` membre de la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) .

### <a name="remarks"></a>Notes

Pour plus d’informations sur la différence entre les info-bulles et les info-bulles, recherchez la rubrique « info-bulles et info-bulles » sur [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le message [TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip) , qui est décrit dans le SDK Windows.

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a> CTreeCtrl :: SortChildren

Appelez cette fonction pour trier par ordre alphabétique les éléments enfants de l’élément parent donné dans un contrôle TreeView.

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem*<br/>
Handle de l’élément parent dont les éléments enfants doivent être triés. Si *hitem* a la valeur null, le tri se poursuit à partir de la racine de l’arborescence.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

`SortChildren` ne parcourra pas de manière récursive l’arborescence ; Seuls les enfants immédiats de *hitem* seront triés.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a> CTreeCtrl :: SortChildrenCB

Appelez cette fonction pour trier les éléments de la vue de l’arborescence à l’aide d’une fonction de rappel définie par l’application qui compare les éléments.

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>Paramètres

*pSort*<br/>
Pointeur vers une structure [TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb) .

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction de comparaison de la structure, `lpfnCompare` , doit retourner une valeur négative si le premier élément doit précéder le deuxième, une valeur positive si le premier élément doit suivre le deuxième, ou zéro si les deux éléments sont équivalents.

Les paramètres *lParam1* et *lParam2* correspondent au `lParam` membre de la structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) pour les deux éléments comparés. Le paramètre *lParamSort* correspond au `lParam` membre de la `TV_SORTCB` structure.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>Voir aussi

[Exemple MFC CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CImageList (classe)](../../mfc/reference/cimagelist-class.md)
