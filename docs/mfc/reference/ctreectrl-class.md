---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 2b6c11600010bc9f97ab8c3a531d33c92c94e442
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752115"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Fournit les fonctionnalités du contrôle commun d’arborescence Windows.

## <a name="syntax"></a>Syntaxe

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|Construit un objet `CTreeCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CTreeCtrl::Créer](#create)|Crée un contrôle de vue d’arbre et l’attache à un `CTreeCtrl` objet.|
|[CTreeCtrl::CreateDragImage](#createdragimage)|Crée une bitmap traînante pour l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::CreateEx](#createex)|Crée un contrôle d’arbre avec les styles `CTreeCtrl` windows étendus spécifiés et le fixe à un objet.|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|Supprime tous les éléments dans un contrôle de vue d’arbre.|
|[CTreeCtrl::DeleteItem](#deleteitem)|Supprime un nouvel élément dans un contrôle de vue d’arbre.|
|[CTreeCtrl::EditLabel](#editlabel)|Modifie un élément de vue d’arbre spécifié sur place.|
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|Annule l’opération de modification sur l’étiquette d’un élément de vue sur les arbres dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|S’assure qu’un élément de vue d’arbre est visible dans son contrôle de vue d’arbre.|
|[CTreeCtrl::Expand](#expand)|Élargit, ou s’effondre, les articles d’enfant de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetBkColor](#getbkcolor)|Récupère la couleur de fond actuelle du contrôle.|
|[CTreeCtrl::GetCheck](#getcheck)|Récupère l’état de contrôle d’un élément de commande d’arbre.|
|[CTreeCtrl::GetChildItem](#getchilditem)|Récupère l’enfant d’un élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetCount](#getcount)|Récupère le nombre d’articles d’arbres associés à un contrôle de vue d’arbre.|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|Récupère la cible d’une opération de drag-and-drop.|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|Récupère la poignée du contrôle de modification utilisé pour modifier l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|Récupère les styles étendus que le contrôle actuel de la vue sur les arbres utilise.|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|Récupère le premier élément visible de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetImageList](#getimagelist)|Récupère la poignée de la liste d’images associée à un contrôle de vue d’arbre.|
|[CTreeCtrl::GetIndent](#getindent)|Récupère le décalage (en pixels) d’un élément de vue d’arbre de son parent.|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Récupère la couleur utilisée pour dessiner la marque d’insertion pour la vue sur l’arbre.|
|[CTreeCtrl::GetItem](#getitem)|Récupère les attributs d’un élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetItemData](#getitemdata)|Retourne la valeur spécifique à l’application associée à un élément.|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|Récupère l’index de l’image pour afficher lorsque l’élément spécifié du contrôle actuel de la vue d’arbre est dans l’état élargi.|
|[CTreeCtrl::GetItemHeight](#getitemheight)|Récupère la hauteur actuelle des éléments de vue de l’arbre.|
|[CTreeCtrl::GetItemImage](#getitemimage)|Récupère les images associées à un élément.|
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|Récupère le rectangle de délimitation pour une partie spécifiée d’un élément spécifié dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::GetItemRect](#getitemrect)|Récupère le rectangle de délimitation d’un élément de vue d’arbre.|
|[CTreeCtrl::GetItemState](#getitemstate)|Retourne l’état d’un article.|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|Récupère l’état étendu de l’élément spécifié dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::GetItemText](#getitemtext)|Retourne le texte d’un élément.|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|Récupère le dernier élément agrandi dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::GetLineColor](#getlinecolor)|Récupère la couleur de la ligne actuelle pour le contrôle de vue de l’arbre.|
|[CTreeCtrl::GetNextItem](#getnextitem)|Récupère l’élément de vue d’arbre suivant qui correspond à une relation spécifiée.|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|Récupère le prochain frère de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|Récupère l’élément visible suivant de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetParentItem](#getparentitem)|Récupère le parent de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|Récupère le frère précédent de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|Récupère l’élément visible précédent de l’élément de vue d’arbre spécifié.|
|[CTreeCtrl::GetRootItem](#getrootitem)|Récupère la racine de l’élément de vue spécifié de l’arbre.|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|Récupère le temps de défilement maximum pour le contrôle de la vue de l’arbre.|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|Récupère le nombre d’articles sélectionnés dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|Récupère l’élément de vue d’arbre actuellement sélectionné.|
|[CTreeCtrl::GetTextColor](#gettextcolor)|Récupère la couleur de texte actuelle du contrôle.|
|[CTreeCtrl::GetToolTips](#gettooltips)|Récupère la poignée à l’enfant ToolTip contrôle utilisé par un contrôle de vue d’arbre.|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|Récupère le nombre d’articles visibles associés à un contrôle de vue d’arbre.|
|[CTreeCtrl::HitTest](#hittest)|Retourne la position actuelle du curseur `CTreeCtrl` lié à l’objet.|
|[CTreeCtrl::InsertItem](#insertitem)|Insère un nouvel élément dans un contrôle de vue d’arbre.|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|Retourne nonzero si l’article spécifié a des articles d’enfant.|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|Cartographier l’identifiant d’accessibilité spécifié à la poignée à un élément de vue sur les arbres dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|Cartographie la poignée spécifiée à un élément de vue d’arbre dans le contrôle actuel de la vue des arbres à un identifiant d’accessibilité.|
|[CTreeCtrl::Sélectionner](#select)|Sélectionne, défile en vue ou redessule un élément de vue d’arbre spécifié.|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|Redessiner l’objet de l’arbre comme cible d’une opération de drag-and-drop.|
|[CTreeCtrl::SelectItem](#selectitem)|Sélectionne un élément de vue d’arbre spécifié.|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|Sélectionne un élément de vue d’arbre spécifié comme premier élément visible.|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|Définit le taux d’autoscroll du contrôle actuel de la vue des arbres.|
|[CTreeCtrl::SetBkColor](#setbkcolor)|Définit la couleur de fond du contrôle.|
|[CTreeCtrl::SetCheck](#setcheck)|Définit l’état de contrôle d’un élément de commande d’arbre.|
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|Définit les styles étendus pour le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::SetImageList](#setimagelist)|Définit la poignée de la liste d’images associée à un contrôle de vue d’arbre.|
|[CTreeCtrl::SetIndent](#setindent)|Définit le décalage (en pixels) d’un élément de vue d’arbre de son parent.|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|Définit la marque d’insertion dans un contrôle de vue d’arbre.|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Définit la couleur utilisée pour dessiner la marque d’insertion pour la vue sur l’arbre.|
|[CTreeCtrl::SetItem](#setitem)|Définit les attributs d’un élément de vue d’arbre spécifié.|
|[CTreeCtrl::SetItemData](#setitemdata)|Définit la valeur spécifique à l’application associée à un élément.|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|Définit l’index de l’image pour afficher lorsque l’élément spécifié du contrôle actuel de la vue d’arbre est dans l’état élargi.|
|[CTreeCtrl::SetItemHeight](#setitemheight)|Définit la hauteur des éléments de vue de l’arbre.|
|[CTreeCtrl::SetItemImage](#setitemimage)|Associe les images à un objet.|
|[CTreeCtrl::SetItemState](#setitemstate)|Définit l’état d’un élément.|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|Définit l’état étendu de l’élément spécifié dans le contrôle actuel de la vue des arbres.|
|[CTreeCtrl::SetItemText](#setitemtext)|Définit le texte d’un élément.|
|[CTreeCtrl::SetLineColor](#setlinecolor)|Définit la couleur de la ligne actuelle pour le contrôle de vue d’arbre.|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|Définit le temps de défilement maximum pour le contrôle de la vue de l’arbre.|
|[CTreeCtrl::SetTextColor](#settextcolor)|Définit la couleur du texte du contrôle.|
|[CTreeCtrl::SetToolTips](#settooltips)|Définit le contrôle de l’outil de contrôle de vue d’arbre.|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|Affiche l’infotip pour l’élément spécifié dans le contrôle actuel de vue d’arbre.|
|[CTreeCtrl::SortChildren](#sortchildren)|Trie les enfants d’un article parent donné.|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|Trie les enfants d’un article parent donné à l’aide d’une fonction de tri définie par l’application.|

## <a name="remarks"></a>Notes

Un « contrôle de vue d’arbre » est une fenêtre qui affiche une liste hiérarchique d’éléments, tels que les titres d’un document, les entrées dans un index, ou les fichiers et répertoires sur un disque. Chaque élément se compose d’une étiquette et d’une image bitmapped optionnelle, et chaque élément peut avoir une liste de subitems associés à elle. En cliquant sur un élément, l’utilisateur peut élargir et effondrer la liste associée des subitems.

Ce contrôle (et `CTreeCtrl` donc la classe) n’est disponible que pour les programmes fonctionnant sous Windows 98 et Windows NT version 4 et plus tard.

Pour plus d’informations sur l’utilisation `CTreeCtrl`, voir:

- [Contrôles](../../mfc/controls-mfc.md)

- [Utilisation de CTreeCtrl](../../mfc/using-ctreectrl.md)

- [Référence de contrôle de vue d’arbre](/windows/win32/Controls/tree-view-control-reference) dans le SDK windows.

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a>CTreeCtrl::Créer

Si vous spécifiez le contrôle de l’arbre dans un modèle de boîte de dialogue, ou si vous utilisez [CTreeView](../../mfc/reference/ctreeview-class.md), votre contrôle des arbres est créé automatiquement lorsque la boîte de dialogue ou la vue est créée.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle (en)*<br/>
Spécifie le style du contrôle de vue d’arbre. Appliquez des styles de fenêtre, décrits dans [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww), et toute combinaison de styles de contrôle de [vue d’arbre](/windows/win32/Controls/tree-view-control-window-styles) comme décrit dans le SDK windows.

*Rect*<br/>
Spécifie la taille et la position du contrôle de la vue sur l’arbre. Il peut s’agir soit d’un objet [CRect,](../../atl-mfc-shared/reference/crect-class.md) soit d’une structure [RECT.](/windows/win32/api/windef/ns-windef-rect)

*pParentWnd*<br/>
Spécifie la fenêtre parente du `CDialog`contrôle de vue d’arbre, habituellement a. Ce ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle de vue d’arbre.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’initialisation a été couronnée de succès; sinon 0.

### <a name="remarks"></a>Notes

Si vous voulez créer le contrôle de l’arbre comme `Create` une fenêtre enfant d’une autre fenêtre, utilisez la fonction membre. Si vous créez le `Create`contrôle de l’arbre en utilisant, vous devez le passer WS_VISIBLE, en plus d’autres styles de vue d’arbre.

Vous construisez un `CTreeCtrl` en deux étapes. Appelez d’abord le `Create`constructeur, puis appelez, ce qui crée `CTreeCtrl` le contrôle de vue de l’arbre et le fixe à l’objet.

Pour créer un contrôle des arbres avec des `Create`styles de fenêtre étendus, appelez [CreateEx](#createex) au lieu de .

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a>CTreeCtrl::CreateEx

Appelez cette fonction pour créer un contrôle (une `CTreeCtrl` fenêtre enfant) et l’associer à l’objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle (en anglais)*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour une liste de styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le Windows SDK.

*dwStyle (en)*<br/>
Spécifie le style du contrôle de vue d’arbre. Appliquez des styles de fenêtre, décrits dans [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww), et toute combinaison de styles de contrôle de [vue d’arbre](/windows/win32/Controls/tree-view-control-window-styles) comme décrit dans le SDK windows.

*Rect*<br/>
Une référence à une structure [RECT](/windows/win32/api/windef/ns-windef-rect) décrivant la taille et la position de la fenêtre à créer, dans les coordonnées des clients de *pParentWnd*.

*pParentWnd*<br/>
Un pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
L’id de fenêtre pour enfants du contrôle.

### <a name="return-value"></a>Valeur de retour

Nonzero si réussi autrement 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au lieu de [créer](#create) pour appliquer des styles Windows étendus, spécifiés par la préface de style étendu Windows **WS_EX_**.

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a>CTreeCtrl::CreateDragImage

Appelez cette fonction pour créer une bitmap traînante pour l’élément donné dans un contrôle de vue d’arbre, créer une liste d’image pour la bitmap, et ajouter la bitmap à la liste d’images.

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’objet de l’arbre à traîner.

### <a name="return-value"></a>Valeur de retour

Pointeur vers la liste d’images à laquelle le bitmap traînant a été ajouté, en cas de succès; autrement NULL.

### <a name="remarks"></a>Notes

Une application utilise les fonctions de liste d’images pour afficher l’image lorsque l’élément est traîné.

L’objet `CImageList` est permanent, et vous devez le supprimer une fois terminé. Par exemple :

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a>CTreeCtrl::CTreeCtrl

Construit un objet `CTreeCtrl`.

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a>CTreeCtrl::DeleteAllItems

Appelez cette fonction pour supprimer tous les éléments du contrôle de vue de l’arbre.

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a>CTreeCtrl::DeleteItem

Appelez cette fonction pour supprimer un élément du contrôle de vue de l’arbre.

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément de l’arbre à supprimer. Si *hitem* a la valeur TVI_ROOT, tous les éléments sont supprimés du contrôle de vue d’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a>CTreeCtrl::EditLabel

Appelez cette fonction pour commencer l’édition place du texte de l’élément spécifié.

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’objet à modifier.

### <a name="return-value"></a>Valeur de retour

En cas de succès, un pointeur de l’objet `CEdit` qui est utilisé pour modifier le texte de l’élément; autrement NULL.

### <a name="remarks"></a>Notes

L’édition est accomplie en remplaçant le texte de l’élément par un contrôle de modification à une seule ligne contenant le texte.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a>CTreeCtrl::EndEditLabelNow

Conclut l’opération de modification sur l’étiquette d’un élément de vue d’arbre dans le contrôle actuel de la vue des arbres.

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*fCancelWithoutSave*|[dans] VRAI pour jeter les modifications à l’élément de vue d’arbre avant de conclure l’opération de modification, ou FALSE pour enregistrer les modifications à l’élément de vue d’arbre avant de conclure l’opération.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_ENDEDITLABELNOW,](/windows/win32/Controls/tvm-endeditlabelnow) qui est décrit dans le SDK Windows.

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a>CTreeCtrl::EnsureVisible

Appelez cette fonction pour vous assurer qu’un élément de vue d’arbre est visible.

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’objet d’arbre étant rendu visible.

### <a name="return-value"></a>Valeur de retour

Retourne VRAI si le système a fait défiler les éléments dans le contrôle de la vue des arbres pour s’assurer que l’élément spécifié est visible. Sinon, la valeur de rendement est FALSE.

### <a name="remarks"></a>Notes

Si nécessaire, la fonction élargit l’élément parent ou fait défiler le contrôle de vue de l’arbre de sorte que l’élément est visible.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a>CTreeCtrl::Expand

Appelez cette fonction pour élargir ou effondrer la liste des articles pour enfants, le cas échéant, associés à l’élément parent donné.

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’objet d’arbre en cours d’agrandissement.

*nCode (en)*<br/>
Un drapeau indiquant le type d’action à prendre. Ce drapeau peut avoir l’une des valeurs suivantes :

- TVE_COLLAPSE effondre la liste.

- TVE_COLLAPSERESET effondre la liste et supprime les articles pour enfants. Le drapeau TVIS_EXPANDEDONCE’État est remis à zéro. Ce drapeau doit être utilisé avec le drapeau TVE_COLLAPSE.

- TVE_EXPAND élargit la liste.

- TVE_TOGGLE effondre la liste si elle est actuellement élargie ou agrandit si elle est actuellement effondrée.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl::EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a>CTreeCtrl::GetBkColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor), tel que décrit dans le SDK Windows.

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui représente la couleur actuelle de fond de fenêtre pour le contrôle. Si cette valeur est de -1, le contrôle utilise la couleur de la fenêtre du système. Dans ce cas, `::GetSysColor(COLOR_WINDOW)` vous pouvez utiliser pour obtenir la couleur du système actuel que le contrôle utilise.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetTextColor](#settextcolor).

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a>CTreeCtrl::GetCheck

Appelez cette fonction de membre pour récupérer l’état de contrôle d’un élément.

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Le HTREEITEM sur lequel recevoir les informations de l’État.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’élément de contrôle de l’arbre est vérifié; sinon 0.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetCheck](#setcheck).

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a>CTreeCtrl::GetChildItem

Appelez cette fonction pour récupérer l’élément de vue de l’arbre qui est l’enfant de l’élément spécifié par *hItem*.

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

La poignée de l’objet de l’enfant en cas de succès; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a>CTreeCtrl::GetCount

Appelez cette fonction pour récupérer un nombre d’articles dans un contrôle de vue d’arbre.

```
UINT GetCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’articles dans le contrôle de vue d’arbre.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a>CTreeCtrl::GetDropHilightItem

Appelez cette fonction pour récupérer l’élément qui est la cible d’une opération de drag-and-drop.

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>Valeur de retour

La poignée de l’article a chuté en cas de succès; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a>CTreeCtrl::GetEditControl

Appelez cette fonction pour récupérer la poignée du contrôle de modification utilisé pour modifier le texte d’un élément de vue d’arbre.

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur sur le contrôle de modification utilisé pour modifier le texte de l’élément, en cas de succès; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a>CTreeCtrl::GetExtendedStyle

Récupère les styles étendus que le contrôle actuel de la vue sur les arbres utilise.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur qui contient une combinaison peu sage (OU) des styles étendus du contrôle de vue d’arbre actuel. Pour plus d’informations, voir [Tree-View Control Extended Styles](/windows/win32/Controls/tree-view-control-window-extended-styles).

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_GETEXTENDEDSTYLE,](/windows/win32/Controls/tvm-getextendedstyle) qui est décrit dans le SDK Windows.

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a>CTreeCtrl::GetFirstVisibleItem

Appelez cette fonction pour récupérer le premier élément visible du contrôle de vue de l’arbre.

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>Valeur de retour

La poignée du premier élément visible; autrement NULL.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetCheck](#setcheck).

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a>CTreeCtrl::GetImageList

Appelez cette fonction pour récupérer la poignée de la liste d’images normale ou d’état associée au contrôle de vue d’arbre.

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>Paramètres

*nImageList*<br/>
Type de liste d’images à récupérer. La liste d’images peut être l’une des valeurs suivantes :

- TVSIL_NORMAL récupère la liste d’images normale, qui contient les images sélectionnées et non sélectionnées pour l’élément de vue de l’arbre.

- TVSIL_STATE récupère la liste d’images de l’État, qui contient les images pour les éléments de vue d’arbre qui sont dans un état défini par l’utilisateur.

### <a name="return-value"></a>Valeur de retour

Pointeur sur la liste d’images du contrôle en cas de succès; autrement NULL.

### <a name="remarks"></a>Notes

Chaque élément dans un contrôle de vue d’arbre peut avoir une paire d’images bitmapped associées à elle. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Pour plus d’informations sur les listes d’images, consultez la classe [CImageList.](../../mfc/reference/cimagelist-class.md)

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a>CTreeCtrl::GetIndent

Appelez cette fonction pour récupérer la quantité, en pixels, que les articles pour enfants sont en retrait par rapport à leurs articles parent.

```
UINT GetIndent() const;
```

### <a name="return-value"></a>Valeur de retour

La quantité d’indentation mesurée en pixels.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CTreeCtrl::GetInsertMarkColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor), tel que décrit dans le SDK Windows.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui contient la couleur actuelle de marque d’insertion.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a>CTreeCtrl::GetItem

Appelez cette fonction pour récupérer les attributs de l’élément de vue d’arbre spécifié.

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>Paramètres

*pItem (en)*<br/>
Un pointeur vers une structure [TVITEM,](/windows/win32/api/commctrl/ns-commctrl-tvitemw) tel que décrit dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl::DeleteItem](#deleteitem).

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a>CTreeCtrl::GetItemData

Appelez cette fonction pour récupérer la valeur spécifique à l’application associée à l’élément spécifié.

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont les données doivent être récupérées.

### <a name="return-value"></a>Valeur de retour

Une valeur spécifique à l’application de taille pointeur associée à l’élément spécifié par *hItem*.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a>CTreeCtrl::GetItemExpandedImageIndex

Récupère l’index de l’image pour afficher lorsque l’élément spécifié du contrôle actuel de la vue d’arbre est dans l’état élargi.

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Poignée à un élément de commande de vue d’arbre.|

### <a name="return-value"></a>Valeur de retour

L’index de l’image à afficher lorsque l’élément spécifié est dans l’état élargi.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_GETITEM,](/windows/win32/Controls/tvm-getitem) qui est décrit dans le SDK Windows. Ce message renvoie la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) qui décrit l’élément de `iExpandedImage` contrôle de la vue des arbres, puis cette méthode récupère le membre de cette structure.

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a>CTreeCtrl::GetItemHeight

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight), tel que décrit dans le SDK Windows.

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>Valeur de retour

La hauteur de l’élément, en pixels.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a>CTreeCtrl::GetItemImage

Chaque élément dans un contrôle de vue d’arbre peut avoir une paire d’images bitmapped associées à elle.

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
La poignée de l’élément dont l’image doit être récupérée.

*nImage (en)*<br/>
Un élément qui reçoit l’index de l’image de l’élément dans la liste d’images du contrôle de vue de l’arbre.

*nSelectedImage*<br/>
Un élément qui reçoit l’index de l’image sélectionnée de l’élément dans la liste d’image du contrôle de vue de l’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Les images apparaissent à gauche de l'étiquette d'un élément. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Appelez cette fonction pour récupérer l’index de l’image de l’élément et son image sélectionnée dans la liste d’images du contrôle de vue de l’arbre.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a>CTreeCtrl::GetItemPartRect

Récupère le rectangle de délimitation pour une partie spécifiée d’un élément spécifié dans le contrôle actuel de la vue des arbres.

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Poignée à un élément de commande de vue d’arbre.|
|*nPart*|[dans] Identifiant pour la pièce. Doit être mis à TVGIPR_BUTTON.|
|*lpRect*|[out] Pointeur vers une structure [RECT.](/windows/win32/api/windef/ns-windef-rect) Si cette méthode est réussie, la structure reçoit les coordonnées rectangle de la pièce spécifiée par *hItem* et *nPart*.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Chaque élément de commande d’arbre est délimité par un rectangle graphique. Chaque fois qu’un point dans ce rectangle est cliqué, l’élément est dit être *frappé*. Cette méthode renvoie le plus grand rectangle de telle sorte que lorsqu’un point dans le rectangle est cliqué, l’élément identifié par le paramètre *hItem* est touché.

Cette méthode envoie le message TVM_GETITEMPARTRECT, qui est décrit dans le SDK Windows. Pour plus d’informations, voir le [TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect) macro.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant utilise un identifiant d’accessibilité et la méthode [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) pour récupérer une poignée à l’élément de vue sur les arbres racines. Ensuite, l’exemple utilise la poignée et la méthode [CTreeCtrl::GetItemPartRect](#getitempartrect) pour dessiner un rectangle 3D autour de cet élément. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Nous avons utilisé la méthode [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) pour associer l’élément de vue sur les arbres racines à un identifiant d’accessibilité.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a>CTreeCtrl::GetItemRect

Appelez cette fonction pour récupérer le rectangle de délimitation pour *hItem* et déterminer si elle est visible ou non.

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
La poignée d’un élément de contrôle de vue d’arbre.

*lpRect*<br/>
Pointeur vers une structure [RECT](/windows/win32/api/windef/ns-windef-rect) qui reçoit le rectangle de délimitation. Les coordonnées sont relatives au coin supérieur gauche du contrôle de la vue de l’arbre.

*bTextOnly*<br/>
Si ce paramètre n’est pas zéro, le rectangle de délimitation ne comprend que le texte de l’élément. Sinon, il comprend la ligne entière que l’élément occupe dans le contrôle de vue d’arbre.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’élément est visible, avec le rectangle de délimitation contenu dans *lpRect*. Sinon, 0 avec *lpRect* uninitialized.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a>CTreeCtrl::GetItemState

Retourne l’état de l’élément spécifié par *hItem*.

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont l’état doit être récupéré.

*nStateMask (en)*<br/>
Masque indiquant un ou plusieurs états à récupérer. Pour plus d’informations sur les valeurs possibles pour `state` `stateMask` *nStateMask*, voir la discussion de la structure et des membres de la structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Un UINT qui détient le bitwise OU des valeurs spécifiées par nStateMask. Pour plus d’informations sur les valeurs possibles, voir [CTreeCtrl::GetItem](#getitem). Pour trouver la valeur d’un état spécifique, effectuez un peu de fonctionnement et de fonctionnement de la valeur de l’État et de la valeur de rendement, comme le montre l’exemple suivant.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a>CTreeCtrl::GetItemStateEx

Récupère l’état étendu de l’élément spécifié dans le contrôle actuel de la vue des arbres.

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Poignée à un élément de commande de vue d’arbre.|

### <a name="return-value"></a>Valeur de retour

L’état étendu de l’article. Pour plus d’informations, consultez le `uStateEx` membre de la structure [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_GETITEM,](/windows/win32/Controls/tvm-getitem) qui est décrit dans le SDK Windows. Ce message renvoie la structure [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) qui décrit l’élément de `uStateEx` contrôle de la vue des arbres, et cette méthode récupère le membre de cette structure.

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a>CTreeCtrl::GetItemText

Retourne le texte de l’élément spécifié par *hItem*.

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont le texte doit être récupéré.

### <a name="return-value"></a>Valeur de retour

Un `CString` objet contenant le texte de l’élément.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetNextItem](#getnextitem).

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a>CTreeCtrl::GetLastVisibleItem

Récupère le dernier nœud nonpandé dans le contrôle actuel de la vue des arbres.

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>Valeur de retour

La poignée au dernier élément de nœud nonpandé si la méthode est réussie; autrement, NULL.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_GETNEXTITEM,](/windows/win32/Controls/tvm-getnextitem) qui est décrit dans le SDK Windows. Pour plus d’informations, voir le drapeau TVGN_LASTVISIBLE dans le paramètre du *drapeau* de ce message.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Une ou plusieurs de ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant récupère une poignée à la dernière nœud nonpandée vue sur les arbres, puis dessine un rectangle 3D autour de cet élément. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a>CTreeCtrl::GetLineColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor), tel que décrit dans le SDK Windows.

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>Valeur de retour

La couleur de ligne actuelle.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a>CTreeCtrl::GetNextItem

Appelez cette fonction pour récupérer l’élément de vue de l’arbre qui a la relation spécifiée, indiquée par le paramètre *nCode,* à *hItem*.

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

*nCode (en)*<br/>
Un drapeau indiquant le type de relation avec *hItem*. Ce drapeau peut être l’une des valeurs suivantes :

- TVGN_CARET récupère l’article actuellement sélectionné.

- TVGN_CHILD récupère le premier élément enfant de l’élément spécifié par le *paramètre hItem.*

- TVGN_DROPHILITE récupère l’élément qui est la cible d’une opération de drag-and-drop.

- TVGN_FIRSTVISIBLE récupère le premier élément visible.

- TVGN_LASTVISIBLE récupère le dernier objet agrandi dans l’arbre. Cela ne récupère pas le dernier élément visible dans la fenêtre de vue sur les arbres.

- TVGN_NEXT récupère l’élément frère suivant.

- TVGN_NEXTVISIBLE récupère l’élément visible suivant qui suit l’élément spécifié.

- TVGN_PARENT récupère le parent de l’élément spécifié.

- TVGN_PREVIOUS récupère l’objet frère précédent.

- TVGN_PREVIOUSVISIBLE récupère le premier élément visible qui précède l’élément spécifié.

- TVGN_ROOT récupère le premier élément enfant de l’élément racine dont l’élément spécifié fait partie.

### <a name="return-value"></a>Valeur de retour

La poignée de l’article suivant en cas de succès; autrement NULL.

### <a name="remarks"></a>Notes

Cette fonction retournera NULL si l’élément récupéré est le nœud de racine de l’arbre. Par exemple, si vous utilisez ce message avec le drapeau TVGN_PARENT sur un enfant de premier niveau du nœud de racine de la vue de l’arbre, le message retournera NULL.

### <a name="example"></a>Exemple

Pour un exemple `GetNextItem` d’utilisation en boucle, voir [CTreeCtrl::DeleteItem](#deleteitem).

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a>CTreeCtrl::GetNextSiblingItem

Appelez cette fonction pour récupérer le prochain frère de *hItem*.

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément frère suivant; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a>CTreeCtrl::GetNextVisibleItem

Appelez cette fonction pour récupérer le prochain élément visible de *hItem*.

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément visible suivant; autrement NULL.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetCheck](#setcheck).

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a>CTreeCtrl::GetParentItem

Appelez cette fonction pour récupérer le parent de *hItem*.

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément parent; autrement NULL.

### <a name="remarks"></a>Notes

Cette fonction retournera NULL si le parent de l’élément spécifié est le nœud de racine de l’arbre.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl::EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a>CTreeCtrl::GetPrevSiblingItem

Appelez cette fonction pour récupérer le frère précédent de *hItem*.

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

Le manche de l’ancien frère; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a>CTreeCtrl::GetPrevVisibleItem

Appelez cette fonction pour récupérer l’élément visible précédent de *hItem*.

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

La poignée de l’article visible précédent; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a>CTreeCtrl::GetRootItem

Appelez cette fonction pour récupérer l’élément racine du contrôle de vue de l’arbre.

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément racine; autrement NULL.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl::EditLabel](#editlabel).

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a>CTreeCtrl::GetScrollTime

Appelez cette fonction de membre pour récupérer le temps de défilement maximum pour le contrôle de vue d’arbre.

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>Valeur de retour

Le temps de défilement maximum, en millisecondes.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime), tel que décrit dans le SDK Windows.

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a>CTreeCtrl::GetSelectedCount

Récupère le nombre d’articles sélectionnés dans le contrôle actuel de la vue des arbres.

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>Valeur de retour

Nombre d’éléments sélectionnés.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_GETSELECTEDCOUNT,](/windows/win32/Controls/tvm-getselectedcount) qui est décrit dans le SDK Windows.

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a>CTreeCtrl::GetSelectedItem

Appelez cette fonction pour récupérer l’élément actuellement sélectionné du contrôle de vue de l’arbre.

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément sélectionné; autrement NULL.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a>CTreeCtrl::GetTextColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor), tel que décrit dans le SDK Windows.

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui représente la couleur de texte actuelle. Si cette valeur est de -1, le contrôle utilise la couleur du système pour la couleur du texte.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetTextColor](#settextcolor).

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a>CTreeCtrl::GetToolTips

Cette fonction de membre implémente le comportement du message Win32 [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips), tel que décrit dans le SDK Windows.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) à utiliser par le contrôle de l’arbre. Si la fonction [membre Create](#create) utilise le style TVS_NOTOOLTIPS, aucune boîte à outils n’est utilisée, et NULL est retourné.

### <a name="remarks"></a>Notes

La mise en `GetToolTips` œuvre MFC de renvois d’un `CToolTipCtrl` objet, qui est utilisé par le contrôle de l’arbre, plutôt que d’une poignée à un contrôle de bout d’outil.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a>CTreeCtrl::GetVisibleCount

Appelez cette fonction pour récupérer un compte des éléments visibles dans un contrôle de vue d’arbre.

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’articles visibles dans le contrôle de la vue d’arbre; autrement - 1.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetCheck](#setcheck).

## <a name="ctreectrlhittest"></a><a name="hittest"></a>CTreeCtrl::HitTest

Appelez cette fonction pour déterminer l’emplacement du point spécifié par rapport à la zone cliente d’un contrôle de vue d’arbre.

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>Paramètres

*Pt*<br/>
Coordonnées des clients du point à tester.

*pFlags*<br/>
Pointeur vers un intégreur qui reçoit des informations sur les résultats du test à succès. Il peut s’agir d’une `flags` ou de plusieurs des valeurs énumérées sous le membre dans la section Remarques.

*pHitTestInfo (en anglais)*<br/>
Adresse d’une structure [TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) qui contient la position de frapper le test et qui reçoit des informations sur les résultats du test à succès.

### <a name="return-value"></a>Valeur de retour

La poignée de l’élément de vue de l’arbre qui occupe le point spécifié ou NULL si aucun élément n’occupe le point.

### <a name="remarks"></a>Notes

Lorsque cette fonction est appelée, le *paramètre pt* spécifie les coordonnées du point à tester. La fonction renvoie la poignée de l’élément au point spécifié ou NULL si aucun élément n’occupe le point. En outre, le *paramètre pFlags* contient une valeur qui indique l’emplacement du point spécifié. Les valeurs possibles sont les suivantes :

|||
|-|-|
|Valeur|Signification|
|TVHT_ABOVE|Au-dessus de la zone client.|
|TVHT_BELOW|En dessous de la zone client.|
|TVHT_NOWHERE|Dans la zone client, mais en dessous du dernier élément.|
|TVHT_ONITEM|Sur la bitmap ou l’étiquette associée à un article.|
|TVHT_ONITEMBUTTON|Sur le bouton associé à un élément.|
|TVHT_ONITEMICON|Sur la bitmap associée à un élément.|
|TVHT_ONITEMINDENT|Dans l’indentation associée à un élément.|
|TVHT_ONITEMLABEL|Sur l’étiquette (corde) associée à un article.|
|TVHT_ONITEMRIGHT|Dans la zone à droite d’un article.|
|TVHT_ONITEMSTATEICON|Sur l’icône d’état pour un élément de vue d’arbre qui est dans un état défini par l’utilisateur.|
|TVHT_TOLEFT|A gauche de la zone client.|
|TVHT_TORIGHT|A droite de la zone client.|
|||

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a>CTreeCtrl::InsertItem

Appelez cette fonction pour insérer un nouvel élément dans un contrôle de vue d’arbre.

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>Paramètres

*lpInsertStruct*<br/>
Un pointeur `TVINSERTSTRUCT` à un qui spécifie les attributs de l’élément de vue d’arbre à insérer.

*nMask (nMask)*<br/>
Integer spécifiant quels attributs définir. Voir `TVITEM` la structure dans le Windows SDK.

*lpszItem (en)*<br/>
Adresse d’une chaîne contenant le texte de l’élément.

*nImage (en)*<br/>
Index de l’image de l’élément dans la liste d’image du contrôle de vue d’arbre.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle de vue d’arbre.

*nState (États-Unis)*<br/>
Spécifie les valeurs des états de l’article. Voir les états de contrôle de vue d’arbre dans le SDK windows pour une liste des états appropriés.

*nStateMask (en)*<br/>
Précise quels états doivent être définis. Voir `TVITEM` la structure dans le Windows SDK.

*lParam*<br/>
Une valeur spécifique à l’application de taille pointeur associée à l’élément.

*hParent*<br/>
Poignée du parent de l’objet inséré.

*hInsertAprès*<br/>
Poignée de l’élément après lequel le nouvel élément doit être inséré.

### <a name="return-value"></a>Valeur de retour

Poignée du nouvel article en cas de succès; autrement NULL.

### <a name="remarks"></a>Notes

L’exemple montre les situations dans lesquelles vous pouvez utiliser chaque version de la fonction lors de l’insertion d’un élément de contrôle de l’arbre.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a>CTreeCtrl::ItemHasChildren

Utilisez cette fonction pour déterminer si l’objet de l’arbre spécifié par *hItem* a des articles pour enfants.

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’objet de l’arbre spécifié par *hItem* a des articles d’enfant; 0 si ce n’est pas le cas.

### <a name="remarks"></a>Notes

Si c’est le cas, vous pouvez ensuite utiliser [CTreeCtrl::GetChildItem](#getchilditem) pour récupérer ces articles pour enfants.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetSelectedItem](#getselecteditem).

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a>CTreeCtrl::MapAccIdToItem

Cartographier l’identifiant d’accessibilité spécifié à la poignée d’un élément de vue sur les arbres dans le contrôle actuel de la vue des arbres.

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*uAccId (en)*|[dans] Un identifiant d’accessibilité pour un élément de l’élément de vue d’arbre.|

### <a name="return-value"></a>Valeur de retour

La poignée à un élément `HTREEITEM`de vue d’arbre ( ) qui correspond au paramètre *uAccId.* Pour plus d’informations, voir le membre *hItem* de la structure [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)

### <a name="remarks"></a>Notes

Les aides à l’accessibilité sont des applications qui aident les personnes handicapées à utiliser des ordinateurs. Un identifiant d’accessibilité `IAccessible` est utilisé par l’interface pour spécifier un élément unique dans une fenêtre. Pour plus d’informations sur les identifiants d’accessibilité, recherchez le thème « About Active Accessibility Support » chez [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le [message TVM_MAPACCIDTOHTREEITEM,](/windows/win32/Controls/tvm-mapaccidtohtreeitem) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant utilise un identifiant d’accessibilité et la méthode [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) pour récupérer une poignée à l’élément de vue sur les arbres racines. L’exemple utilise la poignée et la méthode [CTreeCtrl::GetItemPartRect](#getitempartrect) pour dessiner un rectangle 3D autour de cet élément. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Nous avons utilisé la méthode [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) pour associer l’élément de vue sur les arbres racines à un identifiant d’accessibilité.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a>CTreeCtrl::MapItemToAccID

Cartographie la poignée spécifiée d’un élément de vue d’arbre dans le contrôle actuel de la vue des arbres à un identifiant d’accessibilité.

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Une poignée d’un élément de vue d’arbre dans le contrôle. Pour plus d’informations, voir le membre *hItem* de la structure [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="return-value"></a>Valeur de retour

L’identifiant d’accessibilité qui correspond au *paramètre hItem.*

### <a name="remarks"></a>Notes

Les aides à l’accessibilité sont des applications qui aident les personnes handicapées à utiliser des ordinateurs. Un identifiant d’accessibilité `IAccessible` est utilisé par l’interface pour spécifier un élément unique dans une fenêtre. Pour plus d’informations sur les identifiants d’accessibilité, recherchez le thème « About Active Accessibility Support » chez [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le [message TVM_MAPHTREEITEMTOACCID,](/windows/win32/Controls/tvm-maphtreeitemtoaccid) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant obtient un numéro d’identification pour un élément de contrôle de vue d’arbre. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Cet exemple de code obtient un numéro d’identification unique pour le nœud de pays/région racine.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a>CTreeCtrl::Sélectionner

Appelez cette fonction pour sélectionner l’élément de vue de l’arbre donné, faire défiler l’élément en vue ou redessiner l’élément dans le style utilisé pour indiquer la cible d’une opération de drag-and-drop.

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

*nCode (en)*<br/>
Le type d’action à prendre. Ce paramètre peut être l’une des valeurs suivantes :

- TVGN_CARET définit la sélection à l’élément donné.

- TVGN_DROPHILITE redessiner l’élément donné dans le style utilisé pour indiquer la cible d’une opération de drag-and-drop.

- TVGN_FIRSTVISIBLE Faites défiler la vue de l’arbre verticalement de sorte que l’élément donné est le premier élément visible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si *le code contient* la valeur TVGN_CARET, la fenêtre parente reçoit les messages de notification TVN_SELCHANGING et TVN_SELCHANGED. En outre, si l’élément spécifié est l’enfant d’un article parent effondré, la liste des articles pour enfants du parent est élargie pour révéler l’élément spécifié. Dans ce cas, la fenêtre parente reçoit les messages de notification TVN_ITEMEXPANDING et TVN_ITEMEXPANDED.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:HitTest](#hittest).

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a>CTreeCtrl::SelectDropTarget

Appelez cette fonction pour redessiner l’élément dans le style utilisé pour indiquer la cible d’une opération de drag-and-drop.

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a>CTreeCtrl::SelectItem

Appelez cette fonction pour sélectionner l’élément de vue d’arbre donné.

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée d’un objet d’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si *hItem* est NULL, alors cette fonction ne sélectionne aucun élément.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a>CTreeCtrl::SelectSetFirstVisible

Appelez cette fonction pour faire défiler la vue de l’arbre verticalement de sorte que l’élément donné est le premier élément visible.

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’objet de l’arbre à définir comme premier élément visible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction envoie un message à la fenêtre avec les paramètres TVM_SELECTITEM et TVGN_FIRSTVISIBLE message.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a>CTreeCtrl::SetAutoscrollInfo

Définit le taux d’autoscroll du contrôle actuel de la vue des arbres.

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*uPixelsPerSec*|[dans] Le nombre de pixels par seconde à faire défiler.|
|*uUpdateTime (en)*|[dans] L’intervalle de temps entre les mises à jour du contrôle.|

### <a name="return-value"></a>Valeur de retour

Retourne toujours VRAI.

### <a name="remarks"></a>Notes

Les paramètres de l’autoscroll sont utilisés pour faire défiler en vue un élément qui n’est actuellement pas visible. Le contrôle de vue d’arbre doit avoir le style étendu TVS_EX_AUTOHSCROLL, qui est décrit dans [Tree-View Control Extended Styles](/windows/win32/Controls/tree-view-control-window-extended-styles).

Cette méthode envoie le [message TVM_SETAUTOSCROLLINFO,](/windows/win32/Controls/tvm-setautoscrollinfo) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant définit le comportement d’autoscroll du contrôle actuel de vue d’arbre. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Nous avons intentionnellement fait le contrôle de vue d’arbre étroit de sorte qu’il doit automatiquement faire défiler pour afficher l’élément d’arbre qui a la mise au point. L’exemple du code définit le contrôle de la vue des arbres pour faire défiler automatiquement 30 pixels par seconde toutes les 5 secondes jusqu’à ce que l’élément de l’arbre soit en vue.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a>CTreeCtrl::SetBkColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor), tel que décrit dans le SDK Windows.

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>Paramètres

*Clr*<br/>
Une valeur COLORREF qui contient la nouvelle couleur de fond. Si cette valeur est de -1, le contrôle reviendra à l’utilisation de la couleur du système pour la couleur de fond.

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui représente la couleur de texte actuelle. Si cette valeur est de -1, le contrôle utilise la couleur du système pour la couleur du texte.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:SetTextColor](#settextcolor).

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a>CTreeCtrl::SetCheck

Appelez cette fonction de membre pour définir l’état de contrôle pour un élément de commande d’arbre.

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Le HTREEITEM pour recevoir le changement d’état de contrôle.

*fCheck*<br/>
Indique si l’élément de commande de l’arbre doit être vérifié ou non contrôlé. Par défaut, `SetCheck` définit l’élément à vérifier.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Lorsque l’élément de commande de l’arbre est vérifié *(fCheck* réglé sur TRUE), l’article apparaît avec une case à carreaux adjacente.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>Exemple

Pour utiliser des case à cocher, réglez TVS_CHECKBOXES avant de remplir le contrôle de l’arbre.

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a>CTreeCtrl::SetExtendedStyle

Définit les styles étendus pour le contrôle actuel de la vue des arbres.

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*dwExMask (en anglais)*|[dans] Un petit-s qui spécifie quels styles dans le contrôle actuel de la vue des arbres sont affectés par cette méthode. Si ce paramètre est nul, il est ignoré et la valeur du paramètre *dwExStyles* est attribuée au contrôle de la vue des arbres.<br /><br /> Spécifier zéro ou une combinaison bitwise (OU) de styles décrits dans [Tree-View Control Extended Styles](/windows/win32/Controls/tree-view-control-window-extended-styles).|
|*dwExStyles (en anglais)*|[dans] Un petit-s qui spécifie quels styles dans le contrôle actuel de la vue des arbres à définir ou à dégager.<br /><br /> Pour définir une combinaison de styles, spécifiez une combinaison bitwise (OU) de styles décrits dans [Tree-View Control Extended Styles](/windows/win32/Controls/tree-view-control-window-extended-styles). Pour effacer un ensemble de styles, spécifiez zéro.|

### <a name="return-value"></a>Valeur de retour

Une valeur qui contient les précédents styles de contrôle étendus.

### <a name="remarks"></a>Notes

Cette méthode efface les styles spécifiés dans le paramètre *dwExMask,* puis définit les styles spécifiés dans le paramètre *dwExStyles.* Seuls les styles étendus qui correspondent aux bits dans *dwExMask* changer.

Cette méthode envoie le [message TVM_SETEXTENDEDSTYLE,](/windows/win32/Controls/tvm-setextendedstyle) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant ajoute le style TVS_EX_AUTOHSCROLL étendu au contrôle actuel de la vue des arbres. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Nous avons intentionnellement fait le contrôle de vue d’arbre étroit de sorte qu’il doit automatiquement faire défiler pour afficher l’élément d’arbre qui a la mise au point.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a>CTreeCtrl::SetImageList

Appelez cette fonction pour définir la liste d’images normale ou d’état pour un contrôle de vue d’arbre et redessiner le contrôle à l’aide des nouvelles images.

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>Paramètres

*pImageList (en)*<br/>
Pointeur vers la liste d’images à attribuer. Si *pImageList* est NULL, toutes les images sont retirées du contrôle de vue de l’arbre.

*nImageListType (en)*<br/>
Type de liste d’images à définir. La liste d’images peut être l’une des valeurs suivantes :

- TVSIL_NORMAL définit la liste d’images normale, qui contient les images sélectionnées et non sélectionnées pour l’élément de vue de l’arbre. Vous devez utiliser cet état pour superposer des images.

- TVSIL_STATE définit la liste d’images de l’état, qui contient les images pour les éléments de vue d’arbre qui sont dans un état défini par l’utilisateur.

### <a name="return-value"></a>Valeur de retour

Pointeur vers la liste d’images précédente, le cas échéant; autrement NULL.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetImageList](#getimagelist).

## <a name="ctreectrlsetindent"></a><a name="setindent"></a>CTreeCtrl::SetIndent

Appelez cette fonction pour définir la largeur de l’indentation pour un contrôle de vue d’arbre et redessiner le contrôle pour refléter la nouvelle largeur.

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>Paramètres

*nIndent*<br/>
Largeur, en pixels, de l’indentation. Si *nIndent* est inférieur à la largeur minimale définie par le système, la nouvelle largeur est définie au minimum défini par le système.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetIndent](#getindent).

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a>CTreeCtrl::SetInsertMark

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark), tel que décrit dans le SDK Windows.

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
HTREEITEM qui précise à quel élément la marque d’insertion sera placée. Si cet argument est NULL, la marque d’insertion est supprimée.

*fAprès*<br/>
Valeur BOOL qui spécifie si la marque d’insertion est placée avant ou après l’élément spécifié. Si cet argument n’est paszero, la marque d’insertion sera placée après l’élément. Si cet argument est nul, la marque d’insertion sera placée avant l’élément.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CTreeCtrl::SetInsertMarkColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor), tel que décrit dans le SDK Windows.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
Une valeur COLORREF qui contient la nouvelle couleur de marque d’insertion.

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui contient la couleur précédente de marque d’insertion.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetInsertMarkColor](#getinsertmarkcolor).

## <a name="ctreectrlsetitem"></a><a name="setitem"></a>CTreeCtrl::SetItem

Appelez cette fonction pour définir les attributs de l’élément de vue spécifié de l’arbre.

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>Paramètres

*pItem (en)*<br/>
Un pointeur vers une structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) qui contient les attributs du nouvel élément, tel que décrit dans le SDK Windows.

*hItem (en)*<br/>
Poignée de l’élément dont les attributs doivent être définis. Voir `hItem` le membre `TVITEM` de la structure dans le SDK Windows.

*nMask (nMask)*<br/>
Integer spécifiant quels attributs définir. Consultez le membre `mask` de la structure `TVITEM`.

*lpszItem (en)*<br/>
Adresse d’une chaîne contenant le texte de l’élément.

*nImage (en)*<br/>
Index de l’image de l’élément dans la liste d’image du contrôle de vue d’arbre. Consultez le membre `iImage` de la structure `TVITEM`.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle de vue d’arbre. Consultez le membre `iSelectedImage` de la structure `TVITEM`.

*nState (États-Unis)*<br/>
Spécifie les valeurs des états de l’article. Consultez le membre `State` de la structure `TVITEM`.

*nStateMask (en)*<br/>
Précise quels états doivent être définis. Consultez le membre `stateMask` de la structure `TVITEM`.

*lParam*<br/>
Une valeur spécifique à l’application de taille pointeur associée à l’élément.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Dans `TVITEM` la structure, le `hItem` membre identifie `mask` l’élément, et le membre spécifie quels attributs à définir.

Si `mask` le membre ou le paramètre *nMask* spécifie la valeur TVIF_TEXT, le `pszText` membre ou le `cchTextMax` *lpszItem* est l’adresse d’une chaîne non terminée et le membre est ignoré. Si `mask` (ou *nMask*) spécifie la `stateMask` valeur TVIF_STATE, le membre ou le paramètre *nStateMask* spécifie quel élément modifier et le `state` paramètre membre ou *nState* contient les valeurs de ces États.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a>CTreeCtrl::SetItemData

Appelez cette fonction pour définir la valeur spécifique à l’application associée à l’élément spécifié.

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont les données doivent être récupérées.

*dwData dwData*<br/>
Une valeur spécifique à l’application de taille pointeur associée à l’élément spécifié par *hItem*.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a>CTreeCtrl::SetItemExpandedImageIndex

Définit l’index de l’image pour afficher lorsque l’élément spécifié du contrôle actuel de la vue d’arbre est dans l’état élargi.

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Poignée à un élément de commande de vue d’arbre.|
|*iExpandedImage*|[dans] L’index de l’image à afficher lorsque l’élément spécifié est dans l’état élargi.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_SETITEM,](/windows/win32/Controls/tvm-setitem) qui est décrit dans le SDK Windows. Cette méthode attribue le paramètre *iExpandedImage* au `iExpandedImage` membre d’une structure [TVITEMEX,](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) puis utilise cette structure dans le message.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant est un test trivial pour déterminer si la méthode [CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex) retourne la valeur définie par la méthode [CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex) méthode. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a>CTreeCtrl::SetItemHeight

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight), tel que décrit dans le SDK Windows.

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>Paramètres

*cyHeight*<br/>
Spécifie la nouvelle hauteur de chaque élément dans la vue de l’arbre, en pixels. Si cet argument est inférieur à la hauteur des images, alors il sera réglé à la hauteur des images. Si cet argument n’est même pas, il sera arrondi vers le bas à la valeur la plus proche même. Si cet argument est de -1, le contrôle reviendra à l’utilisation de sa hauteur d’élément par défaut.

### <a name="return-value"></a>Valeur de retour

La hauteur précédente des éléments, en pixels.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetItemHeight](#getitemheight).

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a>CTreeCtrl::SetItemImage

Associe les images à un objet.

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont l’image doit être définie.

*nImage (en)*<br/>
Index de l’image de l’élément dans la liste d’image du contrôle de vue d’arbre.

*nSelectedImage*<br/>
Index de l’image sélectionnée de l’élément dans la liste d’images du contrôle de vue d’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Chaque élément dans un contrôle de vue d’arbre peut avoir une paire d’images bitmapped associées à elle. Les images apparaissent à gauche de l'étiquette d'un élément. Une image est affichée lorsque l'élément est sélectionné, et l'autre est affichée lorsque l'élément n'est pas sélectionné. Par exemple, un élément peut afficher un dossier ouvert lorsqu’il est sélectionné et un dossier fermé lorsqu’il ne l’est pas.

Appelez cette fonction pour définir l’index de l’image de l’élément et son image sélectionnée dans la liste d’images du contrôle de vue de l’arbre.

Pour plus d’informations sur les images, voir [CImageList](../../mfc/reference/cimagelist-class.md).

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetItemImage](#getitemimage).

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a>CTreeCtrl::SetItemState

Définit l’état de l’élément spécifié par *hItem*.

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont l’état doit être défini.

*nState (États-Unis)*<br/>
Spécifie de nouveaux états pour l’article.

*nStateMask (en)*<br/>
Précise quels états doivent être modifiés.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations sur les États, voir [CTreeCtrl::GetItem](#getitem).

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetItemState](#getitemstate).

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a>CTreeCtrl::SetItemStateEx

Définit l’état étendu de l’élément spécifié dans le contrôle actuel de la vue des arbres.

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Poignée à un élément de commande de vue d’arbre.|
|*uStateEx (en anglais)*|[dans] L’état étendu de l’article. Pour plus d’informations, consultez le `uStateEx` membre de la structure [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TVM_SETITEM,](/windows/win32/Controls/tvm-setitem) qui est décrit dans le SDK Windows. Cette méthode attribue le paramètre `uStateEx` *uStateEx* au membre d’une structure [TVITEMEX,](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) puis utilise cette structure dans le message.

### <a name="example"></a>Exemple

L’exemple de code suivant `m_treeCtrl`définit une variable, qui est utilisée pour accéder au contrôle actuel de la vue des arbres. L’exemple de code définit également un integer non signé et plusieurs variables HTREEITEM. Ces variables sont utilisées dans l’exemple suivant.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Exemple

L’exemple de code suivant définit un élément de vue d’arbre à l’état désactivé. Dans une section antérieure de l’exemple du code, qui n’est pas montrée, nous avons créé une vue d’arbre qui se compose d’un pays racine/nœud de région pour les États-Unis, de sous-nodes pour les États de Pennsylvanie et de Washington, et d’articles d’arbres pour les villes de ces États. Cet exemple de code définit le nœud de Pennsylvanie à l’état désactivé.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a>CTreeCtrl::SetItemText

Définit le texte de l’élément spécifié par *hItem*.

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément dont le texte doit être défini.

*lpszItem (en)*<br/>
Adresse d’une chaîne contenant le nouveau texte pour l’élément

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a>CTreeCtrl::SetLineColor

Appelez cette fonction de membre pour définir la couleur de ligne actuelle pour le contrôle de vue d’arbre.

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
La nouvelle couleur de ligne.

### <a name="return-value"></a>Valeur de retour

La couleur de ligne précédente.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor), tel que décrit dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a>CTreeCtrl::SetScrollTime

Appelez cette fonction de membre pour définir le temps de défilement maximum pour le contrôle de vue d’arbre.

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>Paramètres

*uScrollTime (en)*<br/>
Le nouveau temps de défilement maximum, en millisecondes. Si cette valeur est inférieure à 100, elle sera arrondie jusqu’à 100.

### <a name="return-value"></a>Valeur de retour

Le temps de défilement maximum précédent, en millisecondes.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime), tel que décrit dans le SDK Windows.

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a>CTreeCtrl::SetTextColor

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor), tel que décrit dans le SDK Windows.

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>Paramètres

*Clr*<br/>
Une valeur COLORREF qui contient la nouvelle couleur de texte. Si cet argument est de -1, le contrôle reviendra à l’utilisation de la couleur du système pour la couleur du texte.

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui représente la couleur de texte précédente. Si cette valeur est de -1, le contrôle utilisait la couleur du système pour la couleur du texte.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a>CTreeCtrl::SetToolTips

Cette fonction de membre implémente le comportement du message Win32 [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips), tel que décrit dans le SDK Windows.

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>Paramètres

*pWndTip*<br/>
Un pointeur à un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) que le contrôle de l’arbre utilisera.

### <a name="return-value"></a>Valeur de retour

Un pointeur à un objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) contenant la boîte à outils précédemment utilisée par le contrôle, ou NULL si aucune boîte à outils n’a été utilisée auparavant.

### <a name="remarks"></a>Notes

Pour utiliser des outils, indiquez le style TVS_NOTOOLTIPS `CTreeCtrl` lorsque vous créez l’objet.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CTreeCtrl:GetToolTips](#gettooltips).

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a>CTreeCtrl::ShowInfoTip

Affiche l’infotip pour l’élément spécifié dans le contrôle actuel de vue d’arbre.

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*hItem (en)*|[dans] Une poignée à un élément de vue d’arbre dans le contrôle. Pour plus d’informations, consultez le `hItem` membre de la structure [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="remarks"></a>Notes

Pour plus d’informations sur la différence entre les outils et les infotips, recherchez le sujet "Tooltips et Infotips" sur [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Cette méthode envoie le [message TVM_SHOWINFOTIP,](/windows/win32/Controls/tvm-showinfotip) qui est décrit dans le SDK Windows.

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a>CTreeCtrl::SortChildren

Appelez cette fonction pour trier par ordre alphabétique les articles de l’objet parent donné dans un contrôle de vue d’arbre.

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>Paramètres

*hItem (en)*<br/>
Poignée de l’élément parent dont les articles pour enfants doivent être triés. Si *hItem* est NULL, le tri se déroulera à partir de la racine de l’arbre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

`SortChildren`ne se récurera pas à travers l’arbre; seuls les enfants immédiats de *hItem* seront triés.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a>CTreeCtrl::SortChildrenCB

Appelez cette fonction pour trier les éléments de vue d’arbre à l’aide d’une fonction de rappel définie par l’application qui compare les éléments.

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>Paramètres

*pSort*<br/>
Pointeur vers une structure [TVSORTCB.](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction de comparaison `lpfnCompare`de la structure, doit retourner une valeur négative si le premier élément doit précéder le second, une valeur positive si le premier élément doit suivre le second, ou zéro si les deux éléments sont équivalents.

Les paramètres *lParam1* et *lParam2* correspondent au `lParam` membre de la structure [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) pour les deux éléments comparés. Le *paramètre lParamSort* `lParam` correspond au `TV_SORTCB` membre de la structure.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>Voir aussi

[Échantillon MFC CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CImageList, classe](../../mfc/reference/cimagelist-class.md)
