---
title: CFileDialog (classe)
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: c301766b64af7fc1523b39adad91d9b52a5e88f7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506598"
---
# <a name="cfiledialog-class"></a>CFileDialog (classe)

Encapsule la boîte de dialogue commune utilisée pour les opérations d’ouverture de fichier ou d’enregistrement de fichier.

## <a name="syntax"></a>Syntaxe

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CFileDialog:: CFileDialog](#cfiledialog)|Construit un objet `CFileDialog`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CFileDialog:: AddCheckButton](#addcheckbutton)|Ajoute un bouton de vérification à la boîte de dialogue.|
|[CFileDialog::AddComboBox](#addcombobox)|Ajoute une zone de liste déroulante à la boîte de dialogue.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Ajoute un élément à un contrôle conteneur dans la boîte de dialogue.|
|[CFileDialog::AddEditBox](#addeditbox)|Ajoute une zone d’édition à la boîte de dialogue.|
|[CFileDialog::AddMenu](#addmenu)|Ajoute un menu à la boîte de dialogue.|
|[CFileDialog:: AddPlace](#addplace)|Surchargé. Ajoute un dossier à la liste des emplacements disponibles pour l’utilisateur afin d’ouvrir ou d’enregistrer des éléments.|
|[CFileDialog:: AddPushButton](#addpushbutton)|Ajoute un bouton à la boîte de dialogue.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Ajoute un groupe de cases d’option à la boîte de dialogue.|
|[CFileDialog:: AddSeparator](#addseparator)|Ajoute un séparateur à la boîte de dialogue.|
|[CFileDialog::AddText](#addtext)|Ajoute du contenu de texte à la boîte de dialogue.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Met à jour l’état de `CFileDialog` pour qu’il corresponde aux paramètres et aux indicateurs stockés dans la `m_ofn` variable membre.|
|[CFileDialog::D oModal](#domodal)|Affiche la boîte de dialogue et permet à l’utilisateur d’effectuer une sélection.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Active une liste déroulante du bouton **ouvrir** ou **Enregistrer** dans la boîte de dialogue.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Arrête l’ajout d’éléments à un groupe visuel dans la boîte de dialogue.|
|[CFileDialog:: GetCheckButtonState](#getcheckbuttonstate)|Obtient l’état actuel d’un bouton de vérification (case à cocher) dans la boîte de dialogue.|
|[CFileDialog:: GetControlItemState](#getcontrolitemstate)|Obtient l’état actuel d’un élément dans un contrôle conteneur trouvé dans la boîte de dialogue.|
|[CFileDialog:: GetControlState](#getcontrolstate)|Obtient la visibilité actuelle et les États activés d’un contrôle donné.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtient le texte actuel dans un contrôle de zone d’édition.|
|[CFileDialog:: GetFileExt](#getfileext)|Retourne l’extension du fichier sélectionné.|
|[CFileDialog:: GetFileName](#getfilename)|Retourne le nom de fichier du fichier sélectionné.|
|[CFileDialog:: GetFileTitle](#getfiletitle)|Retourne le titre du fichier sélectionné.|
|[CFileDialog:: GetFolderPath](#getfolderpath)|Récupère le chemin d’accès du dossier ou du répertoire actuellement ouvert pour une boîte de dialogue **ouvrir** ou **Enregistrer sous** de style Explorateur.|
|[CFileDialog:: GetIFileDialogCustomize](#getifiledialogcustomize)|Récupère l’objet com interne pour un objet personnalisé `CFileDialog` .|
|[CFileDialog:: GetIFileOpenDialog](#getifileopendialog)|Récupère l’objet com interne pour un `CFileDialog` utilisé comme boîte de dialogue **ouvrir** un fichier.|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Récupère l’objet com interne pour un `CFileDialog` utilisé comme boîte de dialogue **Enregistrer** le fichier.|
|[CFileDialog:: GetNextPathName](#getnextpathname)|Retourne le chemin d’accès complet du prochain fichier sélectionné.|
|[CFileDialog:: GetOFN](#getofn)|Récupère la `OPENFILENAME` structure de l' `CFileDialog` objet.|
|[CFileDialog:: GetPathName](#getpathname)|Retourne le chemin d’accès complet du fichier sélectionné.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Retourne l’État en lecture seule du fichier sélectionné.|
|[CFileDialog:: GetResult](#getresult)|Obtient le choix effectué par l’utilisateur dans la boîte de dialogue.|
|[CFileDialog:: GetResults](#getresults)|Obtient les choix de l’utilisateur dans une boîte de dialogue qui autorise la sélection multiple.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtient un élément particulier à partir des contrôles de conteneur spécifiés dans la boîte de dialogue.|
|[CFileDialog:: GetStartPosition](#getstartposition)|Retourne la position du premier élément de la liste de noms de fichiers.|
|[CFileDialog:: HideControl](#hidecontrol)|Masque le contrôle spécifié dans une boîte de dialogue **ouvrir** ou **Enregistrer comme** commune de style Explorateur.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Détermine si la boîte de dialogue active est en mode sélecteur de dossiers.|
|[CFileDialog::MakeProminent](#makeprominent)|Place un contrôle dans la boîte de dialogue pour qu’il soit comparé à d’autres contrôles ajoutés.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Supprime un élément d’un contrôle conteneur dans la boîte de dialogue.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Définit l’état actuel d’un bouton de vérification (case à cocher) dans la boîte de dialogue.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Définit l’état actuel d’un élément dans un contrôle conteneur trouvé dans la boîte de dialogue.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Définit le texte d’un élément de contrôle. Par exemple, le texte qui accompagne une case d’option ou un élément dans un menu.|
|[CFileDialog:: SetControlLabel](#setcontrollabel)|Définit le texte associé à un contrôle, tel qu’un texte de bouton ou une étiquette de zone d’édition.|
|[CFileDialog:: SetControlState](#setcontrolstate)|Définit la visibilité actuelle et les États activés d’un contrôle donné.|
|[CFileDialog:: SetControlText](#setcontroltext)|Définit le texte pour le contrôle spécifié dans une boîte de dialogue **ouvrir** ou **Enregistrer comme** commune de style Explorateur.|
|[CFileDialog:: SetDefExt](#setdefext)|Définit l’extension de nom de fichier par défaut pour une boîte de dialogue **ouvrir** ou **Enregistrer comme** commune de style Explorateur.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Définit le texte actuel dans un contrôle de zone d’édition.|
|[CFileDialog:: SetProperties](#setproperties)|Fournit une banque de propriétés qui définit les valeurs par défaut à utiliser pour l'élément en cours d'enregistrement.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Définit l’état sélectionné d’un élément particulier dans un groupe de cases d’option ou une zone de liste déroulante trouvée dans la boîte de dialogue.|
|[CFileDialog:: SetTemplate](#settemplate)|Définit le modèle de boîte de dialogue `CFileDialog` pour l’objet.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Déclare un groupe visuel dans la boîte de dialogue. Les appels suivants à toute méthode «Add» ajoutent ces éléments à ce groupe.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Met à jour les données stockées dans la `m_ofn` variable membre pour qu’elles correspondent à l’état actuel de la boîte de dialogue fichier.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CFileDialog:: OnButtonClicked](#onbuttonclicked)|Appelé suite à un clic sur le bouton.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Appelé lorsque la case à cocher est activée/désactivée.|
|[CFileDialog:: OnControlActivating](#oncontrolactivating)|Appelé lorsque le contrôle est actif.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Gère le message WM_NOTIFY CDN_SELCHANGE.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valide le nom de fichier entré dans la boîte de dialogue.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Gère le message WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Gère le message WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Appelé lorsque l’élément conteneur est sélectionné.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Vous permet d’effectuer des actions personnalisées lorsque la sélection de fichiers change.|
|[CFileDialog:: OnShareViolation](#onshareviolation)|Gère les violations de partage.|
|[CFileDialog::OnTypeChange](#ontypechange)|Gère le message WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membres de données publics

|Nom|Description|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|Structure Windows `OPENFILENAME` . Permet d’accéder aux paramètres de la boîte de dialogue fichier de base.|

## <a name="remarks"></a>Notes

Les boîtes de dialogue de fichier courantes vous permettent d’implémenter des boîtes de dialogue de sélection de fichier, par exemple, **ouvrir un fichier** et **Enregistrer sous**, de manière cohérente avec les normes Windows.

Vous pouvez utiliser `CFileDialog` comme c’est le cas avec le constructeur fourni, ou vous pouvez dériver votre propre `CFileDialog` classe de boîte de dialogue à partir de et écrire un constructeur pour répondre à vos besoins. Dans les deux cas, ces boîtes de dialogue se comportent comme des boîtes de dialogue MFC standard, car elles sont dérivées de la [classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`s’appuie sur le COMMDLG. Fichier DLL qui est inclus dans Windows.

L’apparence et la fonctionnalité du `CFileDialog` avec Windows Vista ou version ultérieure diffèrent de celles des versions antérieures de Windows. La valeur `CFileDialog` par défaut utilise automatiquement le nouveau style Windows Vista ou version ultérieure sans modification du code si un programme est compilé et exécuté sous Windows Vista ou version ultérieure. Utilisez le paramètre *bVistaStyle* dans le constructeur pour remplacer manuellement cette mise à jour automatique. L’exception à la mise à jour automatique est une boîte de dialogue personnalisée. Elles ne seront pas converties dans le nouveau style. Pour plus d’informations sur le constructeur, consultez [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  Le système ID de contrôle diffère dans Windows Vista ou version ultérieure des versions antérieures de Windows lorsque vous `CFileDialog`utilisez un. Vous devez mettre à jour toutes `CFileDialog` les références aux contrôles dans le code avant de pouvoir déplacer votre projet à partir d’une version antérieure de Windows.

Certaines `CFileDialog` méthodes ne sont pas prises en charge sous Windows Vista ou version ultérieure. Pour plus d’informations sur la prise en charge de la méthode, consultez la rubrique relative à la méthode individuelle. En outre, les fonctions héritées suivantes ne sont pas prises en charge sous Windows Vista ou version ultérieure:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Les messages Windows de la `CFileDialog` classe varient selon le système d’exploitation que vous utilisez. Par exemple, Windows XP ne prend pas en charge [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) et [CDialog:: OnOK](../../mfc/reference/cdialog-class.md#onok) pour la `CFileDialog` classe. Toutefois, les systèmes d’exploitation Windows Vista et versions ultérieures ne les prennent pas en charge. Pour plus d’informations sur les différents messages générés et l’ordre dans lequel ils sont reçus, consultez [l’exemple CFileDialog: Ordre](../../overview/visual-cpp-samples.md)des événements de journalisation.

Pour utiliser un `CFileDialog` objet, commencez par créer l’objet à l' `CFileDialog` aide du constructeur. Une fois la boîte de dialogue construite, vous pouvez définir ou modifier les valeurs de la structure [CFileDialog:: m_ofn](#m_ofn) pour initialiser les valeurs ou les États des contrôles de boîte de dialogue. La `m_ofn` structure est de type `OPENFILENAME`. Pour plus d’informations, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows.

Après avoir initialisé les contrôles de boîte de dialogue, appelez la méthode [CFileDialog::D omodal](#domodal) pour afficher la boîte de dialogue afin que l’utilisateur puisse taper le chemin d’accès et le nom de fichier. `DoModal`retourne une valeur indiquant si l’utilisateur a cliqué sur le bouton OK (IDOK) ou annuler (IDCANCEL). Si `DoModal` retourne IDOK, vous pouvez utiliser l’une `CFileDialog` des fonctions membres publiques pour récupérer les informations mises en place par l’utilisateur.

> [!NOTE]
> Sous Windows Vista ou version ultérieure, plusieurs appels à [IFileDialog:: SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) provoquent une erreur. Le deuxième appel à `SetFileTypes` pour toute instance de a `CFileDialog` retournera E_UNEXPECTED dans Windows Vista ou version ultérieure. Certaines `CFileDialog` fonctions de méthode `SetFileTypes`appellent. Par exemple, deux appels à `CFileDialog::DoModal` pour la même instance `CFileDialog` de génèrent [Assert](diagnostic-services.md#assert).

`CFileDialog`comprend plusieurs membres protégés qui vous permettent d’effectuer la gestion personnalisée des violations de partage, la validation du nom de fichier et la notification de modification de la zone de liste. Ces membres protégés sont des fonctions de rappel que la plupart des applications n’ont pas besoin d’utiliser car la gestion par défaut est effectuée automatiquement. Les entrées de la table des messages pour ces fonctions ne sont pas requises, car il s’agit de fonctions virtuelles standard.

Vous pouvez utiliser la fonction [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows pour déterminer si une erreur s’est produite lors de l’initialisation de la boîte de dialogue et pour en savoir plus sur l’erreur.

La destruction des `CFileDialog` objets est gérée automatiquement. Vous n’avez pas besoin d’appeler [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Pour permettre à l’utilisateur de sélectionner plusieurs fichiers, définissez l’indicateur OFN_ALLOWMULTISELECT avant `DoModal`d’appeler. Vous devez fournir votre propre mémoire tampon de nom de fichier pour prendre en charge la liste retournée de plusieurs noms de fichiers. Pour ce faire, `m_ofn.lpstrFile` remplacez par un pointeur vers une mémoire tampon que vous avez allouée `CFileDialog`, après avoir construit le `DoModal`, mais avant d’appeler.

En outre, vous devez définir `m_ofn.nMaxFile` en utilisant le nombre de caractères dans la mémoire tampon `m_ofn.lpstrFile`vers laquelle pointe. Si vous définissez le nombre maximal de fichiers à sélectionner `n`, la taille de mémoire tampon requise est. `n * (_MAX_PATH + 1) + 1` Le premier élément retourné dans la mémoire tampon est le chemin d’accès au dossier dans lequel les fichiers ont été sélectionnés. Pour les boîtes de dialogue de style Windows Vista ou version ultérieure, les chaînes de noms de fichiers et de répertoires se terminent par un caractère null, avec un caractère null supplémentaire après le dernier nom de fichier. Ce format permet aux boîtes de dialogue de style Explorateur de retourner des noms de fichiers longs qui incluent des espaces. Pour les anciennes boîtes de dialogue, les chaînes de noms de fichiers et de répertoires sont séparées par des espaces et la fonction utilise des noms de fichiers courts pour les noms de fichiers contenant des espaces.

L’exemple suivant montre comment utiliser une mémoire tampon pour récupérer et répertorier plusieurs noms de fichiers.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Pour modifier la taille de la mémoire tampon en réponse à l’utilisateur qui sélectionne plusieurs noms de fichiers, vous devez `CFileDialog` dériver une nouvelle classe de et substituer la méthode [CFileDialog:: OnFileNameChange](#onfilenamechange) .

Si vous dérivez une nouvelle `CFileDialog`classe de, vous pouvez utiliser une table des messages pour gérer les messages. Pour étendre la gestion des messages par défaut, dérivez une classe de `CFileDialog`, ajoutez une table des messages à la nouvelle classe et fournissez des fonctions membres pour les nouveaux messages. Vous n’avez pas besoin de fournir une fonction de raccordement pour personnaliser la boîte de dialogue.

Pour personnaliser la boîte de dialogue, dérivez `CFileDialog`une classe de, fournissez un modèle de boîte de dialogue personnalisé et ajoutez une table des messages pour traiter les messages de notification des contrôles étendus. Transmettez tous les messages non traités à la classe de base. Vous n’avez pas besoin de personnaliser la fonction de raccordement.

Lorsque vous utilisez le style Windows Vista ou version ultérieure du `CFileDialog`, vous ne pouvez pas utiliser les tables des messages et les modèles de boîte de dialogue. Au lieu de cela, vous devez utiliser les interfaces COM pour des fonctionnalités similaires.

Pour plus d’informations sur l’utilisation `CFileDialog`de, consultez [classes de boîtes de dialogue communes](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Configuration requise

**En-tête:** afxdlgs. h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

Ajoute un bouton de vérification à la boîte de dialogue.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du bouton de vérification à ajouter.

*strLabel*<br/>
Nom du bouton de vérification.

*bChecked*<br/>
Valeur booléenne indiquant l’état actuel du bouton de vérification. TRUE si l’option est activée; FALSe dans le cas contraire

### <a name="remarks"></a>Notes

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

Ajoute une zone de liste déroulante à la boîte de dialogue.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la zone de liste déroulante à ajouter.

### <a name="remarks"></a>Notes

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

Ajoute un élément à un contrôle conteneur dans la boîte de dialogue.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur auquel ajouter l’élément.

*dwIDItem*<br/>
ID de l’élément.

*strLabel*<br/>
Texte de l’élément.

### <a name="remarks"></a>Notes

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

Ajoute une zone d’édition à la boîte de dialogue.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la zone d’édition à ajouter.

*strText*<br/>
Nom de la zone d’édition.

### <a name="remarks"></a>Notes

##  <a name="addmenu"></a>  CFileDialog::AddMenu

Ajoute un menu à la boîte de dialogue.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du menu à ajouter.

*strLabel*<br/>
Nom du menu.

### <a name="remarks"></a>Notes

##  <a name="addplace"></a>CFileDialog:: AddPlace

Ajoute un dossier à la liste des emplacements disponibles pour l’utilisateur afin d’ouvrir ou d’enregistrer des éléments.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Paramètres

*lpszFolder*<br/>
Chemin d’accès au dossier à mettre à la disposition de l’utilisateur. Il peut s’agir uniquement d’un dossier.

*fdap*<br/>
Spécifie l’emplacement du dossier dans la liste.

*psi*<br/>
Pointeur vers un IShellItem qui représente le dossier à mettre à la disposition de l’utilisateur. Il peut s’agir uniquement d’un dossier.

### <a name="remarks"></a>Notes

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

Ajoute un bouton à la boîte de dialogue.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du bouton à ajouter.

*strLabel*<br/>
Nom du bouton.

### <a name="remarks"></a>Notes

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

Ajoute un groupe de cases d’option à la boîte de dialogue.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du groupe de cases d’option à ajouter.

### <a name="remarks"></a>Notes

##  <a name="addseparator"></a>CFileDialog:: AddSeparator

Ajoute un séparateur à la boîte de dialogue.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du séparateur ajouté.

### <a name="remarks"></a>Notes

##  <a name="addtext"></a>  CFileDialog::AddText

Ajoute du texte à la boîte de dialogue.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du texte à ajouter.

*strText*<br/>
Nom du texte.

### <a name="remarks"></a>Notes

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

Met à jour l’état actuel de [CFileDialog](../../mfc/reference/cfiledialog-class.md) en fonction des valeurs stockées dans la `m_ofn` structure de données.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Notes

Dans les versions de Windows antérieures à Windows Vista, la structure de données [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) du membre était constamment synchronisée avec `CFileDialog`l’état de. Toutes les modifications apportées à la variable de membre [m_ofn](#m_ofn) étaient immédiatement reflétées dans l’état de la boîte de dialogue. En outre, toute modification apportée à l’état de la boîte `m_ofn` de dialogue met immédiatement à jour la variable membre.

Dans Windows Vista ou version ultérieure, il n’est `m_ofn` pas garanti que les valeurs de `CFileDialog` la variable membre et de l’état de la ne soient pas synchronisées. Cette fonction force l’état du `CFileDialog` à être mis à jour pour correspondre à la `m_ofn` structure. Windows appelle cette fonction automatiquement pendant [CFileDialog::D omodal](#domodal).

Pour plus d’informations sur l’utilisation de `CFileDialog` la classe sous Windows Vista ou version ultérieure, consultez [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Appelez cette fonction pour créer une boîte de dialogue de fichier Windows standard.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Paramètres

*bOpenFileDialog*<br/>
dans Paramètre qui spécifie le type de boîte de dialogue à créer. Affectez-lui la valeur TRUE pour créer une boîte de dialogue d' **ouverture de fichier** . Affectez-lui la valeur FALSe pour créer une boîte de dialogue **fichier enregistrer sous** .

*lpszDefExt*<br/>
dans Extension de nom de fichier par défaut. Si l’utilisateur n’inclut pas d’extension connue (qui a une association sur l’ordinateur de l’utilisateur) dans la zone nom de fichier, l’extension spécifiée par *lpszDefExt* est automatiquement ajoutée au nom de fichier. Si ce paramètre a la valeur NULL, aucune extension n’est ajoutée.

*lpszFileName*<br/>
dans Nom de fichier initial qui apparaît dans la zone nom de fichier. Si la valeur est NULL, aucun nom de fichier initial ne s’affiche.

*dwFlags*<br/>
dans Combinaison d’un ou de plusieurs indicateurs que vous pouvez utiliser pour personnaliser la boîte de dialogue. Pour obtenir une description de ces indicateurs, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows. Si vous modifiez le `m_ofn.Flags` membre de structure, utilisez un opérateur or au niveau du bit dans vos modifications pour conserver le comportement par défaut intact.

*lpszFilter*<br/>
dans Série de paires de chaînes qui spécifient des filtres que vous pouvez appliquer au fichier. Si vous spécifiez des filtres de fichiers, seuls les fichiers qui correspondent aux critères de filtre s’affichent dans la liste fichiers. Pour plus d’informations sur l’utilisation des filtres de fichiers, consultez la section Notes.

*pParentWnd*<br/>
dans Pointeur vers la fenêtre parente ou propriétaire de la boîte de dialogue de fichier.

*dwSize*<br/>
dans Taille de la `OPENFILENAME` structure. Cette valeur dépend de la version du système d’exploitation. MFC utilise ce paramètre pour déterminer le type approprié de boîte de dialogue à créer. La taille par défaut de 0 signifie que le code MFC déterminera la taille correcte de la boîte de dialogue à utiliser en fonction de la version du système d’exploitation sur laquelle le programme est exécuté.

*bVistaStyle*<br/>
dans **Remarque** Ce paramètre est disponible dans Visual Studio 2008 et versions ultérieures et entraîne l’utilisation de la boîte de dialogue Nouveau style uniquement si vous exécutez Windows Vista ou une version ultérieure.

Paramètre qui spécifie le style de la boîte de dialogue de fichier. Affectez-lui la valeur TRUE pour utiliser les nouvelles boîtes de dialogue de fichier de style Vista. Dans le cas contraire, l’ancien style de boîtes de dialogue sera utilisé. Consultez la section Notes pour plus d’informations sur l’exécution de sous Vista.

### <a name="remarks"></a>Notes

Une boîte de dialogue **ouvrir un fichier** ou **Enregistrer sous** est construite, en fonction de la valeur de *bOpenFileDialog*.

La spécification d’une extension par défaut à l’aide de *lpszDefExt* peut ne pas produire le comportement attendu, car il est rarement prévisible quelles extensions ont des associations de fichiers sur l’ordinateur de l’utilisateur. Si vous avez besoin de davantage de contrôle sur l’ajout d’une extension par défaut, vous pouvez dériver `CFileDialog`votre propre classe de et `CFileDialog::OnFileNameOK` substituer la méthode pour effectuer votre propre gestion d’extension.

Pour permettre à l’utilisateur de sélectionner plusieurs fichiers, définissez l’indicateur OFN_ALLOWMULTISELECT avant d’appeler [DoModal](#domodal). Vous devez fournir votre propre mémoire tampon de nom de fichier pour stocker la liste retournée de plusieurs noms de fichiers. Pour ce faire, `m_ofn.lpstrFile` remplacez par un pointeur vers une mémoire tampon que vous avez allouée, après avoir construit le [CFileDialog](../../mfc/reference/cfiledialog-class.md), mais avant d’appeler `DoModal`. En outre, vous devez définir `m_ofn.nMaxFile` avec le nombre de caractères dans la mémoire tampon `m_ofn.lpstrFile`vers laquelle pointe. Si vous définissez le nombre maximal de fichiers à sélectionner, lataille de mémoire tampon nécessaire est `n`* (_ MAX_PATH + 1) + 1. Par exemple :

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Pour permettre à l’utilisateur de redimensionner une boîte de dialogue de style Explorateur à l’aide de la souris ou du clavier, définissez l’indicateur OFN_ENABLESIZING. La définition de cet indicateur est nécessaire uniquement si vous fournissez une procédure de raccordement ou un modèle personnalisé. L’indicateur fonctionne uniquement avec une boîte de dialogue de style Explorateur; les boîtes de dialogue de style ancien ne peuvent pas être redimensionnées.

Le paramètre *lpszFilter* est utilisé pour déterminer le type de nom de fichier qu’un fichier doit contenir pour être affiché dans la liste de fichiers. La première chaîne de la paire de chaînes décrit le filtre; la deuxième chaîne indique l’extension de nom de fichier à utiliser. Plusieurs extensions peuvent être spécifiées à l’aide d’un point-virgule (caractère «;») comme délimiteur. La chaîne se termine par&#124;deux caractères «», suivis d’un caractère null. Vous pouvez également utiliser un objet [CString](../../atl-mfc-shared/using-cstring.md) pour ce paramètre.

Par exemple, Microsoft Excel permet aux utilisateurs d’ouvrir des fichiers qui ont des extensions. xlc (Chart) ou. xls (feuille de calcul), entre autres. Le filtre pour Excel peut être écrit comme suit:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Toutefois, si vous envisagez d’utiliser cette chaîne pour mettre `OPENFILENAME` directement à jour la structure, vous devez délimiter vos chaînes avec le caractère null, «\ 0», au&#124;lieu des barres verticales («»).

Le paramètre *bVistaStyle* s’applique uniquement lors de l’exécution sous Windows Vista ou version ultérieure. Dans les versions antérieures de Windows, ce paramètre est ignoré. Si *bVistaStyle* a la valeur true, quand vous compilez un programme avec Visual Studio 2008 ou une version ultérieure, la **boîte de dialogue nouveau fichier** de style Vista est utilisée. Dans le cas contraire, la **boîte de dialogue** précédente du fichier de style MFC sera utilisée.

Les modèles de boîtes de dialogue ne sont pas pris en charge dans les boîtes de dialogue basées sur *bVistaStyle*

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CFileDialog::D omodal](#domodal).

##  <a name="domodal"></a>  CFileDialog::DoModal

Appelez cette fonction pour afficher la boîte de dialogue fichier commun de Windows et autoriser l’utilisateur à parcourir les fichiers et les répertoires et à entrer un nom de fichier.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valeur de retour

IDOK ou IDCANCEL. Si IDCANCEL est retourné, appelez la fonction [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) de Windows pour déterminer si une erreur s’est produite.

IDOK et IDCANCEL sont des constantes qui indiquent si l’utilisateur a sélectionné le bouton OK ou annuler.

### <a name="remarks"></a>Notes

Si vous souhaitez initialiser les différentes options de boîte de dialogue de fichier en définissant les `m_ofn` membres de la structure, vous devez effectuer `DoModal`cette opération avant d’appeler, mais après la construction de l’objet de boîte de dialogue.

Par exemple, si vous souhaitez autoriser l’utilisateur à sélectionner plusieurs fichiers, définissez l’indicateur OFN_ALLOWMULTISELECT avant d’appeler `DoModal`, comme indiqué dans l’exemple de code de cette rubrique.

Quand l’utilisateur clique sur les boutons OK ou annuler de la boîte de dialogue, ou sélectionne l’option fermer dans le menu de contrôle de la boîte de dialogue, le contrôle est retourné à votre application. Vous pouvez ensuite appeler d’autres fonctions membres pour récupérer les paramètres ou les informations entrées par l’utilisateur dans la boîte de dialogue.

`DoModal`est une fonction virtuelle substituée à partir `CDialog`de la classe.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

Active une liste déroulante du bouton ouvrir ou enregistrer dans la boîte de dialogue.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la liste déroulante.

### <a name="remarks"></a>Notes

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

Arrête l’ajout d’éléments à un groupe visuel dans la boîte de dialogue.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valeur de retour

Retourne S_OK en cas de réussite; valeur d’erreur dans le cas contraire.

### <a name="remarks"></a>Notes

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

Récupère l’état actuel d’un bouton de vérification (case à cocher) dans la boîte de dialogue.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la case à cocher.

*bChecked*<br/>
État de la case à cocher. TRUE indique que l’option est activée; FALSe indique qu’il est désactivé.

### <a name="remarks"></a>Notes

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

Récupère l’état actuel d’un élément dans un contrôle conteneur trouvé dans la boîte de dialogue.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément.

*dwState*<br/>
Référence à une variable qui reçoit une ou plusieurs valeurs de l’énumération CDCONTROLSTATE qui indique l’état actuel du contrôle.

### <a name="remarks"></a>Notes

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

Récupère la visibilité actuelle et les États activés d’un contrôle donné.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle.

*dwState*<br/>
Référence à une variable qui reçoit une ou plusieurs valeurs de l’énumération CDCONTROLSTATE qui indique l’état actuel du contrôle.

### <a name="remarks"></a>Notes

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

Récupère le texte actuel dans un contrôle de zone d’édition.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la zone d’édition.

*strText*<br/>
Valeur du texte.

### <a name="remarks"></a>Notes

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Appelez cette fonction pour récupérer l’extension du nom de fichier entré dans la boîte de dialogue.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valeur de retour

Extension du nom de fichier.

### <a name="remarks"></a>Notes

Par exemple, si le nom du fichier entré est données. Txt, `GetFileExt` retourne "txt".

Si `m_ofn.Flags` l’indicateur OFN_ALLOWMULTISELECT est défini, cette chaîne contient une séquence de chaînes terminées par le caractère null, la première chaîne étant le chemin d’accès au répertoire du groupe de fichiers sélectionné, suivi des noms de tous les fichiers sélectionnés par l’utilisateur. Pour récupérer les chemins d’accès des fichiers, utilisez les fonctions membres [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) .

##  <a name="getfilename"></a>  CFileDialog::GetFileName

Appelez cette fonction pour récupérer le nom du nom de fichier entré dans la boîte de dialogue.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valeur de retour

Nom du fichier.

### <a name="remarks"></a>Notes

Le nom du fichier contient à la fois le préfixe et l’extension. Par exemple, `GetFileName` retourne «Text». DAT» pour le fichier C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` a l' `OFN_ALLOWMULTISELECT` indicateur défini, vous devez appeler [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer un nom de chemin d’accès de fichier.

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

Appelez cette fonction pour récupérer le titre du fichier entré dans la boîte de dialogue.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valeur de retour

Titre du fichier.

### <a name="remarks"></a>Notes

Le titre du fichier contient uniquement son préfixe, sans le chemin d’accès ou l’extension. Par exemple, `GetFileTitle` retourne «Text» pour le fichier C:\FILES\TEXT.dat.

Si `m_ofn.Flags` l’indicateur OFN_ALLOWMULTISELECT est défini, cette chaîne contient une séquence de chaînes terminées par le caractère null, la première chaîne étant le chemin d’accès au répertoire du groupe de fichiers sélectionné, suivi des noms de tous les fichiers sélectionnés par l’utilisateur. Pour cette raison, utilisez les fonctions membres [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer le nom de fichier suivant dans la liste.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CFileDialog::D omodal](#domodal).

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

Appelez cette fonction membre pour récupérer le chemin d’accès du dossier ou du répertoire actuellement ouvert pour une boîte de dialogue Ouvrir ou enregistrer sous de style Explorateur.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valeur de retour

Objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) contenant le dossier ou le répertoire actuellement ouvert.

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; dans le cas contraire, la méthode échouera avec une assertion.

Vous pouvez appeler cette méthode uniquement lors de l’affichage de la boîte de dialogue. Une fois la boîte de dialogue fermée, cette fonction ne fonctionnera plus et la méthode échouera avec une assertion.

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

Récupère un pointeur vers l’objet COM interne pour un [CFileDialog](../../mfc/reference/cfiledialog-class.md)donné.

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet COM interne pour `CFileDialog`. Il vous incombe de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou version ultérieure avec un objet dont *bVistaStyle* a la valeur true. Si vous utilisez cette fonction quand *bVistaStyle* a la valeur false, elle retourne la valeur null en mode release et lève une assertion en mode débogage.

Pour plus d’informations sur `IFileDialogCustomize` l’interface, consultez [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Exemples

Cet exemple récupère l’objet COM interne. Pour exécuter cet exemple de code, vous devez le compiler sous Windows Vista ou une version ultérieure.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

Récupère un pointeur vers l’objet COM interne pour un donné `CFileDialog`.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet COM interne pour `CFileDialog`. Il vous incombe de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou version ultérieure avec un objet dont *bVistaStyle* a la valeur true. Cette fonction retourne la valeur null `CFileDialog` si le n’est pas une boîte de dialogue **ouverte** ou si *bVistaStyle* a la valeur false. Dans ce dernier cas, la fonction retourne uniquement la valeur NULL en mode release-en mode débogage, elle lève une assertion.

Pour plus d’informations sur `IFileOpenDialog` l’interface, consultez [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Exemple

Cet exemple récupère l’objet COM interne. Pour exécuter ce code, vous devez le compiler sous Windows Vista ou une version ultérieure.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

Récupère un pointeur vers l’objet COM interne pour un donné `CFileDialog`.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet COM interne pour `CFileDialog`. Il vous incombe de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou version ultérieure avec un objet dont *bVistaStyle* a la valeur true. Cette fonction retournera la valeur `CFileDialog` null si le n’est pas une boîte de dialogue **Enregistrer** ou si *bVistaStyle* a la valeur false. Dans ce dernier cas, la fonction retourne uniquement la valeur NULL en mode release-en mode débogage, elle lève une assertion.

Pour plus d’informations sur `IFileSaveDialog` l’interface, consultez [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Exemple

Cet exemple récupère l’objet COM interne. Pour exécuter cet exemple de code, vous devez le compiler sous Windows Vista ou une version ultérieure.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: GetNextPathName

Appelez cette fonction pour récupérer le nom de fichier suivant du groupe sélectionné dans la boîte de dialogue.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Paramètres

*imprim*<br/>
Référence à une valeur de position retournée par un `GetNextPathName` appel `GetStartPosition` de fonction ou précédent. NULL si la fin de la liste a été atteinte.

### <a name="return-value"></a>Valeur de retour

Chemin d’accès complet du fichier.

### <a name="remarks"></a>Notes

Le chemin d’accès au nom de fichier comprend le titre du fichier plus le chemin d’accès complet au répertoire. Par exemple, `GetNextPathName` retourne «C:\FILES\TEXT. DAT» pour le fichier C:\FILES\TEXT.DAT. Vous pouvez utiliser `GetNextPathName` dans une boucle d’itération directe si vous établissez la position initiale avec un `GetStartPosition`appel à.

Si la sélection se compose d’un seul fichier, ce nom de fichier est retourné.

##  <a name="getofn"></a>CFileDialog:: GetOFN

Récupère la structure associée `OPENFILENAME` .

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valeur de retour

Structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Notes

Utilisez la deuxième version de cette fonction pour initialiser l’apparence d’une boîte de dialogue **ouvrir un fichier** ou **Enregistrer sous,** une fois qu’elle a été construite mais avant `DoModal` qu’elle ne soit affichée avec la fonction membre. Par exemple, vous pouvez définir le `lpstrTitle` membre de `m_ofn` sur la légende que vous souhaitez attribuer à la boîte de dialogue.

##  <a name="getpathname"></a>  CFileDialog::GetPathName

Appelez cette fonction pour récupérer le chemin d’accès complet du fichier entré dans la boîte de dialogue.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valeur de retour

Chemin d’accès complet du fichier.

### <a name="remarks"></a>Notes

Le chemin d’accès au nom de fichier comprend le titre du fichier plus le chemin d’accès complet au répertoire. Par exemple, `GetPathName` retourne «C:\FILES\TEXT. DAT» pour le fichier C:\FILES\TEXT.DAT.

Si `m_ofn.Flags` l’indicateur OFN_ALLOWMULTISELECT est défini, cette chaîne contient une séquence de chaînes NULL-teminated, la première chaîne étant le chemin d’accès au répertoire du groupe de fichiers sélectionné, suivi des noms de tous les fichiers sélectionnés par l’utilisateur. Pour cette raison, utilisez les fonctions membres [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer le nom de fichier suivant dans la liste.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CFileDialog::D omodal](#domodal).

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Appelez cette fonction pour déterminer si la case à cocher en lecture seule a été activée dans les boîtes de dialogue fichier standard ouvrir et enregistrer sous.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro si la case à cocher en lecture seule de la boîte de dialogue est activée; Sinon, 0.

### <a name="remarks"></a>Notes

Vous pouvez masquer la case à cocher lecture seule en définissant le style `CFileDialog` OFN_HIDEREADONLY dans le constructeur.

> [!NOTE]
> Les objets de style `CFileDialog` Windows Vista ou version ultérieure ne prennent pas en charge cette fonction. Toute tentative d’utilisation de cette fonction sur un style `CFileDialog` Windows Vista ou version ultérieure lèvera [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>CFileDialog:: GetResult

Récupère le choix effectué par l’utilisateur dans la boîte de dialogue.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers un IShellItem qui représente le choix de l’utilisateur.

### <a name="remarks"></a>Notes

##  <a name="getresults"></a>CFileDialog:: GetResults

Récupère les choix de l’utilisateur dans une boîte de dialogue qui autorise la sélection multiple.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers un IShellItemArray par le biais duquel les éléments sélectionnés dans la boîte de dialogue sont accessibles.

### <a name="remarks"></a>Notes

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

Récupère un élément particulier du contrôle conteneur spécifié dans la boîte de dialogue.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément sélectionné par l’utilisateur dans le contrôle.

### <a name="remarks"></a>Notes

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

Appelez cette fonction membre pour récupérer la position du premier chemin d’accès de fichier dans la liste `m_ofn.Flags` , si l’indicateur OFN_ALLOWMULTISELECT est défini.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur de POSITION qui peut être utilisée pour l’itération; NULL si la liste est vide.

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

Appelez cette fonction membre pour masquer le contrôle spécifié dans une boîte de dialogue Ouvrir ou enregistrer comme commune de style Explorateur.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
ID du contrôle à masquer.

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; dans le cas contraire, la fonction échoue avec une assertion.

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

Détermine si la boîte de dialogue active est en mode sélecteur de dossiers.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la boîte de dialogue est en mode sélecteur de dossiers; Sinon, FALSe.

### <a name="remarks"></a>Notes

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn`est une structure de type `OPENFILENAME`. Les données de cette structure représentent l’état actuel de `CFileDialog`.

### <a name="remarks"></a>Notes

Utilisez cette structure pour initialiser l’apparence d’une boîte de dialogue **ouvrir un fichier** ou **Enregistrer sous** après l’avoir créée, mais avant de l’afficher avec la méthode [DoModal](#domodal) . Par exemple, vous pouvez définir le membre *lpstrTitle* de `m_ofn` sur la légende que vous souhaitez attribuer à la boîte de dialogue.

Avec le style Windows Vista ou version ultérieure de [CFileDialog](../../mfc/reference/cfiledialog-class.md), `m_ofn` n’est pas garanti de correspondre toujours à l’état de la boîte de dialogue. Elle est synchronisée avec la boîte de dialogue des versions antérieures de Windows. Pour plus d’informations sur la synchronisation de la `m_ofn` structure et de l' `CFileDialog` État sous Windows Vista ou version ultérieure, consultez [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog) et [CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) .

Les `CFileDialog`boîtes de dialogue de fichier de style Windows Vista ou version ultérieure ne prennent pas en charge certains membres et indicateurs de. Par conséquent, ils n’auront aucun effet.

La liste suivante répertorie les membres qui ne sont pas pris en charge par Windows Vista ou version ultérieure:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Les indicateurs suivants ne sont pas pris en charge et n’ont donc aucun effet quand vous utilisez le style Windows `CFileDialog`Vista ou version ultérieure de:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-Always on sur Windows Vista ou version ultérieure

- OFN_NOLONGNAMES: toujours désactivée dans Windows Vista ou version ultérieure

- OFN_NONETWORKBUTTON-Always on sur Windows Vista ou version ultérieure

- OFN_READONLY

- OFN_SHOWHELP

Pour plus d’informations sur cette structure, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows.

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

Place un contrôle dans la boîte de dialogue pour qu’il soit comparé à d’autres contrôles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle.

### <a name="remarks"></a>Notes

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

Appelé suite à un clic sur le bouton.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du bouton.

### <a name="remarks"></a>Notes

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

Appelé lorsque la case à cocher est activée ou désactivée.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la case à cocher.

*bChecked*<br/>
Activé ou désactivé.

### <a name="remarks"></a>Notes

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

Appelé lorsque le contrôle est activé.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle.

### <a name="remarks"></a>Notes

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

Substituez cette méthode si vous souhaitez gérer le message WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Notes

Le système envoie le message CDN_SELCHANGE lorsque l’utilisateur sélectionne un nouveau fichier ou dossier dans la liste des fichiers de la boîte de dialogue **ouvrir** ou **Enregistrer sous** . Substituez cette méthode si vous souhaitez exécuter des actions en réponse à ce message.

Le système envoie ce message uniquement si la boîte de dialogue a été créée avec l’indicateur OFN_EXPLORER activé. Pour plus d’informations sur la notification, consultez [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Pour plus d’informations sur l’indicateur OFN_EXPLORER, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et les [boîtes de dialogue Ouvrir et enregistrer sous](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

Remplacez cette fonction uniquement si vous souhaitez fournir une validation personnalisée des noms de fichiers entrés dans une boîte de dialogue de fichier courante.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valeur de retour

1 si le nom de fichier n’est pas un nom de fichier valide; Sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction vous permet de rejeter un nom de fichier pour toute raison spécifique à l’application. Normalement, vous n’avez pas besoin d’utiliser cette fonction, car l’infrastructure fournit la validation par défaut des noms de fichiers et affiche une boîte de message si un nom de fichier non valide est entré.

Si la valeur 1 est retournée, la boîte de dialogue reste affichée pour que l’utilisateur entre un autre nom de fichier. La procédure de boîte de dialogue ignore la boîte de dialogue si le retour est 0. Les autres valeurs de retour différentes de zéro sont actuellement réservées et ne doivent pas être utilisées.

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

Remplacez cette fonction pour gérer le message WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Notes

Le message de notification est envoyé lors de l’ouverture d’un nouveau dossier dans la boîte de dialogue Ouvrir ou enregistrer sous.

La notification est envoyée uniquement si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, consultez [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Pour plus d’informations sur le style OFN_EXPLORER, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et les [boîtes de dialogue Ouvrir et enregistrer sous](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

Remplacez cette fonction pour gérer le message WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Notes

Le système envoie ce message de notification lorsque le système a fini de disposer les contrôles dans la boîte de dialogue **ouvrir** ou **Enregistrer sous** pour faire de la place pour les contrôles de la boîte de dialogue enfant.

Le système envoie cela uniquement si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, consultez [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Pour plus d’informations sur le style OFN_EXPLORER, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et les [boîtes de dialogue Ouvrir et enregistrer sous](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Les boîtes de dialogue de fichier de style Windows Vista ou version ultérieure ne prennent pas en charge cette fonction. Toute tentative d’utilisation de cette fonction sur une boîte de dialogue de fichier de style Windows Vista ou version ultérieure lève [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

Appelé lorsque l’élément conteneur est sélectionné.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément.

### <a name="remarks"></a>Notes

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

Cette fonction est appelée chaque fois que la sélection actuelle dans une zone de liste va être modifiée.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*nIDBox*<br/>
ID de la zone de liste ou zone de liste déroulante dans laquelle la sélection s’est produite.

*iCurSel*<br/>
Index de la sélection actuelle.

*nCode*<br/>
Code de notification de contrôle. Ce paramètre doit avoir l’une des valeurs suivantes:

- CD_LBSELCHANGE spécifie *iCurSel* est l’élément sélectionné dans une zone de liste à sélection unique.

- CD_LBSELSUB spécifie que *iCurSel* n’est plus sélectionné dans une zone de liste multisélection.

- CD_LBSELADD spécifie que *iCurSel* est sélectionné dans une zone de liste multisélection.

- CD_LBSELNOITEMS spécifie qu’il n’existe aucune sélection dans une zone de liste multisélection.

### <a name="remarks"></a>Notes

Substituez cette fonction pour fournir une gestion personnalisée des modifications de sélection dans la zone de liste. Par exemple, vous pouvez utiliser cette fonction pour afficher les droits d’accès ou la date de dernière modification de chaque fichier que l’utilisateur sélectionne.

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

Substituez cette fonction pour fournir une gestion personnalisée des violations de partage.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Paramètres

*lpszPathName*<br/>
Chemin d’accès du fichier sur lequel la violation de partage s’est produite.

### <a name="return-value"></a>Valeur de retour

L’une des valeurs suivantes :

- OFN_SHAREFALLTHROUGH le nom de fichier est retourné à partir de la boîte de dialogue.

- OFN_SHARENOWARN aucune action supplémentaire n’est nécessaire.

- OFN_SHAREWARN l’utilisateur reçoit le message d’avertissement standard pour cette erreur.

### <a name="remarks"></a>Notes

Normalement, vous n’avez pas besoin d’utiliser cette fonction, car le Framework fournit la vérification par défaut des violations de partage et affiche une boîte de message en cas de violation de partage.

Si vous souhaitez désactiver la vérification de violation de partage, utilisez l’opérateur or au niveau du bit pour `m_ofn.Flags`combiner l’indicateur OFN_SHAREAWARE avec.

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

Remplacez cette fonction pour gérer le message WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Notes

Le message de notification est envoyé lorsque l’utilisateur sélectionne un nouveau type de fichier dans la liste des types de fichiers dans la boîte de dialogue Ouvrir ou enregistrer sous.

La notification est envoyée uniquement si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, consultez [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Pour plus d’informations sur le style OFN_EXPLORER, consultez la structure [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et les [boîtes de dialogue Ouvrir et enregistrer sous](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

Supprime un élément d’un contrôle conteneur dans la boîte de dialogue.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur à partir duquel supprimer l’élément.

*dwIDItem*<br/>
ID de l’élément.

### <a name="remarks"></a>Notes

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

Définit l’état actuel d’un bouton de vérification (case à cocher) dans la boîte de dialogue.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la case à cocher.

*bChecked*<br/>
État de la case à cocher. TRUE indique que l’option est activée; FALSe indique qu’il est désactivé.

### <a name="remarks"></a>Notes

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

Définit l’état actuel d’un élément dans un contrôle conteneur trouvé dans la boîte de dialogue.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément.

*dwState*<br/>
Une ou plusieurs valeurs de l’énumération CDCONTROLSTATE qui indiquent le nouvel État du contrôle.

### <a name="remarks"></a>Notes

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

Définit le texte d’un élément de contrôle. Par exemple, le texte qui accompagne une case d’option ou un élément dans un menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément.

*strLabel*<br/>
Texte de l’élément.

### <a name="remarks"></a>Notes

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

Définit le texte associé à un contrôle, tel qu’un texte de bouton ou une étiquette de zone d’édition.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle.

*strLabel*<br/>
Nom du contrôle.

### <a name="remarks"></a>Notes

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

Définit la visibilité actuelle et les États activés d’un contrôle donné.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle.

*dwState*<br/>
Une ou plusieurs valeurs de l’énumération CDCONTROLSTATE qui indiquent l’état actuel du contrôle.

### <a name="remarks"></a>Notes

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

Appelez cette méthode pour définir le texte pour le contrôle spécifié dans une boîte de dialogue **ouvrir** ou **Enregistrer sous** de style Explorateur.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
dans ID du contrôle pour lequel le texte doit être défini.

*lpsz*<br/>
dans Pointeur vers la chaîne qui contient le texte à définir pour le contrôle.

### <a name="remarks"></a>Notes

Les deux versions de cette fonction sont valides pour les applications qui utilisent Unicode. Toutefois, seule la version avec le type LPCSTR est valide pour les applications qui utilisent ANSI.

Pour utiliser cette méthode, vous devez créer la boîte de dialogue avec le style OFN_EXPLORER. Dans le cas contraire, la fonction échoue avec une assertion.

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

Appelez cette fonction pour définir l’extension de nom de fichier par défaut d’une boîte de dialogue Ouvrir ou enregistrer comme commune de style Explorateur.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Paramètres

*lpsz*<br/>
Pointeur vers une chaîne contenant l’extension par défaut à utiliser pour l’objet de boîte de dialogue. Cette chaîne ne doit pas contenir de point (.).

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; dans le cas contraire, la fonction échoue avec une assertion.

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

Définit le texte actuel dans un contrôle de zone d’édition.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID de la zone d’édition.

*strText*<br/>
Valeur du texte.

### <a name="remarks"></a>Notes

##  <a name="setproperties"></a>CFileDialog:: SetProperties

Fournit une banque de propriétés qui définit les valeurs par défaut à utiliser pour l'élément en cours d'enregistrement.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Paramètres

*lpszPropList*<br/>
Liste de propriétés prédéfinies séparées par un « ; ». Pour obtenir la liste des indicateurs, consultez la section Flags de [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Notes

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

Définit l’état sélectionné d’un élément particulier dans un groupe de cases d’option ou une zone de liste déroulante trouvée dans la boîte de dialogue.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem*<br/>
ID de l’élément sélectionné par l’utilisateur dans le contrôle.

### <a name="remarks"></a>Notes

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

Définit le modèle de boîte de dialogue pour l’objet [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Paramètres

*nWin3ID*<br/>
dans Contient le numéro d’identification de la ressource de modèle pour l’objet `CFileDialog` non-Explorer. Ce modèle est utilisé uniquement sur Windows NT 3,51 ou lorsque le style OFN_EXPLORER n’est pas présent.

*nWin4ID*<br/>
dans Contient le numéro d’identification de la ressource de modèle pour `CFileDialog` l’objet Explorer. Ce modèle est utilisé uniquement sur Windows NT 4,0 et versions ultérieures, Windows 95 et versions ultérieures, ou lorsque le style OFN_EXPLORER est présent.

*lpWin3ID*<br/>
dans Contient le nom de la ressource de modèle pour l’objet non `CFileDialog` -Explorer. Ce modèle est utilisé uniquement sur Windows NT 3,51 ou lorsque le style OFN_EXPLORER n’est pas présent.

*lpWin4ID*<br/>
dans Contient le nom de la ressource de modèle de l' `CFileDialog` objet Explorer. Ce modèle est utilisé uniquement sur Windows NT 4,0 et versions ultérieures, Windows 95 et versions ultérieures, ou lorsque le style OFN_EXPLORER est présent.

### <a name="remarks"></a>Notes

Le système utilisera uniquement l’un des modèles spécifiés. Le système détermine le modèle à utiliser en fonction de la présence du style OFN_EXPLORER et du système d’exploitation sur lequel l’application s’exécute. En spécifiant un modèle autre que l’Explorateur et l’Explorateur, il est facile de prendre en charge Windows NT 3,51, Windows NT 4,0 et versions ultérieures, ainsi que Windows 95 et versions ultérieures.

> [!NOTE]
> Les boîtes de dialogue de fichier de style Windows Vista ou version ultérieure ne prennent pas en charge cette fonction. Toute tentative d’utilisation de cette fonction dans une boîte de dialogue de fichier de style Windows Vista ou version ultérieure lève [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Une alternative consiste à utiliser une boîte de dialogue personnalisée. Pour plus d’informations sur l’utilisation `CFileDialog`d’un personnalisé, consultez [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

Déclare un groupe visuel dans la boîte de dialogue. Les appels suivants à toute méthode «Add» ajoutent ces éléments à ce groupe.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl*<br/>
ID du groupe visuel.

*strLabel*<br/>
Nom du groupe.

### <a name="remarks"></a>Notes

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

Met à jour la `m_ofn` structure de données du [CFileDialog](../../mfc/reference/cfiledialog-class.md) en fonction de l’état actuel de l’objet interne.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Notes

Dans les versions de Windows antérieures à Windows Vista, la structure de données [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) du membre était constamment synchronisée avec `CFileDialog`l’état de. Toute modification apportée à la variable de membre [m_ofn](#m_ofn) a directement affecté l’état de la boîte de dialogue. En outre, toute modification apportée à l’état de la boîte de dialogue a immédiatement mis à jour la variable de membre m_ofn.

Dans Windows Vista ou version ultérieure, `m_ofn` la structure de données n’est pas automatiquement mise à jour. Pour garantir la précision des données dans la `m_ofn` variable membre, vous devez appeler la `UpdateOFNFromShellDialog` fonction avant d’accéder aux données. Windows appelle cette fonction automatiquement pendant le traitement de [IFileDialog:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Pour plus d’informations sur l’utilisation de `CFileDialog` la classe sous Windows Vista ou version ultérieure, consultez [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemple

Cet exemple met à jour avant `CFileDialog` de l’afficher. Avant de mettre à `m_ofn` jour la variable membre, nous devons la synchroniser avec l’état actuel de la boîte de dialogue.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Voir aussi

[CCommonDialog, classe](../../mfc/reference/ccommondialog-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)
