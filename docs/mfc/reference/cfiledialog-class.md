---
title: CFileDialog, classe
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 197dec23b4c715b0bca35976f9fa53a055cdd78f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373908"
---
# <a name="cfiledialog-class"></a>CFileDialog, classe

Encapsule la boîte de dialogue commune qui est utilisée pour les opérations d’enregistrement de fichiers ou de fichiers.

## <a name="syntax"></a>Syntaxe

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|Construit un objet `CFileDialog`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|Ajoute un bouton de contrôle au dialogue.|
|[CFileDialog::AddComboBox](#addcombobox)|Ajoute une boîte combo au dialogue.|
|[CFileDialog::AddControlItem](#addcontrolitem)|Ajoute un article à un contrôle des conteneurs dans le dialogue.|
|[CFileDialog::AddEditBox](#addeditbox)|Ajoute une boîte de modification au dialogue.|
|[CFileDialog::AddMenu](#addmenu)|Ajoute un menu au dialogue.|
|[CFileDialog::AddPlace](#addplace)|Surchargé. Ajoute un dossier à la liste des places disponibles pour que l’utilisateur ouvre ou enregistre des éléments.|
|[CFileDialog::AddPushButton](#addpushbutton)|Ajoute un bouton au dialogue.|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|Ajoute un bouton d’option (également connu sous le nom de bouton radio) groupe au dialogue.|
|[CFileDialog::AddSeparator](#addseparator)|Ajoute un séparateur au dialogue.|
|[CFileDialog::AddText](#addtext)|Ajoute du contenu texte au dialogue.|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|Mise à jour `CFileDialog` de l’état de la `m_ofn` pour correspondre aux paramètres et aux drapeaux stockés dans la variable du membre.|
|[CFileDialog::DoModal](#domodal)|Affiche la boîte de dialogue et permet à l’utilisateur de faire une sélection.|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|Permet une liste d’abandon sur le bouton **Open** ou **Enregistrer** dans le dialogue.|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|Arrête l’ajout d’éléments à un groupe visuel dans le dialogue.|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|Obtient l’état actuel d’un bouton à cocher (case à cocher) dans le dialogue.|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|Obtient l’état actuel d’un article dans un contrôle de conteneur trouvé dans le dialogue.|
|[CFileDialog::GetControlState](#getcontrolstate)|Obtient la visibilité actuelle et les états activés d’un contrôle donné.|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|Obtient le texte actuel dans un contrôle de boîte de modification.|
|[CFileDialog::GetFileExt](#getfileext)|Retourne l’extension du fichier sélectionné.|
|[CFileDialog::GetFileName](#getfilename)|Renvoie le nom de fichier du fichier sélectionné.|
|[CFileDialog::GetFileTitle](#getfiletitle)|Retourne le titre du fichier sélectionné.|
|[CFileDialog::GetFolderPath](#getfolderpath)|Récupère le chemin du dossier ou du répertoire actuellement ouvert pour une boîte de dialogue **ouverte** ou **sauveuse** de style Explorer.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Récupère l’objet COM interne `CFileDialog` pour un objet personnalisé.|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|Récupère l’objet COM `CFileDialog` interne pour un qui est utilisé comme une boîte de dialogue de fichier **ouvert.**|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|Récupère l’objet COM `CFileDialog` interne pour un qui est utilisé comme une boîte de dialogue de fichier **Enregistrer.**|
|[CFileDialog::GetNextPathName](#getnextpathname)|Retourne le chemin complet du prochain fichier sélectionné.|
|[CFileDialog::GetOFN](#getofn)|Récupère la `OPENFILENAME` structure `CFileDialog` de l’objet.|
|[CFileDialog::GetPathName](#getpathname)|Retourne le chemin complet du fichier sélectionné.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Retourne l’état de lecture uniquement du fichier sélectionné.|
|[CFileDialog::GetResult](#getresult)|Obtient le choix que l’utilisateur a fait dans le dialogue.|
|[CFileDialog::GetResults](#getresults)|Obtient les choix de l’utilisateur dans un dialogue qui permet une sélection multiple.|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|Obtient un élément particulier à partir de contrôles de conteneurs spécifiés dans le dialogue.|
|[CFileDialog::GetStartPosition](#getstartposition)|Retourne la position du premier élément de la liste de noms de fichier.|
|[CFileDialog::HideControl](#hidecontrol)|Cache le contrôle spécifié dans une boîte de dialogue **ouverte** ou **sauve** comme une boîte de dialogue commune de style Explorer.|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|Détermine si le dialogue actuel en mode dossier.|
|[CFileDialog::MakeProminent](#makeprominent)|Place un contrôle dans le dialogue de sorte qu’il se démarque par rapport à d’autres contrôles supplémentaires.|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|Retire un élément d’un contrôle de conteneur dans le dialogue.|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|Définit l’état actuel d’un bouton à cocher (case à cocher) dans le dialogue.|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|Définit l’état actuel d’un article dans un contrôle de conteneur trouvé dans le dialogue.|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|Définit le texte d’un élément de contrôle. Par exemple, le texte qui accompagne un bouton radio ou un élément dans un menu.|
|[CFileDialog::SetControlLabel](#setcontrollabel)|Définit le texte associé à un contrôle, tel que le texte bouton ou une étiquette de boîte de modification.|
|[CFileDialog::SetControlState](#setcontrolstate)|Définit la visibilité actuelle et les états activés d’un contrôle donné.|
|[CFileDialog::SetControlText](#setcontroltext)|Définit le texte pour le contrôle spécifié dans une boîte de dialogue **ouverte** ou **sauve** comme un dialogue commun.|
|[CFileDialog::SetDefExt](#setdefext)|Définit l’extension de nom de fichier par défaut pour une boîte de dialogue **ouverte** ou **sauve** comme un dialogue commun.|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|Définit le texte actuel dans un contrôle de boîte de modification.|
|[CFileDialog::SetProperties](#setproperties)|Fournit une banque de propriétés qui définit les valeurs par défaut à utiliser pour l'élément en cours d'enregistrement.|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|Définit l’état choisi d’un élément particulier dans un groupe de boutons d’option ou une boîte combo trouvée dans le dialogue.|
|[CFileDialog::SetTemplate](#settemplate)|Définit le modèle de `CFileDialog` boîte de dialogue pour l’objet.|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|Déclare un groupe visuel dans le dialogue. Les appels ultérieurs à toute méthode « ajouter » ajoutent ces éléments à ce groupe.|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|Mise à jour `m_ofn` des données stockées dans la variable du membre pour correspondre à l’état actuel de la boîte de dialogue de fichier.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|Appelé lorsque le bouton est cliqué.|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|Appelé lorsque la case à cocher est cochée/non contrôlée.|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|Appelé lorsque le contrôle est actif.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Gère le message CDN_SELCHANGE WM_NOTIFY.|
|[CFileDialog::OnFileNameOK](#onfilenameok)|Valide le nom du fichier inscrit dans la boîte de dialogue.|
|[CFileDialog::OnFolderChange](#onfolderchange)|Gère le message WM_NOTIFY CDN_FOLDERCHANGE.|
|[CFileDialog::OnInitDone](#oninitdone)|Gère le message WM_NOTIFY CDN_INITDONE.|
|[CFileDialog::OnItemSelected](#onitemselected)|Appelé lorsque l’élément conteneur est sélectionné.|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|Vous permet d’effectuer des actions personnalisées lorsque la sélection des fichiers change.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Gère les violations des actions.|
|[CFileDialog::OnTypeChange](#ontypechange)|Gère le message WM_NOTIFY CDN_TYPECHANGE.|

### <a name="public-data-members"></a>Membres de données publics

|Nom|Description|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|La `OPENFILENAME` structure Windows. Donne accès aux paramètres de base de la boîte de dialogue de fichier.|

## <a name="remarks"></a>Notes

Les boîtes communes de dialogue de fichiers vous permettent d’implémenter des boîtes de dialogue de sélection de fichiers, par exemple, **Open File** et **Save As**, d’une manière qui est compatible avec les normes Windows.

Vous pouvez `CFileDialog` utiliser comme c’est avec le constructeur fourni, ou `CFileDialog` vous pouvez tirer votre propre classe de boîte de dialogue à partir et écrire un constructeur en fonction de vos besoins. Dans les deux cas, ces boîtes de dialogue se comporteront comme des boîtes de dialogue MFC standard parce qu’elles sont dérivées de la [classe CCommonDialog](../../mfc/reference/ccommondialog-class.md). `CFileDialog`s’appuie sur le COMMDLG. Fichier DLL qui est inclus dans Windows.

L’apparence et la fonctionnalité `CFileDialog` de l’avec Windows Vista ou plus tard diffèrent des versions antérieures de Windows. La `CFileDialog` valeur par défaut utilise automatiquement le nouveau Windows Vista ou le style ultérieur sans modifications de code si un programme est compilé et exécuté sous Windows Vista ou plus tard. Utilisez le *paramètre bVistaStyle* dans le constructeur pour remplacer manuellement cette mise à jour automatique. L’exception à la mise à jour automatique est des boîtes de dialogue personnalisées. Ils ne seront pas convertis au nouveau style. Pour plus d’informations sur le constructeur, voir [CFileDialog::CFileDialog](#cfiledialog).

> [!NOTE]
> Le système d’identification de contrôle diffère dans Windows Vista ou `CFileDialog`plus tard des versions antérieures de Windows lorsque vous utilisez un . Vous devez mettre `CFileDialog` à jour toutes les références aux contrôles dans le code avant de pouvoir porter votre projet à partir d’une version antérieure de Windows.

Certaines `CFileDialog` méthodes ne sont pas prises en charge sous Windows Vista ou plus tard. Vérifiez le sujet de méthode individuel pour savoir si la méthode est prise en charge. En outre, les fonctions héritées suivantes ne sont pas prises en charge sous Windows Vista ou plus tard :

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Les messages Windows `CFileDialog` pour la classe varient en fonction du système d’exploitation que vous utilisez. Par exemple, Windows XP ne prend pas en charge [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel) et [CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok) pour la `CFileDialog` classe. Cependant, Windows Vista et les systèmes d’exploitation ultérieurs les prennent en charge. Pour plus d’informations sur les différents messages qui sont générés et l’ordre dans lequel ils sont reçus, voir [CFileDialog Sample: Logging Event Order](../../overview/visual-cpp-samples.md).

Pour utiliser `CFileDialog` un objet, créez d’abord l’objet en utilisant le `CFileDialog` constructeur. Une fois la boîte de dialogue construite, vous pouvez définir ou modifier toutes les valeurs du [CFileDialog : m_ofn](#m_ofn) structure pour initialiser les valeurs ou les états des commandes de la boîte de dialogue. La `m_ofn` structure est `OPENFILENAME`de type . Pour plus d’informations, consultez la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows.

Après avoir paralysé les commandes de la boîte de dialogue, appelez le [CFileDialog: :DoModal](#domodal) méthode pour afficher la boîte de dialogue afin que l’utilisateur puisse taper le chemin et le nom du fichier. `DoModal`l’utilisateur a cliqué sur le bouton OK (IDOK) ou le bouton Annuler (IDCANCEL). Si `DoModal` vous retournez IDOK, `CFileDialog` vous pouvez utiliser l’une des fonctions des membres du public pour récupérer les informations mises en place par l’utilisateur.

> [!NOTE]
> Sous Windows Vista ou plus tard, plusieurs appels vers [IFileDialog : SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) provoque une erreur. Le deuxième `SetFileTypes` appel à tout `CFileDialog` cas d’un retour E_UNEXPECTED dans Windows Vista ou plus tard. Certaines `CFileDialog` fonctions `SetFileTypes`de méthode appellent . Par exemple, deux `CFileDialog::DoModal` appels à la `CFileDialog` même instance d’un génère [ASSERT](diagnostic-services.md#assert).

`CFileDialog`comprend plusieurs membres protégés qui vous permettent de traiter sur mesure les violations des actions, la validation du nom de fichier et la notification de modification de boîte de liste. Ces membres protégés sont des fonctions de rappel que la plupart des applications n’ont pas à utiliser parce que la manipulation par défaut est effectuée automatiquement. Les entrées de carte de message pour ces fonctions ne sont pas requises parce qu’elles sont des fonctions virtuelles standard.

Vous pouvez utiliser la fonction Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) pour déterminer si une erreur s’est produite lors de l’initialisation de la boîte de dialogue et pour en savoir plus sur l’erreur.

La destruction `CFileDialog` d’objets est traitée automatiquement. Vous n’avez pas à appeler [CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Pour permettre à l’utilisateur de sélectionner plusieurs fichiers, définissez le drapeau OFN_ALLOWMULTISELECT avant d’appeler `DoModal`. Vous devez fournir votre propre mémoire tampon de nom de fichier pour tenir compte de la liste retournée de plusieurs noms de fichiers. Faites-le en `m_ofn.lpstrFile` remplaçant par un pointeur à un tampon `CFileDialog`que vous `DoModal`avez alloué, après avoir construit le , mais avant d’appeler .

En outre, `m_ofn.nMaxFile` vous devez définir en utilisant le `m_ofn.lpstrFile`nombre de caractères dans le tampon indiqué par . Si vous définissez le nombre maximum `n`de fichiers à `n * (_MAX_PATH + 1) + 1`sélectionner, la taille du tampon requis est . Le premier élément retourné dans le tampon est le chemin vers le dossier où les fichiers ont été sélectionnés. Pour Windows Vista ou des boîtes de dialogue de style postérieur, les chaînes d’annuaire et de nom de fichier sont non terminées, avec un caractère nul supplémentaire après le nom de fichier de famille. Ce format permet aux boîtes de dialogue de style Explorer de retourner de longs noms de fichiers qui incluent des espaces. Pour les boîtes de dialogue à l’ancienne, les chaînes d’annuaire et de nom de fichier sont séparées par des espaces et la fonction utilise des noms de fichiers courts pour les noms de fichiers avec des espaces.

L’exemple suivant montre comment utiliser un tampon pour récupérer et énumérer plusieurs noms de fichiers.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Pour modifier la taille du tampon en réponse à l’utilisateur sélectionnant plusieurs noms de `CFileDialog` fichiers, vous devez tirer une nouvelle classe de et remplacer le [CFileDialog::OnFileNameChange](#onfilenamechange) méthode.

Si vous dérivez `CFileDialog`une nouvelle classe, vous pouvez utiliser une carte de message pour gérer tous les messages. Pour étendre la manipulation par défaut `CFileDialog`des messages, extraire une classe, ajouter une carte de message à la nouvelle classe et fournir des fonctions aux membres pour les nouveaux messages. Vous n’avez pas à fournir une fonction de crochet pour personnaliser la boîte de dialogue.

Pour personnaliser la boîte de dialogue, `CFileDialog`dérivez une classe à partir de , fournir un modèle personnalisé boîte de dialogue, et ajouter une carte de message pour traiter les messages de notification à partir des contrôles étendus. Transmettez tous les messages non traités à la classe de base. Vous n’avez pas à personnaliser la fonction de crochet.

Lorsque vous utilisez windows Vista ou `CFileDialog`le style ultérieur de la , vous ne pouvez pas utiliser des cartes de messages et des modèles de boîte de dialogue. Au lieu de cela, vous devez utiliser les interfaces COM pour des fonctionnalités similaires.

Pour plus d’informations `CFileDialog`sur la façon d’utiliser , voir [Classes de dialogue commun](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Spécifications

**En-tête:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>CFileDialog::AddCheckButton

Ajoute un bouton de contrôle au dialogue.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du bouton de contrôle à ajouter.

*strLabel (en)*<br/>
Le nom du bouton de contrôle.

*bChecked*<br/>
Un Boolean indiquant l’état actuel du bouton de contrôle. VRAI si vérifié; FALSE autrement

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>CFileDialog::AddComboBox

Ajoute une boîte combo au dialogue.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID de la boîte combo à ajouter.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>CFileDialog::AddControlItem

Ajoute un article à un contrôle des conteneurs dans le dialogue.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du contrôle du conteneur pour ajouter l’article à.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

*strLabel (en)*<br/>
Texte de l’article.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>CFileDialog::AddEditBox

Ajoute une boîte de modification au dialogue.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID de la boîte de modification à ajouter.

*strText (en)*<br/>
Le nom de la boîte de modification.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>CFileDialog::AddMenu

Ajoute un menu au dialogue.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du menu à ajouter.

*strLabel (en)*<br/>
Le nom du menu.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>CFileDialog::AddPlace

Ajoute un dossier à la liste des places disponibles pour que l’utilisateur ouvre ou enregistre des éléments.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Paramètres

*lpszFolder (lpszFolder)*<br/>
Un chemin vers le dossier à mettre à la disposition de l’utilisateur. Cela ne peut être qu’un dossier.

*fdap*<br/>
Précise où le dossier est placé dans la liste.

*Psi*<br/>
Un pointeur à un IShellItem qui représente le dossier à mettre à la disposition de l’utilisateur. Cela ne peut être qu’un dossier.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>CFileDialog::AddPushButton

Ajoute un bouton au dialogue.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du bouton à ajouter.

*strLabel (en)*<br/>
Le nom du bouton.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>CFileDialog::AddRadioButtonList

Ajoute un bouton d’option (également connu sous le nom de bouton radio) groupe au dialogue.

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du groupe de boutons d’option à ajouter.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>CFileDialog::AddSeparator

Ajoute un séparateur au dialogue.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du séparateur ajouter.

### <a name="remarks"></a>Notes

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>CFileDialog::AddText

Ajoute du texte au dialogue.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du texte à ajouter.

*strText (en)*<br/>
Le nom du texte.

### <a name="remarks"></a>Notes

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>CFileDialog::ApplyOFNToShellDialog

Mise à jour de l’état actuel du [CFileDialog](../../mfc/reference/cfiledialog-class.md) en fonction des valeurs stockées dans la structure de `m_ofn` données.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Notes

Dans les versions de Windows avant Windows Vista, la structure de données [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) membre a été synchronisée en permanence avec l’état de la `CFileDialog`. Toute modification de la variable [m_ofn](#m_ofn) membre a été immédiatement reflétée dans l’état de la boîte de dialogue. En outre, toute modification de l’état `m_ofn` de la boîte de dialogue immédiatement mettre à jour la variable du membre.

Dans Windows Vista ou plus `m_ofn` tard, les valeurs `CFileDialog` de la variable membre et de l’état de la sont pas garantis pour être synchronisées. Cette fonction force l’état de `CFileDialog` la `m_ofn` mise à jour pour correspondre à la structure. Windows appelle cette fonction automatiquement pendant [CFileDialog::DoModal](#domodal).

Pour plus d’informations `CFileDialog` sur la façon d’utiliser la classe sous Windows Vista ou plus tard, voir [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemple

  Voir l’exemple pour [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog).

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>CFileDialog::CFileDialog

Appelez cette fonction pour construire une boîte de dialogue de fichier Windows standard.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Paramètres

*bOpenFileDialog*<br/>
[dans] Le paramètre qui spécifie quel type de boîte de dialogue créer. Réglez-le à TRUE pour construire une boîte de dialogue **File Open.** Réglez-le à FALSE pour construire une boîte de dialogue **d’enregistrement de fichier comme.**

*lpszDefExt*<br/>
[dans] L’extension du nom de fichier par défaut. Si l’utilisateur n’inclut pas une extension connue (qui a une association sur l’ordinateur de l’utilisateur) dans la boîte de nom de fichier, l’extension spécifiée par *lpszDefExt* est automatiquement annexée au nom du fichier. Si ce paramètre est NULL, aucune extension n’est annexée.

*lpszFileName*<br/>
[dans] Le nom de fichier initial qui apparaît dans la boîte de nom de fichier. Si NULL, aucun nom de fichier initial n’apparaît.

*dwFlags*<br/>
[dans] Une combinaison d’un ou plusieurs drapeaux que vous pouvez utiliser pour personnaliser la boîte de dialogue. Pour une description de ces drapeaux, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows. Si vous `m_ofn.Flags` modifiez le membre de la structure, utilisez un opérateur bitwise-OR dans vos modifications pour garder le comportement par défaut intact.

*lpszFilter (lpszFilter)*<br/>
[dans] Une série de paires de chaînes qui spécifient les filtres que vous pouvez appliquer au fichier. Si vous spécifiez des filtres de fichiers, seuls les fichiers correspondant aux critères de filtrage apparaîtront dans la liste des fichiers. Consultez la section Remarques pour plus d’informations sur la façon de travailler avec les filtres de fichiers.

*pParentWnd*<br/>
[dans] Un pointeur à la fenêtre du parent ou du propriétaire de la boîte de dialogue de fichier.

*dwSize dwSize*<br/>
[dans] La taille `OPENFILENAME` de la structure. Cette valeur dépend de la version du système d’exploitation. MFC a utilisé ce paramètre pour déterminer le type approprié de boîte de dialogue à créer. La taille par défaut de 0 signifie que le code MFC déterminera la taille correcte de boîte de dialogue à utiliser en fonction de la version du système d’exploitation sur laquelle le programme est exécuté.

*bVistaStyle (en anglais seulement)*<br/>
[dans] **Note** Ce paramètre est disponible dans Visual Studio 2008 et plus tard et provoque le dialogue de nouveau style d’être utilisé que si vous êtes en cours d’exécution dans Windows Vista ou plus tard.

Le paramètre qui spécifie le style du dialogue de fichier. Réglez-le à TRUE pour utiliser les nouveaux dialogues de fichiers de style Vista. Sinon, l’ancien style des boîtes de dialogue sera utilisé. Consultez la section Remarques pour plus d’informations sur la course sous Vista.

### <a name="remarks"></a>Notes

Soit un **fichier ouvert** ou fichier **Enregistrer comme** boîte de dialogue est construit, en fonction de la valeur de *bOpenFileDialog*.

Spécifier une extension par défaut à *l’aide de lpszDefExt* peut ne pas produire le comportement que vous attendez, car il est rarement prévisible quelles extensions ont des associations de fichiers sur l’ordinateur de l’utilisateur. Si vous avez besoin de plus de contrôle sur l’appending d’une extension par défaut, vous pouvez tirer votre propre classe de `CFileDialog`, et remplacer la `CFileDialog::OnFileNameOK` méthode pour effectuer votre propre traitement d’extension.

Pour permettre à l’utilisateur de sélectionner plusieurs fichiers, définissez le drapeau OFN_ALLOWMULTISELECT avant d’appeler [DoModal](#domodal). Vous devez fournir votre propre mémoire tampon pour stocker la liste retournée de plusieurs noms de fichiers. Faites-le en `m_ofn.lpstrFile` remplaçant par un pointeur à un tampon que vous avez alloué, `DoModal`après avoir construit le [CFileDialog](../../mfc/reference/cfiledialog-class.md), mais avant d’appeler . En outre, `m_ofn.nMaxFile` vous devez définir avec le nombre `m_ofn.lpstrFile`de caractères dans le tampon indiqué par . Si vous définissez le nombre maximum de fichiers à `n`sélectionner à *n,* la taille du tampon nécessaire est de _MAX_PATH 1) et 1. Par exemple :

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Pour permettre à l’utilisateur de redimensionner une boîte de dialogue de type Explorer en utilisant la souris ou le clavier, définissez le drapeau OFN_ENABLESIZING. Le réglage de ce drapeau n’est nécessaire que si vous fournissez une procédure de crochet ou un modèle personnalisé. Le drapeau ne fonctionne qu’avec une boîte de dialogue de style Explorer; les boîtes de dialogue à l’ancienne ne peuvent pas être redimensionnalisées.

Le *paramètre lpszFilter* est utilisé pour déterminer le type de nom de fichier qu’un fichier doit être affiché dans la liste de fichiers. La première chaîne de la paire de cordes décrit le filtre; la deuxième chaîne indique l’extension du nom de fichier à utiliser. Plusieurs extensions peuvent être spécifiées à l’aide d’un point-virgule (le caractère ';') comme délimitant. La chaîne se termine par deux personnages « &#124; », suivis d’un personnage DE NULL. Vous pouvez également utiliser un objet [CString](../../atl-mfc-shared/using-cstring.md) pour ce paramètre.

Par exemple, Microsoft Excel permet aux utilisateurs d’ouvrir des fichiers qui ont des extensions .xlc (graphique) ou .xls (feuille de travail), entre autres. Le filtre pour Excel pourrait être écrit comme:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Toutefois, si vous prévoyez d’utiliser `OPENFILENAME` cette chaîne pour mettre à jour directement la structure, vous devez délimiter vos cordes avec le caractère nul, ''0', au lieu des barres verticales ('&#124;').

Le *paramètre bVistaStyle* n’est applicable que lorsqu’il est sous Windows Vista ou plus tard. Sous les versions antérieures de Windows, ce paramètre est ignoré. Si *bVistaStyle* est configuré sur TRUE, lorsque vous compilez un programme avec Visual Studio 2008 ou plus tard, le nouveau style Vista **File Dialog** sera utilisé. Dans le cas contraire, le précédent MFC style **File Dialog** sera utilisé.

Les modèles de dialogue ne sont pas pris en charge sur les dialogues basés sur *bVistaStyle*

### <a name="example"></a>Exemple

  Voir l’exemple pour [CFileDialog::DoModal](#domodal).

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>CFileDialog::DoModal

Appelez cette fonction pour afficher la boîte de dialogue de fichiers commune de Windows et permettre à l’utilisateur de parcourir des fichiers et des répertoires et d’entrer un nom de fichier.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Valeur de retour

IDOK ou IDCANCEL. Si IDCANCEL est retourné, appelez la fonction Windows [CommDlgExtendedError](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) pour déterminer si une erreur s’est produite.

IDOK et IDCANCEL sont des constantes qui indiquent si l’utilisateur a choisi le bouton OK ou Annuler.

### <a name="remarks"></a>Notes

Si vous souhaitez paralyser les différentes options de `m_ofn` dialogue-box de fichier `DoModal`en définissant les membres de la structure, vous devriez le faire avant d’appeler, mais après que l’objet de dialogue est construit.

Par exemple, si vous souhaitez permettre à l’utilisateur de sélectionner `DoModal`plusieurs fichiers, définissez le drapeau OFN_ALLOWMULTISELECT avant d’appeler, comme indiqué dans l’exemple du code dans ce sujet.

Lorsque l’utilisateur clique sur les boutons OK ou Annuler de la boîte de dialogue, ou sélectionne l’option Close dans le menu de contrôle de la boîte de dialogue, le contrôle est retourné à votre application. Vous pouvez ensuite appeler d’autres fonctions de membre pour récupérer les paramètres ou les informations que l’utilisateur entre dans la boîte de dialogue.

`DoModal`est une fonction virtuelle remplacée `CDialog`par la classe .

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>CFileDialog::EnableOpenDropDown

Permet une liste d’abandon sur le bouton Open ou Enregistrer dans le dialogue.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’id de la liste des dépôts.

### <a name="remarks"></a>Notes

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>CFileDialog::EndVisualGroup

Arrête l’ajout d’éléments à un groupe visuel dans le dialogue.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Valeur de retour

Retours S_OK en cas de succès; une valeur d’erreur autrement.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>CFileDialog::GetCheckButtonState

Récupère l’état actuel d’un bouton à cocher (case à cocher) dans le dialogue.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’id de la case à cocher.

*bChecked*<br/>
L’état de la case à cocher. TRUE indique vérifié; FALSE indique non contrôlé.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>CFileDialog::GetControlItemState

Récupère l’état actuel d’un article dans un contrôle de conteneur trouvé dans le dialogue.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

*dwState (en)*<br/>
Une référence à une variable qui reçoit l’une des valeurs les plus du recensement DE CDCONTROLSTATE qui indique l’état actuel du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>CFileDialog::GetControlState

Récupère la visibilité actuelle et les états activés d’un contrôle donné.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L'ID du contrôle.

*dwState (en)*<br/>
Une référence à une variable qui reçoit une ou plusieurs valeurs du recensement CDCONTROLSTATE qui indique l’état actuel du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>CFileDialog::GetEditBoxText

Récupère le texte en cours dans un contrôle de boîte de modification.

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID de la boîte de modification.

*strText (en)*<br/>
Valeur du texte.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>CFileDialog::GetFileExt

Appelez cette fonction pour récupérer l’extension du nom de fichier entré dans la boîte de dialogue.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Valeur de retour

L’extension du nom de fichier.

### <a name="remarks"></a>Notes

Par exemple, si le nom du fichier saisi est DATA. TXT, `GetFileExt` retourne "TXT".

Si `m_ofn.Flags` l’ensemble de drapeau OFN_ALLOWMULTISELECT, cette chaîne contient une séquence de cordes non terminées, la première chaîne étant la trajectoire d’annuaire du groupe de fichiers sélectionnée, suivie des noms de tous les fichiers sélectionnés par l’utilisateur. Pour récupérer les noms de fichiers, utilisez les fonctions membres [GetStartPosition](#getstartposition) et [GetNextPathName.](#getnextpathname)

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>CFileDialog::GetFileName

Appelez cette fonction pour récupérer le nom du nom de fichier inscrit dans la boîte de dialogue.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Valeur de retour

Nom du fichier.

### <a name="remarks"></a>Notes

Le nom du fichier comprend à la fois le préfixe et l’extension. Par exemple, `GetFileName` retournera "TEXT. DAT" pour le fichier C: 'FILES’TEXT.DAT.

Si `m_ofn.Flags` le `OFN_ALLOWMULTISELECT` drapeau est défini, vous devez appeler [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer un nom de voie de fichier.

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>CFileDialog::GetFileTitle

Appelez cette fonction pour récupérer le titre du fichier inscrit dans la boîte de dialogue.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Valeur de retour

Le titre du fichier.

### <a name="remarks"></a>Notes

Le titre du fichier ne comprend que son préfixe, sans le chemin ni l’extension. Par exemple, `GetFileTitle` retournera "TEXT" pour le fichier C: 'FILES’TEXT.DAT.

Si `m_ofn.Flags` l’ensemble de drapeau OFN_ALLOWMULTISELECT, cette chaîne contient une séquence de cordes non terminées, la première chaîne étant la trajectoire d’annuaire du groupe de fichiers sélectionnée, suivie des noms de tous les fichiers sélectionnés par l’utilisateur. Pour cette raison, utilisez les fonctions des membres [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer le nom de fichier suivant dans la liste.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>CFileDialog::GetFolderPath

Appelez cette fonction de membre pour récupérer le chemin du dossier ou du répertoire actuellement ouvert pour une boîte de dialogue ouverte ou sauveuse de style Explorer.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Valeur de retour

Objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) contenant le dossier ou le répertoire actuellement ouvert.

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; sinon, la méthode échouera avec une affirmation.

Vous ne pouvez appeler cette méthode que pendant que la boîte de dialogue est affichée. Une fois la boîte de dialogue fermée, cette fonction ne fonctionnera plus, et la méthode échouera avec une affirmation.

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>CFileDialog::GetIFileDialogCustomize

Récupère un pointeur à l’objet INTERNE COM pour un [CFileDialog](../../mfc/reference/cfiledialog-class.md)donné .

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Valeur de retour

Le pointeur de l’objet INTERNE COM pour le `CFileDialog`. Il est de votre responsabilité de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou plus tard avec un objet qui a *bVistaStyle* réglé à TRUE. Si vous utilisez cette fonction lorsque *bVistaStyle* est FALSE, il retournera NULL en mode version et lancera une affirmation en mode débogé.

Pour plus d’informations sur l’interface, `IFileDialogCustomize` voir [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Exemple

Cet exemple récupère l’objet COM interne. Pour exécuter cet exemple de code, vous devez le compiler sous Windows Vista ou plus tard.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>CFileDialog::GetIFileOpenDialog

Récupère un pointeur à l’objet `CFileDialog`INTERNE COM pour une donnée .

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Valeur de retour

Le pointeur de l’objet INTERNE COM pour le `CFileDialog`. Il est de votre responsabilité de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou plus tard avec un objet qui a *bVistaStyle* réglé à TRUE. Cette fonction renvoie `CFileDialog` NULL si le n’est pas une boîte de dialogue **Open** ou si *bVistaStyle* est réglé sur FALSE. Dans ce dernier cas, la fonction ne renvoie NULL en mode version - en mode débogé, il lancera une affirmation.

Pour plus d’informations sur l’interface, `IFileOpenDialog` voir [IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Exemple

Cet exemple récupère l’objet COM interne. Pour exécuter ce code, vous devez le compiler sous Windows Vista ou plus tard.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>CFileDialog::GetIFileSaveDialog

Récupère un pointeur à l’objet `CFileDialog`INTERNE COM pour une donnée .

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Valeur de retour

Le pointeur de l’objet INTERNE COM pour le `CFileDialog`. Il est de votre responsabilité de libérer ce pointeur de manière appropriée.

### <a name="remarks"></a>Notes

Utilisez cette fonction uniquement sous Windows Vista ou plus tard avec un objet qui a *bVistaStyle* réglé à TRUE. Cette fonction retournera `CFileDialog` NULL si le n’est pas une boîte de dialogue **Save** ou si *bVistaStyle* est réglé sur FALSE. Dans ce dernier cas, la fonction ne renvoie NULL en mode version - en mode débogé, il lancera une affirmation.

Pour plus d’informations sur l’interface, `IFileSaveDialog` voir [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Exemple

Cet exemple récupère l’objet COM interne. Pour exécuter cet exemple de code, vous devez le compiler sous Windows Vista ou plus tard.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>CFileDialog::GetNextPathName

Appelez cette fonction pour récupérer le nom de fichier suivant du groupe sélectionné dans la boîte de dialogue.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Paramètres

*Pos*<br/>
Une référence à une valeur `GetNextPathName` POSITION `GetStartPosition` retournée par un précédent ou un appel de fonction. NULL si la fin de la liste a été atteinte.

### <a name="return-value"></a>Valeur de retour

Chemin d’accès complet du fichier.

### <a name="remarks"></a>Notes

Le chemin du nom de fichier comprend le titre du fichier ainsi que l’ensemble du parcours. Par exemple, `GetNextPathName` retournera "C:FILES-TEXT. DAT" pour le fichier C: 'FILES’TEXT.DAT. Vous pouvez `GetNextPathName` utiliser dans une boucle d’itération vers l’avant si vous établissez la position initiale avec un appel à `GetStartPosition`.

Si la sélection se compose d’un seul fichier, ce nom de fichier sera retourné.

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>CFileDialog::GetOFN

Récupère la `OPENFILENAME` structure associée.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Valeur de retour

Une structure [OPENFILENAME.](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)

### <a name="remarks"></a>Notes

Utilisez la deuxième version de cette fonction pour initialiser l’apparence d’un **Fichier Open** ou File **Save As** boîte de dialogue après sa construction, mais avant qu’il ne soit affiché avec la `DoModal` fonction membre. Par exemple, vous `lpstrTitle` pouvez `m_ofn` définir le membre de la légende que vous voulez que la boîte de dialogue ait.

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>CFileDialog::GetPathName

Appelez cette fonction pour récupérer le chemin complet du fichier entré dans la boîte de dialogue.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Valeur de retour

Chemin d’accès complet du fichier.

### <a name="remarks"></a>Notes

Le chemin du nom de fichier comprend le titre du fichier ainsi que l’ensemble du parcours. Par exemple, `GetPathName` retournera "C:FILES-TEXT. DAT" pour le fichier C: 'FILES’TEXT.DAT.

Si `m_ofn.Flags` l’ensemble de drapeau OFN_ALLOWMULTISELECT, cette chaîne contient une séquence de cordes témérités nulles, la première chaîne étant le parcours du groupe de fichiers sélectionné, suivi des noms de tous les fichiers sélectionnés par l’utilisateur. Pour cette raison, utilisez les fonctions des membres [GetStartPosition](#getstartposition) et [GetNextPathName](#getnextpathname) pour récupérer le nom de fichier suivant dans la liste.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CFileDialog::DoModal](#domodal).

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>CFileDialog::GetReadOnlyPref

Appelez cette fonction pour déterminer si la case à cocher Read Only a été sélectionnée dans les boîtes de téléphone Standard Open et File Save As.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Valeur de retour

Non-zéro si la case à cocher Read Only dans la boîte de dialogue est sélectionnée; sinon 0.

### <a name="remarks"></a>Notes

Vous pouvez masquer la case à cocher Read `CFileDialog` Only en définissant le style OFN_HIDEREADONLY dans le constructeur.

> [!NOTE]
> Windows Vista ou `CFileDialog` des objets de style ultérieur ne prennent pas en charge cette fonction. Tenter d’utiliser cette fonction sur `CFileDialog` un Windows Vista ou un style ultérieur jettera [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>CFileDialog::GetResult

Récupère le choix que l’utilisateur a fait dans le dialogue.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un IShellItem qui représente le choix de l’utilisateur.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>CFileDialog::GetResults

Récupère les choix de l’utilisateur dans un dialogue qui permet une sélection multiple.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à un IShellItemArray à travers lequel les éléments sélectionnés dans le dialogue peuvent être consultés.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>CFileDialog::GetSelectedControlItem

Récupère un élément particulier du contrôle spécifié des conteneurs dans le dialogue.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
L’ID de l’élément que l’utilisateur a choisi dans le contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>CFileDialog::GetStartPosition

Appelez cette fonction de membre pour récupérer la position du `m_ofn.Flags` premier nom de voie de fichier dans la liste, si le drapeau OFN_ALLOWMULTISELECT a défini.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur POSITION qui peut être utilisée pour l’itération; NULL si la liste est vide.

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>CFileDialog::HideControl

Appelez cette fonction de membre pour masquer le contrôle spécifié dans une boîte de dialogue ouverte ou sauve comme un dialogue commun.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
L’identité du contrôle à cacher.

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; sinon, la fonction échouera avec une affirmation.

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>CFileDialog::IsPickFoldersMode

Détermine si le dialogue actuel est en mode dossier.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si le dialogue est en mode dossier; autrement FALSE.

### <a name="remarks"></a>Notes

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>CFileDialog::m_ofn

`m_ofn`est une structure `OPENFILENAME`de type . Les données de cette structure représentent `CFileDialog`l’état actuel de la .

### <a name="remarks"></a>Notes

Utilisez cette structure pour initialiser l’apparence d’un **Fichier Open** ou File **Save As** boîte de dialogue après la construire, mais avant de l’afficher avec la méthode [DoModal.](#domodal) Par exemple, vous pouvez définir le membre `m_ofn` *lpstrTitle* de la légende que vous voulez que la boîte de dialogue ait.

Avec le Windows Vista ou le style `m_ofn` ultérieur de [CFileDialog](../../mfc/reference/cfiledialog-class.md), n’est pas garanti de toujours correspondre à l’état de la boîte de dialogue. Il est synchronisé avec la boîte de dialogue dans les versions antérieures de Windows. Voir [CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog) et [CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog) pour plus `m_ofn` d’informations `CFileDialog` sur la synchronisation de la structure et de l’état sous Windows Vista ou plus tard.

Windows Vista ou les dialogues de fichiers de style `CFileDialog`ultérieur ne prennent pas en charge certains membres et les drapeaux de la . Par conséquent, ceux-ci n’auront aucun effet.

Voici une liste des membres qui ne sont pas pris en charge par Windows Vista ou plus tard :

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Les drapeaux suivants ne sont pas pris en charge et n’ont donc aucun effet lorsque vous utilisez le Windows Vista ou le style ultérieur de `CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - effectivement toujours sur Windows Vista ou plus tard

- OFN_NOLONGNAMES - effectivement toujours hors de Windows Vista ou plus tard

- OFN_NONETWORKBUTTON - effectivement toujours sur Windows Vista ou plus tard

- OFN_READONLY

- OFN_SHOWHELP

Pour plus d’informations sur cette structure, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) dans le SDK Windows.

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>CFileDialog::MakeProminent

Place un contrôle dans le dialogue de sorte qu’il se démarque par rapport à d’autres contrôles.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L'ID du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>CFileDialog::OnButtonClicked

Appelé lorsque le bouton est cliqué.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du bouton.

### <a name="remarks"></a>Notes

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>CFileDialog::OnCheckButtonToggled

Appelé lorsque la case à cocher est cochée ou non contrôlée.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’id de la case à cocher.

*bChecked*<br/>
Vérifié ou non contrôlé.

### <a name="remarks"></a>Notes

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>CFileDialog::OnControlActivating

Appelé lorsque le contrôle est activé.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L'ID du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>CFileDialog::OnFileNameChange

Remplacez cette méthode si vous souhaitez gérer le message WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Notes

Le système envoie le message CDN_SELCHANGE lorsque l’utilisateur sélectionne un nouveau fichier ou un nouveau dossier dans la liste de fichiers de la boîte de dialogue **Open** ou **Save As.** Remplacez cette méthode si vous souhaitez effectuer des actions en réponse à ce message.

Le système n’envoie ce message que si la boîte de dialogue a été créée avec le drapeau OFN_EXPLORER allumé. Pour plus d’informations sur la notification, voir [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Pour plus d’informations sur le drapeau OFN_EXPLORER, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et [Open and Save As Dialog Boxes](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>CFileDialog::OnFileNameOK

Remplacez cette fonction uniquement si vous souhaitez fournir la validation personnalisée des noms de fichiers qui sont entrés dans une boîte commune de dialogue de fichier.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Valeur de retour

1 si le nom de fichier n’est pas un nom de fichier valide; sinon 0.

### <a name="remarks"></a>Notes

Cette fonction vous permet de rejeter un nom de fichier pour toute raison spécifique à l’application. Normalement, vous n’avez pas besoin d’utiliser cette fonction parce que le cadre fournit la validation par défaut des noms de fichiers et affiche une boîte de message si un nom de fichier invalide est entré.

Si 1 est retourné, la boîte de dialogue restera affichée pour que l’utilisateur saisie un autre nom de fichier. La procédure de dialogue rejette le dialogue si le retour est de 0. D’autres valeurs de retour non zéro sont actuellement réservées et ne doivent pas être utilisées.

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>CFileDialog::OnFolderChange

Remplacez cette fonction pour gérer le message WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Notes

Le message de notification est envoyé lorsqu’un nouveau dossier est ouvert dans la boîte de dialogue Open ou Save As.

La notification n’est envoyée que si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, voir [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Pour plus d’informations sur le style OFN_EXPLORER, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et [Open and Save As Dialog Boxes](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>CFileDialog::OnInitDone

Remplacez cette fonction pour gérer le message WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Notes

Le système envoie ce message de notification lorsque le système a fini d’organiser des contrôles dans la boîte de dialogue **Open** ou **Save As** pour faire place aux contrôles de la boîte de dialogue pour enfants.

Le système n’envoie cela que si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, voir [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Pour plus d’informations sur le style OFN_EXPLORER, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et [Open and Save As Dialog Boxes](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

> [!NOTE]
> Windows Vista ou les dialogues de fichiers de style ultérieur ne prennent pas en charge cette fonction. Tenter d’utiliser cette fonction sur un Windows Vista ou plus tard de style dialogue de fichier jettera [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md).

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>CFileDialog::OnItemSelected

Appelé lorsque l’élément conteneur est sélectionné.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

### <a name="remarks"></a>Notes

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>CFileDialog::OnLBSelChangedNotify

Cette fonction est appelée chaque fois que la sélection actuelle dans une boîte de liste est sur le point de changer.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Paramètres

*nIDBox (en)*<br/>
L’ID de la boîte de liste ou de la boîte combo dans laquelle la sélection a eu lieu.

*iCurSel (en)*<br/>
L’indice de la sélection actuelle.

*nCode (en)*<br/>
Le code de notification de contrôle. Ce paramètre doit avoir l’une des valeurs suivantes :

- CD_LBSELCHANGE Specifie *iCurSel* est l’élément sélectionné dans une boîte de liste de sélection unique.

- CD_LBSELSUB précise que *iCurSel* n’est plus sélectionné dans une boîte de liste multisélection.

- CD_LBSELADD précise que *iCurSel* est sélectionné dans une boîte de liste multisélection.

- CD_LBSELNOITEMS précise qu’aucune sélection n’existe dans une boîte de liste multisélection.

### <a name="remarks"></a>Notes

Remplacer cette fonction pour fournir une manipulation personnalisée des modifications de sélection dans la boîte de liste. Par exemple, vous pouvez utiliser cette fonction pour afficher les droits d’accès ou la date dernière modifiée de chaque fichier que l’utilisateur sélectionne.

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>CFileDialog::OnShareViolation

Remplacer cette fonction pour fournir une manipulation personnalisée des violations des actions.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Paramètres

*lpszPathName (en)*<br/>
La trajectoire du dossier sur lequel s’est produite la violation de l’action.

### <a name="return-value"></a>Valeur de retour

L’une des valeurs suivantes :

- OFN_SHAREFALLTHROUGH Le nom de fichier est retourné de la boîte de dialogue.

- OFN_SHARENOWARN Aucune autre mesure n’est à prendre.

- OFN_SHAREWARN L’utilisateur reçoit le message d’avertissement standard pour cette erreur.

### <a name="remarks"></a>Notes

Normalement, vous n’avez pas besoin d’utiliser cette fonction parce que le cadre fournit la vérification par défaut des violations des actions et affiche une boîte de message en cas de violation d’actions.

Si vous souhaitez désactiver la vérification des infractions de partage, utilisez `m_ofn.Flags`l’opérateur bitwise OU pour combiner le drapeau OFN_SHAREAWARE avec .

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>CFileDialog::OnTypeChange

Remplacez cette fonction pour gérer le message WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Notes

Le message de notification est envoyé lorsque l’utilisateur sélectionne un nouveau type de fichier à partir de la liste des types de fichiers dans la boîte de dialogue Open ou Save As.

La notification n’est envoyée que si la boîte de dialogue a été créée avec le style OFN_EXPLORER. Pour plus d’informations sur la notification, voir [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Pour plus d’informations sur le style OFN_EXPLORER, voir la structure [OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) et [Open and Save As Dialog Boxes](/windows/win32/dlgbox/open-and-save-as-dialog-boxes).

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>CFileDialog::RemoveControlItem

Retire un élément d’un contrôle de conteneur dans le dialogue.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du contrôle du conteneur pour enlever l’article.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>CFileDialog::SetCheckButtonState

Définit l’état actuel d’un bouton à cocher (case à cocher) dans le dialogue.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’id de la case à cocher.

*bChecked*<br/>
L’état de la case à cocher. TRUE indique vérifié; FALSE indique unchecked.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>CFileDialog::SetControlItemState

Définit l’état actuel d’un article dans un contrôle de conteneur trouvé dans le dialogue.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

*dwState (en)*<br/>
Une ou plusieurs valeurs du recensement DE CDCONTROLSTATE qui indiquent le nouvel état du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>CFileDialog::SetControlItemText

Définit le texte d’un élément de contrôle. Par exemple, le texte qui accompagne un bouton radio ou un élément dans un menu.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
ID de l'élément.

*strLabel (en)*<br/>
Texte de l’article.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>CFileDialog::SetControlLabel

Définit le texte associé à un contrôle, tel que le texte bouton ou une étiquette de boîte de modification.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L'ID du contrôle.

*strLabel (en)*<br/>
Nom du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>CFileDialog::SetControlState

Définit la visibilité actuelle et les états activés d’un contrôle donné.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L'ID du contrôle.

*dwState (en)*<br/>
Une ou plusieurs valeurs du recensement DE CDCONTROLSTATE qui indiquent l’état actuel du contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>CFileDialog::SetControlText

Appelez cette méthode pour définir le texte pour le contrôle spécifié dans une boîte de dialogue **Ouverte** ou **Enregistrer comme** un dialogue de style Explorer.

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] L’ID du contrôle pour lequel définir le texte.

*lpsz lpsz*<br/>
[dans] Un pointeur à la chaîne qui contient le texte à régler pour le contrôle.

### <a name="remarks"></a>Notes

Les deux versions de cette fonction sont valables pour les applications qui utilisent Unicode. Toutefois, seule la version avec le type LPCSTR est valable pour les applications qui utilisent ANSI.

Pour utiliser cette méthode, vous devez créer la boîte de dialogue avec le style OFN_EXPLORER. Sinon, la fonction échouera avec une affirmation.

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>CFileDialog::SetDefExt

Appelez cette fonction pour définir l’extension de nom de fichier par défaut pour une boîte de dialogue ouverte ou sauvement en commun de style Explorer.

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Paramètres

*lpsz lpsz*<br/>
Un pointeur à une chaîne contenant l’extension par défaut à utiliser pour l’objet de boîte de dialogue. Cette chaîne ne doit pas contenir une période (.).

### <a name="remarks"></a>Notes

La boîte de dialogue doit avoir été créée avec le style OFN_EXPLORER; sinon, la fonction échouera avec une affirmation.

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>CFileDialog::SetEditBoxText

Définit le texte actuel dans un contrôle de boîte de modification.

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID de la boîte de modification.

*strText (en)*<br/>
Valeur du texte.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>CFileDialog::SetProperties

Fournit une banque de propriétés qui définit les valeurs par défaut à utiliser pour l'élément en cours d'enregistrement.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Paramètres

*lpszPropList (en)*<br/>
Liste de propriétés prédéfinies séparées par un « ; ». Pour une liste des drapeaux, voir la section **Drapeaux** [d’OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Notes

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>CFileDialog::SetSelectedControlItem

Définit l’état choisi d’un élément particulier dans un groupe de boutons d’option ou une boîte combo trouvée dans le dialogue.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
ID du contrôle conteneur.

*dwIDItem dwIDItem*<br/>
L’ID de l’élément que l’utilisateur a choisi dans le contrôle.

### <a name="remarks"></a>Notes

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>CFileDialog::SetTemplate

Définit le modèle de boîte de dialogue pour l’objet [CFileDialog.](../../mfc/reference/cfiledialog-class.md)

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Paramètres

*nWin3ID (en)*<br/>
[dans] Contient le numéro d’identification de la `CFileDialog` ressource de modèle pour l’objet non-Explorer. Ce modèle n’est utilisé que sur Windows NT 3.51 ou lorsque le style OFN_EXPLORER n’est pas présent.

*nWin4ID (en)*<br/>
[dans] Contient le numéro d’identification de `CFileDialog` la ressource de modèle pour l’objet Explorer. Ce modèle n’est utilisé que sur Windows NT 4.0 et les versions ultérieures, Windows 95 et versions ultérieures, ou lorsque le style OFN_EXPLORER est présent.

*lpWin3ID*<br/>
[dans] Contient le nom de la ressource `CFileDialog` de modèle pour l’objet non-Explorer. Ce modèle n’est utilisé que sur Windows NT 3.51 ou lorsque le style OFN_EXPLORER n’est pas présent.

*lpWin4ID*<br/>
[dans] Contient le nom de la `CFileDialog` ressource modèle de l’objet Explorer. Ce modèle n’est utilisé que sur Windows NT 4.0 et les versions ultérieures, Windows 95 et versions ultérieures, ou lorsque le style OFN_EXPLORER est présent.

### <a name="remarks"></a>Notes

Le système n’utilisera qu’un seul des modèles spécifiés. Le système détermine le modèle à utiliser en fonction de la présence du style OFN_EXPLORER et du système d’exploitation sur lequel l’application fonctionne. En spécifiant à la fois un modèle de style non-Explorer et Explorer, il est facile de prendre en charge Windows NT 3.51, Windows NT 4.0 et les versions ultérieures, et Windows 95 et les versions ultérieures.

> [!NOTE]
> Windows Vista ou les boîtes de dialogue de fichiers de style postérieur ne prennent pas en charge cette fonction. Tenter d’utiliser cette fonction sur un Windows Vista ou plus tard boîte de dialogue de fichier de style jettera [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md). Une alternative consiste à utiliser un dialogue personnalisé. Pour plus d’informations `CFileDialog`sur l’utilisation d’une coutume , voir [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>CFileDialog::StartVisualGroup

Déclare un groupe visuel dans le dialogue. Les appels ultérieurs à toute méthode « ajouter » ajoutent ces éléments à ce groupe.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Paramètres

*dwIDCtl dwIDCtl*<br/>
L’ID du groupe visuel.

*strLabel (en)*<br/>
Nom de groupe.

### <a name="remarks"></a>Notes

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>CFileDialog::UpdateOFNFromShellDialog

Mise `m_ofn` à jour de la structure de données du [CFileDialog](../../mfc/reference/cfiledialog-class.md) en fonction de l’état actuel de l’objet interne.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Notes

Dans les versions de Windows avant Windows Vista, la structure de données [OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) membre a été synchronisée en permanence avec l’état de la `CFileDialog`. Toute modification de la variable [m_ofn](#m_ofn) membre a directement affecté l’état de la boîte de dialogue. En outre, toute modification de l’état du dialogue a immédiatement mis à jour la variable m_ofn membre.

Dans Windows Vista ou `m_ofn` plus tard, la structure de données n’est pas automatiquement mise à jour. Pour garantir l’exactitude des `m_ofn` données dans la `UpdateOFNFromShellDialog` variable du membre, vous devez appeler la fonction avant d’accéder aux données. Windows appelle cette fonction automatiquement pendant le traitement [d’IFileDialog:OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Pour plus d’informations `CFileDialog` sur la façon d’utiliser la classe sous Windows Vista ou plus tard, voir [CFileDialog Class](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Exemple

Cet exemple `CFileDialog` met à jour le avant de l’afficher. Avant de `m_ofn` mettre à jour la variable du membre, nous devons la synchroniser à l’état actuel de la boîte de dialogue.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>Voir aussi

[Classe CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)
