---
title: CMFCRibbonButton, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::AddSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::CanBeStretched
- AFXRIBBONBUTTON/CMFCRibbonButton::CleanUpSizes
- AFXRIBBONBUTTON/CMFCRibbonButton::ClosePopupMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawBottomText
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawImage
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawRibbonText
- AFXRIBBONBUTTON/CMFCRibbonButton::FindSubItemIndexByID
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCommandRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCompactSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIcon
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIntermediateSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenuRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetRegularSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::GetTextRowHeight
- AFXRIBBONBUTTON/CMFCRibbonButton::GetToolTipText
- AFXRIBBONBUTTON/CMFCRibbonButton::HasCompactMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasIntermediateMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasLargeMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsApplicationButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsCommandAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultPanelButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDrawTooltipImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuOnBottom
- AFXRIBBONBUTTON/CMFCRibbonButton::IsPopupDefaultMenuLook
- AFXRIBBONBUTTON/CMFCRibbonButton::IsRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsSingleLineText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnCalcTextSize
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDraw
- AFXRIBBONBUTTON/CMFCRibbonButton::OnFillBackground
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveAllSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::SetACCData
- AFXRIBBONBUTTON/CMFCRibbonButton::SetAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDescription
- AFXRIBBONBUTTON/CMFCRibbonButton::SetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::SetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetParentCategory
- AFXRIBBONBUTTON/CMFCRibbonButton::SetRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnClick
helpviewer_keywords:
- CMFCRibbonButton [MFC], CMFCRibbonButton
- CMFCRibbonButton [MFC], AddSubItem
- CMFCRibbonButton [MFC], CanBeStretched
- CMFCRibbonButton [MFC], CleanUpSizes
- CMFCRibbonButton [MFC], ClosePopupMenu
- CMFCRibbonButton [MFC], DrawBottomText
- CMFCRibbonButton [MFC], DrawImage
- CMFCRibbonButton [MFC], DrawRibbonText
- CMFCRibbonButton [MFC], FindSubItemIndexByID
- CMFCRibbonButton [MFC], GetCommandRect
- CMFCRibbonButton [MFC], GetCompactSize
- CMFCRibbonButton [MFC], GetIcon
- CMFCRibbonButton [MFC], GetImageIndex
- CMFCRibbonButton [MFC], GetImageSize
- CMFCRibbonButton [MFC], GetIntermediateSize
- CMFCRibbonButton [MFC], GetMenu
- CMFCRibbonButton [MFC], GetMenuRect
- CMFCRibbonButton [MFC], GetRegularSize
- CMFCRibbonButton [MFC], GetSubItems
- CMFCRibbonButton [MFC], GetTextRowHeight
- CMFCRibbonButton [MFC], GetToolTipText
- CMFCRibbonButton [MFC], HasCompactMode
- CMFCRibbonButton [MFC], HasIntermediateMode
- CMFCRibbonButton [MFC], HasLargeMode
- CMFCRibbonButton [MFC], HasMenu
- CMFCRibbonButton [MFC], IsAlwaysDrawBorder
- CMFCRibbonButton [MFC], IsAlwaysLargeImage
- CMFCRibbonButton [MFC], IsApplicationButton
- CMFCRibbonButton [MFC], IsCommandAreaHighlighted
- CMFCRibbonButton [MFC], IsDefaultCommand
- CMFCRibbonButton [MFC], IsDefaultPanelButton
- CMFCRibbonButton [MFC], IsDrawTooltipImage
- CMFCRibbonButton [MFC], IsLargeImage
- CMFCRibbonButton [MFC], IsMenuAreaHighlighted
- CMFCRibbonButton [MFC], IsMenuOnBottom
- CMFCRibbonButton [MFC], IsPopupDefaultMenuLook
- CMFCRibbonButton [MFC], IsRightAlignMenu
- CMFCRibbonButton [MFC], IsSingleLineText
- CMFCRibbonButton [MFC], OnCalcTextSize
- CMFCRibbonButton [MFC], OnDrawBorder
- CMFCRibbonButton [MFC], OnDraw
- CMFCRibbonButton [MFC], OnFillBackground
- CMFCRibbonButton [MFC], RemoveAllSubItems
- CMFCRibbonButton [MFC], RemoveSubItem
- CMFCRibbonButton [MFC], SetACCData
- CMFCRibbonButton [MFC], SetAlwaysLargeImage
- CMFCRibbonButton [MFC], SetDefaultCommand
- CMFCRibbonButton [MFC], SetDescription
- CMFCRibbonButton [MFC], SetImageIndex
- CMFCRibbonButton [MFC], SetMenu
- CMFCRibbonButton [MFC], SetParentCategory
- CMFCRibbonButton [MFC], SetRightAlignMenu
- CMFCRibbonButton [MFC], SetText
- CMFCRibbonButton [MFC], OnClick
ms.assetid: 732e941c-9504-4b83-a691-d18075965d53
ms.openlocfilehash: b0118b47fd1bb1db15916d7deffbaa32dcfc9df7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375295"
---
# <a name="cmfcribbonbutton-class"></a>CMFCRibbonButton, classe

La classe `CMFCRibbonButton` implémente des boutons que vous pouvez placer sur des éléments de barre de ruban, tels que les volets, les barres d'outils Accès rapide et les menus contextuels.

Pour plus de détails, consultez le code source situé dans le dossier **VC\\\\atlmfc src\\mfc** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCRibbonButton : public CMFCRibbonBaseElement
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonButton::CMFCRibbonButton](#cmfcribbonbutton)|Construit un objet bouton de ruban.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonButton::AddSubItem](#addsubitem)|Ajoute un élément de menu au menu contextuel associé au bouton.|
|[CMFCRibbonButton::CanBeStretched](#canbestretched)|(Overrides [CMFCRibbonBaseElement::CanBeStretched](../../mfc/reference/cmfcribbonbaseelement-class.md#canbestretched).)|
|[CMFCRibbonButton::CleanUpSizes](#cleanupsizes)|(Overrides [CMFCRibbonBaseElement::CleanUpSizes](../../mfc/reference/cmfcribbonbaseelement-class.md#cleanupsizes).)|
|[CMFCRibbonButton::ClosePopupMenu](#closepopupmenu)|(Overrides [CMFCRibbonBaseElement::ClosePopupMenu](../../mfc/reference/cmfcribbonbaseelement-class.md#closepopupmenu).)|
|[CMFCRibbonButton::DrawBottomText](#drawbottomtext)||
|[CMFCRibbonButton::DrawImage](#drawimage)|(Overrides [CMFCRibbonBaseElement::DrawImage](../../mfc/reference/cmfcribbonbaseelement-class.md#drawimage).)|
|[CMFCRibbonButton::DrawRibbonText](#drawribbontext)||
|[CMFCRibbonButton::FindSubItemIndexByID](#findsubitemindexbyid)|Retourne l'index d'un élément de menu contextuel associé à l'ID de commande spécifié.|
|[CMFCRibbonButton::GetCommandRect](#getcommandrect)||
|[CMFCRibbonButton::GetCompactSize](#getcompactsize)|Retourne la taille réduite de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::GetCompactSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getcompactsize).)|
|[CMFCRibbonButton::GetIcon](#geticon)||
|[CMFCRibbonButton::GetImageIndex](#getimageindex)|Retourne l'index de l'image associée au bouton.|
|[CMFCRibbonButton::GetImageSize](#getimagesize)|Retourne la taille d'image de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::GetImageSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getimagesize).)|
|[CMFCRibbonButton::GetIntermediateSize](#getintermediatesize)|Retourne la taille de l'élément de ruban dans son état intermédiaire. (Overrides [CMFCRibbonBaseElement::GetIntermediateSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getintermediatesize).)|
|[CMFCRibbonButton::GetMenu](#getmenu)|Retourne un handle de menu Windows affecté au bouton du ruban.|
|[CMFCRibbonButton::GetMenuRect](#getmenurect)||
|[CMFCRibbonButton::GetRegularSize](#getregularsize)|Retourne la taille normale de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::GetRegularSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getregularsize).)|
|[CMFCRibbonButton::GetSubItems](#getsubitems)||
|[CMFCRibbonButton::GetTextRowHeight](#gettextrowheight)||
|[CMFCRibbonButton::GetToolTipText](#gettooltiptext)|Retourne le texte d'info-bulle de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::GetToolTipText](../../mfc/reference/cmfcribbonbaseelement-class.md#gettooltiptext).)|
|[CMFCRibbonButton::HasCompactMode](#hascompactmode)|Précise si l'élément de ruban a un mode réduit. (Overrides [CMFCRibbonBaseElement::HasCompactMode](../../mfc/reference/cmfcribbonbaseelement-class.md#hascompactmode).)|
|[CMFCRibbonButton::HasIntermediateMode](#hasintermediatemode)|Précise si l'élément de ruban a un mode intermédiaire. (Overrides [CMFCRibbonBaseElement::HasIntermediateMode](../../mfc/reference/cmfcribbonbaseelement-class.md#hasintermediatemode).)|
|[CMFCRibbonButton::HasLargeMode](#haslargemode)|Détermine si l'élément de ruban a un mode grand. (Overrides [CMFCRibbonBaseElement::HasLargeMode](../../mfc/reference/cmfcribbonbaseelement-class.md#haslargemode).)|
|[CMFCRibbonButton::HasMenu](#hasmenu)|(Overrides [CMFCRibbonBaseElement::HasMenu](../../mfc/reference/cmfcribbonbaseelement-class.md#hasmenu).)|
|[CMFCRibbonButton::IsAlwaysDrawBorder](#isalwaysdrawborder)||
|[CMFCRibbonButton::IsAlwaysLargeImage](#isalwayslargeimage)|(Overrides [CMFCRibbonBaseElement::IsAlwaysLargeImage](../../mfc/reference/cmfcribbonbaseelement-class.md#isalwayslargeimage).)|
|[CMFCRibbonButton::IsApplicationButton](#isapplicationbutton)||
|[CMFCRibbonButton::IsCommandAreaHighlighted](#iscommandareahighlighted)||
|[CMFCRibbonButton::IsDefaultCommand](#isdefaultcommand)|Détermine si vous avez activé la commande par défaut pour un bouton du ruban.|
|[CMFCRibbonButton::IsDefaultPanelButton](#isdefaultpanelbutton)||
|[CMFCRibbonButton::IsDrawTooltipImage](#isdrawtooltipimage)||
|[CMFCRibbonButton::IsLargeImage](#islargeimage)||
|[CMFCRibbonButton::IsMenuAreaHighlighted](#ismenuareahighlighted)||
|[CMFCRibbonButton::IsMenuOnBottom](#ismenuonbottom)||
|[CMFCRibbonButton::IsPopupDefaultMenuLook](#ispopupdefaultmenulook)||
|[CMFCRibbonButton::IsRightAlignMenu](#isrightalignmenu)|Détermine si le menu est aligné à droite.|
|[CMFCRibbonButton::IsSingleLineText](#issinglelinetext)||
|[CMFCRibbonButton::OnCalcTextSize](#oncalctextsize)|(Overrides [CMFCRibbonBaseElement::OnCalcTextSize](../../mfc/reference/cmfcribbonbaseelement-class.md#oncalctextsize).)|
|[CMFCRibbonButton::OnDrawBorder](#ondrawborder)||
|[CMFCRibbonButton::OnDraw](#ondraw)|Appelé par l'infrastructure pour dessiner l'élément de ruban. (Overrides [CMFCRibbonBaseElement::OnDraw](../../mfc/reference/cmfcribbonbaseelement-class.md#ondraw).)|
|[CMFCRibbonButton::OnFillBackground](#onfillbackground)||
|[CMFCRibbonButton::RemoveAllSubItems](#removeallsubitems)|Supprime tous les éléments de menu du menu contextuel.|
|[CMFCRibbonButton::RemoveSubItem](#removesubitem)|Supprime un élément de menu du menu contextuel.|
|[CMFCRibbonButton::SetACCData](#setaccdata)|(Overrides [CMFCRibbonBaseElement::SetACCData](../../mfc/reference/cmfcribbonbaseelement-class.md#setaccdata).)|
|[CMFCRibbonButton::SetAlwaysLargeImage](#setalwayslargeimage)|Précise si le bouton affiche une image grande ou petite quand l‘utilisateur réduit le bouton.|
|[CMFCRibbonButton::SetDefaultCommand](#setdefaultcommand)|Active la commande par défaut pour le bouton du ruban.|
|[CMFCRibbonButton::SetDescription](#setdescription)|Définit la description de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::SetDescription](../../mfc/reference/cmfcribbonbaseelement-class.md#setdescription).)|
|[CMFCRibbonButton::SetImageIndex](#setimageindex)|Affecte un index à l'image du bouton.|
|[CMFCRibbonButton::SetMenu](#setmenu)|Affecte un menu contextuel au bouton du ruban.|
|[CMFCRibbonButton::SetParentCategory](#setparentcategory)|(Overrides [CMFCRibbonBaseElement::SetParentCategory](../../mfc/reference/cmfcribbonbaseelement-class.md#setparentcategory).)|
|[CMFCRibbonButton::SetRightAlignMenu](#setrightalignmenu)|Aligne le menu contextuel à droite du bouton.|
|[CMFCRibbonButton::SetText](#settext)|Définit le texte de l'élément de ruban. (Overrides [CMFCRibbonBaseElement::SetText](../../mfc/reference/cmfcribbonbaseelement-class.md#settext).)|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonButton::OnClick](#onclick)|Appelé par l'infrastructure quand l'utilisateur clique sur le bouton.|

## <a name="example"></a>Exemple

L'exemple suivant montre comment utiliser les différentes méthodes de la classe `CMFCRibbonButton`. Il montre comment construire un objet de la classe `CMFCRibbonButton`, affecter un menu contextuel au bouton du ruban, définir la description du bouton, supprimer un élément de menu du menu contextuel et aligner le menu contextuel à droite par rapport au bord du bouton.

[!code-cpp[NVC_MFC_RibbonApp#7](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_1.cpp)]

## <a name="remarks"></a>Notes

Pour utiliser un bouton ruban dans une application, construisez l’objet bouton et ajoutez-le au [panneau](../../mfc/reference/cmfcribbonpanel-class.md)de ruban approprié.

```cpp
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"), // Panel name
    m_PanelIcons.ExtractIcon (0)); // Panel icon

// Create the first button ("Paste"):
CMFCRibbonButton* pPasteButton =
    new CMFCRibbonButton (ID_EDIT_PASTE, _T("Paste"), -1, 0);

// The third parameter (-1) disables small images for button.
// This button is always displayed with a large image
// Associate a pop-up menu with the "Paste" button:
pPasteButton->SetMenu (IDR_CONTEXT_MENU);

// Add buttons to the panel. These buttons have only small images.
pPanel->Add (new CMFCRibbonButton (ID_EDIT_CUT, _T("Cut"), 1));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_COPY, _T("Copy"), 2));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_PAINT, _T("Paint"), 9));
```

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

## <a name="requirements"></a>Spécifications

**En-tête :** afxribbonbutton.h

## <a name="cmfcribbonbuttonaddsubitem"></a><a name="addsubitem"></a>CMFCRibbonButton::AddSubItem

Ajoute un élément de menu au menu contextuel associé au bouton.

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1);
```

### <a name="parameters"></a>Paramètres

*pSubItem (en)*<br/>
[dans] Spécifie un pointeur sur le nouvel élément à ajouter.

*nIndex*<br/>
[dans] Spécifie l’index auquel ajouter l’élément à la gamme d’éléments de menu du bouton; -1 pour ajouter l’élément à la fin de la gamme d’éléments de menu.

## <a name="cmfcribbonbuttoncanbestretched"></a><a name="canbestretched"></a>CMFCRibbonButton::CanBeStretched

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttoncleanupsizes"></a><a name="cleanupsizes"></a>CMFCRibbonButton::CleanUpSizes

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonclosepopupmenu"></a><a name="closepopupmenu"></a>CMFCRibbonButton::ClosePopupMenu

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttoncmfcribbonbutton"></a><a name="cmfcribbonbutton"></a>CMFCRibbonButton::CMFCRibbonButton

Construit un objet bouton de ruban.

```
CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex=-1,
    int nLargeImageIndex=-1,
    BOOL bAlwaysShowDescription=FALSE);

CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    HICON hIcon,
    BOOL bAlwaysShowDescription=FALSE,
    HICON hIconSmall=NULL,
    BOOL bAutoDestroyIcon=FALSE,
    BOOL bAlphaBlendIcon=FALSE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] Spécifie l’ID de commande du bouton.

*lpszText*<br/>
[dans] Spécifie l’étiquette de texte du bouton.

*nSmallImageIndex*<br/>
[dans] Spécifie un index zéro de la petite image du bouton dans la liste d’images de la catégorie parente.

*nLargeImageIndex*<br/>
[dans] Spécifie un index zéro de la grande image du bouton dans la liste d’images de la catégorie parente.

*hIcon (en)*<br/>
[dans] Spécifie une poignée à l’icône que l’application utilise comme image du bouton.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `CMFCRibbonButton` construire un objet.

[!code-cpp[NVC_MFC_RibbonApp#6](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_2.cpp)]

## <a name="cmfcribbonbuttondrawbottomtext"></a><a name="drawbottomtext"></a>CMFCRibbonButton::DrawBottomText

```
CSize DrawBottomText(
    CDC* pDC,
    BOOL bCalcOnly);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>
[dans] *bCalcOnly*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttondrawimage"></a><a name="drawimage"></a>CMFCRibbonButton::DrawImage

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>
[dans] *type*<br/>
[dans] *rectImage*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttondrawribbontext"></a><a name="drawribbontext"></a>CMFCRibbonButton::DrawRibbonText

```
virtual int DrawRibbonText(
    CDC* pDC,
    const CString& strText,
    CRect rectText,
    UINT uiDTFlags,
    COLORREF clrText = (COLORREF)-1);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>
[dans] *strText (en)*<br/>
[dans] *rectTexte*<br/>
[dans] *uiDTFlags uiDTFlags*<br/>
[dans] *clrText*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonfindsubitemindexbyid"></a><a name="findsubitemindexbyid"></a>CMFCRibbonButton::FindSubItemIndexByID

Retourne l'index d'un élément de menu contextuel associé à l'ID de commande spécifié.

```
int FindSubItemIndexByID(UINT uiID) const;
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
[dans] Spécifie l’ID de commande de l’élément du menu pop-up.

### <a name="return-value"></a>Valeur de retour

L’indice zéro du sous-élément associé à *l’uiID*. -1 s’il n’y a pas de sous-article de ce type.

## <a name="cmfcribbonbuttongetcommandrect"></a><a name="getcommandrect"></a>CMFCRibbonButton::GetCommandRect

```
CRect GetCommandRect() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetcompactsize"></a><a name="getcompactsize"></a>CMFCRibbonButton::GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongeticon"></a><a name="geticon"></a>CMFCRibbonButton::GetIcon

```
HICON GetIcon(BOOL bLargeIcon = TRUE) const;
```

### <a name="parameters"></a>Paramètres

[dans] *bLargeIcon*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetimageindex"></a><a name="getimageindex"></a>CMFCRibbonButton::GetImageIndex

Retourne l'index de l'image associée au bouton.

```
int GetImageIndex(BOOL bLargeImage) const;
```

### <a name="parameters"></a>Paramètres

*bLargeImage (en)*<br/>
[dans] Si VRAI, retourne l’index d’image dans la liste d’images qui contient les grandes images; retourne autrement l’indice d’image dans la liste d’images qui contient les petites images.

### <a name="return-value"></a>Valeur de retour

L’index de l’image du bouton dans la liste d’images associée.

## <a name="cmfcribbonbuttongetimagesize"></a><a name="getimagesize"></a>CMFCRibbonButton::GetImageSize

```
virtual CSize GetImageSize(RibbonImageType type) const;
```

### <a name="parameters"></a>Paramètres

[dans] *type*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetintermediatesize"></a><a name="getintermediatesize"></a>CMFCRibbonButton::GetIntermediateSize

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetmenu"></a><a name="getmenu"></a>CMFCRibbonButton::GetMenu

Retourne un handle de menu Windows affecté au bouton du ruban.

```
HMENU GetMenu() const;
```

### <a name="return-value"></a>Valeur de retour

Une poignée à un menu Windows assigné au bouton; NULL s’il n’y a pas de menu attribué.

## <a name="cmfcribbonbuttongetmenurect"></a><a name="getmenurect"></a>CMFCRibbonButton::GetMenuRect

```
CRect GetMenuRect() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetregularsize"></a><a name="getregularsize"></a>CMFCRibbonButton::GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongetsubitems"></a><a name="getsubitems"></a>CMFCRibbonButton::GetSubItems

```
const CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& GetSubItems() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongettextrowheight"></a><a name="gettextrowheight"></a>CMFCRibbonButton::GetTextRowHeight

```
int GetTextRowHeight() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttongettooltiptext"></a><a name="gettooltiptext"></a>CMFCRibbonButton::GetToolTipText

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonhascompactmode"></a><a name="hascompactmode"></a>CMFCRibbonButton::HasCompactMode

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonhasintermediatemode"></a><a name="hasintermediatemode"></a>CMFCRibbonButton::HasIntermediateMode

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonhaslargemode"></a><a name="haslargemode"></a>CMFCRibbonButton::HasLargeMode

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonhasmenu"></a><a name="hasmenu"></a>CMFCRibbonButton::HasMenu

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisalwaysdrawborder"></a><a name="isalwaysdrawborder"></a>CMFCRibbonButton::IsAlwaysDrawBorder

```
virtual BOOL IsAlwaysDrawBorder() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisalwayslargeimage"></a><a name="isalwayslargeimage"></a>CMFCRibbonButton::IsAlwaysLargeImage

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisapplicationbutton"></a><a name="isapplicationbutton"></a>CMFCRibbonButton::IsApplicationButton

```
virtual BOOL IsApplicationButton() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttoniscommandareahighlighted"></a><a name="iscommandareahighlighted"></a>CMFCRibbonButton::IsCommandAreaHighlighted

```
virtual BOOL IsCommandAreaHighlighted() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisdefaultcommand"></a><a name="isdefaultcommand"></a>CMFCRibbonButton::IsDefaultCommand

Précise si la commande par défaut pour un bouton ruban est activée.

```
BOOL IsDefaultCommand() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si vous avez activé la commande par défaut pour un bouton ruban; FALSE autrement.

## <a name="cmfcribbonbuttonisdefaultpanelbutton"></a><a name="isdefaultpanelbutton"></a>CMFCRibbonButton::IsDefaultPanelButton

```
virtual BOOL IsDefaultPanelButton() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisdrawtooltipimage"></a><a name="isdrawtooltipimage"></a>CMFCRibbonButton::IsDrawTooltipImage

```
virtual BOOL IsDrawTooltipImage() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonislargeimage"></a><a name="islargeimage"></a>CMFCRibbonButton::IsLargeImage

```
BOOL IsLargeImage() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonismenuareahighlighted"></a><a name="ismenuareahighlighted"></a>CMFCRibbonButton::IsMenuAreaHighlighted

```
virtual BOOL IsMenuAreaHighlighted() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonismenuonbottom"></a><a name="ismenuonbottom"></a>CMFCRibbonButton::IsMenuOnBottom

```
BOOL IsMenuOnBottom() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonispopupdefaultmenulook"></a><a name="ispopupdefaultmenulook"></a>CMFCRibbonButton::IsPopupDefaultMenuLook

```
virtual BOOL IsPopupDefaultMenuLook() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonisrightalignmenu"></a><a name="isrightalignmenu"></a>CMFCRibbonButton::IsRightAlignMenu

Précise si le menu est aligné à droite.

```
BOOL IsRightAlignMenu() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si le menu est aligné à droite; autrement FALSE.

## <a name="cmfcribbonbuttonissinglelinetext"></a><a name="issinglelinetext"></a>CMFCRibbonButton::IsSingleLineText

```
BOOL IsSingleLineText() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttononcalctextsize"></a><a name="oncalctextsize"></a>CMFCRibbonButton::OnCalcTextSize

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttononclick"></a><a name="onclick"></a>CMFCRibbonButton::OnClick

Appelé par l'infrastructure quand l'utilisateur clique sur le bouton.

```
virtual void OnClick(CPoint point);
```

### <a name="parameters"></a>Paramètres

*Point*<br/>
[dans] Spécifie la position du clic de la souris.

### <a name="remarks"></a>Notes

Remplacer cette méthode dans une classe dérivée si vous voulez gérer cet événement.

## <a name="cmfcribbonbuttonondraw"></a><a name="ondraw"></a>CMFCRibbonButton::OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonondrawborder"></a><a name="ondrawborder"></a>CMFCRibbonButton::OnDrawBorder

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttononfillbackground"></a><a name="onfillbackground"></a>CMFCRibbonButton::OnFillBackground

```
virtual COLORREF OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonremoveallsubitems"></a><a name="removeallsubitems"></a>CMFCRibbonButton::SupprimerAllSubItems

Supprime tous les éléments de menu du menu contextuel.

```
void RemoveAllSubItems();
```

## <a name="cmfcribbonbuttonremovesubitem"></a><a name="removesubitem"></a>CMFCRibbonButton::RemoveSubItem

Supprime un élément de menu du menu contextuel.

```
BOOL RemoveSubItem(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index zéro de l’élément de menu que vous souhaitez supprimer.

### <a name="return-value"></a>Valeur de retour

VRAI si l’élément spécifié a été supprimé avec succès; autrement FALSE si *nIndex* est négatif ou dépasse le nombre d’éléments de menu dans le menu pop-up.

## <a name="cmfcribbonbuttonsetaccdata"></a><a name="setaccdata"></a>CMFCRibbonButton::SetACCData

Définit les données d’accessibilité du bouton de ruban.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
La fenêtre parente de l’élément ruban.

*data*<br/>
Les données d’accessibilité de l’élément ruban.

### <a name="return-value"></a>Valeur de retour

Rendements VRAI en cas de succès; autrement FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonsetalwayslargeimage"></a><a name="setalwayslargeimage"></a>CMFCRibbonButton::SetAlwaysLargeImage

Précise si le bouton affiche une image grande ou petite quand l‘utilisateur réduit le bouton.

```
void SetAlwaysLargeImage(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] Si VRAI, le bouton affiche une grande image. Sinon, le bouton affiche une petite image.

## <a name="cmfcribbonbuttonsetdefaultcommand"></a><a name="setdefaultcommand"></a>CMFCRibbonButton::SetDefaultCommand

Active la commande par défaut pour le bouton du ruban.

```
void SetDefaultCommand(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] Si TRUE, le bouton peut exécuter sa commande par défaut. Si FALSE, le bouton ne peut pas exécuter sa commande par défaut.

### <a name="remarks"></a>Notes

*bSet* n’est pertinent que lorsque le bouton a un menu. Si *bSet* est VRAI, le bouton peut exécuter sa commande par défaut et le menu pop-up assigné n’apparaît que lorsqu’un utilisateur clique sur la flèche sur le bord droit du bouton. Dans le cas contraire, le bouton ne peut pas exécuter sa commande par défaut, et le menu pop-up apparaît quelle que soit la zone du bouton que l’utilisateur clique.

## <a name="cmfcribbonbuttonsetdescription"></a><a name="setdescription"></a>CMFCRibbonButton::SetDescription

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>Paramètres

[dans] *lpszText*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonsetimageindex"></a><a name="setimageindex"></a>CMFCRibbonButton::SetImageIndex

Affecte un index à l'image du bouton.

```
void SetImageIndex(
    int nIndex,
    BOOL bLargeImage);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
[dans] Spécifie l’index d’image.

*bLargeImage (en)*<br/>
[dans] Si VRAI, l’index spécifié se réfère à la liste des grandes images. Sinon, l’index se réfère à la liste des petites images.

## <a name="cmfcribbonbuttonsetmenu"></a><a name="setmenu"></a>CMFCRibbonButton::SetMenu

Affecte un menu contextuel au bouton du ruban.

```
void SetMenu(
    HMENU hMenu,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);

void SetMenu(
    UINT uiMenuResID,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);
```

### <a name="parameters"></a>Paramètres

*hMenu*<br/>
Une poignée à un menu Windows.

*bIsDefaultCommand (en)*<br/>
Si VRAI, le bouton peut exécuter sa commande par défaut; sinon, le bouton affiche un menu pop-up.

*bRightAlign (en)*<br/>
Si VRAI, le menu est aligné à droite. Sinon, le menu est aligné à gauche.

*uiMenuResID*<br/>
Une pièce d’identité de ressource de menu.

### <a name="remarks"></a>Notes

Lorsque l’application attribue le menu au bouton, le bouton affiche une flèche sur son côté droit. Si *bIsDefaultCommand* est VRAI, le menu n’apparaît que lorsque l’utilisateur clique sur la flèche. Si l’utilisateur clique sur le bouton, sa commande par défaut est exécutée. Si *bIsDefaultCommand* est FALSE, le menu apparaît en cliquant n’importe où sur le bouton.

## <a name="cmfcribbonbuttonsetparentcategory"></a><a name="setparentcategory"></a>CMFCRibbonButton::SetParentCategory

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>Paramètres

[dans] *pParent*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbonbuttonsetrightalignmenu"></a><a name="setrightalignmenu"></a>CMFCRibbonButton::SetRightAlignMenu

Aligne le menu pop-up sur le bord du bouton.

```
void SetRightAlignMenu(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] Si VRAI, le menu est aligné à droite. Sinon, le menu est aligné à gauche

## <a name="cmfcribbonbuttonsettext"></a><a name="settext"></a>CMFCRibbonButton::SetText

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>Paramètres

[dans] *lpszText*<br/>

### <a name="remarks"></a>Notes

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)
