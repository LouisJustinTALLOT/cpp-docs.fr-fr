---
description: 'En savoir plus sur : classe COleControlSite'
title: COleControlSite, classe
ms.date: 11/04/2016
f1_keywords:
- COleControlSite
- AFXOCC/COleControlSite
- AFXOCC/COleControlSite::COleControlSite
- AFXOCC/COleControlSite::BindDefaultProperty
- AFXOCC/COleControlSite::BindProperty
- AFXOCC/COleControlSite::CreateControl
- AFXOCC/COleControlSite::DestroyControl
- AFXOCC/COleControlSite::DoVerb
- AFXOCC/COleControlSite::EnableDSC
- AFXOCC/COleControlSite::EnableWindow
- AFXOCC/COleControlSite::FreezeEvents
- AFXOCC/COleControlSite::GetDefBtnCode
- AFXOCC/COleControlSite::GetDlgCtrlID
- AFXOCC/COleControlSite::GetEventIID
- AFXOCC/COleControlSite::GetExStyle
- AFXOCC/COleControlSite::GetProperty
- AFXOCC/COleControlSite::GetStyle
- AFXOCC/COleControlSite::GetWindowText
- AFXOCC/COleControlSite::InvokeHelper
- AFXOCC/COleControlSite::InvokeHelperV
- AFXOCC/COleControlSite::IsDefaultButton
- AFXOCC/COleControlSite::IsWindowEnabled
- AFXOCC/COleControlSite::ModifyStyle
- AFXOCC/COleControlSite::ModifyStyleEx
- AFXOCC/COleControlSite::MoveWindow
- AFXOCC/COleControlSite::QuickActivate
- AFXOCC/COleControlSite::SafeSetProperty
- AFXOCC/COleControlSite::SetDefaultButton
- AFXOCC/COleControlSite::SetDlgCtrlID
- AFXOCC/COleControlSite::SetFocus
- AFXOCC/COleControlSite::SetProperty
- AFXOCC/COleControlSite::SetPropertyV
- AFXOCC/COleControlSite::SetWindowPos
- AFXOCC/COleControlSite::SetWindowText
- AFXOCC/COleControlSite::ShowWindow
- AFXOCC/COleControlSite::GetControlInfo
- AFXOCC/COleControlSite::m_bIsWindowless
- AFXOCC/COleControlSite::m_ctlInfo
- AFXOCC/COleControlSite::m_dwEventSink
- AFXOCC/COleControlSite::m_dwMiscStatus
- AFXOCC/COleControlSite::m_dwPropNotifySink
- AFXOCC/COleControlSite::m_dwStyle
- AFXOCC/COleControlSite::m_hWnd
- AFXOCC/COleControlSite::m_iidEvents
- AFXOCC/COleControlSite::m_nID
- AFXOCC/COleControlSite::m_pActiveObject
- AFXOCC/COleControlSite::m_pCtrlCont
- AFXOCC/COleControlSite::m_pInPlaceObject
- AFXOCC/COleControlSite::m_pObject
- AFXOCC/COleControlSite::m_pWindowlessObject
- AFXOCC/COleControlSite::m_pWndCtrl
- AFXOCC/COleControlSite::m_rect
helpviewer_keywords:
- COleControlSite [MFC], COleControlSite
- COleControlSite [MFC], BindDefaultProperty
- COleControlSite [MFC], BindProperty
- COleControlSite [MFC], CreateControl
- COleControlSite [MFC], DestroyControl
- COleControlSite [MFC], DoVerb
- COleControlSite [MFC], EnableDSC
- COleControlSite [MFC], EnableWindow
- COleControlSite [MFC], FreezeEvents
- COleControlSite [MFC], GetDefBtnCode
- COleControlSite [MFC], GetDlgCtrlID
- COleControlSite [MFC], GetEventIID
- COleControlSite [MFC], GetExStyle
- COleControlSite [MFC], GetProperty
- COleControlSite [MFC], GetStyle
- COleControlSite [MFC], GetWindowText
- COleControlSite [MFC], InvokeHelper
- COleControlSite [MFC], InvokeHelperV
- COleControlSite [MFC], IsDefaultButton
- COleControlSite [MFC], IsWindowEnabled
- COleControlSite [MFC], ModifyStyle
- COleControlSite [MFC], ModifyStyleEx
- COleControlSite [MFC], MoveWindow
- COleControlSite [MFC], QuickActivate
- COleControlSite [MFC], SafeSetProperty
- COleControlSite [MFC], SetDefaultButton
- COleControlSite [MFC], SetDlgCtrlID
- COleControlSite [MFC], SetFocus
- COleControlSite [MFC], SetProperty
- COleControlSite [MFC], SetPropertyV
- COleControlSite [MFC], SetWindowPos
- COleControlSite [MFC], SetWindowText
- COleControlSite [MFC], ShowWindow
- COleControlSite [MFC], GetControlInfo
- COleControlSite [MFC], m_bIsWindowless
- COleControlSite [MFC], m_ctlInfo
- COleControlSite [MFC], m_dwEventSink
- COleControlSite [MFC], m_dwMiscStatus
- COleControlSite [MFC], m_dwPropNotifySink
- COleControlSite [MFC], m_dwStyle
- COleControlSite [MFC], m_hWnd
- COleControlSite [MFC], m_iidEvents
- COleControlSite [MFC], m_nID
- COleControlSite [MFC], m_pActiveObject
- COleControlSite [MFC], m_pCtrlCont
- COleControlSite [MFC], m_pInPlaceObject
- COleControlSite [MFC], m_pObject
- COleControlSite [MFC], m_pWindowlessObject
- COleControlSite [MFC], m_pWndCtrl
- COleControlSite [MFC], m_rect
ms.assetid: 43970644-5eab-434a-8ba6-56d144ff1e3f
ms.openlocfilehash: 3fecd9f81baec29a205dbdf4a10ee7d4927c3823
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97227453"
---
# <a name="colecontrolsite-class"></a>COleControlSite, classe

Prend en charge les interfaces de contrôle côté client personnalisées.

## <a name="syntax"></a>Syntaxe

```
class COleControlSite : public CCmdTarget
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleControlSite::COleControlSite](#colecontrolsite)|Construit un objet `COleControlSite`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleControlSite::BindDefaultProperty](#binddefaultproperty)|Lie la propriété par défaut du contrôle hébergé à une source de données.|
|[COleControlSite::BindProperty](#bindproperty)|Lie une propriété du contrôle hébergé à une source de données.|
|[COleControlSite :: CreateControl](#createcontrol)|Crée un contrôle ActiveX hébergé.|
|[COleControlSite ::D estroyControl](#destroycontrol)|Détruit le contrôle hébergé.|
|[COleControlSite ::D oVerb](#doverb)|Exécute un verbe spécifique du contrôle hébergé.|
|[COleControlSite::EnableDSC](#enabledsc)|Active la source de données pour un site de contrôle.|
|[COleControlSite::EnableWindow](#enablewindow)|Active le site de contrôle.|
|[COleControlSite :: FreezeEvents](#freezeevents)|Spécifie si le site de contrôle accepte des événements.|
|[COleControlSite::GetDefBtnCode](#getdefbtncode)|Récupère le code de bouton par défaut pour le contrôle hébergé.|
|[COleControlSite::GetDlgCtrlID](#getdlgctrlid)|Récupère l’identificateur du contrôle.|
|[COleControlSite::GetEventIID](#geteventiid)|Récupère l’ID d’une interface d’événement pour un contrôle hébergé.|
|[COleControlSite::GetExStyle](#getexstyle)|Récupère les styles étendus du site de contrôle.|
|[COleControlSite :: GetProperty](#getproperty)|Récupère une propriété spécifique du contrôle hébergé.|
|[COleControlSite::GetStyle](#getstyle)|Récupère les styles du site de contrôle.|
|[COleControlSite :: GetWindowText](#getwindowtext)|Récupère le texte du contrôle hébergé.|
|[COleControlSite :: InvokeHelper](#invokehelper)|Appelle une méthode spécifique du contrôle hébergé.|
|[COleControlSite::InvokeHelperV](#invokehelperv)|Appelle une méthode spécifique du contrôle hébergé avec une liste variable d’arguments.|
|[COleControlSite::IsDefaultButton](#isdefaultbutton)|Détermine si le contrôle est le bouton par défaut dans la fenêtre.|
|[COleControlSite::IsWindowEnabled](#iswindowenabled)|Vérifie l’état visible du site de contrôle.|
|[COleControlSite :: ModifyStyle](#modifystyle)|Modifie les styles étendus actuels du site de contrôle.|
|[COleControlSite::ModifyStyleEx](#modifystyleex)|Modifie les styles actuels du site de contrôle.|
|[COleControlSite::MoveWindow](#movewindow)|Modifie la position du site de contrôle.|
|[COleControlSite::QuickActivate](#quickactivate)|Active rapidement le contrôle hébergé.|
|[COleControlSite::SafeSetProperty](#safesetproperty)|Définit une propriété ou une méthode du contrôle sans risque de lever une exception.|
|[COleControlSite::SetDefaultButton](#setdefaultbutton)|Définit le bouton par défaut dans la fenêtre.|
|[COleControlSite::SetDlgCtrlID](#setdlgctrlid)|Récupère l’identificateur du contrôle.|
|[COleControlSite :: SetFocus](#setfocus)|Définit le focus sur le site de contrôle.|
|[COleControlSite :: SetProperty](#setproperty)|Définit une propriété spécifique du contrôle hébergé.|
|[COleControlSite::SetPropertyV](#setpropertyv)|Définit une propriété spécifique du contrôle hébergé avec une liste variable d’arguments.|
|[COleControlSite :: SetWindowPos](#setwindowpos)|Définit la position du site de contrôle.|
|[COleControlSite :: SetWindowText](#setwindowtext)|Définit le texte du contrôle hébergé.|
|[COleControlSite :: ShowWindow](#showwindow)|Affiche ou masque le site de contrôle.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleControlSite::GetControlInfo](#getcontrolinfo)|Récupère des informations de clavier et des mnémoniques pour le contrôle hébergé.|

### <a name="public-data-members"></a>Membres de données publics

|Nom|Description|
|----------|-----------------|
|[COleControlSite :: m_bIsWindowless](#m_biswindowless)|Détermine si le contrôle hébergé est un contrôle sans fenêtre.|
|[COleControlSite :: m_ctlInfo](#m_ctlinfo)|Contient des informations sur la gestion du clavier pour le contrôle.|
|[COleControlSite :: m_dwEventSink](#m_dweventsink)|Cookie du point de connexion du contrôle.|
|[COleControlSite :: m_dwMiscStatus](#m_dwmiscstatus)|États divers pour le contrôle hébergé.|
|[COleControlSite :: m_dwPropNotifySink](#m_dwpropnotifysink)|`IPropertyNotifySink`Cookie du contrôle.|
|[COleControlSite :: m_dwStyle](#m_dwstyle)|Styles du contrôle hébergé.|
|[COleControlSite :: m_hWnd](#m_hwnd)|Descripteur du site de contrôle.|
|[COleControlSite :: m_iidEvents](#m_iidevents)|ID de l’interface d’événement pour le contrôle hébergé.|
|[COleControlSite :: m_nID](#m_nid)|ID du contrôle hébergé.|
|[COleControlSite :: m_pActiveObject](#m_pactiveobject)|Pointeur vers l' `IOleInPlaceActiveObject` objet du contrôle hébergé.|
|[COleControlSite :: m_pCtrlCont](#m_pctrlcont)|Conteneur du contrôle hébergé.|
|[COleControlSite :: m_pInPlaceObject](#m_pinplaceobject)|Pointeur vers l' `IOleInPlaceObject` objet du contrôle hébergé.|
|[COleControlSite :: m_pObject](#m_pobject)|Pointeur vers l' `IOleObjectInterface` interface du contrôle.|
|[COleControlSite :: m_pWindowlessObject](#m_pwindowlessobject)|Pointeur vers l' `IOleInPlaceObjectWindowless` interface du contrôle.|
|[COleControlSite :: m_pWndCtrl](#m_pwndctrl)|Pointeur vers l’objet de fenêtre pour le contrôle hébergé.|
|[COleControlSite :: m_rect](#m_rect)|Dimensions du site de contrôle.|

## <a name="remarks"></a>Notes

Cette prise en charge est la principale méthode par laquelle un contrôle ActiveX incorporé obtient des informations sur l’emplacement et l’étendue de son site d’affichage, son moniker, son interface utilisateur, ses propriétés ambiantes et d’autres ressources fournies par son conteneur. `COleControlSite` implémente entièrement les interfaces [IOleControlSite](/windows/win32/api/ocidl/nn-ocidl-iolecontrolsite), [IOleInPlaceSite](/windows/win32/api/oleidl/nn-oleidl-ioleinplacesite), [IOleClientSite](/windows/win32/api/oleidl/nn-oleidl-ioleclientsite), [IPropertyNotifySink](/windows/win32/api/ocidl/nn-ocidl-ipropertynotifysink), `IBoundObjectSite` , `INotifyDBEvents` et [IRowSetNotify](../../data/oledb/irowsetnotifyimpl-class.md)       . En outre, l’interface IDispatch (assurant la prise en charge des propriétés ambiantes et des récepteurs d’événements) est également implémentée.

Pour créer un site de contrôle ActiveX à l’aide de `COleControlSite` , dérivez une classe de `COleControlSite` . Dans votre `CWnd` classe dérivée de, pour le conteneur (par exemple, votre boîte de dialogue), remplacez la `CWnd::CreateControlSite` fonction.

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

`COleControlSite`

## <a name="requirements"></a>Spécifications

**En-tête :** afxocc. h

## <a name="colecontrolsitebinddefaultproperty"></a><a name="binddefaultproperty"></a> COleControlSite::BindDefaultProperty

Lie la propriété de liaison simple par défaut de l’objet appelant, telle qu’elle est marquée dans la bibliothèque de types, au curseur sous-jacent qui est défini par les propriétés DataSource, UserName, Password et SQL du contrôle de source de données.

```
virtual void BindDefaultProperty(
    DISPID dwDispID,
    VARTYPE vtProp,
    LPCTSTR szFieldName,
    CWnd* pDSCWnd);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Spécifie le DISPID d’une propriété sur un contrôle lié aux données qui doit être lié à un contrôle de source de données.

*vtProp*<br/>
Spécifie le type de la propriété à lier (par exemple, VT_BSTR, VT_VARIANT, etc.).

*szFieldName*<br/>
Spécifie le nom de la colonne, dans le curseur fourni par le contrôle de source de données, auquel la propriété sera liée.

*pDSCWnd*<br/>
Pointeur vers l' `CWnd` objet dérivé de qui héberge le contrôle de source de données auquel la propriété sera liée.

### <a name="remarks"></a>Notes

L' `CWnd` objet sur lequel vous appelez cette fonction doit être un contrôle lié aux données.

## <a name="colecontrolsitebindproperty"></a><a name="bindproperty"></a> COleControlSite::BindProperty

Lie la propriété liée simple de l’objet appelant, telle qu’elle est marquée dans la bibliothèque de types, au curseur sous-jacent qui est défini par la source de données, le nom d’utilisateur, le mot de passe et les propriétés SQL du contrôle de source de données.

```
virtual void BindProperty(
    DISPID dwDispId,
    CWnd* pWndDSC);
```

### <a name="parameters"></a>Paramètres

*dwDispId*<br/>
Spécifie le DISPID d’une propriété sur un contrôle lié aux données qui doit être lié à un contrôle de source de données.

*pWndDSC*<br/>
Pointeur vers l' `CWnd` objet dérivé de qui héberge le contrôle de source de données auquel la propriété sera liée.

### <a name="remarks"></a>Notes

L' `CWnd` objet sur lequel vous appelez cette fonction doit être un contrôle lié aux données.

## <a name="colecontrolsitecolecontrolsite"></a><a name="colecontrolsite"></a> COleControlSite::COleControlSite

Construit un nouvel objet `COleControlSite`.

```
explicit COleControlSite(COleControlContainer* pCtrlCont);
```

### <a name="parameters"></a>Paramètres

*pCtrlCont*<br/>
Pointeur vers le conteneur du contrôle (qui représente la fenêtre qui héberge le contrôle AtiveX).

### <a name="remarks"></a>Notes

Cette fonction est appelée par la fonction [COccManager :: CreateContainer](../../mfc/reference/coccmanager-class.md#createcontainer) . Pour plus d’informations sur la personnalisation de la création de conteneurs, consultez [COccManager :: createsite](../../mfc/reference/coccmanager-class.md#createsite).

## <a name="colecontrolsitecreatecontrol"></a><a name="createcontrol"></a> COleControlSite :: CreateControl

Crée un contrôle ActiveX, hébergé par l' `COleControlSite` objet.

```
virtual HRESULT CreateControl(
    CWnd* pWndCtrl,
    REFCLSID clsid,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    UINT nID,
    CFile* pPersist = NULL,
    BOOL bStorage = FALSE,
    BSTR bstrLicKey = NULL);

virtual HRESULT CreateControl(
    CWnd* pWndCtrl,
    REFCLSID clsid,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const POINT* ppt,
    const SIZE* psize,
    UINT nID,
    CFile* pPersist = NULL,
    BOOL bStorage = FALSE,
    BSTR bstrLicKey = NULL);
```

### <a name="parameters"></a>Paramètres

*pWndCtrl*<br/>
Pointeur vers l’objet fenêtre représentant le contrôle.

*identificateur*<br/>
ID de classe unique du contrôle.

*lpszWindowName*<br/>
Pointeur vers le texte à afficher dans le contrôle. Définit la valeur de la propriété Text ou Caption de winodw (le cas échéant).

*dwStyle*<br/>
Styles Windows. Les styles disponibles sont répertoriés sous la section **Notes** .

*rectangulaire*<br/>
Spécifie la taille et la position du contrôle. Il peut s’agir d’un `CRect` objet ou d’une `RECT` structure.

*nID*<br/>
Spécifie l’ID de fenêtre enfant du contrôle.

*pPersist*<br/>
Pointeur vers un `CFile` qui contient l’état persistant du contrôle. La valeur par défaut est NULL, ce qui indique que le contrôle s’initialise lui-même sans restaurer son état à partir d’un stockage persistant. Si la valeur n’est pas NULL, il doit s’agir d’un pointeur désignant un `CFile` objet dérivé de qui contient les données persistantes du contrôle, sous la forme d’un flux ou d’un stockage. Ces données peuvent avoir été enregistrées dans une précédente activation du client. Le `CFile` peut contenir d’autres données, mais doit avoir son pointeur de lecture-écriture défini sur le premier octet de données persistantes au moment de l’appel à `CreateControl` .

*bStorage*<br/>
Indique si les données dans *pPersist* doivent être interprétées comme des `IStorage` `IStream` données ou. Si les données dans *pPersist* sont un stockage, *bStorage* doit avoir la valeur true. Si les données dans *pPersist* sont un flux, *bStorage* doit avoir la valeur false. La valeur par défaut est FALSE.

*bstrLicKey*<br/>
Données de clé de licence facultatives. Ces données sont nécessaires uniquement pour créer des contrôles qui nécessitent une clé de licence d’exécution. Si le contrôle prend en charge la gestion des licences, vous devez fournir une clé de licence pour que la création du contrôle aboutisse. La valeur par défaut est NULL.

*formations*<br/>
Pointeur vers une `POINT` structure qui contient l’angle supérieur gauche du contrôle. La taille du contrôle est déterminée par la valeur de *psize*. Les valeurs *PPT* et *psize* sont une méthode facultative de spécification de la taille et de la position pendant le contrôle.

*psize*<br/>
Pointeur vers une `SIZE` structure qui contient la taille du contrôle. L’angle supérieur gauche est déterminé par la valeur de *PPT*. Les valeurs *PPT* et *psize* sont une méthode facultative de spécification de la taille et de la position pendant le contrôle.

### <a name="return-value"></a>Valeur renvoyée

Valeur HRESULT standard.

### <a name="remarks"></a>Notes

Seul un sous-ensemble des indicateurs *DwStyle* Windows est pris en charge par `CreateControl` :

- WS_VISIBLE crée une fenêtre qui est initialement visible. Obligatoire si vous souhaitez que le contrôle soit visible immédiatement, comme les fenêtres ordinaires.

- WS_DISABLED crée une fenêtre qui est initialement désactivée. Une fenêtre désactivée ne peut pas recevoir d’entrée de l’utilisateur. Peut être défini si le contrôle a une propriété Enabled.

- WS_BORDER crée une fenêtre avec une bordure fine. Peut être défini si le contrôle a une propriété BorderStyle.

- WS_GROUP spécifie le premier contrôle d’un groupe de contrôles. L’utilisateur peut modifier le focus clavier d’un contrôle du groupe à l’autre à l’aide des touches de direction. Tous les contrôles définis avec le style WS_GROUP après le premier contrôle appartiennent au même groupe. Le contrôle suivant avec le style de WS_GROUP termine le groupe et démarre le groupe suivant.

- WS_TABSTOP spécifie un contrôle qui peut recevoir le focus clavier lorsque l’utilisateur appuie sur la touche TAB. Si vous appuyez sur la touche TAB, le focus clavier passe au contrôle suivant du style de WS_TABSTOP.

Utilisez la deuxième surcharge pour créer des contrôles de taille par défaut.

## <a name="colecontrolsitedestroycontrol"></a><a name="destroycontrol"></a> COleControlSite ::D estroyControl

Détruit l' `COleControlSite` objet.

```
virtual BOOL DestroyControl();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite, sinon 0.

### <a name="remarks"></a>Notes

Une fois terminé, l’objet est libéré de la mémoire et tous les pointeurs vers l’objet ne sont plus valides.

## <a name="colecontrolsitedoverb"></a><a name="doverb"></a> COleControlSite ::D oVerb

Exécute le verbe spécifié.

```
virtual HRESULT DoVerb(
    LONG nVerb,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb*<br/>
Spécifie le verbe à exécuter. Il peut inclure l’un des éléments suivants :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|0|Primary (verbe)|OLEIVERB_PRIMARY|
|-1|Verbe secondaire|(aucune)|
|1|Affiche l’objet à modifier.|OLEIVERB_SHOW|
|-2|Modifie l’élément dans une fenêtre séparée.|OLEIVERB_OPEN|
|-3|Masque l’objet.|OLEIVERB_HIDE|
|-4|Active un contrôle sur place.|OLEIVERB_UIACTIVATE|
|-5|Active un contrôle sur place, sans éléments d’interface utilisateur supplémentaires.|OLEIVERB_INPLACEACTIVATE|
|-7|Affichez les propriétés du contrôle.|OLEIVERB_PROPERTIES|

*lpMsg*<br/>
Pointeur vers le message qui a provoqué l’activation de l’élément.

### <a name="return-value"></a>Valeur renvoyée

Valeur HRESULT standard.

### <a name="remarks"></a>Notes

Cette fonction appelle directement via l’interface du contrôle `IOleObject` pour exécuter le verbe spécifié. Si une exception est levée à la suite de cet appel de fonction, un code d’erreur HRESULT est retourné.

Pour plus d’informations, consultez [IOleObject ::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

## <a name="colecontrolsiteenabledsc"></a><a name="enabledsc"></a> COleControlSite::EnableDSC

Active l’approvisionnement des données pour le site de contrôle.

```
virtual void EnableDSC();
```

### <a name="remarks"></a>Notes

Appelée par l’infrastructure pour activer et initialiser l’approvisionnement des données pour le site de contrôle. Substituez cette fonction pour fournir un comportement personnalisé.

## <a name="colecontrolsiteenablewindow"></a><a name="enablewindow"></a> COleControlSite::EnableWindow

Active ou désactive l’entrée de la souris et du clavier sur le site de contrôle.

```
virtual BOOL EnableWindow(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
Spécifie s’il faut activer ou désactiver la fenêtre : TRUE si l’entrée de fenêtre doit être activée ; sinon, FALSe.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la fenêtre a été précédemment désactivée ; sinon, 0.

## <a name="colecontrolsitefreezeevents"></a><a name="freezeevents"></a> COleControlSite :: FreezeEvents

Spécifie si le site de contrôle gère ou ignore les événements déclenchés à partir d’un contrôle.

```cpp
void FreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Paramètres

*bFreeze*<br/>
Spécifie si le site de contrôle souhaite cesser d'accepter des événements. Différent de zéro si le contrôle n’accepte pas d’événements ; Sinon, zéro.

### <a name="remarks"></a>Notes

Si *bFreeze* a la valeur true, le site de contrôle demande au contrôle d’arrêter les événements de franges. Si *bFreeze* a la valeur false, le site de contrôle demande au contrôle de continuer à déclencher des événements.

> [!NOTE]
> Le contrôle n’est pas requis pour arrêter le déclenchement d’événements si le site de contrôle le demande. Il peut continuer à s’activer, mais tous les événements suivants seront ignorés par le site de contrôle.

## <a name="colecontrolsitegetcontrolinfo"></a><a name="getcontrolinfo"></a> COleControlSite::GetControlInfo

Récupère des informations sur les mnémoniques du clavier d’un contrôle et le comportement du clavier.

```cpp
void GetControlInfo();
```

### <a name="remarks"></a>Notes

Les informations sont stockées dans [COleControlSite :: m_ctlInfo](#m_ctlinfo).

## <a name="colecontrolsitegetdefbtncode"></a><a name="getdefbtncode"></a> COleControlSite::GetDefBtnCode

Détermine si le contrôle est un bouton de commande par défaut.

```
DWORD GetDefBtnCode();
```

### <a name="return-value"></a>Valeur renvoyée

Il peut s'agir de l'une des valeurs suivantes :

- DLGC_DEFPUSHBUTTON contrôle est le bouton par défaut dans la boîte de dialogue.

- DLGC_UNDEFPUSHBUTTON contrôle n’est pas le bouton par défaut dans la boîte de dialogue.

- le contrôle **0** n’est pas un bouton.

## <a name="colecontrolsitegetdlgctrlid"></a><a name="getdlgctrlid"></a> COleControlSite::GetDlgCtrlID

Récupère l’identificateur du contrôle.

```
virtual int GetDlgCtrlID() const;
```

### <a name="return-value"></a>Valeur renvoyée

Identificateur de l’élément de boîte de dialogue du contrôle.

## <a name="colecontrolsitegeteventiid"></a><a name="geteventiid"></a> COleControlSite::GetEventIID

Récupère un pointeur vers l’interface d’événement par défaut du contrôle.

```
BOOL GetEventIID(IID* piid);
```

### <a name="parameters"></a>Paramètres

*piid*<br/>
Pointeur vers un ID d’interface.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite, sinon 0. En cas de réussite, *piid* contient l’ID d’interface de l’interface d’événement par défaut du contrôle.

## <a name="colecontrolsitegetexstyle"></a><a name="getexstyle"></a> COleControlSite::GetExStyle

Récupère les styles étendus de la fenêtre.

```
virtual DWORD GetExStyle() const;
```

### <a name="return-value"></a>Valeur renvoyée

Styles étendus de la fenêtre de contrôle.

### <a name="remarks"></a>Notes

Pour récupérer les styles normaux, appelez [COleControlSite :: getStyle](#getstyle).

## <a name="colecontrolsitegetproperty"></a><a name="getproperty"></a> COleControlSite :: GetProperty

Obtient la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void GetProperty(
    DISPID dwDispID,
    VARTYPE vtProp,
    void* pvProp) const;
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété, trouvé sur l’interface par défaut du contrôle `IDispatch` , à récupérer.

*vtProp*<br/>
Spécifie le type de la propriété à récupérer. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvProp*<br/>
Adresse de la variable qui recevra la valeur de la propriété. Il doit correspondre au type spécifié par *vtProp*.

### <a name="remarks"></a>Notes

La valeur est retournée via *pvProp*.

## <a name="colecontrolsitegetstyle"></a><a name="getstyle"></a> COleControlSite::GetStyle

Récupère les styles du site de contrôle.

```
virtual DWORD GetStyle() const;
```

### <a name="return-value"></a>Valeur renvoyée

Styles de la fenêtre.

### <a name="remarks"></a>Notes

Pour obtenir la liste des valeurs possibles, consultez [styles Windows](../../mfc/reference/styles-used-by-mfc.md#window-styles). Pour récupérer les styles étendus du site de contrôle, appelez [COleControlSite :: GetExStyle](#getexstyle).

## <a name="colecontrolsitegetwindowtext"></a><a name="getwindowtext"></a> COleControlSite :: GetWindowText

Récupère le texte actuel du contrôle.

```
virtual void GetWindowText(CString& str) const;
```

### <a name="parameters"></a>Paramètres

*str*<br/>
Référence à un `CString` objet qui contient le texte actuel du contrôle.

### <a name="remarks"></a>Notes

Si le contrôle prend en charge la propriété stock de légende, cette valeur est retournée. Si la propriété stock de légende n’est pas prise en charge, la valeur de la propriété Text est retournée.

## <a name="colecontrolsiteinvokehelper"></a><a name="invokehelper"></a> COleControlSite :: InvokeHelper

Appelle la méthode ou la propriété spécifiée par *dwDispID*, dans le contexte spécifié par *wFlags*.

```
virtual void AFX_CDECL InvokeHelper(
    DISPID dwDispID,
    WORD wFlags,
    VARTYPE vtRet,
    void* pvRet,
    const BYTE* pbParamInfo, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété ou de la méthode, trouvée sur l’interface du contrôle `IDispatch` , à appeler.

*wFlags*<br/>
Indicateurs décrivant le contexte de l’appel à IDispatch::Invoke. Pour connaître les valeurs *wFlags* possibles, consultez `IDispatch::Invoke` dans la SDK Windows.

*vtRet*<br/>
Spécifie le type de la valeur de retour. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvRet*<br/>
Adresse de la variable qui recevra la valeur de propriété ou la valeur de retour. Il doit correspondre au type spécifié par *vtRet*.

*pbParamInfo*<br/>
Pointeur vers une chaîne d’octets se terminant par un caractère null qui spécifie les types des paramètres après *pbParamInfo*. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Liste variable de paramètres, des types spécifiés dans *pbParamInfo*.

### <a name="remarks"></a>Notes

Le paramètre *pbParamInfo* spécifie les types des paramètres passés à la méthode ou à la propriété. La liste variable d’arguments est représentée par ... dans la déclaration de syntaxe.

Cette fonction convertit les paramètres en valeurs VARIANTARG, puis appelle la `IDispatch::Invoke` méthode sur le contrôle. Si l’appel à `IDispatch::Invoke` échoue, cette fonction lève une exception. Si le code d’état retourné par `IDispatch::Invoke` est `DISP_E_EXCEPTION` , cette fonction lève un `COleDispatchException` objet ; sinon, elle lève une `COleException` .

## <a name="colecontrolsiteinvokehelperv"></a><a name="invokehelperv"></a> COleControlSite::InvokeHelperV

Appelle la méthode ou la propriété spécifiée par *dwDispID*, dans le contexte spécifié par *wFlags*.

```
virtual void InvokeHelperV(
    DISPID dwDispID,
    WORD wFlags,
    VARTYPE vtRet,
    void* pvRet,
    const BYTE* pbParamInfo,
    va_list argList);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété ou de la méthode, trouvée sur l’interface du contrôle `IDispatch` , à appeler.

*wFlags*<br/>
Indicateurs décrivant le contexte de l’appel à IDispatch::Invoke.

*vtRet*<br/>
Spécifie le type de la valeur de retour. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvRet*<br/>
Adresse de la variable qui recevra la valeur de propriété ou la valeur de retour. Il doit correspondre au type spécifié par *vtRet*.

*pbParamInfo*<br/>
Pointeur vers une chaîne d’octets se terminant par un caractère null qui spécifie les types des paramètres après *pbParamInfo*. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*argList*<br/>
Pointeur désignant une liste d’arguments de variables.

### <a name="remarks"></a>Notes

Le paramètre *pbParamInfo* spécifie les types des paramètres passés à la méthode ou à la propriété. Des paramètres supplémentaires pour la méthode ou la propriété appelée peuvent être passés à l’aide du paramètre *va_list* .

En règle générale, cette fonction est appelée par `COleControlSite::InvokeHelper` .

## <a name="colecontrolsiteisdefaultbutton"></a><a name="isdefaultbutton"></a> COleControlSite::IsDefaultButton

Détermine si le contrôle est le bouton par défaut.

```
BOOL IsDefaultButton();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est le bouton par défaut dans la fenêtre ; sinon, zéro.

## <a name="colecontrolsiteiswindowenabled"></a><a name="iswindowenabled"></a> COleControlSite::IsWindowEnabled

Détermine si le site de contrôle est activé.

```
virtual BOOL IsWindowEnabled() const;
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est activé ; sinon, zéro.

### <a name="remarks"></a>Notes

La valeur est récupérée à partir de la propriété stock activée du contrôle.

## <a name="colecontrolsitem_biswindowless"></a><a name="m_biswindowless"></a> COleControlSite :: m_bIsWindowless

Détermine si l’objet est un contrôle sans fenêtre.

```
BOOL m_bIsWindowless;
```

### <a name="remarks"></a>Notes

Différent de zéro si le contrôle n’a aucune fenêtre ; sinon, zéro.

## <a name="colecontrolsitem_ctlinfo"></a><a name="m_ctlinfo"></a> COleControlSite :: m_ctlInfo

Informations sur la façon dont l’entrée au clavier est gérée par le contrôle.

```
CONTROLINFO m_ctlInfo;
```

### <a name="remarks"></a>Notes

Ces informations sont stockées dans une structure [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) .

## <a name="colecontrolsitem_dweventsink"></a><a name="m_dweventsink"></a> COleControlSite :: m_dwEventSink

Contient le cookie du point de connexion à partir du récepteur d’événements du contrôle.

```
DWORD m_dwEventSink;
```

## <a name="colecontrolsitem_dwmiscstatus"></a><a name="m_dwmiscstatus"></a> COleControlSite :: m_dwMiscStatus

Contient diverses informations sur le contrôle.

```
DWORD m_dwMiscStatus;
```

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [OLEMISC](/windows/win32/api/oleidl/ne-oleidl-olemisc)dans le SDK Windows.

## <a name="colecontrolsitem_dwpropnotifysink"></a><a name="m_dwpropnotifysink"></a> COleControlSite :: m_dwPropNotifySink

Contient le cookie [IPropertyNotifySink](/windows/win32/api/ocidl/nn-ocidl-ipropertynotifysink) .

```
DWORD m_dwPropNotifySink;
```

## <a name="colecontrolsitem_dwstyle"></a><a name="m_dwstyle"></a> COleControlSite :: m_dwStyle

Contient les styles de fenêtre du contrôle.

```
DWORD m_dwStyle;
```

## <a name="colecontrolsitem_hwnd"></a><a name="m_hwnd"></a> COleControlSite :: m_hWnd

Contient le HWND du contrôle, ou NULL si le contrôle n’est pas sans fenêtre.

```
HWND m_hWnd;
```

## <a name="colecontrolsitem_iidevents"></a><a name="m_iidevents"></a> COleControlSite :: m_iidEvents

Contient l’ID d’interface de l’interface de récepteur d’événements par défaut du contrôle.

```
IID m_iidEvents;
```

## <a name="colecontrolsitem_nid"></a><a name="m_nid"></a> COleControlSite :: m_nID

Contient l’ID d’élément de boîte de dialogue du contrôle.

```
UINT m_nID;
```

## <a name="colecontrolsitem_pactiveobject"></a><a name="m_pactiveobject"></a> COleControlSite :: m_pActiveObject

Contient l’interface [IOleInPlaceActiveObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject) du contrôle.

```
LPOLEINPLACEACTIVEOBJECT m_pActiveObject;
```

## <a name="colecontrolsitem_pctrlcont"></a><a name="m_pctrlcont"></a> COleControlSite :: m_pCtrlCont

Contient le conteneur du contrôle (représentant le formulaire).

```
COleControlContainer* m_pCtrlCont;
```

## <a name="colecontrolsitem_pinplaceobject"></a><a name="m_pinplaceobject"></a> COleControlSite :: m_pInPlaceObject

Contient l' `IOleInPlaceObject` interface [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) du contrôle.

```
LPOLEINPLACEOBJECT m_pInPlaceObject;
```

## <a name="colecontrolsitem_pobject"></a><a name="m_pobject"></a> COleControlSite :: m_pObject

Contient l' `IOleObjectInterface` interface du contrôle.

```
LPOLEOBJECT m_pObject;
```

## <a name="colecontrolsitem_pwindowlessobject"></a><a name="m_pwindowlessobject"></a> COleControlSite :: m_pWindowlessObject

Contient l' `IOleInPlaceObjectWindowless` interface [IOleInPlaceObjectWindowless](/windows/win32/api/ocidl/nn-ocidl-ioleinplaceobjectwindowless) du contrôle.

```
IOleInPlaceObjectWindowless* m_pWindowlessObject;
```

## <a name="colecontrolsitem_pwndctrl"></a><a name="m_pwndctrl"></a> COleControlSite :: m_pWndCtrl

Contient un pointeur vers l' `CWnd` objet qui représente le contrôle lui-même.

```
CWnd* m_pWndCtrl;
```

## <a name="colecontrolsitem_rect"></a><a name="m_rect"></a> COleControlSite :: m_rect

Contient les limites du contrôle, par rapport à la fenêtre du conteneur.

```
CRect m_rect;
```

## <a name="colecontrolsitemodifystyle"></a><a name="modifystyle"></a> COleControlSite :: ModifyStyle

Modifie les styles du contrôle.

```
virtual BOOL ModifyStyle(
    DWORD dwRemove,
    DWORD dwAdd,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*dwRemove*<br/>
Styles à supprimer des styles de fenêtre actuels.

*dwAdd*<br/>
Styles à ajouter à partir des styles de fenêtre actuels.

*nFlags*<br/>
Indicateurs de positionnement de la fenêtre. Pour obtenir la liste des valeurs possibles, consultez la fonction [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans la SDK Windows.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si les styles sont modifiés ; sinon, zéro.

### <a name="remarks"></a>Notes

La propriété stock activée du contrôle sera modifiée pour correspondre au paramètre de WS_DISABLED. La propriété de style de bordure de stock du contrôle sera modifiée pour correspondre au paramètre demandé pour WS_BORDER. Tous les autres styles sont appliqués directement au handle de fenêtre du contrôle, s’il en existe un.

Modifie les styles de fenêtre du contrôle. Les styles à ajouter ou à supprimer peuvent être combinés à l’aide de l’opérateur de bits or (&#124;). Pour plus d’informations sur les styles de fenêtre disponibles, consultez la fonction [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le SDK Windows.

Si *nFlags* est différent de zéro, `ModifyStyle` appelle la fonction Win32 `SetWindowPos` et redessine la fenêtre en combinant *nFlags* avec les quatre indicateurs suivants :

- SWP_NOSIZE conserve la taille actuelle.

- SWP_NOMOVE conserve la position actuelle.

- SWP_NOZORDER conserve l’ordre de plan actuel.

- SWP_NOACTIVATE n’active pas la fenêtre.

Pour modifier les styles étendus d’une fenêtre, appelez [ModifyStyleEx](#modifystyleex).

## <a name="colecontrolsitemodifystyleex"></a><a name="modifystyleex"></a> COleControlSite::ModifyStyleEx

Modifie les styles étendus du contrôle.

```
virtual BOOL ModifyStyleEx(
    DWORD dwRemove,
    DWORD dwAdd,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*dwRemove*<br/>
Styles étendus à supprimer des styles de fenêtre actuels.

*dwAdd*<br/>
Styles étendus à ajouter à partir des styles de fenêtre actuels.

*nFlags*<br/>
Indicateurs de positionnement de la fenêtre. Pour obtenir la liste des valeurs possibles, consultez la fonction [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans la SDK Windows.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si les styles sont modifiés ; sinon, zéro.

### <a name="remarks"></a>Notes

La propriété d’apparence de stock du contrôle sera modifiée pour correspondre au paramètre de WS_EX_CLIENTEDGE. Tous les autres styles de fenêtre étendus sont appliqués directement au handle de fenêtre du contrôle, s’il en existe un.

Modifie les styles étendus de la fenêtre de l’objet de site de contrôle. Les styles à ajouter ou à supprimer peuvent être combinés à l’aide de l’opérateur de bits or (&#124;). Pour plus d’informations sur les styles de fenêtre disponibles, consultez la fonction [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le SDK Windows.

Si *nFlags* est différent de zéro, `ModifyStyleEx` appelle la fonction Win32 `SetWindowPos` et redessine la fenêtre en combinant *nFlags* avec les quatre indicateurs suivants :

- SWP_NOSIZE conserve la taille actuelle.

- SWP_NOMOVE conserve la position actuelle.

- SWP_NOZORDER conserve l’ordre de plan actuel.

- SWP_NOACTIVATE n’active pas la fenêtre.

Pour modifier les styles étendus d’une fenêtre, appelez [ModifyStyle](#modifystyle).

## <a name="colecontrolsitemovewindow"></a><a name="movewindow"></a> COleControlSite::MoveWindow

Modifie la position du contrôle.

```
virtual void MoveWindow(
    int x,
    int y,
    int nWidth,
    int nHeight);
```

### <a name="parameters"></a>Paramètres

*x*<br/>
Nouvelle position du côté gauche de la fenêtre.

*y*<br/>
Nouvelle position du haut de la fenêtre.

*nWidth*<br/>
Nouvelle largeur de la fenêtre

*nHeight*<br/>
Nouvelle hauteur de la fenêtre.

## <a name="colecontrolsitequickactivate"></a><a name="quickactivate"></a> COleControlSite::QuickActivate

Active rapidement le contrôle contenu.

```
virtual BOOL QuickActivate();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le site de contrôle a été activé ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction doit être appelée uniquement si l’utilisateur substitue le processus de création du contrôle.

Les `IPersist*::Load` `IPersist*::InitNew` méthodes et doivent être appelées après l’activation rapide. Le contrôle doit établir ses connexions aux récepteurs du conteneur au cours de l’activation rapide. Toutefois, ces connexions ne sont pas actives tant que `IPersist*::Load` ou `IPersist*::InitNew` n’a pas été appelé.

## <a name="colecontrolsitesafesetproperty"></a><a name="safesetproperty"></a> COleControlSite::SafeSetProperty

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual BOOL AFX_CDECL SafeSetProperty(
    DISPID dwDispID,
    VARTYPE vtProp, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété ou de la méthode, trouvée sur l’interface du contrôle `IDispatch` , à définir.

*vtProp*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Paramètre unique du type spécifié par *vtProp*.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

> [!NOTE]
> Contrairement `SetProperty` `SetPropertyV` à et, si une erreur est rencontrée (telle que la tentative de définition d’une propriété inexistante), aucune exception n’est levée.

## <a name="colecontrolsitesetdefaultbutton"></a><a name="setdefaultbutton"></a> COleControlSite::SetDefaultButton

Définit le contrôle comme bouton par défaut.

```cpp
void SetDefaultButton(BOOL bDefault);
```

### <a name="parameters"></a>Paramètres

*bDefault*<br/>
Différent de zéro si le contrôle doit devenir le bouton par défaut ; Sinon, zéro.

### <a name="remarks"></a>Notes

> [!NOTE]
> Le bit d’état de OLEMISC_ACTSLIKEBUTTON doit être défini pour le contrôle.

## <a name="colecontrolsitesetdlgctrlid"></a><a name="setdlgctrlid"></a> COleControlSite::SetDlgCtrlID

Modifie la valeur de l’identificateur d’élément de boîte de dialogue du contrôle.

```
virtual int SetDlgCtrlID(int nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Nouvelle valeur de l’identificateur.

### <a name="return-value"></a>Valeur renvoyée

En cas de réussite, l’identificateur d’élément de boîte de dialogue précédent de la fenêtre ; Sinon, 0.

### <a name="remarks"></a>Notes

## <a name="colecontrolsitesetfocus"></a><a name="setfocus"></a> COleControlSite :: SetFocus

Définit le focus sur le contrôle.

```
virtual CWnd* SetFocus();
virtual CWnd* SetFocus(LPMSG lpmsg);
```

### <a name="parameters"></a>Paramètres

*lpmsg*<br/>
Pointeur vers une [structure MSG](/windows/win32/api/winuser/ns-winuser-msg). Cette structure contient le message Windows déclenchant la `SetFocus` demande pour le contrôle contenu dans le site de contrôle actuel.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la fenêtre qui avait précédemment le focus.

## <a name="colecontrolsitesetproperty"></a><a name="setproperty"></a> COleControlSite :: SetProperty

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void AFX_CDECL SetProperty(
    DISPID dwDispID,
    VARTYPE vtProp, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété ou de la méthode, trouvée sur l’interface du contrôle `IDispatch` , à définir.

*vtProp*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Paramètre unique du type spécifié par *vtProp*.

### <a name="remarks"></a>Notes

Si `SetProperty` rencontre une erreur, une exception est levée.

Le type d’exception est déterminé par la valeur de retour de la tentative de définition de la propriété ou de la méthode. Si la valeur de retour est `DISP_E_EXCEPTION` , une `COleDispatchExcpetion` est levée ; sinon, `COleException` .

## <a name="colecontrolsitesetpropertyv"></a><a name="setpropertyv"></a> COleControlSite::SetPropertyV

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void SetPropertyV(
    DISPID dwDispID,
    VARTYPE vtProp,
    va_list argList);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de dispatch de la propriété ou de la méthode, trouvée sur l’interface du contrôle `IDispatch` , à définir.

*vtProp*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*argList*<br/>
Pointeur désignant la liste d’arguments.

### <a name="remarks"></a>Notes

Les paramètres supplémentaires de la méthode ou de la propriété appelée peuvent être passeed à l’aide du paramètre *arg_list* . Si `SetProperty` rencontre une erreur, une exception est levée.

Le type d’exception est déterminé par la valeur de retour de la tentative de définition de la propriété ou de la méthode. Si la valeur de retour est `DISP_E_EXCEPTION` , une `COleDispatchExcpetion` est levée ; sinon, `COleException` .

## <a name="colecontrolsitesetwindowpos"></a><a name="setwindowpos"></a> COleControlSite :: SetWindowPos

Définit la taille, la position et l’ordre de plan du site de contrôle.

```
virtual BOOL SetWindowPos(
    const CWnd* pWndInsertAfter,
    int x,
    int y,
    int cx,
    int cy,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*pWndInsertAfter*<br/>
Pointeur vers la fenêtre.

*x*<br/>
Nouvelle position du côté gauche de la fenêtre.

*y*<br/>
Nouvelle position du haut de la fenêtre.

*adéquat*<br/>
Nouvelle largeur de la fenêtre

*CY*<br/>
Nouvelle hauteur de la fenêtre.

*nFlags*<br/>
Spécifie les indicateurs de dimensionnement et de positionnement de la fenêtre. Pour connaître les valeurs possibles, consultez la section Notes pour [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans le SDK Windows.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite, sinon zéro.

## <a name="colecontrolsitesetwindowtext"></a><a name="setwindowtext"></a> COleControlSite :: SetWindowText

Définit le texte du site de contrôle.

```
virtual void SetWindowText(LPCTSTR lpszString);
```

### <a name="parameters"></a>Paramètres

*lpszString*<br/>
Pointeur vers une chaîne se terminant par un caractère null à utiliser comme nouveau titre ou texte de contrôle.

### <a name="remarks"></a>Notes

Cette fonction tente d’abord de définir la propriété stock de légende. Si la propriété stock de légende n’est pas prise en charge, la propriété Text est définie à la place.

## <a name="colecontrolsiteshowwindow"></a><a name="showwindow"></a> COleControlSite :: ShowWindow

Définit l’état d’affichage de la fenêtre.

```
virtual BOOL ShowWindow(int nCmdShow);
```

### <a name="parameters"></a>Paramètres

*nCmdShow*<br/>
Spécifie le mode d’affichage du site de contrôle. Il doit s’agir de l’une des valeurs suivantes :

- SW_HIDE masque cette fenêtre et passe l’activation à une autre fenêtre.

- SW_MINIMIZE réduit la fenêtre et active la fenêtre de niveau supérieur dans la liste du système.

- SW_RESTORE s’active et affiche la fenêtre. Si la fenêtre est réduite ou agrandie, Windows la restaure à sa taille et à sa position d’origine.

- SW_SHOW active la fenêtre et l’affiche à sa taille et à sa position actuelles.

- SW_SHOWMAXIMIZED active la fenêtre et l’affiche sous la forme d’une fenêtre agrandie.

- SW_SHOWMINIMIZED active la fenêtre et l’affiche sous forme d’icône.

- SW_SHOWMINNOACTIVE affiche la fenêtre sous forme d’icône. La fenêtre actuellement active reste active.

- SW_SHOWNA affiche la fenêtre dans son état actuel. La fenêtre actuellement active reste active.

- SW_SHOWNOACTIVATE affiche la fenêtre à sa taille et à sa position les plus récentes. La fenêtre actuellement active reste active.

- SW_SHOWNORMAL s’active et affiche la fenêtre. Si la fenêtre est réduite ou agrandie, Windows la restaure à sa taille et à sa position d’origine.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la fenêtre était visible auparavant ; 0 si la fenêtre a été précédemment masquée.

## <a name="see-also"></a>Voir aussi

[CCmdTarget, classe](../../mfc/reference/ccmdtarget-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[COleControlContainer, classe](../../mfc/reference/colecontrolcontainer-class.md)
