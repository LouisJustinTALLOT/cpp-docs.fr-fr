---
title: Classe COleControlSite
ms.date: 11/04/2016
f1_keywords:
- COleControlSite
- AFXOCC/COleControlSite
- AFXOCC/COleControlSite::COleControlSite
- AFXOCC/COleControlSite::BindDefaultProperty
- AFXOCC/COleControlSite::BindProperty
- AFXOCC/COleControlSite::CreateControl
- AFXOCC/COleControlSite::DestroyControl
- AFXOCC/COleControlSite::DoVerb
- AFXOCC/COleControlSite::EnableDSC
- AFXOCC/COleControlSite::EnableWindow
- AFXOCC/COleControlSite::FreezeEvents
- AFXOCC/COleControlSite::GetDefBtnCode
- AFXOCC/COleControlSite::GetDlgCtrlID
- AFXOCC/COleControlSite::GetEventIID
- AFXOCC/COleControlSite::GetExStyle
- AFXOCC/COleControlSite::GetProperty
- AFXOCC/COleControlSite::GetStyle
- AFXOCC/COleControlSite::GetWindowText
- AFXOCC/COleControlSite::InvokeHelper
- AFXOCC/COleControlSite::InvokeHelperV
- AFXOCC/COleControlSite::IsDefaultButton
- AFXOCC/COleControlSite::IsWindowEnabled
- AFXOCC/COleControlSite::ModifyStyle
- AFXOCC/COleControlSite::ModifyStyleEx
- AFXOCC/COleControlSite::MoveWindow
- AFXOCC/COleControlSite::QuickActivate
- AFXOCC/COleControlSite::SafeSetProperty
- AFXOCC/COleControlSite::SetDefaultButton
- AFXOCC/COleControlSite::SetDlgCtrlID
- AFXOCC/COleControlSite::SetFocus
- AFXOCC/COleControlSite::SetProperty
- AFXOCC/COleControlSite::SetPropertyV
- AFXOCC/COleControlSite::SetWindowPos
- AFXOCC/COleControlSite::SetWindowText
- AFXOCC/COleControlSite::ShowWindow
- AFXOCC/COleControlSite::GetControlInfo
- AFXOCC/COleControlSite::m_bIsWindowless
- AFXOCC/COleControlSite::m_ctlInfo
- AFXOCC/COleControlSite::m_dwEventSink
- AFXOCC/COleControlSite::m_dwMiscStatus
- AFXOCC/COleControlSite::m_dwPropNotifySink
- AFXOCC/COleControlSite::m_dwStyle
- AFXOCC/COleControlSite::m_hWnd
- AFXOCC/COleControlSite::m_iidEvents
- AFXOCC/COleControlSite::m_nID
- AFXOCC/COleControlSite::m_pActiveObject
- AFXOCC/COleControlSite::m_pCtrlCont
- AFXOCC/COleControlSite::m_pInPlaceObject
- AFXOCC/COleControlSite::m_pObject
- AFXOCC/COleControlSite::m_pWindowlessObject
- AFXOCC/COleControlSite::m_pWndCtrl
- AFXOCC/COleControlSite::m_rect
helpviewer_keywords:
- COleControlSite [MFC], COleControlSite
- COleControlSite [MFC], BindDefaultProperty
- COleControlSite [MFC], BindProperty
- COleControlSite [MFC], CreateControl
- COleControlSite [MFC], DestroyControl
- COleControlSite [MFC], DoVerb
- COleControlSite [MFC], EnableDSC
- COleControlSite [MFC], EnableWindow
- COleControlSite [MFC], FreezeEvents
- COleControlSite [MFC], GetDefBtnCode
- COleControlSite [MFC], GetDlgCtrlID
- COleControlSite [MFC], GetEventIID
- COleControlSite [MFC], GetExStyle
- COleControlSite [MFC], GetProperty
- COleControlSite [MFC], GetStyle
- COleControlSite [MFC], GetWindowText
- COleControlSite [MFC], InvokeHelper
- COleControlSite [MFC], InvokeHelperV
- COleControlSite [MFC], IsDefaultButton
- COleControlSite [MFC], IsWindowEnabled
- COleControlSite [MFC], ModifyStyle
- COleControlSite [MFC], ModifyStyleEx
- COleControlSite [MFC], MoveWindow
- COleControlSite [MFC], QuickActivate
- COleControlSite [MFC], SafeSetProperty
- COleControlSite [MFC], SetDefaultButton
- COleControlSite [MFC], SetDlgCtrlID
- COleControlSite [MFC], SetFocus
- COleControlSite [MFC], SetProperty
- COleControlSite [MFC], SetPropertyV
- COleControlSite [MFC], SetWindowPos
- COleControlSite [MFC], SetWindowText
- COleControlSite [MFC], ShowWindow
- COleControlSite [MFC], GetControlInfo
- COleControlSite [MFC], m_bIsWindowless
- COleControlSite [MFC], m_ctlInfo
- COleControlSite [MFC], m_dwEventSink
- COleControlSite [MFC], m_dwMiscStatus
- COleControlSite [MFC], m_dwPropNotifySink
- COleControlSite [MFC], m_dwStyle
- COleControlSite [MFC], m_hWnd
- COleControlSite [MFC], m_iidEvents
- COleControlSite [MFC], m_nID
- COleControlSite [MFC], m_pActiveObject
- COleControlSite [MFC], m_pCtrlCont
- COleControlSite [MFC], m_pInPlaceObject
- COleControlSite [MFC], m_pObject
- COleControlSite [MFC], m_pWindowlessObject
- COleControlSite [MFC], m_pWndCtrl
- COleControlSite [MFC], m_rect
ms.assetid: 43970644-5eab-434a-8ba6-56d144ff1e3f
ms.openlocfilehash: 90c41a1be1a66cdceebb3f045a98167e56b7cf4c
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753948"
---
# <a name="colecontrolsite-class"></a>Classe COleControlSite

Prend en charge les interfaces de contrôle côté client personnalisées.

## <a name="syntax"></a>Syntaxe

```
class COleControlSite : public CCmdTarget
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleControlSite::COleControlSite](#colecontrolsite)|Construit un objet `COleControlSite`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleControlSite::BindDefaultProperty](#binddefaultproperty)|Lie la propriété par défaut du contrôle hébergé à une source de données.|
|[COleControlSite::BindProperty](#bindproperty)|Lie une propriété du contrôle hébergé à une source de données.|
|[COleControlSite::CreateControl](#createcontrol)|Crée un contrôle ActiveX hébergé.|
|[COleControlSite::DestroyControl](#destroycontrol)|Détruit le contrôle hébergé.|
|[COleControlSite::DoVerb](#doverb)|Exécute un verbe spécifique du contrôle hébergé.|
|[COleControlSite::EnableDSC](#enabledsc)|Permet l’approvisionnement en données pour un site de contrôle.|
|[COleControlSite::EnableWindow](#enablewindow)|Permet le site de contrôle.|
|[COleControlSite::FreezeEvents](#freezeevents)|Précise si le site de contrôle accepte les événements.|
|[COleControlSite::GetDefBtnCode](#getdefbtncode)|Récupère le code bouton par défaut pour le contrôle hébergé.|
|[COleControlSite::GetDlgCtrlID](#getdlgctrlid)|Récupère l’identifiant du contrôle.|
|[COleControlSite::GetEventIID](#geteventiid)|Récupère l’ID d’une interface d’événement pour un contrôle hébergé.|
|[COleControlSite::GetExStyle](#getexstyle)|Récupère les styles étendus du site de contrôle.|
|[COleControlSite::GetProperty](#getproperty)|Récupère une propriété spécifique du contrôle hébergé.|
|[COleControlSite::GetStyle](#getstyle)|Récupère les styles du site de contrôle.|
|[COleControlSite::GetWindowText](#getwindowtext)|Récupère le texte du contrôle hébergé.|
|[COleControlSite::InvokeHelper](#invokehelper)|Invoquez une méthode spécifique du contrôle hébergé.|
|[COleControlSite::InvokeHelperV](#invokehelperv)|Invoquez une méthode spécifique du contrôle hébergé avec une liste variable d’arguments.|
|[COleControlSite::IsDefaultButton](#isdefaultbutton)|Détermine si le contrôle est le bouton par défaut dans la fenêtre.|
|[COleControlSite::IsWindowEnabled](#iswindowenabled)|Vérifie l’état visible du site de contrôle.|
|[COleControlSite::ModifyStyle](#modifystyle)|Modifie les styles étendus actuels du site de contrôle.|
|[COleControlSite::ModifyStyleEx](#modifystyleex)|Modifie les styles actuels du site de contrôle.|
|[COleControlSite::MoveWindow](#movewindow)|Modifications de la position du site de contrôle.|
|[COleControlSite::QuickActivate](#quickactivate)|Active rapidement le contrôle hébergé.|
|[COleControlSite::SafeSetProperty](#safesetproperty)|Définit une propriété ou une méthode de contrôle sans possibilité de jeter une exception.|
|[COleControlSite::SetDefaultButton](#setdefaultbutton)|Définit le bouton par défaut dans la fenêtre.|
|[COleControlSite::SetDlgCtrlID](#setdlgctrlid)|Récupère l’identifiant du contrôle.|
|[COleControlSite::SetFocus](#setfocus)|Met l’accent sur le site de contrôle.|
|[COleControlSite::SetProperty](#setproperty)|Définit une propriété spécifique du contrôle hébergé.|
|[COleControlSite::SetPropertyV](#setpropertyv)|Définit une propriété spécifique du contrôle hébergé avec une liste variable d’arguments.|
|[COleControlSite::SetWindowPos](#setwindowpos)|Définit la position du site de contrôle.|
|[COleControlSite::SetWindowText](#setwindowtext)|Définit le texte du contrôle hébergé.|
|[COleControlSite::ShowWindow](#showwindow)|Affiche ou cache le site de contrôle.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleControlSite::GetControlInfo](#getcontrolinfo)|Récupère les informations du clavier et les mnémoniques pour le contrôle hébergé.|

### <a name="public-data-members"></a>Membres de données publics

|Nom|Description|
|----------|-----------------|
|[COleControlSite::m_bIsWindowless](#m_biswindowless)|Détermine si le contrôle hébergé est un contrôle sans fenêtre.|
|[COleControlSite::m_ctlInfo](#m_ctlinfo)|Contient des informations sur la manipulation du clavier pour le contrôle.|
|[COleControlSite::m_dwEventSink](#m_dweventsink)|Le cookie du point de connexion du contrôle.|
|[COleControlSite::m_dwMiscStatus](#m_dwmiscstatus)|Les états divers pour le contrôle hébergé.|
|[COleControlSite::m_dwPropNotifySink](#m_dwpropnotifysink)|Le `IPropertyNotifySink` cookie du contrôle.|
|[COleControlSite::m_dwStyle](#m_dwstyle)|Les styles du contrôle hébergé.|
|[COleControlSite::m_hWnd](#m_hwnd)|La poignée du site de contrôle.|
|[COleControlSite::m_iidEvents](#m_iidevents)|L’ID de l’interface de l’événement pour le contrôle hébergé.|
|[COleControlSite::m_nID](#m_nid)|L’id du contrôle hébergé.|
|[COleControlSite::m_pActiveObject](#m_pactiveobject)|Un pointeur `IOleInPlaceActiveObject` à l’objet du contrôle hébergé.|
|[COleControlSite::m_pCtrlCont](#m_pctrlcont)|Le conteneur du contrôle hébergé.|
|[COleControlSite::m_pInPlaceObject](#m_pinplaceobject)|Un pointeur `IOleInPlaceObject` à l’objet du contrôle hébergé.|
|[COleControlSite::m_pObject](#m_pobject)|Un pointeur `IOleObjectInterface` à l’interface du contrôle.|
|[COleControlSite::m_pWindowlessObject](#m_pwindowlessobject)|Un pointeur `IOleInPlaceObjectWindowless` à l’interface du contrôle.|
|[COleControlSite::m_pWndCtrl](#m_pwndctrl)|Un pointeur à l’objet de fenêtre pour le contrôle hébergé.|
|[COleControlSite::m_rect](#m_rect)|Les dimensions du site de contrôle.|

## <a name="remarks"></a>Notes

Ce support est le principal moyen par lequel un contrôle ActiveX intégré obtient des informations sur l’emplacement et l’étendue de son site d’affichage, son surnom, son interface utilisateur, ses propriétés ambiantes, et d’autres ressources fournies par son conteneur. `COleControlSite`implémente pleinement [l’IOleControlSite](/windows/win32/api/ocidl/nn-ocidl-iolecontrolsite), [IOleInPlaceSite](/windows/win32/api/oleidl/nn-oleidl-ioleinplacesite), [IOleClientSite](/windows/win32/api/oleidl/nn-oleidl-ioleclientsite) `IBoundObjectSite`, `INotifyDBEvents` [IPropertyNotifySink](/windows/win32/api/ocidl/nn-ocidl-ipropertynotifysink), , [IRowSetNotify](../../data/oledb/irowsetnotifyimpl-class.md) interfaces. En outre, l’interface IDispatch (fournir un soutien pour les propriétés ambiantes et les éviers d’événements) est également implémentée.

Pour créer un site `COleControlSite`de contrôle ActiveX à l’aide , tirer une classe de `COleControlSite`. Dans `CWnd`votre classe dérivée pour le conteneur (par exemple, `CWnd::CreateControlSite` votre boîte de dialogue) remplace la fonction.

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

`COleControlSite`

## <a name="requirements"></a>Spécifications

**En-tête:** afxocc.h

## <a name="colecontrolsitebinddefaultproperty"></a><a name="binddefaultproperty"></a>COleControlSite::BindDefaultProperty

Lie la propriété simple liée par défaut de l’objet d’appel, telle qu’indiquée dans la bibliothèque de type, au curseur sous-jacent qui est défini par les propriétés DataSource, UserName, Password et SQL du contrôle de source de données.

```
virtual void BindDefaultProperty(
    DISPID dwDispID,
    VARTYPE vtProp,
    LPCTSTR szFieldName,
    CWnd* pDSCWnd);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Spécifie le DISPID d’une propriété sur un contrôle lié aux données qui doit être lié à un contrôle de source de données.

*vtProp (en)*<br/>
Spécifie le type de propriété à lier — par exemple, VT_BSTR, VT_VARIANT, et ainsi de suite.

*szFieldName (en)*<br/>
Précise le nom de la colonne, dans le curseur fourni par le contrôle de source de données, auquel la propriété sera liée.

*pDSCWnd (en)*<br/>
Un pointeur `CWnd`vers l’objet dérivé qui héberge le contrôle de source de données auquel la propriété sera liée.

### <a name="remarks"></a>Notes

L’objet `CWnd` sur lequel vous appelez cette fonction doit être un contrôle lié aux données.

## <a name="colecontrolsitebindproperty"></a><a name="bindproperty"></a>COleControlSite::BindProperty

Lie la propriété simple liée de l’objet d’appel, telle qu’elle est indiquée dans la bibliothèque de type, au curseur sous-jacent défini par les propriétés DataSource, UserName, Password et SQL du contrôle de la source de données.

```
virtual void BindProperty(
    DISPID dwDispId,
    CWnd* pWndDSC);
```

### <a name="parameters"></a>Paramètres

*dwDispId*<br/>
Spécifie le DISPID d’une propriété sur un contrôle lié aux données qui doit être lié à un contrôle de source de données.

*pWndDSC (en)*<br/>
Un pointeur `CWnd`vers l’objet dérivé qui héberge le contrôle de source de données auquel la propriété sera liée.

### <a name="remarks"></a>Notes

L’objet `CWnd` sur lequel vous appelez cette fonction doit être un contrôle lié aux données.

## <a name="colecontrolsitecolecontrolsite"></a><a name="colecontrolsite"></a>COleControlSite::COleControlSite

Construit un nouvel objet `COleControlSite`.

```
explicit COleControlSite(COleControlContainer* pCtrlCont);
```

### <a name="parameters"></a>Paramètres

*pCtrlCont*<br/>
Un pointeur sur le conteneur du contrôle (qui représente la fenêtre qui héberge le contrôle AtiveX).

### <a name="remarks"></a>Notes

Cette fonction est appelée par le [COccManager::CreateContainer](../../mfc/reference/coccmanager-class.md#createcontainer) fonction. Pour plus d’informations sur la personnalisation de la création de conteneurs, voir [COccManager::CreateSite](../../mfc/reference/coccmanager-class.md#createsite).

## <a name="colecontrolsitecreatecontrol"></a><a name="createcontrol"></a>COleControlSite::CreateControl

Crée un contrôle ActiveX, `COleControlSite` hébergé par l’objet.

```
virtual HRESULT CreateControl(
    CWnd* pWndCtrl,
    REFCLSID clsid,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    UINT nID,
    CFile* pPersist = NULL,
    BOOL bStorage = FALSE,
    BSTR bstrLicKey = NULL);

virtual HRESULT CreateControl(
    CWnd* pWndCtrl,
    REFCLSID clsid,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const POINT* ppt,
    const SIZE* psize,
    UINT nID,
    CFile* pPersist = NULL,
    BOOL bStorage = FALSE,
    BSTR bstrLicKey = NULL);
```

### <a name="parameters"></a>Paramètres

*pWndCtrl*<br/>
Un pointeur à l’objet de fenêtre représentant le contrôle.

*clsid*<br/>
L’ID de classe unique du contrôle.

*lpszWindowName (en)*<br/>
Un pointeur sur le texte à afficher dans le contrôle. Définit la valeur de la propriété caption ou texte du winodw (le cas échéant).

*dwStyle (en)*<br/>
Styles Windows. Les styles disponibles sont répertoriés dans la section **Remarques.**

*Rect*<br/>
Spécifie la taille et la position du contrôle. Il peut s’agir `CRect` `RECT` d’un objet ou d’une structure.

*nID*<br/>
Spécifie l’id de fenêtre pour enfant du contrôle.

*pPersist pPersist*<br/>
Un pointeur `CFile` à un contenant de l’état persistant pour le contrôle. La valeur par défaut est NULL, ce qui indique que le contrôle se parasité sans restaurer son état à partir d’un stockage persistant. Si ce n’est pas NULL, il devrait être un pointeur à un `CFile`objet dérivé qui contient les données persistantes du contrôle, sous la forme d’un flux ou d’un stockage. Ces données auraient pu être enregistrées lors d’une activation précédente du client. Le `CFile` peut contenir d’autres données, mais doit avoir son pointeur de lecture-écriture `CreateControl`réglé à la première mise en place de données persistantes au moment de l’appel à .

*bStorage*<br/>
Indique si les données dans *pPersist* doivent être interprétées comme `IStorage` ou `IStream` des données. Si les données dans *pPersist* est un stockage, *bStorage* devrait être VRAI. Si les données dans *pPersist* est un flux, *bStorage* devrait être FALSE. La valeur par défaut est FALSE.

*bstrLicKey (en)*<br/>
Données clés de licence facultatives. Ces données sont nécessaires uniquement pour créer des contrôles qui nécessitent une clé de licence en temps de course. Si le contrôle prend en charge l’octroi de licences, vous devez fournir une clé de licence pour la création du contrôle pour réussir. La valeur par défaut est NULL.

*Ppt*<br/>
Pointeur d’une `POINT` structure qui contient le coin supérieur gauche du contrôle. La taille du contrôle est déterminée par la valeur de *psize*. Les valeurs *de ppt* et *de psize* sont une méthode facultative pour spécifier la taille et la position opf le contrôle.

*Psize*<br/>
Un pointeur `SIZE` vers une structure qui contient la taille du contrôle. Le coin supérieur gauche est déterminé par la valeur du *ppt*. Les valeurs *de ppt* et *de psize* sont une méthode facultative pour spécifier la taille et la position opf le contrôle.

### <a name="return-value"></a>Valeur de retour

Une valeur HRESULT standard.

### <a name="remarks"></a>Notes

Seul un sous-ensemble des drapeaux Windows `CreateControl` *dwStyle* sont pris en charge par :

- WS_VISIBLE crée une fenêtre qui est initialement visible. Nécessaire si vous voulez que le contrôle soit visible immédiatement, comme les fenêtres ordinaires.

- WS_DISABLED crée une fenêtre qui est initialement désactivée. Une fenêtre désactivée ne peut pas recevoir l’entrée de l’utilisateur. Peut être défini si le contrôle a une propriété activée.

- WS_BORDER crée une fenêtre avec une bordure à ligne mince. Peut être défini si le contrôle a une propriété BorderStyle.

- WS_GROUP précise le premier contrôle d’un groupe de contrôles. L’utilisateur peut modifier la mise au point du clavier d’un contrôle dans le groupe à l’autre en utilisant les touches de direction. Tous les contrôles définis avec le style WS_GROUP après le premier contrôle appartiennent au même groupe. Le prochain contrôle avec le style WS_GROUP termine le groupe et commence le groupe suivant.

- WS_TABSTOP specifie un contrôle qui peut recevoir la mise au point du clavier lorsque l’utilisateur appuie sur la touche TAB. Appuyer sur la clé TAB change la mise au point du clavier pour le prochain contrôle du style WS_TABSTOP.

Utilisez la deuxième surcharge pour créer des commandes par défaut.

## <a name="colecontrolsitedestroycontrol"></a><a name="destroycontrol"></a>COleControlSite::DestroyControl

Détruit l’objet. `COleControlSite`

```
virtual BOOL DestroyControl();
```

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès, sinon 0.

### <a name="remarks"></a>Notes

Une fois terminé, l’objet est libéré de la mémoire et les indications de l’objet ne sont plus valides.

## <a name="colecontrolsitedoverb"></a><a name="doverb"></a>COleControlSite::DoVerb

Exécute le verbe spécifié.

```
virtual HRESULT DoVerb(
    LONG nVerb,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb (en)*<br/>
Spécifie le verbe à exécuter. Il peut inclure l’un des éléments suivants :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|0|Primary (verbe)|OLEIVERB_PRIMARY|
|-1|Verbe secondaire|(aucune)|
|1|Affiche l’objet pour l’édition.|OLEIVERB_SHOW|
|-2|Modifie l’élément dans une fenêtre séparée.|OLEIVERB_OPEN|
|-3|Cache l’objet.|OLEIVERB_HIDE|
|-4|Active un contrôle sur place.|OLEIVERB_UIACTIVATE|
|-5|Active un contrôle sur place, sans éléments d’interface utilisateur supplémentaires.|OLEIVERB_INPLACEACTIVATE|
|-7|Afficher les propriétés du contrôle.|OLEIVERB_PROPERTIES|

*lpMsg*<br/>
Pointeur vers le message qui a causé l’activation de l’élément.

### <a name="return-value"></a>Valeur de retour

Une valeur HRESULT standard.

### <a name="remarks"></a>Notes

Cette fonction passe directement par `IOleObject` l’interface du contrôle pour exécuter le verbe spécifié. Si une exception est lancée à la suite de cet appel de fonction, un code d’erreur HRESULT est retourné.

Pour plus d’informations, voir [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

## <a name="colecontrolsiteenabledsc"></a><a name="enabledsc"></a>COleControlSite::EnableDSC

Permet l’approvisionnement en données pour le site de contrôle.

```
virtual void EnableDSC();
```

### <a name="remarks"></a>Notes

Appelé par le cadre pour activer et initialiser l’approvisionnement en données pour le site de contrôle. Remplacer cette fonction pour fournir un comportement personnalisé.

## <a name="colecontrolsiteenablewindow"></a><a name="enablewindow"></a>COleControlSite::EnableWindow

Permet ou désactive l’entrée de la souris et du clavier sur le site de contrôle.

```
virtual BOOL EnableWindow(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
Précise s’il faut activer ou désactiver la fenêtre : VRAI si l’entrée de fenêtre doit être activée, sinon FALSE.

### <a name="return-value"></a>Valeur de retour

Nonzero si la fenêtre était auparavant désactivée, sinon 0.

## <a name="colecontrolsitefreezeevents"></a><a name="freezeevents"></a>COleControlSite::FreezeEvents

Précise si le site de contrôle gérera ou ignorera les événements déclenchés par un contrôle.

```cpp
void FreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Paramètres

*bFreeze (en)*<br/>
Spécifie si le site de contrôle souhaite cesser d'accepter des événements. Nonzero si le contrôle n’accepte pas les événements; autrement zéro.

### <a name="remarks"></a>Notes

Si *bFreeze* est VRAI, le site de contrôle demande au contrôle d’arrêter les événements fring. Si *bFreeze* est FALSE, le site de contrôle demande au contrôle de continuer à tirer des événements.

> [!NOTE]
> Le contrôle n’est pas nécessaire pour arrêter les événements de tir si demandé par le site de contrôle. Il peut continuer à tirer, mais tous les événements ultérieurs seront ignorés par le site de contrôle.

## <a name="colecontrolsitegetcontrolinfo"></a><a name="getcontrolinfo"></a>COleControlSite::GetControlInfo

Récupère des informations sur les mnémoniques du clavier et le comportement du clavier.

```cpp
void GetControlInfo();
```

### <a name="remarks"></a>Notes

L’information est stockée dans [COleControlSite:m_ctlInfo](#m_ctlinfo).

## <a name="colecontrolsitegetdefbtncode"></a><a name="getdefbtncode"></a>COleControlSite::GetDefBtnCode

Détermine si le contrôle est un bouton push par défaut.

```
DWORD GetDefBtnCode();
```

### <a name="return-value"></a>Valeur de retour

Il peut s'agir de l'une des valeurs suivantes :

- DLGC_DEFPUSHBUTTON Control est le bouton par défaut dans le dialogue.

- DLGC_UNDEFPUSHBUTTON Control n’est pas le bouton par défaut dans le dialogue.

- **0** Le contrôle n’est pas un bouton.

## <a name="colecontrolsitegetdlgctrlid"></a><a name="getdlgctrlid"></a>COleControlSite::GetDlgCtrlID

Récupère l’identifiant du contrôle.

```
virtual int GetDlgCtrlID() const;
```

### <a name="return-value"></a>Valeur de retour

L’identifiant d’élément de dialogue du contrôle.

## <a name="colecontrolsitegeteventiid"></a><a name="geteventiid"></a>COleControlSite::GetEventIID

Récupère un pointeur sur l’interface d’événement par défaut du contrôle.

```
BOOL GetEventIID(IID* piid);
```

### <a name="parameters"></a>Paramètres

*piid*<br/>
Un pointeur à une interface ID.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès, sinon 0. En cas de succès, *piid* contient l’interface ID pour l’interface d’événement par défaut du contrôle.

## <a name="colecontrolsitegetexstyle"></a><a name="getexstyle"></a>COleControlSite::GetExStyle

Récupère les styles étendus de la fenêtre.

```
virtual DWORD GetExStyle() const;
```

### <a name="return-value"></a>Valeur de retour

Les styles étendus de la fenêtre de contrôle.

### <a name="remarks"></a>Notes

Pour récupérer les styles réguliers, appelez [COleControlSite:GetStyle](#getstyle).

## <a name="colecontrolsitegetproperty"></a><a name="getproperty"></a>COleControlSite::GetProperty

Obtient la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void GetProperty(
    DISPID dwDispID,
    VARTYPE vtProp,
    void* pvProp) const;
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’id de répartition de la propriété, `IDispatch` trouvé sur l’interface par défaut du contrôle, à récupérer.

*vtProp (en)*<br/>
Spécifie le type de propriété à récupérer. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvProp (en)*<br/>
Adresse de la variable qui recevra la valeur de la propriété. Il doit correspondre au type spécifié par *vtProp*.

### <a name="remarks"></a>Notes

La valeur est retournée par *pvProp*.

## <a name="colecontrolsitegetstyle"></a><a name="getstyle"></a>COleControlSite::GetStyle

Récupère les styles du site de contrôle.

```
virtual DWORD GetStyle() const;
```

### <a name="return-value"></a>Valeur de retour

Les styles de la fenêtre.

### <a name="remarks"></a>Notes

Pour une liste de valeurs possibles, voir [Windows Styles](../../mfc/reference/styles-used-by-mfc.md#window-styles). Pour récupérer les styles étendus du site de contrôle, appelez [COleControlSite::GetExStyle](#getexstyle).

## <a name="colecontrolsitegetwindowtext"></a><a name="getwindowtext"></a>COleControlSite::GetWindowText

Récupère le texte actuel du contrôle.

```
virtual void GetWindowText(CString& str) const;
```

### <a name="parameters"></a>Paramètres

*Str*<br/>
Une référence `CString` à un objet qui contient le texte actuel du contrôle.

### <a name="remarks"></a>Notes

Si le contrôle prend en charge la propriété d’actions caption, cette valeur est retournée. Si la propriété stock caption n’est pas prise en charge, la valeur de la propriété Text est retournée.

## <a name="colecontrolsiteinvokehelper"></a><a name="invokehelper"></a>COleControlSite::InvokeHelper

Invoque la méthode ou la propriété spécifiée par *dwDispID*, dans le contexte spécifié par *wFlags*.

```
virtual void AFX_CDECL InvokeHelper(
    DISPID dwDispID,
    WORD wFlags,
    VARTYPE vtRet,
    void* pvRet,
    const BYTE* pbParamInfo, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’id de répartition de la propriété ou `IDispatch` de la méthode, trouvé sur l’interface du contrôle, à invoquer.

*wFlags (en)*<br/>
Indicateurs décrivant le contexte de l’appel à IDispatch::Invoke. Pour d’éventuelles valeurs `IDispatch::Invoke` *wFlags,* voir dans le SDK Windows.

*vtRet (en)*<br/>
Spécifie le type de la valeur de retour. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvRet*<br/>
Adresse de la variable qui recevra la valeur de propriété ou la valeur de retour. Il doit correspondre au type spécifié par *vtRet*.

*pbParamInfo*<br/>
Pointeur vers une chaîne d’octets à durée nulle spécifiant les types de paramètres suivant *pbParamInfo*. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Liste variable des paramètres, des types spécifiés dans *pbParamInfo*.

### <a name="remarks"></a>Notes

Le *paramètre pbParamInfo* spécifie les types de paramètres transmis à la méthode ou à la propriété. La liste variable d’arguments est représentée par ... dans la déclaration de syntaxe.

Cette fonction convertit les paramètres en valeurs VARIANTARG, puis invoque la `IDispatch::Invoke` méthode sur le contrôle. Si l’appel à `IDispatch::Invoke` échoue, cette fonction lève une exception. Si le code `IDispatch::Invoke` d’état retourné par est `DISP_E_EXCEPTION`, cette fonction jette un `COleDispatchException` objet, sinon il jette un `COleException`.

## <a name="colecontrolsiteinvokehelperv"></a><a name="invokehelperv"></a>COleControlSite::InvokeHelperV

Invoque la méthode ou la propriété spécifiée par *dwDispID*, dans le contexte spécifié par *wFlags*.

```
virtual void InvokeHelperV(
    DISPID dwDispID,
    WORD wFlags,
    VARTYPE vtRet,
    void* pvRet,
    const BYTE* pbParamInfo,
    va_list argList);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’id de répartition de la propriété ou `IDispatch` de la méthode, trouvé sur l’interface du contrôle, à invoquer.

*wFlags (en)*<br/>
Indicateurs décrivant le contexte de l’appel à IDispatch::Invoke.

*vtRet (en)*<br/>
Spécifie le type de la valeur de retour. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*pvRet*<br/>
Adresse de la variable qui recevra la valeur de propriété ou la valeur de retour. Il doit correspondre au type spécifié par *vtRet*.

*pbParamInfo*<br/>
Pointeur vers une chaîne d’octets à durée nulle spécifiant les types de paramètres suivant *pbParamInfo*. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*Arglist*<br/>
Pointeur vers une liste d’arguments variables.

### <a name="remarks"></a>Notes

Le *paramètre pbParamInfo* spécifie les types de paramètres transmis à la méthode ou à la propriété. Des paramètres supplémentaires pour la méthode ou la propriété invoquée peuvent être adoptés à l’aide du *paramètre va_list.*

Typiquement, cette fonction `COleControlSite::InvokeHelper`est appelée par .

## <a name="colecontrolsiteisdefaultbutton"></a><a name="isdefaultbutton"></a>COleControlSite::IsDefaultButton

Détermine si le contrôle est le bouton par défaut.

```
BOOL IsDefaultButton();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est le bouton par défaut sur la fenêtre, sinon zéro.

## <a name="colecontrolsiteiswindowenabled"></a><a name="iswindowenabled"></a>COleControlSite::IsWindowEnabled

Détermine si le site de contrôle est activé.

```
virtual BOOL IsWindowEnabled() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est activé, sinon zéro.

### <a name="remarks"></a>Notes

La valeur est récupérée à partir de la propriété d’actions activées par le contrôle.

## <a name="colecontrolsitem_biswindowless"></a><a name="m_biswindowless"></a>COleControlSite::m_bIsWindowless

Détermine si l’objet est un contrôle sans fenêtre.

```
BOOL m_bIsWindowless;
```

### <a name="remarks"></a>Notes

Nonzero si le contrôle n’a pas de fenêtre, sinon zéro.

## <a name="colecontrolsitem_ctlinfo"></a><a name="m_ctlinfo"></a>COleControlSite::m_ctlInfo

Informations sur la façon dont l’entrée du clavier est gérée par le contrôle.

```
CONTROLINFO m_ctlInfo;
```

### <a name="remarks"></a>Notes

Ces informations sont stockées dans une structure [CONTROLINFO.](/windows/win32/api/ocidl/ns-ocidl-controlinfo)

## <a name="colecontrolsitem_dweventsink"></a><a name="m_dweventsink"></a>COleControlSite::m_dwEventSink

Contient le cookie du point de connexion de l’évier de l’événement du contrôle.

```
DWORD m_dwEventSink;
```

## <a name="colecontrolsitem_dwmiscstatus"></a><a name="m_dwmiscstatus"></a>COleControlSite::m_dwMiscStatus

Contient des informations diverses sur le contrôle.

```
DWORD m_dwMiscStatus;
```

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [OLEMISC](/windows/win32/api/oleidl/ne-oleidl-olemisc)dans le SDK Windows.

## <a name="colecontrolsitem_dwpropnotifysink"></a><a name="m_dwpropnotifysink"></a>COleControlSite::m_dwPropNotifySink

Contient le cookie [IPropertyNotifySink.](/windows/win32/api/ocidl/nn-ocidl-ipropertynotifysink)

```
DWORD m_dwPropNotifySink;
```

## <a name="colecontrolsitem_dwstyle"></a><a name="m_dwstyle"></a>COleControlSite::m_dwStyle

Contient les styles de fenêtre du contrôle.

```
DWORD m_dwStyle;
```

## <a name="colecontrolsitem_hwnd"></a><a name="m_hwnd"></a>COleControlSite::m_hWnd

Contient le HWND du contrôle, ou NULL si le contrôle est sans fenêtre.

```
HWND m_hWnd;
```

## <a name="colecontrolsitem_iidevents"></a><a name="m_iidevents"></a>COleControlSite::m_iidEvents

Contient l’interface ID de l’interface de l’évier d’événements par défaut du contrôle.

```
IID m_iidEvents;
```

## <a name="colecontrolsitem_nid"></a><a name="m_nid"></a>COleControlSite::m_nID

Contient l’ID d’élément de dialogue du contrôle.

```
UINT m_nID;
```

## <a name="colecontrolsitem_pactiveobject"></a><a name="m_pactiveobject"></a>COleControlSite::m_pActiveObject

Contient l’interface [IOleInPlaceActiveObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject) du contrôle.

```
LPOLEINPLACEACTIVEOBJECT m_pActiveObject;
```

## <a name="colecontrolsitem_pctrlcont"></a><a name="m_pctrlcont"></a>COleControlSite::m_pCtrlCont

Contient le conteneur du contrôle (représentant le formulaire).

```
COleControlContainer* m_pCtrlCont;
```

## <a name="colecontrolsitem_pinplaceobject"></a><a name="m_pinplaceobject"></a>COleControlSite::m_pInPlaceObject

Contient `IOleInPlaceObject` l’interface [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) du contrôle.

```
LPOLEINPLACEOBJECT m_pInPlaceObject;
```

## <a name="colecontrolsitem_pobject"></a><a name="m_pobject"></a>COleControlSite::m_pObject

Contient `IOleObjectInterface` l’interface du contrôle.

```
LPOLEOBJECT m_pObject;
```

## <a name="colecontrolsitem_pwindowlessobject"></a><a name="m_pwindowlessobject"></a>COleControlSite::m_pWindowlessObject

Contient `IOleInPlaceObjectWindowless`l’interface [IOleInPlaceObjectWindowless](/windows/win32/api/ocidl/nn-ocidl-ioleinplaceobjectwindowless) du contrôle.

```
IOleInPlaceObjectWindowless* m_pWindowlessObject;
```

## <a name="colecontrolsitem_pwndctrl"></a><a name="m_pwndctrl"></a>COleControlSite::m_pWndCtrl

Contient un pointeur à l’objet `CWnd` qui représente le contrôle lui-même.

```
CWnd* m_pWndCtrl;
```

## <a name="colecontrolsitem_rect"></a><a name="m_rect"></a>COleControlSite::m_rect

Contient les limites du contrôle, par rapport à la fenêtre du conteneur.

```
CRect m_rect;
```

## <a name="colecontrolsitemodifystyle"></a><a name="modifystyle"></a>COleControlSite::ModifyStyle

Modifie les styles du contrôle.

```
virtual BOOL ModifyStyle(
    DWORD dwRemove,
    DWORD dwAdd,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*dwRemove (en)*<br/>
Les styles à supprimer des styles de fenêtre actuels.

*dwAdd dwAdd*<br/>
Les styles à ajouter à partir des styles de fenêtre actuels.

*nFlags*<br/>
Drapeaux de positionnement de fenêtre. Pour une liste de valeurs possibles, consultez la fonction [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Nonzero si les styles sont changés, sinon zéro.

### <a name="remarks"></a>Notes

Le stock de la propriété activée par le contrôle sera modifié pour correspondre au réglage pour WS_DISABLED. La propriété Border Style de stock du contrôle sera modifiée pour correspondre au paramètre demandé pour WS_BORDER. Tous les autres styles sont appliqués directement sur la poignée de fenêtre du contrôle, si l’on est présent.

Modifie les styles de fenêtre du contrôle. Les styles à ajouter ou à supprimer peuvent être combinés en utilisant l’opérateur bitwise OU ( &#124;). Consultez la fonction [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le Windows SDK pour plus d’informations sur les styles de fenêtre disponibles.

Si *nFlags* n’est `ModifyStyle` paszero, `SetWindowPos`appelle la fonction Win32 , et redessine la fenêtre en combinant *nFlags* avec les quatre drapeaux suivants:

- SWP_NOSIZE conserve la taille actuelle.

- SWP_NOMOVE conserve la position actuelle.

- SWP_NOZORDER conserve l’ordre Z actuel.

- SWP_NOACTIVATE n’active pas la fenêtre.

Pour modifier les styles étendus d’une fenêtre, appelez [ModifyStyleEx](#modifystyleex).

## <a name="colecontrolsitemodifystyleex"></a><a name="modifystyleex"></a>COleControlSite::ModifyStyleEx

Modifie les styles étendus du contrôle.

```
virtual BOOL ModifyStyleEx(
    DWORD dwRemove,
    DWORD dwAdd,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*dwRemove (en)*<br/>
Les styles étendus à supprimer des styles de fenêtre actuels.

*dwAdd dwAdd*<br/>
Les styles étendus à ajouter à partir des styles de fenêtre actuels.

*nFlags*<br/>
Drapeaux de positionnement de fenêtre. Pour une liste de valeurs possibles, consultez la fonction [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Nonzero si les styles sont changés, sinon zéro.

### <a name="remarks"></a>Notes

La propriété apparence de stock du contrôle sera modifiée pour correspondre au réglage pour WS_EX_CLIENTEDGE. Tous les autres styles de fenêtre étendus sont appliqués directement sur la poignée de fenêtre du contrôle, si l’on est présent.

Modifie les styles étendus de la fenêtre de l’objet du site de contrôle. Les styles à ajouter ou à supprimer peuvent être combinés en utilisant l’opérateur bitwise OU ( &#124;). Consultez la fonction [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le Windows SDK pour plus d’informations sur les styles de fenêtre disponibles.

Si *nFlags* n’est `ModifyStyleEx` paszero, `SetWindowPos`appelle la fonction Win32 , et redessine la fenêtre en combinant *nFlags* avec les quatre drapeaux suivants:

- SWP_NOSIZE conserve la taille actuelle.

- SWP_NOMOVE conserve la position actuelle.

- SWP_NOZORDER conserve l’ordre Z actuel.

- SWP_NOACTIVATE n’active pas la fenêtre.

Pour modifier les styles étendus d’une fenêtre, appelez [ModifyStyle](#modifystyle).

## <a name="colecontrolsitemovewindow"></a><a name="movewindow"></a>COleControlSite::MoveWindow

Change la position du contrôle.

```
virtual void MoveWindow(
    int x,
    int y,
    int nWidth,
    int nHeight);
```

### <a name="parameters"></a>Paramètres

*x*<br/>
La nouvelle position du côté gauche de la fenêtre.

*y*<br/>
La nouvelle position du haut de la fenêtre.

*nWidth (en)*<br/>
La nouvelle largeur de la fenêtre

*nHeight (en)*<br/>
La nouvelle hauteur de la fenêtre.

## <a name="colecontrolsitequickactivate"></a><a name="quickactivate"></a>COleControlSite::QuickActivate

Active rapidement le contrôle contenu.

```
virtual BOOL QuickActivate();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le site de contrôle a été activé, sinon zéro.

### <a name="remarks"></a>Notes

Cette fonction ne doit être appelée que si l’utilisateur est en train de passer outre au processus de création du contrôle.

Les `IPersist*::Load` `IPersist*::InitNew` méthodes et les méthodes doivent être appelées après une activation rapide. Le contrôle doit établir ses connexions aux éviers du conteneur lors d’une activation rapide. Cependant, ces connexions `IPersist*::Load` ne `IPersist*::InitNew` sont pas en direct jusqu’à ce que ou a été appelé.

## <a name="colecontrolsitesafesetproperty"></a><a name="safesetproperty"></a>COleControlSite::SafeSetProperty

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual BOOL AFX_CDECL SafeSetProperty(
    DISPID dwDispID,
    VARTYPE vtProp, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de répartition de la propriété ou `IDispatch` de la méthode, trouvé sur l’interface du contrôle, à définir.

*vtProp (en)*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Un seul paramètre du type spécifié par *vtProp*.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

> [!NOTE]
> Contrairement `SetProperty` `SetPropertyV`et, si une erreur est rencontrée (comme essayer de définir une propriété inexistante), aucune exception n’est lancée.

## <a name="colecontrolsitesetdefaultbutton"></a><a name="setdefaultbutton"></a>COleControlSite::SetDefaultButton

Définit le contrôle comme le bouton par défaut.

```cpp
void SetDefaultButton(BOOL bDefault);
```

### <a name="parameters"></a>Paramètres

*bDefault (en)*<br/>
Nonzero si le contrôle doit devenir le bouton par défaut; autrement zéro.

### <a name="remarks"></a>Notes

> [!NOTE]
> Le contrôle doit avoir le OLEMISC_ACTSLIKEBUTTON jeu de statut.

## <a name="colecontrolsitesetdlgctrlid"></a><a name="setdlgctrlid"></a>COleControlSite::SetDlgCtrlID

Modifie la valeur de l’identifiant d’élément de dialogue du contrôle.

```
virtual int SetDlgCtrlID(int nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
La nouvelle valeur d’identification.

### <a name="return-value"></a>Valeur de retour

En cas de succès, l’identifiant précédent de l’élément de dialogue de la fenêtre; sinon 0.

### <a name="remarks"></a>Notes

## <a name="colecontrolsitesetfocus"></a><a name="setfocus"></a>COleControlSite::SetFocus

Définit la mise au point vers le contrôle.

```
virtual CWnd* SetFocus();
virtual CWnd* SetFocus(LPMSG lpmsg);
```

### <a name="parameters"></a>Paramètres

*lpmsg*<br/>
Un pointeur à une [structure MSG](/windows/win32/api/winuser/ns-winuser-msg). Cette structure contient le message `SetFocus` Windows déclenchant la demande de contrôle contenue dans le site de contrôle actuel.

### <a name="return-value"></a>Valeur de retour

Un pointeur à la fenêtre qui avait auparavant se concentrer.

## <a name="colecontrolsitesetproperty"></a><a name="setproperty"></a>COleControlSite::SetProperty

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void AFX_CDECL SetProperty(
    DISPID dwDispID,
    VARTYPE vtProp, ...);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de répartition de la propriété ou `IDispatch` de la méthode, trouvé sur l’interface du contrôle, à définir.

*vtProp (en)*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*...*<br/>
Un seul paramètre du type spécifié par *vtProp*.

### <a name="remarks"></a>Notes

Si `SetProperty` vous rencontrez une erreur, une exception est lancée.

Le type d’exception est déterminé par la valeur de rendement de la tentative de définir la propriété ou la méthode. Si la valeur `DISP_E_EXCEPTION`de `COleDispatchExcpetion` rendement est , a est jeté; sinon `COleException`un .

## <a name="colecontrolsitesetpropertyv"></a><a name="setpropertyv"></a>COleControlSite::SetPropertyV

Définit la propriété de contrôle spécifiée par *dwDispID*.

```
virtual void SetPropertyV(
    DISPID dwDispID,
    VARTYPE vtProp,
    va_list argList);
```

### <a name="parameters"></a>Paramètres

*dwDispID*<br/>
Identifie l’ID de répartition de la propriété ou `IDispatch` de la méthode, trouvé sur l’interface du contrôle, à définir.

*vtProp (en)*<br/>
Spécifie le type de propriété à définir. Pour connaître les valeurs possibles, consultez la section Notes de [COleDispatchDriver::InvokeHelper](../../mfc/reference/coledispatchdriver-class.md#invokehelper).

*Arglist*<br/>
Pointeur désignant la liste d’arguments.

### <a name="remarks"></a>Notes

Des paramètres supplémentaires pour la méthode ou la propriété invoquée peuvent être passés à l’aide du *paramètre arg_list.* Si `SetProperty` vous rencontrez une erreur, une exception est lancée.

Le type d’exception est déterminé par la valeur de rendement de la tentative de définir la propriété ou la méthode. Si la valeur `DISP_E_EXCEPTION`de `COleDispatchExcpetion` rendement est , a est jeté; sinon `COleException`un .

## <a name="colecontrolsitesetwindowpos"></a><a name="setwindowpos"></a>COleControlSite::SetWindowPos

Définit la taille, la position et l’ordre Z du site de contrôle.

```
virtual BOOL SetWindowPos(
    const CWnd* pWndInsertAfter,
    int x,
    int y,
    int cx,
    int cy,
    UINT nFlags);
```

### <a name="parameters"></a>Paramètres

*pWndInsertAprès*<br/>
Un pointeur à la fenêtre.

*x*<br/>
La nouvelle position du côté gauche de la fenêtre.

*y*<br/>
La nouvelle position du haut de la fenêtre.

*Cx*<br/>
La nouvelle largeur de la fenêtre

*Cy*<br/>
La nouvelle hauteur de la fenêtre.

*nFlags*<br/>
Spécifie la fenêtre en dimensionnant et en positionnant les drapeaux. Pour les valeurs possibles, consultez la section Remarques pour [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès, sinon zéro.

## <a name="colecontrolsitesetwindowtext"></a><a name="setwindowtext"></a>COleControlSite::SetWindowText

Définit le texte pour le site de contrôle.

```
virtual void SetWindowText(LPCTSTR lpszString);
```

### <a name="parameters"></a>Paramètres

*lpszString (lpszString)*<br/>
Pointeur vers une corde non terminée pour être utilisé comme nouveau titre ou texte de contrôle.

### <a name="remarks"></a>Notes

Cette fonction tente d’abord de définir la propriété stock caption. Si la propriété stock caption n’est pas prise en charge, la propriété Text est définie à la place.

## <a name="colecontrolsiteshowwindow"></a><a name="showwindow"></a>COleControlSite::ShowWindow

Définit l’état du spectacle de la fenêtre.

```
virtual BOOL ShowWindow(int nCmdShow);
```

### <a name="parameters"></a>Paramètres

*nCmdShow (en)*<br/>
Précise comment le site de contrôle doit être montré. Il doit être l’une des valeurs suivantes :

- SW_HIDE cache cette fenêtre et passe l’activation vers une autre fenêtre.

- SW_MINIMIZE minimise la fenêtre et active la fenêtre de haut niveau dans la liste du système.

- SW_RESTORE active et affiche la fenêtre. Si la fenêtre est réduite au minimum ou maximisée, Windows la restaure à sa taille et à sa position d’origine.

- SW_SHOW active la fenêtre et l’affiche dans sa taille et sa position actuelles.

- SW_SHOWMAXIMIZED active la fenêtre et l’affiche comme une fenêtre maximisée.

- SW_SHOWMINIMIZED active la fenêtre et l’affiche comme une icône.

- SW_SHOWMINNOACTIVE affiche la fenêtre comme une icône. La fenêtre actuellement active reste active.

- SW_SHOWNA affiche la fenêtre dans son état actuel. La fenêtre actuellement active reste active.

- SW_SHOWNOACTIVATE affiche la fenêtre dans sa taille et sa position les plus récentes. La fenêtre actuellement active reste active.

- SW_SHOWNORMAL active et affiche la fenêtre. Si la fenêtre est réduite au minimum ou maximisée, Windows la restaure à sa taille et à sa position d’origine.

### <a name="return-value"></a>Valeur de retour

Nonzero si la fenêtre était auparavant visible; 0 si la fenêtre était auparavant cachée.

## <a name="see-also"></a>Voir aussi

[CCmdTarget, classe](../../mfc/reference/ccmdtarget-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classe COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md)
