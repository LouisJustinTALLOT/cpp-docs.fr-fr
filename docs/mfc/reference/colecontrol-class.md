---
title: COleControl (classe)
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 8587eb76f38c07d54234c810dfd6ab79f487e740
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/04/2019
ms.locfileid: "57283421"
---
# <a name="colecontrol-class"></a>COleControl (classe)

Classe de base puissante pour développer des contrôles OLE.

## <a name="syntax"></a>Syntaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Crée un objet `COleControl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Récupère l’apparence actuelle du contrôle.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retourne la valeur de la propriété BackColor ambiante.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retourne le nom du contrôle tel que spécifié par le conteneur.|
|[COleControl::AmbientFont](#ambientfont)|Retourne la valeur de la propriété de police ambiante.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Retourne la valeur de la propriété de couleur de premier plan ambiante.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Retourne l’ID de paramètres régionaux. du conteneur|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retourne le type d’unités utilisées par le conteneur.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Détermine si les poignées de manipulation doivent s’afficher.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Détermine si le hachurage doit s’afficher.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retourne le type d’alignement de texte spécifié par le conteneur.|
|[COleControl::AmbientUIDead](#ambientuidead)|Détermine si le contrôle doit répondre aux actions de l’interface utilisateur.|
|[COleControl::AmbientUserMode](#ambientusermode)|Détermine le mode du conteneur.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Informe le conteneur qu’une propriété liée a été modifiée.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Demande l’autorisation de modifier la valeur de propriété.|
|[COleControl::ClientToParent](#clienttoparent)|Convertit un point relatif à l’origine du contrôle à un point relatif à l’origine de son conteneur.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajuste un rectangle de signe insertion si elle est recouverte par un contrôle.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Appelez cette fonction une fois que l’ensemble des mnémoniques gérés par le contrôle a changé.|
|[COleControl::DisplayError](#displayerror)|Affiche les événements d’erreur stock à l’utilisateur du contrôle.|
|[COleControl::DoClick](#doclick)|Implémentation de la cotation `DoClick` (méthode).|
|[COleControl::DoPropExchange](#dopropexchange)|Sérialise les propriétés d’un `COleControl` objet.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Permet la prise en charge de cadre simple pour un contrôle.|
|[COleControl::ExchangeExtent](#exchangeextent)|Sérialise la largeur et la hauteur du contrôle.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Sérialise les propriétés stock du contrôle.|
|[COleControl::ExchangeVersion](#exchangeversion)|Sérialise le numéro de version du contrôle.|
|[COleControl::FireClick](#fireclick)|Déclenche l’action `Click` événement.|
|[COleControl::FireDblClick](#firedblclick)|Déclenche l’action `DblClick` événement.|
|[COleControl::FireError](#fireerror)|Déclenche l’action `Error` événement.|
|[COleControl::FireEvent](#fireevent)|Déclenche un événement personnalisé.|
|[COleControl::FireKeyDown](#firekeydown)|Déclenche l’action `KeyDown` événement.|
|[COleControl::FireKeyPress](#firekeypress)|Déclenche l’action `KeyPress` événement.|
|[COleControl::FireKeyUp](#firekeyup)|Déclenche l’action `KeyUp` événement.|
|[COleControl::FireMouseDown](#firemousedown)|Déclenche l’action `MouseDown` événement.|
|[COleControl::FireMouseMove](#firemousemove)|Déclenche l’action `MouseMove` événement.|
|[COleControl::FireMouseUp](#firemouseup)|Déclenche l’action `MouseUp` événement.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Déclenche un événement lorsque l’état prêt du contrôle change.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Modifie le comportement de l’activation par défaut d’un contrôle qui prend en charge la `IPointerInactive` interface.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Retourne la valeur de la propriété ambiante spécifiée.|
|[COleControl::GetAppearance](#getappearance)|Retourne la valeur de la propriété Appearance du stockée.|
|[COleControl::GetBackColor](#getbackcolor)|Retourne la valeur de la propriété BackColor stockée.|
|[COleControl::GetBorderStyle](#getborderstyle)|Retourne la valeur de la propriété BorderStyle stockée.|
|[COleControl::GetCapture](#getcapture)|Détermine si un objet de contrôle sans fenêtre, activé a la capture de la souris.|
|[COleControl::GetClassID](#getclassid)|Récupère l’ID de classe du contrôle.|
|[COleControl::GetClientOffset](#getclientoffset)|Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.|
|[COleControl::GetClientRect](#getclientrect)|Récupère la taille de la zone cliente du contrôle.|
|[COleControl::GetClientSite](#getclientsite)|Interroge un objet pour le pointeur à son site client actuelle au sein de son conteneur.|
|[COleControl::GetControlFlags](#getcontrolflags)|Récupère les paramètres d’indicateur de contrôle.|
|[COleControl::GetControlSize](#getcontrolsize)|Retourne la position et la taille du contrôle OLE.|
|[COleControl::GetDC](#getdc)|Fournit un moyen pour un contrôle sans fenêtre obtenir un contexte de périphérique à partir de son conteneur.|
|[COleControl::GetEnabled](#getenabled)|Retourne la valeur de la propriété Enabled de l’action.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Récupère un pointeur vers un objet de contrôle étendu appartenant au conteneur.|
|[COleControl::GetFocus](#getfocus)|Détermine si le contrôle a le focus.|
|[COleControl::GetFont](#getfont)|Retourne la valeur de la propriété stock Font.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retourne les mesures d’un `CFontHolder` objet.|
|[COleControl::GetForeColor](#getforecolor)|Retourne la valeur de la propriété ForeColor stockée.|
|[COleControl::GetHwnd](#gethwnd)|Retourne la valeur de la propriété stock hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Fournit le texte de barre d’état pour un élément de menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Empêche l’accès à la valeur de la propriété d’un contrôle par l’utilisateur.|
|[COleControl::GetReadyState](#getreadystate)|Retourne l’état de préparation du contrôle.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Retourne le rectangle du contrôle par rapport à son conteneur.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retourne les métriques de la propriété stock Font.|
|[COleControl::GetText](#gettext)|Retourne la valeur de la propriété Text ou Caption stockée.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Méthode override pour permettre à un contrôle sans fenêtre être la cible de glisser-déplacer des opérations.|
|[COleControl::InitializeIIDs](#initializeiids)|Informe la classe de base de l’IID le contrôle utilise.|
|[COleControl::InternalGetFont](#internalgetfont)|Retourne un `CFontHolder` objet pour la propriété stock Font.|
|[COleControl::InternalGetText](#internalgettext)|Récupère la propriété stock de légende ou le texte.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Définit l’état de préparation du contrôle et déclenche l’événement de changement d’état prêt.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalide une zone du contrôle affiché, à l’origine de ce dernier à être redessiné.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalide la zone cliente de la fenêtre conteneur dans la région donnée. Peut être utilisé à redessiner les contrôles sans fenêtre dans la région.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Autorise spécialisé de chargement d’un contrôle OLE.|
|[COleControl::IsModified](#ismodified)|Détermine si l’état du contrôle a changé.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indique si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Appelé pour déterminer si le contrôle sous-classe un Windows contrôle.|
|[COleControl::Load](#load)|Réinitialise des données asynchrones antérieures et déclenche un nouveau chargement de la propriété du contrôle asynchrone.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Détermine si votre contrôle peut être désactivé par le conteneur.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Appelé lorsqu’une propriété ambiante est modifiée.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Appelé lorsque la propriété Appearance stockée est modifiée.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Appelé lorsque la propriété BackColor stock est modifiée.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Appelé lorsque la propriété BorderStyle stock est modifiée.|
|[COleControl::OnClick](#onclick)|Appelée pour déclencher le clic événement.|
|[COleControl::OnClose](#onclose)|Avertit le contrôle qui `IOleControl::Close` a été appelée.|
|[COleControl::OnDoVerb](#ondoverb)|Appelé après l’exécution d’un verbe de contrôle.|
|[COleControl::OnDraw](#ondraw)|Appelée lorsqu’un contrôle est demandé à redessiner.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Appelée par le conteneur lorsqu’un contrôle est demandé à redessiner lui-même à l’aide d’un contexte de périphérique de métafichier.|
|[COleControl::OnEdit](#onedit)|Appelé par le conteneur d’interface utilisateur Activer un contrôle OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Appelé lorsque la propriété Enabled de stock est modifié.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Appelé par le conteneur pour énumérer les verbes d’un contrôle.|
|[COleControl::OnEventAdvise](#oneventadvise)|Appelé lorsque les gestionnaires d’événements soient ou non connectés à partir d’un contrôle.|
|[COleControl::OnFontChanged](#onfontchanged)|Appelé lorsque la propriété stock Font est modifiée.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Appelé lorsque la propriété ForeColor stock est modifiée.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Appelé lorsque des événements d’un contrôle sont figées ou non figées.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Avertit le contrôle qui `IOleObject::GetColorSet` a été appelée.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fournit des informations mnémoniques au conteneur.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Appelée pour obtenir une chaîne représentant une valeur de propriété.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Demande le handle du menu du contrôle qui est fusionné avec le menu du conteneur.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Méthode override pour récupérer la taille d’affichage du contrôle le plus proche pour le mode de taille et l’étendue proposé.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retourne des chaînes représentant les valeurs possibles pour une propriété.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retourne la valeur correspondant à une chaîne prédéfinie.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Méthode override pour récupérer la taille des zones d’affichage du contrôle (peut être utilisé pour activer le dessin en deux temps).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Méthode override pour convertir la taille du contrôle dans un rectangle en commençant à une position spécifique.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Méthode override pour récupérer l’état d’affichage du contrôle.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Appelé par le conteneur lorsque le contrôle est l’interface utilisateur désactivée.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Méthode override pour avoir le conteneur pour le contrôle inactif sous les souris pointeur dispatch WM_MOUSEMOVE les messages au contrôle.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Méthode override pour avoir le conteneur pour le contrôle inactif sous les souris pointeur dispatch WM_SETCURSOR les messages au contrôle.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Appelé après que l’événement KeyDown stock a été déclenché.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Appelé après que l’événement KeyPress stock a été déclenché.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Appelé après que l’événement KeyUp stock a été déclenché.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indique quelle page de propriété à utiliser pour modifier une propriété.|
|[COleControl::OnMnemonic](#onmnemonic)|Appelé lorsqu’une touche mnémonique du contrôle a été enfoncée.|
|[COleControl::OnProperties](#onproperties)|Appelé lorsque le verbe de « Propriétés » du contrôle a été appelée.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Remplacer à la requête si l’affichage d’un contrôle superpose à un moment donné.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Remplacer à la requête si l’affichage d’un contrôle superpose à n’importe quel point dans un rectangle donné.|
|[COleControl::OnRenderData](#onrenderdata)|Appelé par l’infrastructure pour récupérer des données au format spécifié.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Appelé par l’infrastructure pour récupérer des données à partir d’un fichier au format spécifié.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Appelé par l’infrastructure pour récupérer des données à partir de la mémoire globale dans le format spécifié.|
|[COleControl::OnResetState](#onresetstate)|Réinitialise les propriétés d’un contrôle pour les valeurs par défaut.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Avertit le contrôle qui `IOleControl::SetClientSite` a été appelée.|
|[COleControl::OnSetData](#onsetdata)|Remplace les données du contrôle avec une autre valeur.|
|[COleControl::OnSetExtent](#onsetextent)|Appelé après modification de l’étendue du contrôle.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Appelé après la modification des dimensions du contrôle.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Appelé lorsque le contrôle a été activée UI.|
|[COleControl::OnTextChanged](#ontextchanged)|Appelé lorsque le stock texte ou la propriété Caption est modifiée.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Traite les messages de fenêtre (autres que les messages de clavier et souris) pour les contrôles sans fenêtre.|
|[COleControl::ParentToClient](#parenttoclient)|Convertit un point relatif à l’origine du conteneur à un point relatif à l’origine du contrôle.|
|[COleControl::PostModalDialog](#postmodaldialog)|Informe le conteneur qu’une boîte de dialogue modale a été fermée.|
|[COleControl::PreModalDialog](#premodaldialog)|Informe le conteneur une boîte de dialogue modale est sur le point d’être affiché.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Supprime et recrée la fenêtre du contrôle.|
|[COleControl::Refresh](#refresh)|Force à repeindre l’apparence d’un contrôle.|
|[COleControl::ReleaseCapture](#releasecapture)|Libère la capture de la souris.|
|[COleControl::ReleaseDC](#releasedc)|Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Réinitialise le parent de la fenêtre de contrôle.|
|[COleControl::ResetStockProps](#resetstockprops)|Initialise `COleControl` boursiers propriétés à leurs valeurs par défaut.|
|[COleControl::ResetVersion](#resetversion)|Initialise le numéro de version à une valeur donnée.|
|[COleControl::ScrollWindow](#scrollwindow)|Permet à un contrôle sans fenêtre faire défiler une zone dans son image active sur place sur l’affichage.|
|[COleControl::SelectFontObject](#selectfontobject)|Sélectionne une propriété de police personnalisée dans un contexte de périphérique.|
|[COleControl::SelectStockFont](#selectstockfont)|Sélectionne la propriété stock Font dans un contexte de périphérique.|
|[COleControl::SerializeExtent](#serializeextent)|Sérialise ou initialise l’espace d’affichage pour le contrôle.|
|[COleControl::SerializeStockProps](#serializestockprops)|Sérialise ou initialise le `COleControl` propriétés stock.|
|[COleControl::SerializeVersion](#serializeversion)|Sérialise ou initialise les informations de version du contrôle.|
|[COleControl::SetAppearance](#setappearance)|Définit la valeur de la propriété Appearance du stockée.|
|[COleControl::SetBackColor](#setbackcolor)|Définit la valeur de la propriété BackColor stockée.|
|[COleControl::SetBorderStyle](#setborderstyle)|Définit la valeur de la propriété BorderStyle stockée.|
|[COleControl::SetCapture](#setcapture)|Provoque la fenêtre du contrôle conteneur à prendre possession de la capture de souris procuration du contrôle.|
|[COleControl::SetControlSize](#setcontrolsize)|Définit la position et la taille du contrôle OLE.|
|[COleControl::SetEnabled](#setenabled)|Définit la valeur de la propriété Enabled de l’action.|
|[COleControl::SetFocus](#setfocus)|Provoque la fenêtre du contrôle conteneur à prendre possession du focus d’entrée procuration du contrôle.|
|[COleControl::SetFont](#setfont)|Définit la valeur de la propriété stock Font.|
|[COleControl::SetForeColor](#setforecolor)|Définit la valeur de la propriété ForeColor stockée.|
|[COleControl::SetInitialSize](#setinitialsize)|Définit la taille d’un contrôle OLE lorsque d’abord affiché dans un conteneur.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Modifie l’état modifié d’un contrôle.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indique qu’une demande de modification a échoué.|
|[COleControl::SetNotSupported](#setnotsupported)|Empêche toute modification à la valeur de la propriété d’un contrôle par l’utilisateur.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Définit le rectangle du contrôle par rapport à son conteneur.|
|[COleControl::SetText](#settext)|Définit la valeur de la propriété Text ou Caption stockée.|
|[COleControl::ThrowError](#throwerror)|Signale qu’une erreur s’est produite dans un contrôle OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transformations de coordonnent les valeurs comprises entre un conteneur et le contrôle.|
|[COleControl::TranslateColor](#translatecolor)|Convertit une valeur de type OLE_COLOR en une valeur COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Détermine si les propriétés ambiantes seront disponibles la prochaine fois que le contrôle est chargé.|
|[COleControl::WindowProc](#windowproc)|Fournit une procédure de Windows pour un `COleControl` objet.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Appelé par l’infrastructure lorsque l’apparence du contrôle doit être mis à jour.|
|[COleControl::DrawMetafile](#drawmetafile)|Appelé par l’infrastructure quand le contexte de périphérique de métafichier est utilisé.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permet l’appel de méthode automation.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.|

## <a name="remarks"></a>Notes

Dérivé `CWnd`, cette classe hérite de toutes les fonctionnalités d’un objet de fenêtre de Windows ainsi que des fonctionnalités supplémentaires spécifiques à OLE, telles que le déclenchement des événements et la possibilité de prendre en charge les méthodes et propriétés.

Contrôles OLE peuvent être insérées dans des applications conteneur OLE et communiquent avec le conteneur à l’aide d’un système bidirectionnels de déclenchement des événements et exposant des méthodes et des propriétés pour le conteneur. Notez que les conteneurs OLE standards prennent uniquement en charge les fonctionnalités de base d’un contrôle OLE. Ils ne peuvent pas prendre en charge des fonctionnalités étendues d’un contrôle OLE. Déclenchement de l’événement se produit lorsque des événements sont envoyés au conteneur suite à certaines actions se produisent dans le contrôle. À son tour, le conteneur communique avec le contrôle à l’aide d’un jeu exposé des méthodes et propriétés analogues pour les fonctions membres et les membres de données d’une classe C++. Cette approche permet au développeur de contrôler l’apparence du contrôle et de notifier au conteneur lorsque certaines actions se produisent.

## <a name="windowless-controls"></a>Contrôles sans fenêtre

Contrôles OLE peuvent être utilisé actif en place sans fenêtre. Les contrôles sans fenêtre ont des avantages importants :

- Les contrôles sans fenêtre peuvent être transparent et non rectangulaires

- Les contrôles sans fenêtre réduisent le temps de taille et de la création d’instance de l’objet

Contrôles n’avez pas besoin d’une fenêtre. Services offre une fenêtre peuvent facilement être fournis via une fenêtre unique partagée (généralement du conteneur) et un peu de code de distribution. Présence d’une fenêtre est essentiellement une complication inutile sur l’objet.

Lorsque l’activation sans fenêtre est utilisée, le conteneur (qui possède de fenêtre) est chargé de fournir des services qui seraient sinon ont été fournis par la fenêtre du contrôle. Par exemple, si votre contrôle doit interroger le focus clavier, interroger la capture de la souris ou obtenir un contexte de périphérique, ces opérations sont gérées par le conteneur. Le `COleControl` ces opérations sur le conteneur d’appel de fonctions membres de l’opération sans fenêtre.

Lorsque l’activation sans fenêtre est activée, les délégués de conteneur envoyer les messages vers le contrôle `IOleInPlaceObjectWindowless` interface (une extension de [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) pour la prise en charge sans fenêtre). `COleControl`d’implémentation de cette interface distribue ces messages via la table des messages de votre contrôle, une fois que le réglage de la souris en coordonnées en conséquence. Vous pouvez traiter ces messages tels que des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages.

Dans un contrôle sans fenêtre, vous devez toujours utiliser le `COleControl` des fonctions de membre au lieu de le correspondantes `CWnd` fonctions membres ou les fonctions Windows API associées.

Objets de contrôle OLE peuvent également créer une fenêtre uniquement lorsqu’ils deviennent actifs, mais augmente la quantité de travail nécessaire pour la transition inactive active et la vitesse de la transition tombe en panne. Il existe des cas lorsqu’il s’agit d’un problème : par exemple, considérez une grille de zones de texte. Lorsque le curseur haut et bas dans la colonne, chaque contrôle doit être in situ activées et désactivées puis. La vitesse de la transition inactif/actif affecte directement la vitesse de défilement.

Pour plus d’informations sur le développement d’une infrastructure de contrôle OLE, consultez les articles [contrôles ActiveX MFC](../../mfc/mfc-activex-controls.md) et [vue d’ensemble : Création d’un programme de contrôle ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Pour plus d’informations sur l’optimisation des contrôles OLE, y compris les contrôles sans fenêtre et sans scintillement, consultez [contrôles ActiveX MFC : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Retourne la valeur de la propriété BackColor ambiante.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la propriété ambiante du conteneur BackColor, le cas échéant. Si la propriété n’est pas pris en charge, cette fonction retourne la couleur d’arrière-plan définie par le système Windows.

### <a name="remarks"></a>Notes

La propriété BackColor ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Le nom que du conteneur a assigné au contrôle peut être utilisé dans les messages d’erreur affichés à l’utilisateur.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valeur de retour

Le nom du contrôle OLE. La valeur par défaut est une chaîne de longueur nulle.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Retourne la valeur de la propriété de police ambiante.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’interface de dispatch de police ambiante du conteneur. La valeur par défaut est NULL. Si la valeur de retour n’est pas égal à NULL, vous êtes chargé de libérer de la police en appelant son [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) fonction membre.

### <a name="remarks"></a>Notes

La propriété de police ambiante est défini par le conteneur et disponible à tous les contrôles. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Retourne la valeur de la propriété de couleur de premier plan ambiante.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la propriété ambiante du conteneur couleur de premier plan, le cas échéant. Si non pris en charge, cette fonction retourne la couleur de texte définie par le système de Windows.

### <a name="remarks"></a>Notes

La propriété de couleur de premier plan ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Retourne l’ID de paramètres régionaux. du conteneur

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valeur de retour

La valeur de la propriété du conteneur LocaleID, le cas échéant. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.

### <a name="remarks"></a>Notes

Le contrôle peut utiliser LocaleID pour adapter son interface utilisateur pour les paramètres régionaux spécifiques. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Récupère le paramètre d’apparence actuelle pour l’objet de contrôle.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valeur de retour

L’apparence du contrôle :

- **0** plat apparence

- **1** apparence 3D

### <a name="remarks"></a>Notes

Appelez cette fonction pour récupérer la valeur actuelle de la propriété DISPID_AMBIENT_APPEARANCE pour le contrôle.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Retourne le type d’unités utilisées par le conteneur.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valeur de retour

Chaîne contenant les unités d’échelle ambiantes du conteneur. Si cette propriété n’est pas pris en charge, cette fonction retourne une chaîne de longueur nulle.

### <a name="remarks"></a>Notes

La propriété du conteneur ambiante unités d’échelle peut être utilisée pour afficher les positions ou dimensions, accompagnées de l’unité choisie, telles que des twips ou en centimètres. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Détermine si le conteneur autorise le contrôle afficher les poignées de manipulation pour lui-même lorsqu’il est actif.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si les poignées de manipulation doivent être affichées ; sinon 0. Si cette propriété n’est pas pris en charge, cette fonction retourne la valeur différente de zéro.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Détermine si le conteneur autorise le contrôle s’afficher avec un hachurée modèle lorsque l’interface utilisateur actif.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le motif hachuré doit être affiché ; sinon 0. Si cette propriété n’est pas pris en charge, cette fonction retourne la valeur différente de zéro.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Détermine l’alignement du texte ambiant préféré par le conteneur de contrôle.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valeur de retour

L’état de la propriété du conteneur ambiante TextAlign. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.

Voici une liste valides des valeurs de retour :

|Valeur de retour|Signification|
|------------------|-------------|
|0|Alignement général (nombres pour le texte de droite, à gauche).|
|1|Aligner à gauche|
|2|Center|
|3|Justifier à droite|

### <a name="remarks"></a>Notes

Cette propriété est disponible à tous les contrôles incorporés et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour prendre en charge cette propriété.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Détermine si le conteneur puisse exiger le contrôle de répondre aux actions de l’interface utilisateur.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle doit répondre aux actions de l’interface utilisateur ; sinon 0. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.

### <a name="remarks"></a>Notes

Par exemple, un conteneur peut définir cela sur TRUE dans le mode Création.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Détermine si le conteneur est en mode Création ou en mode utilisateur.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le conteneur est en mode utilisateur ; sinon 0 (en mode Création). Si cette propriété n’est pas pris en charge, cette fonction retourne la valeur TRUE.

### <a name="remarks"></a>Notes

Par exemple, un conteneur peut définir cette valeur false en mode Création.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Indique que la valeur de propriété liée a changé.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’ID de dispatch d’une propriété liée du contrôle.

### <a name="remarks"></a>Notes

Cela doit être appelée chaque fois que la valeur de la propriété change, même dans les cas où la modification n’était pas effectuée via la propriété définie (méthode). Tenez compte notamment des propriétés liées qui sont mappées à des variables de membre. Chaque modification tel un membre variable, `BoundPropertyChanged` doit être appelée.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Demande l’autorisation à partir de la `IPropertyNotifySink` interface pour modifier une valeur de propriété liée fournie par le contrôle.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’ID de dispatch d’une propriété liée du contrôle.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la modification est autorisée ; sinon 0. La valeur par défaut est différent de zéro.

### <a name="remarks"></a>Notes

Si l’autorisation est refusée, le contrôle ne doit pas à la valeur de la modification de propriété. Pour cela, en ignorant ou d’échec de l’action qui a tenté de modifier la valeur de propriété.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Convertit les coordonnées de *pPoint* dans les coordonnées du parent.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. La zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement, mais pas dans la zone cliente.

*pPoint*<br/>
Pointeur vers le point de zone du client OLE pour traduire les coordonnées du parent (conteneur).

### <a name="remarks"></a>Notes

Sur l’entrée *pPoint* est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle). Lors de la sortie *pPoint* est relatif à l’origine du parent (coin supérieur gauche du conteneur).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Ajuste un rectangle de signe insertion s’il est entièrement ou partiellement couvert par des objets opaques superposés.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
En entrée, pointeur vers un [RECT](/windows/desktop/api/windef/ns-windef-tagrect) structure qui contient la zone de signe insertion à ajuster. Sur la sortie, la zone du signe insertion ajustée, ou NULL si le rectangle de signe insertion est complètement couvert.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Un point d’insertion est une ligne, bloc ou bitmap qui indique généralement qu’où sera inséré texte ou des graphiques clignotant.

Un objet sans fenêtre ne peut pas afficher en toute sécurité un accent circonflexe sans vérifier d’abord si le signe insertion est partiellement ou totalement masqué par des objets superposés. Pour que cela soit possible, un objet peut utiliser `ClipCaretRect` pour obtenir le point d’insertion ajustée (réduit) pour vous assurer qu’il s’intègre dans la zone de découpage.

Création d’un point d’insertion des objets doivent soumettre le rectangle de signe insertion à `ClipCaretRect` et utiliser le rectangle ajusté pour le point d’insertion. Si le signe insertion est entièrement masqué, cette méthode retournera la valeur FALSE et le signe insertion ne doit pas être afficher tout dans ce cas.

##  <a name="colecontrol"></a>  COleControl::COleControl

Construit un objet `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Notes

Cette fonction n’est normalement pas appelée directement. À la place du contrôle OLE est généralement créé par la fabrique de classe.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Appelez cette fonction lorsque l’ensemble des mnémoniques pris en charge par le contrôle a été modifiée.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Notes

Lorsqu’il reçoit cette notification, le conteneur du contrôle obtienne le nouvel ensemble de mnémoniques en effectuant un appel à [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Notez que le conteneur n’est pas nécessaire pour répondre à cette notification.

##  <a name="displayerror"></a>  COleControl::DisplayError

Appelé par l’infrastructure après que l’événement d’erreur stock a été gérée (à moins que le Gestionnaire d’événements a supprimé l’affichage de l’erreur).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Paramètres

*scode*<br/>
La valeur de code d’état soient signalés. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La description de l’erreur signalée.

*lpszSource*<br/>
Le nom du module génère l’erreur (en règle générale, le nom du module de contrôle OLE).

*lpszHelpFile*<br/>
Le nom du fichier d’aide contenant une description de l’erreur.

*nHelpID*<br/>
L’ID de contexte aide de l’erreur signalée.

### <a name="remarks"></a>Notes

Le comportement par défaut affiche une boîte de message qui contient la description de l’erreur contenue dans *lpszDescription*.

Remplacez cette fonction pour personnaliser l’affichent des erreurs.

##  <a name="doclick"></a>  COleControl::DoClick

Simule une souris cliquez sur action sur le contrôle.

```
void DoClick();
```

### <a name="remarks"></a>Notes

La méthode `COleControl::OnClick` fonction membre sera appelée et un clic événement est déclenché, si pris en charge par le contrôle.

Cette fonction est prise en charge par le `COleControl` classe de base comme une méthode stockée, appelée DoClick. Pour plus d’informations, consultez l’article [contrôles ActiveX : Méthodes](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Appelé par l’infrastructure lors du chargement ou de stocker un contrôle à partir d’une représentation sous forme de stockage persistant, tel qu’un ensemble de flux de données ou de la propriété.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet `CPropExchange` . L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.

### <a name="remarks"></a>Notes

Cette fonction effectue normalement des appels à la **PX_** famille de fonctions pour charger ou stocker des propriétés spécifiques définies par l’utilisateur d’un contrôle OLE.

Si l’Assistant de contrôle a été utilisé pour créer le projet de contrôle OLE, la version substituée de cette fonction sérialise les propriétés stock prises en charge par `COleControl` avec un appel à la fonction de la classe de base, `COleControl::DoPropExchange`. Lorsque vous ajoutez des propriétés définies par l’utilisateur à votre contrôle OLE, vous devrez modifier cette fonction pour sérialiser vos nouvelles propriétés. Pour plus d’informations sur la sérialisation, consultez l’article [contrôles ActiveX : Sérialisation](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers le contexte de périphérique du conteneur de contrôle.

*rcBounds*<br/>
La zone dans laquelle le contrôle doit être dessiné.

### <a name="remarks"></a>Notes

Appelez cette fonction pour gérer correctement la peinture d’un contrôle OLE non active. Cette fonction doit être utilisée uniquement si le OLE contrôle sous-classe un contrôle Windows et doit être appelée le `OnDraw` fonction de votre contrôle.

Pour plus d’informations sur cette fonction et le sous-classement d’un contrôle Windows, consultez l’article [contrôles ActiveX : Sous-classement d’un contrôle Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Appelé par l’infrastructure lorsque l’apparence du contrôle doit être mis à jour.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers le contexte de périphérique.

*rc*<br/>
Zone rectangulaire à dessiner dans.

### <a name="remarks"></a>Notes

Cette fonction appelle directement la méthode `OnDraw` (fonction).

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Appelé par l’infrastructure quand le contexte de périphérique de métafichier est utilisé.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers le contexte de périphérique de métafichier.

*rc*<br/>
Zone rectangulaire à dessiner dans.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Permet la caractéristique de cadre simple pour un contrôle OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Notes

Cette caractéristique permet à un contrôle prendre en charge de la relation contenant-contenu visuel d’autres contrôles, mais n’est pas true relation contenant-contenu OLE. Un exemple serait une zone de groupe avec plusieurs contrôles à l’intérieur. Ces contrôles ne sont pas OLE contenu, mais elles se trouvent dans la même zone de groupe.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Sérialise ou initialise l’état de l’étendue du contrôle (ses dimensions en unités HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Un pointeur vers un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la fonction a réussi ; 0 dans le cas contraire.

### <a name="remarks"></a>Notes

Cette fonction est généralement appelée par l’implémentation par défaut de `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Sérialise ou initialise l’état des propriétés stock du contrôle.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Un pointeur vers un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.

### <a name="remarks"></a>Notes

Cette fonction est généralement appelée par l’implémentation par défaut de `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Sérialise ou initialise l’état d’un contrôle informations de version.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet `CPropExchange` . L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.

*dwVersionDefault*<br/>
Le numéro de version actuel du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties vers le format le plus récent lorsque enregistré ou mis à jour dans le même format que celui qui a été chargé.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro de la fonction a réussi ; 0 dans le cas contraire.

### <a name="remarks"></a>Notes

En règle générale, il s’agit de la première fonction appelée par une substitution de `COleControl::DoPropExchange`. Lors du chargement, cette fonction lit le numéro de version des données persistantes et définit l’attribut de version de la [CPropExchange](../../mfc/reference/cpropexchange-class.md) de l’objet en conséquence. Lors de l’enregistrement, cette fonction écrit le numéro de version des données persistantes.

Pour plus d’informations sur la persistance et le contrôle de version, consultez l’article [contrôles ActiveX : Sérialisation](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Appelé par le framework lorsque l’utilisateur clique sur un contrôle actif.

```
void FireClick();
```

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement Click se produise, table d’événements du contrôle doit avoir un clic événement défini.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Appelé par le framework lorsque la souris est double-clic sur un contrôle actif.

```
void FireDblClick();
```

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement de double clic se produise, table d’événements du contrôle doit avoir un événement de double clic stock défini.

##  <a name="fireerror"></a>  COleControl::FireError

Déclenche l’événement d’erreur stock.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*scode*<br/>
La valeur de code d’état soient signalés. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La description de l’erreur signalée.

*nHelpID*<br/>
L’ID d’aide de l’erreur signalée.

### <a name="remarks"></a>Notes

Cet événement offre un moyen de signalisation, à des emplacements appropriés dans votre code, qu’une erreur s’est produite au sein de votre contrôle. Contrairement à d’autres événements stock, tels que MouseMove, ou sur erreur n’est jamais déclenchée par l’infrastructure.

Pour signaler une erreur qui se produit pendant une fonction get de propriété, une fonction set de propriété ou une méthode automation, appelez [COleControl::ThrowError](#throwerror).

L’implémentation d’événement d’erreur de Stock d’un contrôle OLE utilise une valeur SCODE. Si votre contrôle utilise cet événement et est destiné à être utilisé dans Visual Basic 4.0, vous recevrez des erreurs, car la valeur SCODE n’est pas pris en charge dans Visual Basic.

Pour résoudre ce problème, modifiez manuellement le paramètre SCODE dans le contrôle. Fichier ODL pour un **long**. En outre, n’importe quel événement personnalisé, une méthode ou une propriété qui utilise un paramètre SCODE entraîne également le même problème.

##  <a name="fireevent"></a>  COleControl::FireEvent

Déclenche un événement défini par l’utilisateur à partir de votre contrôle avec un nombre quelconque d’arguments facultatifs.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’ID de dispatch de l’événement à déclencher.

*pbParams*<br/>
Un descripteur pour les types de paramètres de l’événement.

### <a name="remarks"></a>Notes

En général cette fonction ne doit pas appelée directement. Au lieu de cela, vous appellerez les fonctions de déclenchement d’événement dans la section de mappage d’événement de déclaration de classe de votre contrôle.

Le *pbParams* argument est une liste séparée par des espaces de **VTS_**. Une ou plusieurs de ces valeurs, séparées par des espaces (et non par des virgules), spécifient la liste des paramètres de la fonction. Les valeurs possibles sont les suivantes :

|Symbole|Type de paramètre|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Les constantes de type variants supplémentaires ont été définis pour tous les types variants, à l’exception VTS_FONT et VTS_PICTURE, qui fournissent un pointeur vers la constante de données variant. Ces constantes sont nommés à l’aide de la **VTS_P** `constantname` convention. Par exemple, VTS_PCOLOR est un pointeur vers un VTS_COLOR (constante).

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Appelé par le framework lorsqu’une touche est enfoncée alors que le contrôle est l’interface utilisateur active.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement KeyDown se produise, table d’événements du contrôle doit avoir un événement KeyDown stock défini.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Appelé par le framework lorsqu’une touche est relâchée alors que le contrôle personnalisé est actif de l’interface utilisateur au sein du conteneur.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de caractère de la touche enfoncée.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Le destinataire de l’événement peut modifier *pnChar*, par exemple, convertir tous les caractères minuscules en majuscules. Si vous souhaitez examiner le caractère modifié, substituez `OnKeyPressEvent`.

Pour le déclenchement automatique d’un événement KeyPress se produise, table d’événements du contrôle doit avoir un événement KeyPress stock défini.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Appelé par le framework lorsqu’une touche est relâchée pendant que le contrôle personnalisé est actif de l’interface utilisateur au sein du conteneur.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de code de touche virtuelle de la clé publiée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement KeyUp se produise, table d’événements du contrôle doit avoir un événement KeyUp stock défini.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Appelé par l’infrastructure quand un bouton de la souris est enfoncé sur un contrôle personnalisé actif.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton*<br/>
La valeur numérique du bouton de la souris est enfoncé. Il peut contenir une des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été enfoncé.

- MIDDLE_BUTTON le bouton central de la souris a été enfoncé.

- RIGHT_BUTTON le bouton droit de la souris a été enfoncé.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

*x*<br/>
Coordonnée x du curseur lorsque le bouton de la souris a été enfoncé. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y du curseur lorsque le bouton de la souris a été enfoncé. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement MouseDown se produise, table d’événements du contrôle doit avoir un événement MouseDown stock défini.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Appelé par le framework lorsque le curseur est placé sur un contrôle personnalisé actif.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton*<br/>
La valeur numérique de boutons de la souris est enfoncé. Contient une combinaison des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été enfoncé lors de l’action.

- MIDDLE_BUTTON le bouton central de la souris a été enfoncé lors de l’action.

- RIGHT_BUTTON le bouton droit de la souris a été enfoncé lors de l’action.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

*x*<br/>
Coordonnée x du curseur. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y du curseur. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement MouseMove se produise, table d’événements du contrôle doit avoir un événement MouseMove stock défini.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Appelé par le framework lorsqu’un bouton de la souris est relâché au-dessus actif d’un contrôle personnalisé.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton*<br/>
La valeur numérique de la souris du bouton. Il peut avoir l’une des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été relâché.

- MIDDLE_BUTTON le bouton central de la souris a été relâché.

- RIGHT_BUTTON le bouton droit de la souris a été relâché.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

*x*<br/>
Coordonnée x du curseur lorsqu’un bouton de la souris a été relâché. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y d’un curseur lorsqu’un bouton de la souris a été relâché. La coordonnée est par rapport à l’angle supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.

Pour le déclenchement automatique d’un événement MouseUp se produise, table d’événements du contrôle doit avoir un événement MouseUp stock défini.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Déclenche un événement avec la valeur actuelle de l’état prêt du contrôle.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Notes

L’état prêt peut prendre la valeur de l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État de l’initialisation par défaut|
|READYSTATE_LOADING|Contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Contrôle a été initialisé.|
|READYSTATE_INTERACTIVE|Contrôle a suffisamment de données de manière interactive, mais pas tous les asynchrone des données sont encore chargées|
|READYSTATE_COMPLETE|Contrôle a toutes ses données|

Utilisez [GetReadyState](#getreadystate) pour déterminer le niveau de préparation actuel du contrôle.

[InternalSetReadyState](#internalsetreadystate) modifie l’état prêt à la valeur fournie, puis appelle `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Modifie le comportement de l’activation par défaut d’un contrôle qui prend en charge la `IPointerInactive` interface.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valeur de retour

Une combinaison d’indicateurs de l’énumération POINTERINACTIVE. Indicateurs possibles sont :

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|L’objet doit être activé lorsque la souris pénètre dans pendant une opération de déplacement de la souris sur place.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|L’objet doit être désactivé lorsque la souris quitte l’objet pendant une opération de déplacement de la souris.|
|POINTERINACTIVE_ACTIVATEONDRAG|L’objet doit être activé lors de la souris est glissée pendant une opération de glissement sur place et l’opération de suppression.|

### <a name="remarks"></a>Notes

Lorsque le `IPointerInactive` interface est activée, le conteneur délègue les messages WM_SETCURSOR et WM_MOUSEMOVE à celui-ci. `COleControl`d’implémentation de cette interface distribue ces messages via la table des messages de votre contrôle, une fois que le réglage de la souris en coordonnées en conséquence.

Chaque fois que le conteneur reçoit un message WM_SETCURSOR ou WM_MOUSEMOVE alors que le pointeur de la souris sur un objet inactif prenant en charge `IPointerInactive`, elle doit appeler `GetActivationPolicy` sur l’interface et les indicateurs de retour à partir de l’énumération POINTERINACTIVE.

Vous pouvez traiter ces messages comme des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages. Dans vos gestionnaires, évitez d’utiliser le `m_hWnd` variable membre (ou toutes les fonctions membres qui l’utilise) sans d’abord vérifier que sa valeur est non NULL.

N’importe quel objet destiné à de plus de définir le curseur de souris et/ou de déclencher un événement de déplacement de la souris, tels que fournir des commentaires visuels spéciaux, doit retourner l’indicateur POINTERINACTIVE_ACTIVATEONENTRY et dessiner les commentaires uniquement lorsqu’il est actif. Si l’objet retourné cet indicateur, le conteneur doit activer sur place immédiatement et le transférer le même message qui a déclenché l’appel à `GetActivationPolicy`.

Si le POINTERINACTIVE_ACTIVATEONENTRY et POINTERINACTIVE_DEACTIVATEONLEAVE indicateurs sont retournés, l’objet sera uniquement activé lorsque la souris est positionnée sur l’objet. Si seul l’indicateur POINTERINACTIVE_ACTIVATEONENTRY est retourné, puis l’objet n’est activée une fois lorsque la souris pénètre dans l’objet.

Vous pouvez également un contrôle inactif pour être la cible d’un glisser OLE et de l’opération de suppression. Cela nécessite l’activation du contrôle au moment où que l’utilisateur fait glisser un objet positionnée sur celle-ci, afin que la fenêtre du contrôle peut être enregistrée comme une cible de dépôt. Pour que l’activation se produisent pendant une opération de glissement, retournent l’indicateur POINTERINACTIVE_ACTIVATEONDRAG :

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Les informations communiquées par `GetActivationPolicy` ne doit pas être mis en cache par un conteneur. Au lieu de cela, cette méthode doit être appelée chaque fois que la souris entre dans un objet inactif.

Si un objet inactif ne demande pas à être activé lorsque la souris pénètre il sur place, son conteneur doit distribuer les messages WM_SETCURSOR suivants à cet objet en appelant [OnInactiveSetCursor](#oninactivesetcursor) aussi longtemps que le pointeur de la souris reste sur l’objet.

L’activation de la `IPointerInactive` interface signifie généralement que vous souhaitez le contrôle doit être capable de traiter les messages de la souris en permanence. Pour obtenir ce comportement dans un conteneur qui ne prend en charge la `IPointerInactive` interface, vous devez avoir toujours activé lorsqu’elle est visible, ce qui signifie que le contrôle doit avoir l’indicateur OLEMISC_ACTIVATEWHENVISIBLE parmi ses indicateurs divers. Toutefois, pour empêcher cet indicateur de prendre effet dans un conteneur qui prend en charge `IPointerInactive`, vous pouvez également spécifier l’indicateur OLEMISC_IGNOREACTIVATEWHENVISIBLE :

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Obtient la valeur d’une propriété ambiante du conteneur.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Paramètres

*dwDispid*<br/>
L’ID de dispatch de la propriété ambiante souhaitée.

*vtProp*<br/>
Une balise de type variant qui spécifie le type de la valeur à retourner dans *pvProp*.

*pvProp*<br/>
Pointeur vers l’adresse de la variable qui recevra la valeur de propriété ou valeur de retour. Le type réel de ce pointeur doit correspondre au type spécifié par *vtProp*.

|vtProp|Type de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la propriété ambiante est pris en charge ; sinon 0.

### <a name="remarks"></a>Notes

Si vous utilisez `GetAmbientProperty` pour récupérer les propriétés ambiantes DisplayName et unités d’échelle, définissez *vtProp* sur VT_BSTR et *pvProp* à `CString*`. Si vous récupérez la propriété de police ambiante, définissez *vtProp* à VT_FONT et *pvProp* à LPFONTDISP *.

Notez que les fonctions déjà fournies pour les propriétés ambiantes courantes, telles que [AmbientBackColor](#ambientbackcolor) et [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Implémente la fonction Get de propriété Appearance du stockée de votre contrôle.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour Spécifie le paramètre d’apparence actuelle comme un **court** (VT_I2) valeur, en cas de réussite. Cette valeur est zéro si l’apparence du contrôle est plat et 1 si l’apparence du contrôle est 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Implémente la fonction Get de propriété BackColor stock de votre contrôle.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour spécifie la couleur d’arrière-plan actuelle comme une valeur de type OLE_COLOR, en cas de réussite. Cette valeur peut être traduite vers une valeur COLORREF avec un appel à `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Implémente la fonction Get de propriété BorderStyle stock de votre contrôle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valeur de retour

1 si le contrôle a une bordure normale ; 0 si le contrôle n’a aucune bordure.

##  <a name="getcapture"></a>  COleControl::GetCapture

Détermine si le `COleControl` objet possède la capture de la souris.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valeur de retour

Si le contrôle est activé et sans fenêtre, retourne **cela** si le contrôle a actuellement la souris capturer (tel que déterminé par le conteneur du contrôle), ou NULL si elle n’a pas la capture.

Sinon, retourne le `CWnd` objet qui a la capture de la souris (même en tant que `CWnd::GetCapture`).

### <a name="remarks"></a>Notes

Un contrôle sans fenêtre activé reçoit la souris lorsque capture [SetCapture](#setcapture) est appelée.

##  <a name="getclassid"></a>  COleControl::GetClassID

Appelé par l’infrastructure pour récupérer l’ID de classe du contrôle.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Paramètres

*pclsid*<br/>
Pointeur vers l’emplacement de l’ID de classe.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel n’a pas réussi ; sinon 0.

### <a name="remarks"></a>Notes

Généralement implémentée par le [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Paramètres

*pdxOffset*<br/>
Pointeur vers le décalage horizontal de la zone cliente du contrôle OLE.

*pdyOffset*<br/>
Pointeur vers le décalage vertical de la zone cliente du contrôle OLE.

### <a name="remarks"></a>Notes

Le contrôle OLE a une zone rectangulaire dans son conteneur. La zone cliente du contrôle est la zone de contrôle à l’exclusion des bordures et des barres de défilement. Le décalage est récupérée par `GetClientOffset` est la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente. Si votre contrôle a des éléments non clients autres que les bordures standards et les barres de défilement, remplacent cette fonction membre pour spécifier le décalage.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Récupère la taille de la zone cliente du contrôle.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers un `RECT` structure contenant les dimensions de la zone cliente du contrôle sans fenêtre ; autrement dit, la taille du contrôle moins les bordures de fenêtre, cadres, barres de défilement et ainsi de suite. Le *lpRect* paramètre indique la taille du rectangle de client du contrôle, pas sa position.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Interroge un objet pour le pointeur à son site client actuelle au sein de son conteneur.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers le site de client actuel du contrôle dans son conteneur.

### <a name="remarks"></a>Notes

Le pointeur retourné pointe vers une instance de `IOleClientSite`. Le `IOleClientSite` interface, implémentée par les conteneurs, est la vue de l’objet de son contexte : où elle est ancrée dans le document, où il obtient son stockage, de l’interface utilisateur et d’autres ressources.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Récupère les paramètres d’indicateur de contrôle.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valeur de retour

Une combinaison ORed des indicateurs de l’énumération ControlFlags :

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Notes

Par défaut, `GetControlFlags` retourne `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Si la valeur, utilise une peinture de begin (fonction) adaptées aux contrôles OLE au lieu du [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (valeur par défaut).|
|`clipPaintDC`|Si ce n’est pas définie, désactive l’appel à `IntersectClipRect` effectuées par `COleControl` et un gain de vitesse limité. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.|
|`pointerInactive`|Si défini, fournit l’interaction souris pendant que votre contrôle est inactif en activant `COleControl`d’implémentation de la `IPointerInactive` interface, qui est désactivé par défaut.|
|`noFlickerActivate`|Si défini, élimine le scintillement qui accompagne cet article et les opérations de dessin supplémentaires. À utiliser lorsque votre contrôle se dessine lui-même de façon identique dans des états actifs et inactifs. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.|
|`windowlessActivate`|Si défini, indique à votre contrôle utilise l’activation sans fenêtre.|
|`canOptimizeDraw`|Si défini, indique que le contrôle effectue un dessin optimisé, si le conteneur prend en charge.|

Pour plus d’informations sur `GetControlFlags` et autres optimisations des contrôles OLE, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Récupère la taille de la fenêtre de contrôle OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Paramètres

*pcx*<br/>
Spécifie la largeur du contrôle en pixels.

*pcy*<br/>
Spécifie la hauteur du contrôle en pixels.

### <a name="remarks"></a>Notes

Notez que toutes les coordonnées pour les fenêtres de contrôle sont par rapport à l’angle supérieur gauche du contrôle.

##  <a name="getdc"></a>  COleControl::GetDC

Permet un objet sans contexte de périphérique get un écran (ou compatible) de son conteneur.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Paramètres

*lprcRect*<br/>
Un pointeur vers le rectangle du contrôle sans fenêtre souhaite redessiner, dans les coordonnées clientes du contrôle. NULL signifie que l’étendue de l’objet complet.

*dwFlags*<br/>
Attributs de dessin du contexte de périphérique. Choix possibles sont :

- OLEDC_NODRAW indique que l’objet n’utilisons pas le contexte de périphérique pour effectuer aucun dessin, mais simplement pour obtenir des informations sur le périphérique d’affichage. Le conteneur doit simplement transmettre le contrôleur de domaine de la fenêtre sans traitement supplémentaire.

- Demandes de OLEDC_PAINTBKGND que le conteneur peindre l’arrière-plan avant de retourner le contrôleur de domaine. Un objet doit utiliser cet indicateur si elle demande un contrôleur de domaine du redessin une zone avec un arrière-plan transparent.

- OLEDC_OFFSCREEN informe le conteneur que l’objet souhaite effectuer le rendu dans une bitmap hors écran doit ensuite être copiée sur l’écran. Un objet doit utiliser cet indicateur lorsqu’il est sur le point d’effectuer l’opération de dessin génère un grand nombre de scintillement. Le conteneur est libre d’honorer cette demande ou non. Toutefois, si cet indicateur n’est pas défini, le conteneur doit obtenir un à l’écran contrôleur de domaine. Cela permet aux objets effectuer des opérations d’écran direct comme montrant une sélection (via un **XOR** opération).

### <a name="return-value"></a>Valeur de retour

Pointeur vers le contexte de périphérique d’affichage pour le conteneur `CWnd` zone cliente si réussi ; sinon, la valeur de retour est NULL. Le contexte de périphérique d’affichage peut être utilisé dans les fonctions GDI suivantes pour dessiner dans la zone cliente de la fenêtre du conteneur.

### <a name="remarks"></a>Notes

Le [ReleaseDC](#releasedc) fonction membre doit être appelée pour libérer le contexte après la peinture. Lors de l’appel `GetDC`, les objets passent le rectangle qu’ils souhaitent dessiner dans leurs propres les coordonnées clientes. `GetDC` traduit ces coordonnées de la zone cliente de conteneur. L’objet ne doit pas demander un rectangle de dessin souhaité supérieur à sa propre rectangle de zone client, dont la taille peut être récupérée avec [GetClientRect](#getclientrect). Cela empêche les objets par inadvertance de dessin où ils ne devraient pas.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Implémente la fonction Get de stock de votre contrôle propriété Enabled.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle est activé ; sinon 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Obtient un pointeur vers un objet géré par le conteneur qui représente le contrôle à un ensemble étendu de propriétés.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers le conteneur étendus d’un objet de contrôle. Si aucun objet n’est disponible, la valeur est NULL.

Cet objet peut être manipulé via son `IDispatch` interface. Vous pouvez également utiliser `QueryInterface` pour obtenir d’autres interfaces disponibles fournies par l’objet. Toutefois, l’objet n’est pas nécessaire pour prendre en charge un ensemble spécifique d’interfaces. Notez que sur les fonctionnalités spécifiques de l’objet de contrôle étendu d’un conteneur de partie de confiance limite la portabilité de votre contrôle vers d’autres conteneurs arbitraires.

### <a name="remarks"></a>Notes

La fonction qui appelle cette fonction est chargée de libérer le pointeur lorsque terminé avec l’objet. Notez que le conteneur n’est pas nécessaire pour prendre en charge de cet objet.

##  <a name="getfocus"></a>  COleControl::GetFocus

Détermine si le `COleControl` objet a le focus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valeur de retour

Si le contrôle est activé et sans fenêtre, retourne **cela** si le contrôle a actuellement le clavier concentrer (tel que déterminé par le conteneur du contrôle), ou NULL si elle n’a pas le focus.

Sinon, retourne le `CWnd` objet qui a le focus (même en tant que `CWnd::GetFocus`).

### <a name="remarks"></a>Notes

Un contrôle sans fenêtre activé reçoit le focus lorsque [SetFocus](#setfocus) est appelée.

##  <a name="getfont"></a>  COleControl::GetFont

Implémente la fonction Get de la propriété stock Font.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’interface de dispatch de police de propriété stock du contrôle Font.

### <a name="remarks"></a>Notes

Notez que l’appelant doit libérer l’objet une fois. Dans l’implémentation du contrôle, utilisez `InternalGetFont` pour accéder à l’objet du contrôle stock police. Pour plus d’informations sur l’utilisation des polices dans votre contrôle, consultez l’article [contrôles ActiveX : Utilisation des polices dans un contrôle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Des mesures pour toutes les mesures de texte `CFontHolder` objet détenu par le contrôle.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*lptm*<br/>
Pointeur vers un [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) structure.

*fontHolder*<br/>
Référence à un [CFontHolder](../../mfc/reference/cfontholder-class.md) objet.

### <a name="remarks"></a>Notes

Une telle police peut être sélectionnée avec le [COleControl::SelectFontObject](#selectfontobject) (fonction). `GetFontTextMetrics` initialisera le `TEXTMETRIC` structure vers laquelle pointe *lptm* avec des informations de mesures valides sur `fontHolder`de police en cas de réussite, ou remplir la structure avec des zéros en cas d’échec. Vous devez utiliser cette fonction au lieu de [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) lorsque la peinture de votre contrôle, car les contrôles, comme les incorporant OLE, peuvent être requises pour s’afficher dans un métafichier.

Le `TEXTMETRIC` structure pour la police par défaut est actualisé lorsque le [SelectFontObject](#selectfontobject) fonction est appelée. Vous devez appeler `GetFontTextMetrics` uniquement une fois que la propriété stock Font pour vous assurer qu’il fournit des informations de la sélection est valide.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Implémente la fonction Get de la propriété ForeColor stockée.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour spécifie la couleur de premier plan actuelle comme une valeur de type OLE_COLOR, en cas de réussite. Cette valeur peut être traduite vers un [COLORREF](/windows/desktop/gdi/colorref) valeur avec un appel à `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Implémente la fonction Get de la propriété stock hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valeur de retour

Handle de fenêtre du contrôle OLE, le cas échéant ; Sinon, NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Appelé par l’infrastructure pour obtenir une chaîne courte qui décrit l’objectif de l’élément de menu identifiée par *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Un ID d’élément de menu.

*rMessage*<br/>
Une référence à un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objet via lequel une chaîne est retournée.

### <a name="remarks"></a>Notes

Cela peut servir à obtenir un message à afficher dans une barre d’état, l’élément de menu est en surbrillance. L’implémentation par défaut tente de charger une ressource de chaîne identifiée par *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Empêche l’accès à la valeur de la propriété d’un contrôle par l’utilisateur.

```
void GetNotSupported();
```

### <a name="remarks"></a>Notes

Appelez cette fonction à la place de la fonction Get de n’importe quelle propriété où la récupération de la propriété par l’utilisateur du contrôle n’est pas pris en charge. Un exemple serait une propriété qui est en écriture uniquement.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Retourne l’état de préparation du contrôle.

```
long GetReadyState();
```

### <a name="return-value"></a>Valeur de retour

État de préparation du contrôle, une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État de l’initialisation par défaut|
|READYSTATE_LOADING|Contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Contrôle a été initialisé.|
|READYSTATE_INTERACTIVE|Contrôle a suffisamment de données de manière interactive, mais pas tous les asynchrone des données sont encore chargées|
|READYSTATE_COMPLETE|Contrôle a toutes ses données|

### <a name="remarks"></a>Notes

La plupart des contrôles simples a jamais besoin de faire la distinction entre LOADED et INTERACTIVE. Toutefois, les contrôles qui prennent en charge les propriétés de chemin d’accès de données peut-être pas prêts à être interactif jusqu'à la réception d’au moins certaines données de façon asynchrone. Un contrôle doit tenter de devenir interactive dès que possible.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Obtient les coordonnées du rectangle du contrôle relatifs au conteneur, exprimé en unités de périphérique.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers la structure rectangle dans lequel les coordonnées du contrôle seront copiées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle est actif en place ; sinon 0.

### <a name="remarks"></a>Notes

Le rectangle est valide uniquement si le contrôle est actif en place.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Mesure les métriques de texte pour la propriété du contrôle stockée Font, ce qui peut être sélectionnée avec le [SelectStockFont](#selectstockfont) (fonction).

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Paramètres

*lptm*<br/>
Un pointeur vers un [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) structure.

### <a name="remarks"></a>Notes

Le `GetStockTextMetrics` fonction initialisera le `TEXTMETRIC` structure vers laquelle pointe *lptm* avec les informations de métriques valide en cas de réussite, ou un remplissage la structure avec des zéros non significatifs en cas d’échec. Utilisez cette fonction au lieu de [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) lorsque la peinture de votre contrôle, car les contrôles, comme les incorporant OLE, peuvent être requises pour s’afficher dans un métafichier.

Le `TEXTMETRIC` structure pour la police par défaut est actualisé lorsque le `SelectStockFont` fonction est appelée. Vous devez appeler cette fonction uniquement après que la sélection de la police stockée afin d’assurer les informations qu’elle fournit est valide.

##  <a name="gettext"></a>  COleControl::GetText

Implémente la fonction Get de la propriété Text ou Caption stockée.

```
BSTR GetText();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la chaîne de texte de contrôle ou une chaîne de longueur nulle si aucune chaîne n’est présent.

> [!NOTE]
>  Pour plus d’informations sur le type de données BSTR, consultez [Types de données](../../mfc/reference/data-types-mfc.md) dans la section de Macros et objet Globals.

### <a name="remarks"></a>Notes

Notez que l’appelant de cette fonction doit appeler `SysFreeString` sur la chaîne retournée de gratuitement la ressource. Dans l’implémentation du contrôle, utilisez `InternalGetText` pour accéder à la propriété du contrôle stockée Text ou Caption.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Substituer `GetWindowlessDropTarget` lorsque vous souhaitez un contrôle sans fenêtre pour être la cible d’OLE opération glisser-déplacer.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’objet `IDropTarget` interface. Dans la mesure où il n’est pas une fenêtre, un objet sans fenêtre ne peut pas inscrire un `IDropTarget` interface. Toutefois, pour participer au glisser -déplacer, un objet sans fenêtre peut toujours implémenter l’interface et renvoyez-le dans `GetWindowlessDropTarget`.

### <a name="remarks"></a>Notes

Normalement, cela suppose que la fenêtre de contrôle soit stockée en tant que cible de déplacement. Mais puisque le contrôle n’a pas de fenêtre, le conteneur utilise sa propre fenêtre comme cible de dépôt. Le contrôle a simplement besoin de fournir une implémentation de la `IDropTarget` interface à laquelle le conteneur peut déléguer des appels au moment opportun. Exemple :

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Informe la classe de base de l’IID le contrôle utilise.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Paramètres

*piidPrimary*<br/>
Pointeur vers l’ID de l’interface de dispatch principale du contrôle.

*piidEvents*<br/>
Pointeur vers l’ID de l’interface d’événement du contrôle.

### <a name="remarks"></a>Notes

Appelez cette fonction dans le constructeur du contrôle pour informer la classe de base de l’interface ID utiliseront votre contrôle.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Accède à la propriété stock Font de votre contrôle

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valeur de retour

Une référence à un [CFontHolder](../../mfc/reference/cfontholder-class.md) objet qui contient l’objet de police de stock.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Accède à la propriété Text ou Caption stock de votre contrôle.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valeur de retour

Une référence à la chaîne de texte du contrôle.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Définit l’état de préparation du contrôle.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Paramètres

*lNewReadyState*<br/>
L’état de préparation à définir pour le contrôle, une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État de l’initialisation par défaut|
|READYSTATE_LOADING|Contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Contrôle a été initialisé.|
|READYSTATE_INTERACTIVE|Contrôle a suffisamment de données de manière interactive, mais pas tous les asynchrone des données sont encore chargées|
|READYSTATE_COMPLETE|Contrôle a toutes ses données|

### <a name="remarks"></a>Notes

La plupart des contrôles simples a jamais besoin de faire la distinction entre LOADED et INTERACTIVE. Toutefois, les contrôles qui prennent en charge les propriétés de chemin d’accès de données peut-être pas prêts à être interactif jusqu'à la réception d’au moins certaines données de façon asynchrone. Un contrôle doit tenter de devenir interactive dès que possible.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Force le contrôle à redessiner.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers la région du contrôle à invalider.

*bErase*<br/>
Spécifie si l’arrière-plan dans la région de mise à jour est le point d’être effacé lors du traitement de la région de mise à jour.

### <a name="remarks"></a>Notes

Si *lpRect* a une valeur NULL, l’ensemble du contrôle est redessiné. Si *lpRect* n’est pas NULL, cela indique la partie du rectangle du contrôle qui doit être invalidée. Dans le cas où le contrôle n’a aucune fenêtre, ou n’est pas actif actuellement, le rectangle est ignoré et un appel est effectué sur le site client [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) fonction membre. Utilisez cette fonction au lieu de `CWnd::InvalidateRect` ou `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Invalide la zone cliente de la fenêtre conteneur dans la région donnée.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*pRgn*<br/>
Un pointeur vers un [CRgn](../../mfc/reference/crgn-class.md) objet qui identifie la zone d’affichage de l’objet OLE à invalider, dans les coordonnées clientes de la fenêtre conteneur. Si ce paramètre est NULL, l’étendue est l’objet entier.

*bErase*<br/>
Spécifie si l’arrière-plan dans la région rendue non valide est le point d’être effacé. Si la valeur est TRUE, l’arrière-plan est effacé. Si la valeur est FALSE, l’arrière-plan reste inchangé.

### <a name="remarks"></a>Notes

Cela peut servir à redessiner les contrôles sans fenêtre au sein du conteneur. La région invalidée, ainsi que toutes les autres zones dans la région de mise à jour, est marquée pour la peinture lorsque la prochaine [WM_PAINT](/windows/desktop/gdi/wm-paint) message est envoyé.

Si *bErase* a la valeur TRUE pour n’importe quelle partie de la région de mise à jour, l’arrière-plan de la région entière, pas seulement dans la partie spécifiée, est effacée.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Autorise spécialisé de chargement d’un contrôle OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle en cours de conversion ; sinon 0.

### <a name="remarks"></a>Notes

Lors de la conversion d’un formulaire qui utilise VBX des contrôles pour qu’il utilise des contrôles OLE, le code de chargement spéciale pour les contrôles OLE peut être nécessaire. Par exemple, si vous chargez une instance de votre contrôle OLE, vous pouvez avoir un appel à [PX_Font](persistence-of-ole-controls.md#px_font) dans votre `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Toutefois, les contrôles VBX n’ont pas un objet de police ; chaque propriété de la police a été enregistrée individuellement. Dans ce cas, vous utiliseriez `IsConvertingVBX` faire la distinction entre ces deux cas :

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Un autre cas serait si votre contrôle VBX enregistré des données binaires propriétaires (dans son gestionnaire de messages VBM_SAVEPROPERTY) et votre contrôle OLE enregistre ses données binaires dans un format différent. Si vous souhaitez que votre contrôle OLE à compatibilité descendante avec le contrôle VBX, vous pouvez lire les deux formats anciens et nouveaux à l’aide de la `IsConvertingVBX` fonction en distinguant si le contrôle VBX ou le contrôle OLE a été chargé.

Dans de votre contrôle `DoPropExchange` (fonction), vous pouvez vérifier cette condition et si la valeur est true, exécuter du code de charge spécifique pour cette conversion (par exemple, les exemples précédents). Si le contrôle n’est pas converti, vous pouvez exécuter le code d’une charge normale. Cette possibilité s’applique uniquement aux contrôles en cours de conversion à partir de leurs équivalents VBX.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Permet l’appel de méthode automation.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle a été initialisé ; sinon 0.

### <a name="remarks"></a>Notes

Implémentation de l’infrastructure de `IDispatch::Invoke` appels `IsInvokeAllowed` pour déterminer si une fonction donnée (identifié par `dispid`) peuvent être appelées. Le comportement par défaut pour un contrôle OLE consiste à autoriser les méthodes automation d’être appelée uniquement si le contrôle a été initialisé ; Toutefois, `IsInvokeAllowed` est une fonction virtuelle et ne peut être remplacée si nécessaire (par exemple, lorsque le contrôle est utilisé en tant que serveur automation).

##  <a name="ismodified"></a>  COleControl::IsModified

Détermine si l’état du contrôle a été modifiée.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’état du contrôle a été modifié depuis son dernier enregistrement ; sinon 0.

### <a name="remarks"></a>Notes

L’état d’un contrôle est modifié lorsqu’une propriété change de valeur.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Détermine si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valeur de retour

TRUE si le conteneur prend en charge le dessin optimisé pour l’opération de dessin actuelle ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Si le dessin optimisé est pris en charge, puis le contrôle devez sélectionnez pas anciens objets (stylets, pinceaux, polices, etc.) dans le contexte de périphérique lorsque le dessin est terminé.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Appelé par l’infrastructure pour déterminer si le contrôle sous-classe un Windows contrôle.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le contrôle est une sous-classe ; sinon 0.

### <a name="remarks"></a>Notes

Vous devez substituer cette fonction et retourner la valeur TRUE si votre OLE contrôle sous-classe un contrôle Windows.

##  <a name="load"></a>  COleControl::Load

Réinitialise les données précédentes chargées de façon asynchrone et lance un nouveau chargement de la propriété du contrôle asynchrone.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Paramètres

*strNewPath*<br/>
Un pointeur vers une chaîne contenant le chemin d’accès qui fait référence à l’emplacement absolu de la propriété de contrôle asynchrone.

*prop*<br/>
Un [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) objet qui implémente une propriété de contrôle asynchrone.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Empêche le conteneur de la désactivation de votre contrôle.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Paramètres

*bLock*<br/>
TRUE si l’état actif sur place du contrôle doit être verrouillée ; FALSE s’il doit être déverrouillé.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le verrou a réussi ; sinon 0.

### <a name="remarks"></a>Notes

Notez que chaque verrouillage du contrôle doit être associé un déverrouillage du contrôle une fois. Vous devez uniquement verrouiller votre contrôle sur de courtes périodes, telles que lors de l’activation d’un événement.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Appelé par le framework lorsqu’une propriété ambiante du conteneur a changé de valeur.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispID*<br/>
L’ID de dispatch de la propriété ambiante qui a changé, ou DISPID_UNKNOWN si plusieurs propriétés ont été modifiées.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Appelé par le framework lorsque la valeur de propriété stockée apparence a été modifiée.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez notification après cette propriété change. L’implémentation par défaut appelle `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Appelé par le framework lorsque la valeur de propriété BackColor stockée a été modifiée.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez notification après cette propriété change. L’implémentation par défaut appelle `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Appelé par le framework lorsque la valeur de propriété BorderStyle stockée a été modifiée.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle `InvalidateControl`.

Remplacez cette fonction si vous souhaitez notification après cette propriété change.

##  <a name="onclick"></a>  COleControl::OnClick

Appelé par l’infrastructure quand un bouton de la souris a été cliqué ou la méthode stock DoClick a été appelée.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Paramètres

*iButton*<br/>
Index d’un bouton de la souris. Peut avoir l’une des valeurs suivantes :

- LEFT_BUTTON l’utilisateur a cliqué sur le bouton gauche de la souris.

- MIDDLE_BUTTON l’utilisateur a cliqué sur le bouton central de la souris.

- RIGHT_BUTTON l’utilisateur a cliqué sur le bouton droit de la souris.

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle `COleControl::FireClick`.

Remplacez cette fonction membre pour modifier ou étendre la gestion par défaut.

##  <a name="onclose"></a>  COleControl::OnClose

Appelé par le framework lorsque le conteneur a appelé le contrôle `IOleControl::Close` (fonction).

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Paramètres

*dwSaveOption*<br/>
Indicateur qui indique si l’objet doit être enregistré avant le chargement. Les valeurs valides sont les suivantes :

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Notes

Par défaut, `OnClose` enregistre l’objet de contrôle s’il a été modifié et *dwSaveOption* est OLECLOSE_SAVEIFDIRTY ou OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Appelé par le framework lorsque le conteneur appelle le `IOleObject::DoVerb` fonction membre.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*iVerb*<br/>
L’index du verbe de contrôle à appeler.

*lpMsg*<br/>
Pointeur vers le message Windows qui a provoqué le verbe à appeler.

*hWndParent*<br/>
Handle vers la fenêtre parente du contrôle. Si l’exécution du verbe crée une fenêtre (ou windows), *hWndParent* doit être utilisé comme parent.

*lpRect*<br/>
Un pointeur vers une structure RECT dans lequel les coordonnées du contrôle, relatifs au conteneur, seront copiées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel a réussi ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut utilise les entrées de mappage de message ON_OLEVERB et ON_STDOLEVERB pour déterminer la fonction à appeler.

Remplacez cette fonction pour modifier la gestion par défaut du verbe.

##  <a name="ondraw"></a>  COleControl::OnDraw

Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié en utilisant le contexte de périphérique spécifié.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de périphérique dans lequel le dessin se produit.

*rcBounds*<br/>
La zone rectangulaire du contrôle, y compris la bordure.

*rcInvalid*<br/>
La zone rectangulaire du contrôle qui n’est pas valide.

### <a name="remarks"></a>Notes

`OnDraw` est généralement appelée pour afficher l’écran, en passant un contexte de périphérique en tant que *pDC*. Le *rcBounds* paramètre identifie le rectangle dans le contexte de périphérique cible (par rapport à son mode de mappage en cours). Le *rcInvalid* paramètre est le rectangle réel qui n’est pas valide. Dans certains cas il s’agit d’une plus petite zone que *rcBounds*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié en utilisant le contexte de périphérique de métafichier spécifié.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de périphérique dans lequel le dessin se produit.

*rcBounds*<br/>
La zone rectangulaire du contrôle, y compris la bordure.

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle la [OnDraw](#ondraw) (fonction).

##  <a name="onedit"></a>  COleControl::OnEdit

Force le contrôle à être activée UI.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Pointeur vers le message Windows qui a appelé le verbe.

*hWndParent*<br/>
Handle vers la fenêtre parente du contrôle.

*lpRect*<br/>
Un pointeur vers le rectangle utilisé par le contrôle dans le conteneur.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel a réussi ; sinon 0.

### <a name="remarks"></a>Notes

Cela a le même effet que l’appel de verbe OLEIVERB_UIACTIVATE du contrôle.

Cette fonction est généralement utilisée en tant que la fonction de gestionnaire pour une entrée de mappage de message ON_OLEVERB. Cela rend un verbe « Modifier » disponibles sur le menu du contrôle « Objet ». Exemple :

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Appelé par le framework lorsque le stock de valeur de la propriété Enabled a été modifiée.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez notification après cette propriété change. L’implémentation par défaut appelle [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Appelé par le framework lorsque le conteneur appelle le `IOleObject::EnumVerbs` fonction membre.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Paramètres

*ppenumOleVerb*<br/>
Un pointeur vers le `IEnumOLEVERB` objet qui énumère les verbes du contrôle.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si les verbes sont disponibles ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut énumère les entrées ON_OLEVERB dans la table des messages.

Remplacez cette fonction pour modifier le mode par défaut de l’énumération des verbes.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Appelé par l’infrastructure quand un gestionnaire d’événements est connecté à ou déconnecté d’un contrôle OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Paramètres

*bAdvise*<br/>
TRUE indique qu’un gestionnaire d’événements a été connecté au contrôle. La valeur FALSE indique qu’un gestionnaire d’événements a été déconnecté à partir du contrôle.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Appelé par le framework lorsque la valeur de propriété de police stockée a été modifiée.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle `COleControl::InvalidateControl`. Si le contrôle sous-classe un contrôle Windows, l’implémentation par défaut envoie également un message WM_SETFONT à la fenêtre du contrôle.

Remplacez cette fonction si vous souhaitez notification après cette propriété change.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Appelé par le framework lorsque la valeur de propriété ForeColor stockée a été modifiée.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle `InvalidateControl`.

Remplacez cette fonction si vous souhaitez notification après cette propriété change.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Appelé par l’infrastructure après les appels de conteneur `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Paramètres

*bFreeze*<br/>
TRUE si du contrôle gestion des événements sont figée ; Sinon, FALSE.

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération.

Remplacez cette fonction si vous souhaitez un comportement supplémentaire lors de la gestion des événements sont figée ou non figée.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Appelé par le framework lorsque le conteneur appelle le `IViewObject::GetColorSet` fonction membre.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Paramètres

*ptd*<br/>
Pointe vers le périphérique cible pour lequel l’image doit être restitué. Si cette valeur est NULL, l’image doit être restitué pour un appareil cible par défaut, généralement un périphérique d’affichage.

*hicTargetDev*<br/>
Spécifie le contexte d’informations sur le périphérique cible indiqué par *ptd*. Ce paramètre peut être un contexte de périphérique, mais il ne fait pas partie nécessairement. Si *ptd* est NULL, *hicTargetDev* doit également être NULL.

*ppColorSet*<br/>
Pointeur vers l’emplacement dans lequel le jeu de couleurs qui serait utilisé doit être copié. Si la fonction ne retourne pas le jeu de couleurs, la valeur NULL est retournée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un jeu de couleurs valide est retourné ; sinon 0.

### <a name="remarks"></a>Notes

Le conteneur appelle cette fonction pour obtenir toutes les couleurs nécessaires pour dessiner le contrôle OLE. Le conteneur peut utiliser les jeux de couleur obtenues en conjonction avec les couleurs, qu'il doit définir la palette de couleurs globale. L’implémentation par défaut retourne FALSE.

Remplacez cette fonction pour effectuer tout traitement spécial de cette demande.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Appelé par le framework lorsque le conteneur du contrôle a demandé des informations sur le contrôle.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Paramètres

*pControlInfo*<br/>
Pointeur vers un [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) structure doit être renseigné.

### <a name="remarks"></a>Notes

Ces informations se composent principalement d’une description des touches mnémoniques du contrôle. L’implémentation par défaut se remplit *pControlInfo* avec les informations par défaut.

Remplacez cette fonction si votre contrôle doit traiter des touches mnémoniques.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Appelé par l’infrastructure pour obtenir une chaîne qui représente la valeur actuelle de la propriété identifiée par *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*strValue*<br/>
Une référence à un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objet via lequel une chaîne est retournée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une chaîne a été retournée dans *strValue ;* sinon 0.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a une propriété dont la valeur ne peut pas être directement convertie en une chaîne et que valeur de la propriété à afficher dans un Explorateur de propriétés fourni par conteneur.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Appelé par le framework lorsque le contrôle est activée pour obtenir le menu à fusionner dans le menu du conteneur existant UI.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valeur de retour

Handle de menu du contrôle, ou NULL si le contrôle n’a aucun. L’implémentation par défaut retourne la valeur NULL.

### <a name="remarks"></a>Notes

Pour plus d’informations sur la fusion des ressources OLE, consultez l’article [Menus et ressources (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Appelé par l’infrastructure en réponse à d’un conteneur `IViewObjectEx::GetNaturalExtent` demande.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Représentations contiennent du contenu, une icône, une miniature ou un document imprimé. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*lindex*<br/>
La partie de l’objet qui présente un intérêt. Actuellement, seuls -1 est valide.

*ptd*<br/>
Pointe vers le [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) structure définissant le périphérique cible pour lequel la taille de l’objet doit être retournée.

*hicTargetDev*<br/>
Spécifie le contexte d’informations pour le périphérique cible indiqué par le *ptd* paramètre à partir duquel l’objet peut extraire les métriques du périphérique et tester les fonctions du périphérique. Si *ptd* est NULL, l’objet doit ignorer la valeur dans le *hicTargetDev* paramètre.

*pExtentInfo*<br/>
Pointe vers le `DVEXTENTINFO` structure qui spécifie les données de dimensionnement. Le `DVEXTENTINFO` structure est :

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Le membre de structure `dwExtentMode` peut prendre une des deux valeurs :

- DVEXTENT_CONTENT Inquire big comment le contrôle doit être à exactement adapter au contenu (composant logiciel enfichable à la taille)

- DVEXTENT_INTEGRAL lors du redimensionnement, taille proposée de passer au contrôle

*psizel*<br/>
Points à dimensionner les données retournées par le contrôle. Les données de dimensionnement retournée sont définies sur -1 pour n’importe quelle dimension qui n’était pas ajustée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si elle retourne correctement ou que vous ajuste la taille ; sinon 0.

### <a name="remarks"></a>Notes

Remplacez cette fonction pour retourner la taille d’affichage de l’objet le plus proche pour le mode de taille et l’étendue proposé dans le `DVEXTENTINFO` structure. L’implémentation par défaut retourne la valeur FALSE et aucun ajuste à la taille.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Appelé par l’infrastructure pour obtenir un ensemble de chaînes prédéfinis représentant les valeurs possibles pour une propriété.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*pStringArray*<br/>
Un tableau de chaînes doivent être remplis avec les valeurs de retour.

*pCookieArray*<br/>
Un tableau DWORD doit être remplie avec les valeurs de retour.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si les éléments ont été ajoutés au *pStringArray* et *pCookieArray*.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a une propriété avec un ensemble de valeurs possibles qui peuvent être représentés par des chaînes. Pour chaque élément ajouté à *pStringArray*, vous devez ajouter un élément « cookie » correspondant à *pCookieArray.* Ces valeurs de « cookie » peuvent être passés ultérieurement par l’infrastructure pour le `COleControl::OnGetPredefinedValue` (fonction).

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Appelé par l’infrastructure pour obtenir la valeur correspondant à une des chaînes prédéfinies précédemment retournés par une substitution de `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*dwCookie*<br/>
Une valeur de cookie retournée précédemment par un remplacement de `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Pointeur vers un `VARIANT` structure via laquelle une valeur de propriété sera retournée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si une valeur a été retournée dans *lpvarOut*; sinon, 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Appelé par l’infrastructure en réponse à d’un conteneur [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) demande.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Paramètres

*dwDrawAspect*<br/>
DWORD qui décrit quel formulaire ou un aspect, d’un objet doit être affichée. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*lindex*<br/>
La partie de l’objet qui présente un intérêt. Actuellement, seuls -1 est valide.

*ptd*<br/>
Pointe vers le [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) structure définissant le périphérique cible pour lequel la taille de l’objet doit être retournée.

*lpsizel*<br/>
Pointe vers l’emplacement où la taille de l’objet est retournée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si les informations de mesure sont retournées avec succès ; sinon 0.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle utilise deux passes dessin et de ses parties opaques et transparents ont des dimensions différentes.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Appelé par l’infrastructure en réponse à d’un conteneur `IViewObjectEx::GetRect` demande.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
DWORD qui décrit quel formulaire ou un aspect, d’un objet doit être affichée. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2 :

- Rectangle englobant DVASPECT_CONTENT de l’objet entier. Angle supérieur gauche à l’origine et une taille égale à l’étendue retournée par l’objet `GetViewExtent` *.*

- Objets DVASPECT_OPAQUE avec une zone rectangulaire opaque retourner ce rectangle. Que d’autres échoue.

- Rectangle DVASPECT_TRANSPARENT couvrant toutes les parties transparentes ou irréguliers.

*pRect*<br/>
Pointe vers le [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) structure qui spécifie le rectangle dans lequel l’objet doit être dessiné. Ce paramètre contrôle le positionnement et l’étirement de l’objet.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le rectangle dimensionnée en fonction de l’objet est retourné avec succès ; sinon 0.

### <a name="remarks"></a>Notes

Taille de l’objet est convertie en `OnGetViewRect` dans un rectangle en commençant à une position spécifique (la valeur par défaut est le coin supérieur gauche de l’affichage). Remplacez cette fonction si votre contrôle utilise deux passes dessin et de ses parties opaques et transparents ont des dimensions différentes.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Appelé par l’infrastructure en réponse à d’un conteneur `IViewObjectEx::GetViewStatus` demande.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valeur de retour

Une des valeurs de l’énumération de double en cas de réussite ; sinon 0. Les valeurs possibles sont n’importe quelle combinaison des éléments suivants :

|||
|-|-|
|VIEWSTATUS_OPAQUE|L’objet est complètement opaque. Si ce bit n’est pas défini, l’objet contient les parties transparentes. Ce bit s’applique uniquement pour les aspects liés au contenu et pas DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Objet a un arrière-plan uni (composé dans une couleur unie, pas un motif de pinceau). Ce bit est significatif uniquement si VIEWSTATUS_OPAQUE est définie et s’applique uniquement pour les aspects liés au contenu et pas DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Objet prend en charge DVASPECT_OPAQUE. Toutes les méthodes IViewObjectEx qui prennent un aspect de dessin comme un paramètre peut être appelé avec cet aspect.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Objet prend en charge DVASPECT_TRANSPARENT. Tous les `IViewObjectEx` méthodes qui prennent un aspect de dessin comme un paramètre peut être appelé avec cet aspect.|

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle utilise le dessin en deux temps. L’implémentation par défaut retourne VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Appelé par le framework lorsque le contrôle est l’interface utilisateur désactivée.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Notes

L’implémentation doit masquer toutes les barres d’outils affichées par `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Appelé par le conteneur pour l’objet situé sous le pointeur de la souris sur la réception d’un message WM_MOUSEMOVE inactif.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
L’objet englobant le rectangle, en coordonnées clientes de la fenêtre conteneur. Indique à l’objet sa position exacte et la taille à l’écran lorsque le message WM_MOUSEMOVE a été reçu.

*x*<br/>
Coordonnée x de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*y*<br/>
Coordonnée y de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*dwKeyState*<br/>
Identifie l’état actuel des touches de modification de clavier sur le clavier. Les valeurs valides peuvent être une combinaison quelconque des indicateurs MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON et MK_RBUTTON.

### <a name="remarks"></a>Notes

Notez que les coordonnées clientes de fenêtre (pixels) sont utilisées pour transmettre la position du curseur de la souris. Cela est possible en passant également le rectangle englobant de l’objet dans le même système de coordonnées.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Appelé par le conteneur pour l’objet situé sous le pointeur de la souris sur la réception d’un message WM_SETCURSOR inactif.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
L’objet englobant le rectangle, en coordonnées clientes de la fenêtre conteneur. Indique à l’objet sa position exacte et la taille à l’écran lorsque le message WM_SETCURSOR a été reçu.

*x*<br/>
Coordonnée x de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*y*<br/>
Coordonnée y de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*dwMouseMsg*<br/>
L’identificateur du message de la souris pour lequel un WM_SETCURSOR s’est produite.

*bSetAlways*<br/>
Spécifie si l’objet doit définir le curseur. Si la valeur est TRUE, l’objet doit définir le curseur ; Si la valeur est FALSE, le curseur n’est pas tenu de définir le curseur et doit retourner S_FALSE dans ce cas.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Notez que les coordonnées clientes de fenêtre (pixels) sont utilisées pour transmettre la position du curseur de la souris. Cela est possible en passant également le rectangle englobant de l’objet dans le même système de coordonnées.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Appelé par l’infrastructure après qu’un événement KeyDown stock a été traité.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
La valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations de clé une fois que l’événement a été déclenché.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Appelé par l’infrastructure après le stock événement KeyPress a été déclenché.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
Contient la valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h

### <a name="remarks"></a>Notes

Notez que le *nChar* valeur ont été modifiée par le conteneur.

Remplacez cette fonction si vous souhaitez une notification une fois que cet événement se produit.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Appelé par l’infrastructure après qu’un événement KeyDown stock a été traité.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
La valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- Touche MAJ de The SHIFT_MASK a été activée lors de l’action.

- Touche CTRL le CTRL_MASK a été enfoncé lors de l’action.

- Lors de l’action a été appuyé sur ALT le ALT_MASK.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations de clé une fois que l’événement a été déclenché.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Appelé par l’infrastructure pour obtenir l’ID de classe d’une page de propriétés qui implémente la modification de la propriété spécifiée.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*lpclsid*<br/>
Pointeur vers un `CLSID` structure via lequel un ID de classe sera retourné.

*pbPageOptional*<br/>
Retourne un indicateur de non utilisation de la page de propriété spécifiée est facultative.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un ID de classe a été retourné dans *lpclsid*; sinon, 0.

### <a name="remarks"></a>Notes

Remplacez cette fonction pour fournir un moyen d’appeler des pages de propriétés de votre contrôle à partir de l’Explorateur de propriétés du conteneur.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Appelé par le framework lorsque le conteneur a détecté qu’une touche mnémonique du contrôle OLE a été enfoncée.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Paramètres

*pMsg*<br/>
Pointeur vers le message Windows généré par une pression sur une touche mnémonique.

##  <a name="onproperties"></a>  COleControl::OnProperties

Appelé par le framework lorsque le verbe de propriétés du contrôle a été appelée par le conteneur.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Pointeur vers le message Windows qui a appelé le verbe.

*hWndParent*<br/>
Handle vers la fenêtre parente du contrôle.

*lpRect*<br/>
Un pointeur vers le rectangle utilisé par le contrôle dans le conteneur.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel a réussi ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut affiche une boîte de dialogue de propriétés modale.

Vous pouvez également utiliser cette fonction pour provoquer l’affichage des pages de propriétés de votre contrôle. Effectuez un appel à la `OnProperties` fonction, en passant le handle du parent de votre contrôle dans le *hWndParent* paramètre. Dans ce cas, les valeurs de la *lpMsg* et *lpRect* paramètres sont ignorés.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Appelé par l’infrastructure en réponse à d’un conteneur `IViewObjectEx::QueryHitPoint` demande.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la façon dont l’objet est représenté. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Pointeur vers un `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.

*ptlLoc*<br/>
Pointeur vers le `POINT` qui spécifie le point à vérifier pour effectuer un test de structure. Le point est spécifié dans les coordonnées de la zone client OLE.

*lCloseHint*<br/>
La distance qui définit « fermer » pour le point activée pour effectuer un test.

*pHitResult*<br/>
Pointeur désignant le résultat de la requête d’accès. Une des valeurs suivantes :

- HITRESULT_OUTSIDE *ptlLoc* est en dehors de l’OLE de l’objet et ne fermez pas.

- HITRESULT_TRANSPARENT *ptlLoc* est dans les limites de l’objet OLE, mais pas proche de l’image. Par exemple, un point au milieu d’un cercle transparent peut être HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* est à l’intérieur ou à l’extérieur de l’objet OLE, mais suffisamment près à l’objet à prendre en compte à l’intérieur. Les objets de petites, fines ou détaillées peuvent utiliser cette valeur. Même si un point se trouve en dehors du cadre englobant le rectangle d’un objet, il peut néanmoins être proche (Ceci est nécessaire pour atteindre les petits objets).

- HITRESULT_HIT *ptlLoc* se trouve dans l’image de l’objet.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un résultat de recherche est retourné avec succès ; sinon 0. D’un accès est un chevauchement avec la zone d’affichage de contrôle OLE.

### <a name="remarks"></a>Notes

Interroge si le rectangle d’affichage d’un objet chevauche le point donné (atteint le point). `QueryHitPoint` peut être substituée pour tester le nombre d’accès à des objets non rectangulaires.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Appelé par l’infrastructure en réponse à d’un conteneur `IViewObjectEx::QueryHitRect` demande.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Pointeur vers un `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.

*prcLoc*<br/>
Pointeur vers le `RECT` structure qui spécifie le rectangle à vérifier pour effectuer un test (chevauchement avec le rectangle de l’objet), par rapport à l’angle supérieur gauche de l’objet.

*lCloseHint*<br/>
Non utilisé.

*pHitResult*<br/>
Pointeur désignant le résultat de la requête d’accès. Une des valeurs suivantes :

- HITRESULT_OUTSIDE aucun point dans le rectangle n’est atteint par l’objet OLE.

- HITRESULT_HIT au moins un point dans le rectangle serait d’atteinte sur l’objet.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un résultat de recherche est retourné avec succès ; sinon 0.

### <a name="remarks"></a>Notes

Interroge si le rectangle d’affichage d’un objet chevauche n’importe quel point dans le rectangle donné (atteint le rectangle). `QueryHitRect` peut être substituée pour tester le nombre d’accès à des objets non rectangulaires.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Appelé par l’infrastructure pour récupérer des données au format spécifié.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers le [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) structure qui spécifie le format dans lequel les informations sont demandées.

*lpStgMedium*<br/>
Pointe vers un [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) structure dans laquelle les données doit être retourné.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un été placé dans l’objet de contrôle en utilisant le [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) fonctions membres pour le rendu retardé. L’implémentation par défaut de cette fonction appelle `OnRenderFileData` ou `OnRenderGlobalData`, respectivement, si le support de stockage fourni est un fichier ou la mémoire. Si le format demandé est CF_METAFILEPICT ou le format de jeu de propriété persistante, l’implémentation par défaut restitue les données appropriées et retourne différente de zéro. Sinon, elle retourne 0 et ne fait rien.

Si *lpStgMedium -> tymed* est TYMED_NULL, le STGMEDIUM doit être alloué et rempli comme spécifié par *lpFormatEtc -> tymed*. Si ce n’est pas le cas, TYMED_NULL, le STGMEDIUM doit être rempli en place avec les données.

Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez substituer l’une des autres versions de cette fonction à la place. Si vos données soient petite et une taille fixe, substituez `OnRenderGlobalData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.

Pour plus d’informations, consultez le `FORMATETC` et `STGMEDIUM` structures dans le SDK Windows.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Appelé par l’infrastructure pour récupérer des données au format spécifié lorsque le support de stockage est un fichier.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers le [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) structure qui spécifie le format dans lequel les informations sont demandées.

*pFile*<br/>
Pointe vers un [CFile](../../mfc/reference/cfile-class.md) objet dans lequel les données doit être restitué.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un été placé dans l’objet de contrôle en utilisant le [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) fonction membre pour le rendu retardé. L’implémentation par défaut de cette fonction renvoie simplement FALSE.

Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez peut-être substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, substituez `OnRenderData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.

Pour plus d’informations, consultez le `FORMATETC` structure dans le SDK Windows.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Appelé par l’infrastructure pour récupérer des données au format spécifié lorsque le support de stockage spécifié est la mémoire globale.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers le [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) structure qui spécifie le format dans lequel les informations sont demandées.

*phGlobal*<br/>
Pointe vers un handle de mémoire globale dans lequel les données doit être retourné. Si aucune mémoire n’a été allouée, ce paramètre peut être NULL.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un été placé dans l’objet de contrôle en utilisant le [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) fonction membre pour le rendu retardé. L’implémentation par défaut de cette fonction renvoie simplement FALSE.

Si *phGlobal* est NULL, un nouveau HGLOBAL doit être alloué et retournée dans *phGlobal*. Sinon, HGLOBAL spécifié par *phGlobal* doit être rempli avec les données. La quantité de données placées dans HGLOBAL ne doit pas dépasser la taille actuelle du bloc de mémoire. En outre, le bloc ne peut pas être réaffecté à une plus grande taille.

Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, substituez `OnRenderData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.

Pour plus d’informations, consultez le `FORMATETC` structure dans le SDK Windows.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Appelé par l’infrastructure lorsque les propriétés du contrôle doivent être définies sur leurs valeurs par défaut.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle [DoPropExchange](#dopropexchange), en passant un `CPropExchange` objet qui provoque des propriétés à leurs valeurs par défaut.

L’enregistreur de contrôle peut insérer du code d’initialisation pour le contrôle OLE dans ce substituable. Cette fonction est appelée lorsque [IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) ou [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) échoue, ou [qu’IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) ou [IPersistStorage : : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) est appelée sans appeler auparavant soit `IPersistStream::Load` ou `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Appelé par le framework lorsque le conteneur a appelé le contrôle `IOleControl::SetClientSite` (fonction).

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Notes

Par défaut, `OnSetClientSite` vérifie si les propriétés de chemin d’accès de données sont chargées et, s’ils sont, appelle `DoDataPathPropExchange`.

Remplacez cette fonction pour effectuer tout traitement spécial de cette notification. En particulier, les substitutions de cette fonction doivent appeler la classe de base.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Appelé par l’infrastructure pour remplacer les données du contrôle avec les données spécifiées.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointeur vers un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) structure qui spécifie le format des données.

*lpStgMedium*<br/>
Pointeur vers un [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) structure dans lequel résident les données.

*bRelease*<br/>
TRUE si le contrôle doit libérer le support de stockage ; FALSE si le contrôle ne doit pas libérer le support de stockage.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si les données sont définies dans la propriété persistante le format, l’implémentation par défaut modifie l’état du contrôle en conséquence. Sinon, l’implémentation par défaut ne fait rien. Si *bRelease* a la valeur TRUE, un appel à `ReleaseStgMedium` est effectuée ; sinon not.

Remplacez cette fonction pour remplacer les données du contrôle avec les données spécifiées.

Pour plus d’informations, consultez le `FORMATETC` et `STGMEDIUM` structures dans le SDK Windows.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Appelé par l’infrastructure lorsque l’étendue du contrôle doit être modifiée, suite à un appel à [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Paramètres

*lpSizeL*<br/>
Un pointeur vers le `SIZEL` structure qui utilise des entiers longs pour représenter la largeur et la hauteur du contrôle, exprimé en unités HIMETRIC.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le changement de taille a été accepté ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut gère le redimensionnement de l’étendue du contrôle. Si le contrôle est actif en place, un appel à du conteneur `OnPosRectChanged` est alors effectuée.

Remplacez cette fonction pour modifier le redimensionnement par défaut de votre contrôle.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Appelé par l’infrastructure pour implémenter un appel à [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Paramètres

*lpRectPos*<br/>
Un pointeur vers un `RECT` structure indiquant la nouvelle position et la taille par rapport au conteneur du contrôle.

*lpRectClip*<br/>
Un pointeur vers un `RECT` structure indiquant une zone rectangulaire à laquelle le contrôle doit être attachée.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le repositionnement a été acceptée ; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut automatiquement gère le repositionnement et le redimensionnement de la fenêtre de contrôle et retourne la valeur TRUE.

Remplacez cette fonction pour modifier le comportement par défaut de cette fonction.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Appelé par le framework lorsque le contrôle a été activée UI.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Appelé par le framework lorsque la valeur de propriété stockée de légende ou le texte a changé.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle `InvalidateControl`.

Remplacez cette fonction si vous souhaitez notification après cette propriété change.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Appelé par l’infrastructure en réponse à d’un conteneur `IOleInPlaceObjectWindowless::OnWindowMessage` demande.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Paramètres

*msg*<br/>
Identificateur de message comme passé par Windows.

*wParam*<br/>
Passés par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur de la *msg* paramètre.

*lParam*<br/>
Passés par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur de la *msg* paramètre.

*plResult*<br/>
Code de sortie de Windows. Spécifie le résultat du traitement du message et varie selon le message envoyé.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Traite les messages de fenêtre pour les contrôles sans fenêtre. `COleControl`de `OnWindowlessMessage` doit être utilisé pour les messages de fenêtre autres que les messages de la souris et les messages de clavier. `COleControl` Fournit des [SetCapture](#setcapture) et [SetFocus](#setfocus) spécifiquement pour obtenir le focus clavier et de capture de la souris pour les objets OLE sans fenêtre.

Étant donné que les objets sans fenêtre n’ont pas d’une fenêtre, dont ils ont besoin d’un mécanisme pour permettre les conteneur répartition des messages. Un objet OLE sans Obtient des messages à partir de son conteneur, via le `OnWindowMessage` méthode sur le `IOleInPlaceObjectWindowless` interface (une extension de [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) pour la prise en charge sans fenêtre). `OnWindowMessage` ne prend pas un `HWND` paramètre.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Convertit les coordonnées de *pPoint* dans les coordonnées clientes.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. La zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement, mais pas dans la zone cliente.

*pPoint*<br/>
Pointeur vers le parent (conteneur) point sera traduite dans les coordonnées de la zone cliente du contrôle.

*bHitTest*<br/>
Spécifie si le test de positionnement est à effectuer sur le point.

### <a name="return-value"></a>Valeur de retour

Si *bHitTest* est FALSE, renvoie HTNOWHERE. Si *bHitTest* est TRUE, retourne l’emplacement dans lequel le parent (conteneur) pointent maintenant dans la zone cliente du contrôle OLE et un de la souris suivante des valeurs de test de positionnement :

- HTBORDER dans la bordure d’une fenêtre qui n’a pas d’une bordure de redimensionnement.

- HTBOTTOM dans la bordure horizontale inférieure de la fenêtre.

- HTBOTTOMLEFT dans le coin inférieur gauche de la bordure de fenêtre.

- HTBOTTOMRIGHT dans le coin inférieur droit de la bordure de fenêtre.

- HTCAPTION dans une zone de barre de titre.

- HTCLIENT dans une zone cliente.

- HTERROR sur l’arrière-plan de l’écran ou sur une ligne de démarcation entre les fenêtres (identique à HTNOWHERE sauf que le `DefWndProc` (fonction) Windows génère un signal sonore pour indiquer une erreur).

- HTGROWBOX dans une zone de taille.

- HTHSCROLL dans la barre de défilement horizontale.

- HTLEFT dans la bordure gauche de la fenêtre.

- HTMAXBUTTON dans optimiser un bouton.

- HTMENU dans une zone de menu.

- HTMINBUTTON dans réduire un bouton.

- HTNOWHERE sur l’arrière-plan de l’écran ou sur une ligne de démarcation entre les fenêtres.

- HTREDUCE dans réduire un bouton.

- HTRIGHT dans la bordure droite de la fenêtre.

- HTSIZE dans une zone de taille (identique à HTGROWBOX).

- Menu HTSYSMENU dans un contrôle ou un bouton Fermer dans une fenêtre enfant.

- HTTOP dans la bordure horizontale supérieure de la fenêtre.

- HTTOPLEFT dans le coin supérieur gauche de la bordure de fenêtre.

- HTTOPRIGHT dans le coin supérieur droit de la bordure de fenêtre.

- HTTRANSPARENT dans une fenêtre actuellement couverte par une autre fenêtre.

- HTVSCROLL dans la barre de défilement verticale.

- HTZOOM dans optimiser un bouton.

### <a name="remarks"></a>Notes

Sur l’entrée *pPoint* est relatif à l’origine du parent (coin supérieur gauche du conteneur). Lors de la sortie *pPoint* est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Informe le conteneur qu’une boîte de dialogue modale a été fermée.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Handle de la fenêtre parente de la boîte de dialogue modale.

### <a name="remarks"></a>Notes

Appelez cette fonction après avoir affiché la boîte de dialogue modale quelconque. Vous devez appeler cette fonction afin que le conteneur peut activer des fenêtres de niveau supérieur désactivées par `PreModalDialog`. Cette fonction doit être associée à un appel à `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Informe le conteneur une boîte de dialogue modale est sur le point d’être affiché.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Handle de la fenêtre parente de la boîte de dialogue modale.

### <a name="remarks"></a>Notes

Appelez cette fonction avant d’afficher une boîte de dialogue modale. Vous devez appeler cette fonction afin que le conteneur peut désactiver toutes ses fenêtres de niveau supérieur. Après avoir affiché la boîte de dialogue modale, vous devez ensuite appeler `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Supprime et recrée la fenêtre du contrôle.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Notes

Cela peut être nécessaire si vous devez modifier les bits de style de la fenêtre.

##  <a name="refresh"></a>  COleControl::Refresh

Force à repeindre du contrôle OLE.

```
void Refresh();
```

### <a name="remarks"></a>Notes

Cette fonction est prise en charge par le `COleControl` classe de base comme une méthode stockée, appelée actualisation. Cela permet aux utilisateurs de votre contrôle OLE de redessiner le contrôle à un moment donné. Pour plus d’informations sur cette méthode, consultez l’article [contrôles ActiveX : Méthodes](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Libère la capture de la souris.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si le contrôle a actuellement la capture de la souris, la capture est libérée. Sinon, cette fonction n’a aucun effet.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre, en libérant le contexte de périphérique pour une utilisation par d’autres applications.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Identifie le contexte de périphérique de conteneur doit être publié.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

L’application doit appeler `ReleaseDC` pour chaque appel à [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Définit le parent du contrôle.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Paramètres

*hWndOuter*<br/>
Handle de la fenêtre de contrôle.

*hWndParent*<br/>
Handle de la nouvelle fenêtre parente.

### <a name="remarks"></a>Notes

Appelez cette fonction pour réinitialiser le parent de la fenêtre de contrôle.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Initialise l’état de la `COleControl` boursiers propriétés à leurs valeurs par défaut.

```
void ResetStockProps();
```

### <a name="remarks"></a>Notes

Il s’agit des propriétés suivantes : Apparence, BackColor, BorderStyle, légende, activé, la police, couleur de premier plan, hWnd et texte. Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : Ajout de propriétés Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances de l’initialisation binaire d’un contrôle à l’aide de `ResetStockProps` et `ResetVersion` substituer `COleControl::OnResetState`. Lisez l'exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Initialise le numéro de version à la valeur spécifiée.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Paramètres

*dwVersionDefault*<br/>
Le numéro de version pour être assigné au contrôle.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances de l’initialisation binaire d’un contrôle à l’aide de `ResetVersion` et `ResetStockProps` substituer `COleControl::OnResetState`. Consultez l’exemple [ResetStockProps](#resetstockprops). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Permet à un objet OLE sans faire défiler une zone au sein de son image active sur place sur l’écran.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Paramètres

*xAmount*<br/>
Spécifie la quantité, en unités de périphérique, de défilement horizontal. Ce paramètre doit être une valeur négative pour faire défiler vers la gauche.

*yAmount*<br/>
Spécifie la quantité, en unités de périphérique, de défilement verticale. Ce paramètre doit être une valeur négative pour faire défiler vers le haut.

*lpRect*<br/>
Pointe vers un [CRect](../../atl-mfc-shared/reference/crect-class.md) objet ou une structure RECT qui spécifie la partie de la zone cliente de l’objet OLE à faire défiler, dans les coordonnées clientes de la fenêtre conteneur. Si *lpRect* est NULL, défile de la zone cliente de l’objet OLE entier.

*lpClipRect*<br/>
Pointe vers un `CRect` objet ou `RECT` structure qui spécifie le rectangle de découpage à. Seuls les pixels à l’intérieur du rectangle défile. Bits en dehors du rectangle ne sont pas affectées même si elles se trouvent dans le *lpRect* rectangle. Si *lpClipRect* est NULL, aucun découpage n’est effectuée sur le rectangle de défilement.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Sélectionne une police dans un contexte de périphérique.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers un objet de contexte de périphérique.

*fontHolder*<br/>
Référence à la [CFontHolder](../../mfc/reference/cfontholder-class.md) objet représentant la police doit être sélectionnée.

### <a name="return-value"></a>Valeur de retour

Pointeur vers la police sélectionnée précédemment. Lorsque l’appelant a terminé toutes les opérations de dessin qui utilisent *fontHolder,* il doit sélectionner à nouveau la police sélectionnée précédemment en lui passant comme paramètre à [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Sélectionne la propriété stock Font dans un contexte de périphérique.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de périphérique dans lequel la police est sélectionnée.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers sélectionné précédemment `CFont` objet. Vous devez utiliser [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) pour sélectionner cette police dans le contexte de périphérique lorsque vous avez terminé.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Sérialise ou initialise l’état de l’espace alloué au contrôle d’affichage.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*ar*<br/>
Un `CArchive` objet à sérialiser à partir d’ou.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeExtent`, `SerializeStockProps`, et `SerializeVersion` substituer `COleControl::Serialize`. Lisez l'exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Sérialise ou initialise l’état de la `COleControl` propriétés stock : Apparence, BackColor, BorderStyle, légende, activé, la police, couleur de premier plan et texte.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*ar*<br/>
Un `CArchive` objet à sérialiser à partir d’ou.

### <a name="remarks"></a>Notes

Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : Ajout de propriétés Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeStockProps`, `SerializeExtent`, et `SerializeVersion` substituer `COleControl::Serialize`. Pour obtenir un exemple, consultez le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Sérialise ou initialise l’état d’un contrôle informations de version.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*ar*<br/>
Un `CArchive` objet à sérialiser à partir d’ou.

*dwVersionDefault*<br/>
Le numéro de version actuel du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties au format plus récent quand il est enregistré ou mis à jour dans le même format qu’elle avait lorsqu’il a été chargé.

### <a name="return-value"></a>Valeur de retour

Le numéro de version du contrôle. Si la charge de l’archive spécifiée, `SerializeVersion` retourne la version chargée à partir de cette archive. Sinon, elle retourne la version actuellement chargée.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeVersion`, `SerializeExtent`, et `SerializeStockProps` substituer `COleControl::Serialize`. Pour obtenir un exemple, consultez le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : Optimisation](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Définit la valeur de propriété stockée apparence de votre contrôle.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Paramètres

*sAppearance*<br/>
Un **court** valeur (VT_I2) à utiliser pour l’apparence de votre contrôle. Une valeur égale à zéro définit l’apparence du contrôle à plat et la valeur 1 définit l’apparence du contrôle en 3D.

### <a name="remarks"></a>Notes

Pour plus d’informations sur les propriétés stocks, consultez [contrôles ActiveX : Propriétés](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Définit la valeur de propriété BackColor stockée de votre contrôle.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Paramètres

*dwBackColor*<br/>
Une valeur OLE_COLOR à utiliser pour l’arrière-plan de votre contrôle de dessin.

### <a name="remarks"></a>Notes

Pour plus d’informations sur l’utilisation de cette propriété et autres les propriétés, consultez l’article [contrôles ActiveX : Propriétés](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Définit la valeur de propriété BorderStyle stockée de votre contrôle.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Paramètres

*sBorderStyle*<br/>
Le nouveau style de bordure pour le contrôle ; 0 n’indique aucune bordure et 1 indique une bordure normale.

### <a name="remarks"></a>Notes

La fenêtre de contrôle sera recréée et `OnBorderStyleChanged` appelée.

##  <a name="setcapture"></a>  COleControl::SetCapture

Provoque la fenêtre du contrôle conteneur à prendre possession de la capture de souris procuration du contrôle.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers le `CWnd` objet de fenêtre qui a déjà reçu d’entrée de la souris.

### <a name="remarks"></a>Notes

Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre du contrôle conteneur à prendre possession de la capture de la souris, procuration du contrôle. Sinon, cette fonction provoque le contrôle proprement dit à prendre possession de la capture de la souris (même en tant que `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Définit la taille de la fenêtre de contrôle OLE et informe le conteneur qui le site de contrôle est en cours de modification.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Paramètres

*cx*<br/>
Spécifie la nouvelle largeur du contrôle en pixels.

*cy*<br/>
Spécifie la nouvelle hauteur du contrôle en pixels.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel a réussi ; sinon 0.

### <a name="remarks"></a>Notes

Cette fonction ne doit pas être utilisée dans le constructeur de votre contrôle.

Notez que toutes les coordonnées pour les fenêtres de contrôle sont par rapport à l’angle supérieur gauche du contrôle.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Définit la valeur de la propriété Enabled de votre contrôle de stock.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Paramètres

*bEnabled*<br/>
TRUE si le contrôle doit être activé ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Après avoir défini cette propriété, `OnEnabledChange` est appelée.

##  <a name="setfocus"></a>  COleControl::SetFocus

Provoque la fenêtre du contrôle conteneur à prendre possession du focus d’entrée procuration du contrôle.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers le `CWnd` objet window qui avait précédemment l’entrée concentrer, ou NULL s’il n’existe pas de fenêtre.

### <a name="remarks"></a>Notes

Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre du contrôle conteneur à prendre possession du focus d’entrée, procuration du contrôle. Le focus d’entrée dirige l’entrée au clavier pour la fenêtre du conteneur et le conteneur distribue à tous les messages de clavier suivants pour l’objet OLE qui appelle `SetFocus`. N’importe quelle fenêtre qui avait précédemment le focus d’entrée perd il.

Si le contrôle n’est pas sans fenêtre, cette fonction provoque le contrôle lui-même pour s’approprier le focus d’entrée (même en tant que `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Définit la propriété stock Font de votre contrôle.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Paramètres

*pFontDisp*<br/>
Pointeur vers une interface de dispatch de police.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Définit la valeur de propriété stockée ForeColor de votre contrôle.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Paramètres

*dwForeColor*<br/>
Une valeur OLE_COLOR à utiliser pour le dessin de votre contrôle de premier plan.

### <a name="remarks"></a>Notes

Pour plus d’informations sur l’utilisation de cette propriété et autres les propriétés, consultez l’article [contrôles ActiveX : Propriétés](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut spécifie deux formats : CF_METAFILEPICT et la propriété persistante définis.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Définit la taille d’un contrôle OLE lorsque d’abord affiché dans un conteneur.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Paramètres

*cx*<br/>
Largeur initiale du contrôle OLE en pixels.

*cy*<br/>
La hauteur initiale du contrôle OLE en pixels.

### <a name="remarks"></a>Notes

Appelez cette fonction dans votre constructeur pour définir la taille initiale de votre contrôle. La taille initiale est mesurée en unités de périphérique ou de pixels. Il est recommandé que cet appel soit effectué dans le constructeur de votre contrôle.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Modifie l’état modifié d’un contrôle.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Paramètres

*bModified*<br/>
La nouvelle valeur pour le contrôle de modification indicateur. TRUE indique que l’état du contrôle a été modifié ; La valeur FALSE indique que l’état du contrôle vient d’être enregistré.

### <a name="remarks"></a>Notes

Appel de cette fonction chaque fois qu’une modification produit qui affecterait l’état persistant de votre contrôle. Par exemple, si la valeur d’une propriété persistante change, appelez cette fonction avec *bModified* **TRUE**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Indique qu’une demande de modification a échoué.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Notes

Appelez cette fonction lorsque `BoundPropertyRequestEdit` échoue. Cette fonction lève une exception de type `COleDispScodeException` pour indiquer que l’opération de définition n’a pas été autorisée.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Empêche toute modification à la valeur de la propriété d’un contrôle par l’utilisateur.

```
void SetNotSupported();
```

### <a name="remarks"></a>Notes

Appelez cette fonction à la place de la fonction Get de n’importe quelle propriété où la modification de la valeur de propriété par l’utilisateur du contrôle n’est pas pris en charge. Un exemple serait une propriété qui est en lecture seule.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Définit les coordonnées du rectangle du contrôle relatifs au conteneur, exprimé en unités de périphérique.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers un rectangle qui contient les nouvelles coordonnées du contrôle relatifs au conteneur.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel a réussi ; sinon 0.

### <a name="remarks"></a>Notes

Si le contrôle est ouvert, il est redimensionné ; Sinon, le conteneur `OnPosRectChanged` fonction est appelée.

##  <a name="settext"></a>  COleControl::SetText

Définit la valeur de propriété stock de légende ou le texte de votre contrôle.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Paramètres

*pszText*<br/>
Pointeur vers une chaîne de caractères.

### <a name="remarks"></a>Notes

Notez que les propriétés stock de légende et le texte sont mappées à la même valeur. Cela signifie que toute modification apportée à des propriétés change automatiquement les deux propriétés. En règle générale, un contrôle doit prendre en charge le stock légende ou propriété de texte, mais pas les deux.

##  <a name="throwerror"></a>  COleControl::ThrowError

Signale l’occurrence d’une erreur dans votre contrôle.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*sc*<br/>
La valeur de code d’état soient signalés. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
La chaîne ID de ressource de l’exception doit être signalée.

*nHelpID*<br/>
ID de la rubrique d’aide à étudier.

*pszDescription*<br/>
Chaîne contenant une explication de l’exception doit être signalée.

### <a name="remarks"></a>Notes

Cette fonction doit uniquement être appelée à partir d’une fonction Get ou Set pour une propriété OLE, ou de l’implémentation d’une méthode d’automation OLE. Si vous avez besoin signaler les erreurs qui se produisent à d’autres moments, l’événement d’erreur stock doit se déclencher.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Transformations coordonnent les valeurs comprises entre les unités HIMETRIC et unités native du conteneur.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Paramètres

*lpptlHimetric*<br/>
Pointeur vers un `POINTL` structure contenant les coordonnées en unités HIMETRIC.

*lpptfContainer*<br/>
Pointeur vers un `POINTF` structure contenant les coordonnées de la taille d’unité du conteneur.

*flags*<br/>
Une combinaison des valeurs suivantes :

- Position de XFORMCOORDS_POSITION A dans le conteneur.

- Taille d’un XFORMCOORDS_SIZE dans le conteneur.

- Unités HIMETRIC de transformer XFORMCOORDS_HIMETRICTOCONTAINER à des unités du conteneur.

- XFORMCOORDS_CONTAINERTOHIMETRIC transformer unités du conteneur pour les unités HIMETRIC.

### <a name="remarks"></a>Notes

Les deux premiers indicateurs, XFORMCOORDS_POSITION et XFORMCOORDS_SIZE, indiquent si les coordonnées doivent être traitées comme une position ou une taille. Les deux indicateurs restantes indiquent le sens de transformation.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Convertit une valeur de couleur à partir du type de données OLE_COLOR à la [COLORREF](/windows/desktop/gdi/colorref) type de données.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Paramètres

*clrColor*<br/>
Un type de données OLE_COLOR. Pour plus d’informations, consultez le Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) (fonction).

*hpal*<br/>
Un handle vers une palette facultatif ; peut être NULL.

### <a name="return-value"></a>Valeur de retour

Une valeur de 32 bits couleur RVB (rouge, vert, bleu) qui définit le solide de couleur plus proche de la *clrColor* valeur que l’appareil peut représenter.

### <a name="remarks"></a>Notes

Cette fonction est utile pour traduire les propriétés stock ForeColor et BackColor aux types COLORREF utilisés par [CDC](../../mfc/reference/cdc-class.md) fonctions membres.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Détermine si votre contrôle doit utiliser les valeurs des propriétés ambiantes en tant que valeurs par défaut, lorsqu’il est chargé par la suite de son état persistant.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro indique que les propriétés ambiantes seront valides ; Sinon, les propriétés ambiantes ne sera pas valides.

### <a name="remarks"></a>Notes

Dans certains conteneurs, votre contrôle peut-être pas accès à ses propriétés ambiantes pendant l’appel initial à la substitution de `COleControl::DoPropExchange`. C’est le cas si le conteneur appelle [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) ou [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) avant d’appeler [l’IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (autrement dit, si elle n’est pas le cas honorer le bit d’état OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>  COleControl::WindowProc

Fournit une procédure de Windows pour un `COleControl` objet.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Paramètres

*message*<br/>
Spécifie le message Windows à traiter.

*wParam*<br/>
Fournit des informations supplémentaires utilisées pour traiter le message. La valeur du paramètre dépend du message.

*lParam*<br/>
Fournit des informations supplémentaires utilisées pour traiter le message. La valeur du paramètre dépend du message.

### <a name="return-value"></a>Valeur de retour

La valeur de retour du message distribué.

### <a name="remarks"></a>Notes

Appelez cette fonction pour distribuer des messages spécifiques via la table des messages du contrôle.

## <a name="see-also"></a>Voir aussi

[MFC exemple CIRC3](../../visual-cpp-samples.md)<br/>
[Exemple MFC TESTHELP](../../visual-cpp-samples.md)<br/>
[COlePropertyPage, classe](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder, classe](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder, classe](../../mfc/reference/cpictureholder-class.md)<br/>
