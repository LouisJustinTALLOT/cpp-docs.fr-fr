---
title: COleControl, classe
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753939"
---
# <a name="colecontrol-class"></a>COleControl, classe

Classe de base puissante pour développer des contrôles OLE.

## <a name="syntax"></a>Syntaxe

```
class COleControl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Crée un objet `COleControl` .|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Récupère l’apparence actuelle du contrôle.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retourne la valeur de la propriété Ambient BackColor.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retourne le nom du contrôle tel que spécifié par le conteneur.|
|[COleControl::AmbientFont](#ambientfont)|Retourne la valeur de la propriété Font ambiante.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Retourne la valeur de la propriété Ambient ForeColor.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Retourne l’ID local du conteneur.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retourne le type d’unités utilisées par le conteneur.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Détermine si les poignées de prise doivent être affichées.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Détermine si l’éclosion doit être affichée.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retourne le type d’alignement de texte spécifié par le conteneur.|
|[COleControl::AmbientUIDead](#ambientuidead)|Détermine si le contrôle doit répondre aux actions utilisateur-interface.|
|[COleControl::AmbientUserMode](#ambientusermode)|Détermine le mode du conteneur.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Informe le conteneur qu’une propriété liée a été modifiée.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Demande l’autorisation de modifier la valeur de la propriété.|
|[COleControl::ClientToParent](#clienttoparent)|Traduit un point par rapport à l’origine du contrôle à un point par rapport à l’origine de son conteneur.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajuste un rectangle de caret s’il est chevauché par un contrôle.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Appelez cette fonction après l’ensemble de mnémoniques manipulés par le contrôle a changé.|
|[COleControl::DisplayError](#displayerror)|Affiche les événements d’erreur de stock à l’utilisateur du contrôle.|
|[COleControl::DoClick](#doclick)|Mise en `DoClick` œuvre de la méthode du stock.|
|[COleControl::DoPropExchange](#dopropexchange)|Sérialise les `COleControl` propriétés d’un objet.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Permet un support cadre simple pour un contrôle.|
|[COleControl::ExchangeExtent](#exchangeextent)|Sérialise la largeur et la hauteur du contrôle.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Sérialise les propriétés des actions du contrôle.|
|[COleControl::ExchangeVersion](#exchangeversion)|Sérialise le numéro de version du contrôle.|
|[COleControl::FireClick](#fireclick)|Le stock `Click` déclenche l’événement.|
|[COleControl::FireDblClick](#firedblclick)|Le stock `DblClick` déclenche l’événement.|
|[COleControl::FireError](#fireerror)|Le stock `Error` déclenche l’événement.|
|[COleControl::FireEvent](#fireevent)|Déclenche un événement personnalisé.|
|[COleControl::FireKeyDown](#firekeydown)|Le stock `KeyDown` déclenche l’événement.|
|[COleControl::FireKeyPress](#firekeypress)|Le stock `KeyPress` déclenche l’événement.|
|[COleControl::FireKeyUp](#firekeyup)|Le stock `KeyUp` déclenche l’événement.|
|[COleControl::FireMouseDown](#firemousedown)|Le stock `MouseDown` déclenche l’événement.|
|[COleControl::FireMouseMove](#firemousemove)|Le stock `MouseMove` déclenche l’événement.|
|[COleControl::FireMouseUp](#firemouseup)|Le stock `MouseUp` déclenche l’événement.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Déclenche un événement lorsque l’état de contrôle est prêt à changer.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Modifie le comportement d’activation par `IPointerInactive` défaut d’un contrôle qui prend en charge l’interface.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Retourne la valeur de la propriété ambiante spécifiée.|
|[COleControl::GetAppearance](#getappearance)|Retourne la valeur de la propriété Apparence d’actions.|
|[COleControl::GetBackColor](#getbackcolor)|Retourne la valeur de la propriété BackColor.|
|[COleControl::GetBorderStyle](#getborderstyle)|Retourne la valeur de la propriété BorderStyle.|
|[COleControl::GetCapture](#getcapture)|Détermine si un objet de commande activé sans fenêtre a la capture de la souris.|
|[COleControl::GetClassID](#getclassid)|Récupère l’ID de classe OLE du contrôle.|
|[COleControl::GetClientOffset](#getclientoffset)|Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.|
|[COleControl::GetClientRect](#getclientrect)|Récupère la taille de la zone cliente du contrôle.|
|[COleControl::GetClientSite](#getclientsite)|Interroge un objet pour le pointeur sur son site client actuel dans son conteneur.|
|[COleControl::GetControlFlags](#getcontrolflags)|Récupère les paramètres du drapeau de contrôle.|
|[COleControl::GetControlSize](#getcontrolsize)|Retourne la position et la taille du contrôle OLE.|
|[COleControl::GetDC](#getdc)|Fournit un moyen pour un contrôle sans fenêtre pour obtenir un contexte d’appareil à partir de son conteneur.|
|[COleControl::GetEnabled](#getenabled)|Retourne la valeur de la propriété activée par actions.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Récupère un pointeur sur un objet de commande étendu appartenant au conteneur.|
|[COleControl::GetFocus](#getfocus)|Détermine si le contrôle a l’accent.|
|[COleControl::GetFont](#getfont)|Retourne la valeur de la propriété Font stock.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retourne les mesures `CFontHolder` d’un objet.|
|[COleControl::GetForeColor](#getforecolor)|Retourne la valeur de la propriété ForeColor.|
|[COleControl::GetHwnd](#gethwnd)|Retourne la valeur de la propriété hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Fournit du texte de barre d’état pour un élément de menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Empêche l’accès à la valeur de propriété d’un contrôle par l’utilisateur.|
|[COleControl::GetReadyState](#getreadystate)|Retourne l’état de préparation du contrôle.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Retourne le rectangle du contrôle par rapport à son conteneur.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retourne les mesures de la propriété Stock Font.|
|[COleControl::GetText](#gettext)|Retourne la valeur de l’action Texte ou caption propriété.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Remplacer pour permettre à un contrôle sans fenêtre d’être la cible d’opérations de drag and drop.|
|[COleControl::InitializeIIDs](#initializeiids)|Informe la classe de base des CDS que le contrôle utilisera.|
|[COleControl::InternalGetFont](#internalgetfont)|Retourne `CFontHolder` un objet pour la propriété Stock Font.|
|[COleControl::InternalGetText](#internalgettext)|Récupère la propriété caption ou texte.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Définit l’état de préparation du contrôle et déclenche l’événement de changement d’état prêt à l’emploi.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalide une zone de contrôle affiché, ce qui la redessine.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalide la zone cliente de la fenêtre de conteneurs dans la région donnée. Peut être utilisé pour redessiner les contrôles sans fenêtre dans la région.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permet le chargement spécialisé d’un contrôle OLE.|
|[COleControl::IsModified](#ismodified)|Détermine si l’état de contrôle a changé.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indique si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Appelé pour déterminer si le contrôle sous-classe un contrôle Windows.|
|[COleControl::Load](#load)|Réinitialise toutes les données asynchrones antérieures et initie une nouvelle charge de la propriété asynchrone du contrôle.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Détermine si votre contrôle peut être désactivé par le conteneur.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Appelé quand une propriété ambiante est changée.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Appelé lorsque la propriété Apparence stock est changé.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Appelé lorsque la propriété BackColor stock est changé.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Appelé lorsque la propriété BorderStyle stock est changé.|
|[COleControl::OnClick](#onclick)|Appelé pour le feu de l’événement de clic de stock.|
|[COleControl::OnClose](#onclose)|Informe le contrôle `IOleControl::Close` qui a été appelé.|
|[COleControl::OnDoVerb](#ondoverb)|Appelé après qu’un verbe de contrôle a été exécuté.|
|[COleControl::OnDraw](#ondraw)|Appelé quand un contrôle est demandé de se redessiner.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Appelé par le conteneur lorsqu’un contrôle est demandé de se redessiner à l’aide d’un contexte de dispositif métaafile.|
|[COleControl::OnEdit](#onedit)|Appelé par le conteneur à l’interface utilisateur Activez un contrôle OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Appelé lorsque la propriété activée par le stock est changée.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Appelé par le conteneur pour énumérer les verbes d’un contrôle.|
|[COleControl::OnEventAdvise](#oneventadvise)|Appelé lorsque les gestionnaires d’événements sont connectés ou déconnectés d’un contrôle.|
|[COleControl::OnFontChanged](#onfontchanged)|Appelé lorsque la propriété Stock Font est changée.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Appelé lorsque la propriété ForeColor stock est changé.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Appelé lorsque les événements d’un contrôle sont gelés ou non gelés.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Informe le contrôle `IOleObject::GetColorSet` qui a été appelé.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fournit des informations mnémoniques au conteneur.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Appelé à obtenir une chaîne pour représenter une valeur de propriété.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Demande la poignée du menu du contrôle qui sera fusionné avec le menu conteneur.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Remplacer pour récupérer la taille d’affichage du contrôle le plus proche de la taille et du mode d’étendue proposés.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retourne les chaînes représentant les valeurs possibles pour une propriété.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retourne la valeur correspondant à une chaîne prédéfinie.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Remplacement pour récupérer la taille des zones d’affichage du contrôle (peut être utilisé pour permettre le dessin à deux pas).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Remplacer pour convertir la taille du contrôle en rectangle à partir d’une position spécifique.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Remplacement pour récupérer l’état de vue du contrôle.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Appelé par le conteneur lorsque le contrôle est désactivé.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Remplacer pour avoir le conteneur pour le contrôle inactif sous l’envoi de pointeur de souris WM_MOUSEMOVE messages au contrôle.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Remplacer pour avoir le conteneur pour le contrôle inactif sous l’envoi de pointeur de souris WM_SETCURSOR messages au contrôle.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Appelé après l’événement De stock KeyDown a été congédié.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Appelé après l’événement De stock KeyPress a été congédié.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Appelé après l’événement De stock KeyUp a été congédié.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indique quelle page de propriété utiliser pour l’édition d’une propriété.|
|[COleControl::OnMnemonic](#onmnemonic)|Appelé quand une clé mnémonique du contrôle a été pressée.|
|[COleControl::OnProperties](#onproperties)|Appelé lorsque le verbe "Propriétés" du contrôle a été invoqué.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Remplacer pour savoir si l’affichage d’un contrôle chevauche un point donné.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Remplacer pour savoir si l’affichage d’un contrôle chevauche un point dans un rectangle donné.|
|[COleControl::OnRenderData](#onrenderdata)|Appelé par le cadre pour récupérer les données dans le format spécifié.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Appelé par le cadre pour récupérer les données d’un fichier dans le format spécifié.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Appelé par le cadre pour récupérer les données de la mémoire globale dans le format spécifié.|
|[COleControl::OnResetState](#onresetstate)|Réinitialise les propriétés d’un contrôle aux valeurs par défaut.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Informe le contrôle `IOleControl::SetClientSite` qui a été appelé.|
|[COleControl::OnSetData](#onsetdata)|Remplace les données du contrôle par une autre valeur.|
|[COleControl::OnSetExtent](#onsetextent)|Appelé après l’étendue du contrôle a changé.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Appelé après les dimensions du contrôle ont été changés.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Appelé lorsque le contrôle a été activé par l’interface utilisateur.|
|[COleControl::OnTextChanged](#ontextchanged)|Appelé lorsque le stock Texte ou caption propriété est changé.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Traite les messages de fenêtre (autres que les messages de souris et de clavier) pour les commandes sans fenêtre.|
|[COleControl::ParentToClient](#parenttoclient)|Traduit un point par rapport à l’origine du conteneur à un point par rapport à l’origine du contrôle.|
|[COleControl::PostModalDialog](#postmodaldialog)|Informe le conteneur qu’une boîte de dialogue modal a été fermée.|
|[COleControl::PreModalDialog](#premodaldialog)|Informe le conteneur qu’une boîte de dialogue modal est sur le point d’être affichée.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Détruit et re-crée la fenêtre du contrôle.|
|[COleControl::Rafraîchissement](#refresh)|Force un repeindre l’apparence d’un contrôle.|
|[COleControl::ReleaseCapture](#releasecapture)|Libère la capture de la souris.|
|[COleControl::ReleaseDC](#releasedc)|Libère le contexte de l’appareil d’affichage d’un conteneur d’un contrôle sans fenêtre.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Réinitialise le parent de la fenêtre de contrôle.|
|[COleControl::ResetStockProps](#resetstockprops)|Initialise `COleControl` les propriétés boursières à leurs valeurs par défaut.|
|[COleControl::ResetVersion](#resetversion)|Initialise le numéro de version à une valeur donnée.|
|[COleControl::ScrollWindow](#scrollwindow)|Permet à un contrôle sans fenêtre de faire défiler une zone à l’intérieur de son image active sur l’écran.|
|[COleControl::SelectFontObject](#selectfontobject)|Sélectionne une propriété Font personnalisée dans un contexte d’appareil.|
|[COleControl::SelectStockFont](#selectstockfont)|Sélectionne la propriété Stock Font dans un contexte d’appareil.|
|[COleControl::SerializeExtent](#serializeextent)|Sérialise ou initialise l’espace d’affichage pour le contrôle.|
|[COleControl::SerializeStockProps](#serializestockprops)|Sérialise ou initialise les propriétés du `COleControl` stock.|
|[COleControl::SerializeVersion](#serializeversion)|Sérialise ou initialise les informations de version du contrôle.|
|[COleControl::SetAppearance](#setappearance)|Définit la valeur de la propriété Apparence d’actions.|
|[COleControl::SetBackColor](#setbackcolor)|Définit la valeur de la propriété BackColor.|
|[COleControl::SetBorderStyle](#setborderstyle)|Définit la valeur de la propriété BorderStyle stock.|
|[COleControl::SetCapture](#setcapture)|Provoque la fenêtre de conteneur du contrôle à prendre possession de la capture de la souris au nom du contrôle.|
|[COleControl::SetControlSize](#setcontrolsize)|Définit la position et la taille du contrôle OLE.|
|[COleControl::SetEnabled](#setenabled)|Définit la valeur de la propriété activée par actions.|
|[COleControl::SetFocus](#setfocus)|Fait en fait que la fenêtre de conteneur du contrôle prend possession de l’accent mis sur l’entrée au nom du contrôle.|
|[COleControl::SetFont](#setfont)|Définit la valeur de la propriété Font stock.|
|[COleControl::SetForeColor](#setforecolor)|Définit la valeur de la propriété ForeColor.|
|[COleControl::SetInitialSize](#setinitialsize)|Définit la taille d’un contrôle OLE lorsqu’il est affiché pour la première fois dans un conteneur.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Modifications de l’état modifié d’un contrôle.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indique qu’une demande de modification a échoué.|
|[COleControl::SetNotSupported](#setnotsupported)|Empêche la modification de la valeur de propriété d’un contrôle par l’utilisateur.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Définit le rectangle du contrôle par rapport à son conteneur.|
|[COleControl::SetText](#settext)|Définit la valeur du stock Texte ou propriété caption.|
|[COleControl::ThrowError](#throwerror)|Signale qu’une erreur s’est produite dans un contrôle OLE.|
|[COleControl::TransformCoords](#transformcoords)|Transforme les valeurs de coordonnées entre un conteneur et le contrôle.|
|[COleControl::TraduitColor](#translatecolor)|Convertit une valeur OLE_COLOR en valeur COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Détermine si les propriétés ambiantes seront disponibles la prochaine fois que le contrôle sera chargé.|
|[COleControl::WindowProc](#windowproc)|Fournit une procédure `COleControl` Windows pour un objet.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleControl::Dcontent](#drawcontent)|Appelé par le cadre lorsque l’apparence du contrôle doit être mise à jour.|
|[COleControl::DrawMetafile](#drawmetafile)|Appelé par le cadre lorsque le contexte de l’appareil métaafile est utilisé.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permet l’invocation de la méthode d’automatisation.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Appelé par le cadre pour initialiser la liste des formats de données pris en charge par le contrôle.|

## <a name="remarks"></a>Notes

Dérivé `CWnd`de , cette classe hérite de toutes les fonctionnalités d’un objet windows, ainsi que des fonctionnalités supplémentaires spécifiques à OLE, telles que la mise à feu d’événements et la possibilité de prendre en charge les méthodes et les propriétés.

Les commandes OLE peuvent être insérées dans les applications de conteneurs OLE et communiquer avec le conteneur en utilisant un système bidirectionnel de tir d’événements et d’exposer les méthodes et les propriétés au conteneur. Notez que les conteneurs OLE standard ne prennent en charge que les fonctionnalités de base d’un contrôle OLE. Ils ne sont pas en mesure de prendre en charge les fonctionnalités étendues d’un contrôle OLE. Le tir d’événement se produit lorsque des événements sont envoyés au conteneur à la suite de certaines actions prises dans le contrôle. À son tour, le conteneur communique avec le contrôle en utilisant un ensemble exposé de méthodes et de propriétés analogues aux fonctions des membres et aux membres des données d’une classe C. Cette approche permet au développeur de contrôler l’apparence du contrôle et d’aviser le conteneur lorsque certaines actions se produisent.

## <a name="windowless-controls"></a>Contrôles sans fenêtre

Les commandes OLE peuvent être utilisées en place actives sans fenêtre. Les commandes sans fenêtre présentent des avantages significatifs :

- Les commandes sans fenêtre peuvent être transparentes et non rectangulaires

- Les contrôles sans fenêtre réduisent la taille de l’instance et le temps de création de l’objet

Les commandes n’ont pas besoin d’une fenêtre. Les services qu’une fenêtre offre peuvent facilement être fournis via une seule fenêtre partagée (généralement le conteneur) et un peu de code d’expédition. Avoir une fenêtre est surtout une complication inutile sur l’objet.

Lorsque l’activation sans fenêtre est utilisée, le conteneur (qui a une fenêtre) est responsable de fournir des services qui auraient autrement été fournis par la propre fenêtre du contrôle. Par exemple, si votre contrôle doit interroger le clavier, interroger la capture de la souris ou obtenir un contexte d’appareil, ces opérations sont gérées par le conteneur. Les `COleControl` fonctions de membre sans fenêtre invoquent ces opérations sur le conteneur.

Lorsque l’activation sans fenêtre est activée, le `IOleInPlaceObjectWindowless` conteneur délègue des messages d’entrée à l’interface du contrôle (une extension d’IOleInPlaceObject pour un support sans fenêtre). [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) `COleControl`la mise en œuvre de cette interface enverra ces messages à travers la carte de message de votre contrôle, après ajustement des coordonnées de la souris de manière appropriée. Vous pouvez traiter ces messages comme des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la carte de message.

Dans un contrôle sans fenêtre, `COleControl` vous devez toujours utiliser `CWnd` les fonctions du membre au lieu des fonctions correspondantes du membre ou de leurs fonctions d’API Windows connexes.

Les objets de contrôle OLE ne peuvent également créer une fenêtre que lorsqu’ils deviennent actifs, mais la quantité de travail nécessaire pour la transition active augmente et la vitesse de la transition diminue. Il y a des cas où il s’agit d’un problème : par exemple, considérez une grille de boîtes textuelles. Lors du curseur de haut en bas à travers la colonne, chaque contrôle doit être activé en place, puis désactivé. La vitesse de la transition inactive/active affectera directement la vitesse de défilement.

Pour plus d’informations sur l’élaboration d’un cadre de contrôle OLE, voir les articles [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) and [Overview: Creating an MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md). Pour plus d’informations sur l’optimisation des commandes OLE, y compris les commandes sans fenêtre et sans scintillement, voir [MFC ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Spécifications

**En-tête:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl::AmbientBackColor

Retourne la valeur de la propriété Ambient BackColor.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la propriété BackColor ambiante du conteneur, le cas échéant. Si la propriété n’est pas prise en charge, cette fonction renvoie la couleur de fond Windows définie par le système.

### <a name="remarks"></a>Notes

La propriété BackColor ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl::AmbientDisplayName

Le nom que le conteneur a attribué au contrôle peut être utilisé dans les messages d’erreur affichés à l’utilisateur.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valeur de retour

Le nom du contrôle OLE. La valeur par défaut est une chaîne de longueur zéro.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl::AmbientFont

Retourne la valeur de la propriété Font ambiante.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur sur l’interface de répartition ambiante de font du conteneur. La valeur par défaut est NULL. Si le retour n’est pas égal à NULL, vous êtes responsable de la libération de la police en appelant son [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) fonction membre.

### <a name="remarks"></a>Notes

La propriété Font ambiante est définie par le conteneur et accessible à tous les contrôles. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl::AmbientForeColor

Retourne la valeur de la propriété Ambient ForeColor.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la propriété ForeColor ambiante du conteneur, le cas échéant. Si elle n’est pas prise en charge, cette fonction renvoie la couleur de texte Windows définie par le système.

### <a name="remarks"></a>Notes

La propriété ForeColor ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl::AmbientLocaleID

Retourne l’ID local du conteneur.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valeur de retour

La valeur de la propriété LocaleID du conteneur, le cas échéant. Si cette propriété n’est pas prise en charge, cette fonction revient 0.

### <a name="remarks"></a>Notes

Le contrôle peut utiliser le LocalID pour adapter son interface utilisateur pour des lieux spécifiques. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl::AmbientAppearance

Récupère le paramètre d’apparence actuel pour l’objet de commande.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valeur de retour

L’apparence du contrôle :

- **0** Aspect plat

- **1** apparence 3D

### <a name="remarks"></a>Notes

Appelez cette fonction pour récupérer la valeur actuelle de la propriété DISPID_AMBIENT_APPEARANCE pour le contrôle.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits

Retourne le type d’unités utilisées par le conteneur.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valeur de retour

Une chaîne contenant les ScaleUnits ambiants du récipient. Si cette propriété n’est pas prise en charge, cette fonction renvoie une chaîne de longueur zéro.

### <a name="remarks"></a>Notes

La propriété échelle du conteneur peut être utilisée pour afficher des positions ou des dimensions, étiquetées avec l’unité choisie, comme des twips ou des centimètres. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles

Détermine si le conteneur permet au contrôle d’afficher les poignées de capture pour lui-même lorsqu’il est actif.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si les poignées de prise doivent être affichées; sinon 0. Si cette propriété n’est pas prise en charge, cette fonction retourne nonzero.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl::AmbientShowHatching

Détermine si le conteneur permet au contrôle de s’afficher avec un motif éclos lorsque l’interface utilisateur est active.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le modèle éclos doit être montré; sinon 0. Si cette propriété n’est pas prise en charge, cette fonction retourne nonzero.

### <a name="remarks"></a>Notes

Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl::AmbientTextAlign

Détermine l’alignement du texte ambiant préféré par le récipient de commande.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valeur de retour

L’état de la propriété TextAlign ambiante du conteneur. Si cette propriété n’est pas prise en charge, cette fonction revient 0.

Voici une liste de valeurs de rendement valides :

|Valeur retournée|Signification|
|------------------|-------------|
|0|Alignement général (nombres à droite, texte à gauche).|
|1|La gauche justifie|
|2|Center|
|3|Just justify|

### <a name="remarks"></a>Notes

Cette propriété est disponible pour tous les contrôles intégrés et est définie par le conteneur. Notez que le conteneur n’est pas nécessaire pour soutenir cette propriété.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl::AmbientUIDead

Détermine si le conteneur veut que le contrôle réponde aux actions utilisateur-interface.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle doit répondre aux actions utilisateur-interface; sinon 0. Si cette propriété n’est pas prise en charge, cette fonction revient 0.

### <a name="remarks"></a>Notes

Par exemple, un conteneur peut définir cela en mode de conception TRUE.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl::AmbientUserMode

Détermine si le conteneur est en mode conception ou en mode utilisateur.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le conteneur est en mode utilisateur; autrement 0 (en mode design). Si cette propriété n’est pas prise en charge, cette fonction renvoie VRAI.

### <a name="remarks"></a>Notes

Par exemple, un conteneur peut définir cela en mode DE conception FALSE.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged

Signale que la valeur de la propriété liée a changé.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’id de répartition d’une propriété liée du contrôle.

### <a name="remarks"></a>Notes

Cela doit être appelé chaque fois que la valeur de la propriété change, même dans les cas où le changement n’a pas été fait par la méthode de l’ensemble de propriété. Soyez particulièrement conscient des propriétés liées qui sont cartographiées aux variables des membres. Chaque fois qu’une `BoundPropertyChanged` telle variable de membre change, doit être appelé.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit

Demande l’autorisation de l’interface `IPropertyNotifySink` pour modifier une valeur de propriété liée fournie par le contrôle.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’id de répartition d’une propriété liée du contrôle.

### <a name="return-value"></a>Valeur de retour

Nonzero si le changement est autorisé; sinon 0. La valeur par défaut est nonzero.

### <a name="remarks"></a>Notes

Si l’autorisation est refusée, le contrôle ne doit pas laisser la valeur de la propriété changer. Cela peut être fait en ignorant ou en omettant l’action qui a tenté de changer la valeur de la propriété.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl::ClientToParent

Traduit les coordonnées de *pPoint* en coordonnées parentales.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds (lprcBounds)*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. Pas la zone cliente, mais la zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement.

*pPoint (en)*<br/>
Pointeur vers le point de secteur client OLE à traduire dans les coordonnées du parent (conteneur).

### <a name="remarks"></a>Notes

Sur l’entrée *pPoint* est relative à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle). Sur la sortie *pPoint* est relative à l’origine du parent (coin supérieur gauche du conteneur).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl::ClipCaretRect

Ajuste un rectangle de caret s’il est entièrement ou partiellement recouvert d’objets opaques qui se chevauchent.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Sur l’entrée, un pointeur à une structure [RECT](/windows/win32/api/windef/ns-windef-rect) qui contient la zone de caret à ajuster. Sur la sortie, la zone de caret ajustée, ou NULL si le rectangle caret est complètement couvert.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Une caret est une ligne clignotante, un bloc ou une bitmap qui indique généralement où le texte ou les graphiques seront insérés.

Un objet sans fenêtre ne peut pas montrer en toute sécurité un caret sans d’abord vérifier si le caret est partiellement ou totalement caché par des objets qui se chevauchent. Afin de rendre cela possible, `ClipCaretRect` un objet peut utiliser pour obtenir la caret ajusté (réduit) pour s’assurer qu’il s’adapte dans la région de coupure.

Les objets créant une caret doivent `ClipCaretRect` soumettre le rectangle caret et utiliser le rectangle ajusté pour le caret. Si le caret est entièrement caché, cette méthode retournera FALSE et le caret ne doit pas être montré du tout dans ce cas.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl::COleControl

Construit un objet `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Notes

Cette fonction n’est normalement pas appelée directement. Au lieu de cela, le contrôle OLE est généralement créé par son usine de classe.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl::ControlInfoChanged

Appelez cette fonction lorsque l’ensemble de mnémoniques soutenus par le contrôle a changé.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Notes

Lors de la réception de cette notification, le conteneur du contrôle obtient le nouvel ensemble de mnémoniques en faisant un appel à [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Notez que le conteneur n’est pas tenu de répondre à cette notification.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::DisplayError

Appelé par le cadre après l’événement d’erreur de stock a été manipulé (sauf si le gestionnaire d’événement a supprimé l’affichage de l’erreur).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Paramètres

*scode*<br/>
La valeur du code d’état à signaler. Pour une liste complète des codes possibles, voir l’article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La description de l’erreur signalée.

*lpszSource (en)*<br/>
Le nom du module générant l’erreur (généralement, le nom du module de contrôle OLE).

*lpszHelpFile*<br/>
Le nom du fichier d’aide contenant une description de l’erreur.

*nHelpID (en)*<br/>
L’ID De contexte d’aide de l’erreur signalée.

### <a name="remarks"></a>Notes

Le comportement par défaut affiche une boîte de message contenant la description de l’erreur, contenue dans *lpszDescription*.

Remplacez cette fonction pour personnaliser la façon dont les erreurs s’affichent.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

Simule une action de clic de souris sur le contrôle.

```cpp
void DoClick();
```

### <a name="remarks"></a>Notes

La fonction `COleControl::OnClick` de membre primordiale sera appelée, et un événement de clic stock sera tiré, si pris en charge par le contrôle.

Cette fonction est `COleControl` prise en charge par la classe de base comme méthode de stock, appelée DoClick. Pour plus d’informations, voir l’article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

Appelé par le cadre lors du chargement ou du stockage d’un contrôle à partir d’une représentation de stockage persistante, comme un flux ou un ensemble de propriété.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*Ppx*<br/>
Pointeur vers un objet `CPropExchange`. Le cadre fournit cet objet pour établir le contexte de l’échange de biens, y compris sa direction.

### <a name="remarks"></a>Notes

Cette fonction passe normalement des appels à la **famille PX_** de fonctions pour charger ou stocker des propriétés spécifiques définies par l’utilisateur d’un contrôle OLE.

Si Control Wizard a été utilisé pour créer le projet de contrôle OLE, la `COleControl` version dépassée de cette `COleControl::DoPropExchange`fonction sérialisera les propriétés stock prises en charge par un appel à la fonction de classe de base, . Lorsque vous ajoutez des propriétés définies par l’utilisateur à votre contrôle OLE, vous devrez modifier cette fonction pour sérialiser vos nouvelles propriétés. Pour plus d’informations sur la sérialisation, voir l’article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint

Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Un pointeur sur le contexte de l’appareil du conteneur de contrôle.

*rcBounds*<br/>
La zone dans laquelle le contrôle doit être tracé.

### <a name="remarks"></a>Notes

Appelez cette fonction pour manipuler correctement la peinture d’un contrôle OLE non inactif. Cette fonction ne doit être utilisée que si le contrôle OLE `OnDraw` sous-classe un contrôle Windows et doit être appelé dans la fonction de votre contrôle.

Pour plus d’informations sur cette fonction et sous-classer un contrôle Windows, voir l’article [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::Dcontent

Appelé par le cadre lorsque l’apparence du contrôle doit être mise à jour.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur sur le contexte de l’appareil.

*Rc*<br/>
Zone rectangulaire à attirer.

### <a name="remarks"></a>Notes

Cette fonction appelle directement `OnDraw` la fonction primordiale.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::DrawMetafile

Appelé par le cadre lorsque le contexte de l’appareil métaafile est utilisé.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur sur le contexte de l’appareil métaafile.

*Rc*<br/>
Zone rectangulaire à attirer.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame

Permet la caractéristique simple du cadre pour un contrôle OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Notes

Cette caractéristique permet un contrôle pour soutenir le confinement visuel d’autres contrôles, mais pas le confinement OLE vrai. Un exemple serait une boîte de groupe avec plusieurs contrôles à l’intérieur. Ces contrôles ne sont pas contenus dans l’OL, mais ils sont dans la même boîte de groupe.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::ExchangeExtent

Sérialise ou initialise l’état de l’étendue du contrôle (ses dimensions dans les unités HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*Ppx*<br/>
Un pointeur vers un objet [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Le cadre fournit cet objet pour établir le contexte de l’échange de biens, y compris sa direction.

### <a name="return-value"></a>Valeur de retour

Nonzero si la fonction a réussi; 0 autrement.

### <a name="remarks"></a>Notes

Cette fonction est normalement appelée par `COleControl::DoPropExchange`la mise en œuvre par défaut de .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::ExchangeStockProps

Sérialise ou initialise l’état des propriétés du contrôle.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*Ppx*<br/>
Un pointeur vers un objet [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Le cadre fournit cet objet pour établir le contexte de l’échange de biens, y compris sa direction.

### <a name="remarks"></a>Notes

Cette fonction est normalement appelée par `COleControl::DoPropExchange`la mise en œuvre par défaut de .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl::ExchangeVersion

Sérialise ou initialise l’état des informations de version d’un contrôle.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*Ppx*<br/>
Pointeur vers un objet `CPropExchange`. Le cadre fournit cet objet pour établir le contexte de l’échange de biens, y compris sa direction.

*dwVersionDefault*<br/>
Le numéro de version actuel du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties au dernier format lorsqu’elles sont enregistrées, ou maintenues dans le même format qui a été chargé.

### <a name="return-value"></a>Valeur de retour

Nonzero de la fonction a réussi; 0 autrement.

### <a name="remarks"></a>Notes

Typiquement, ce sera la première fonction appelée par `COleControl::DoPropExchange`le remplacement d’un contrôle de . Lors du chargement, cette fonction lit le numéro de version des données persistantes et définit l’attribut de version de l’objet [CPropExchange](../../mfc/reference/cpropexchange-class.md) en conséquence. Lors de l’enregistrement, cette fonction écrit le numéro de version des données persistantes.

Pour plus d’informations sur la persistance et la version, voir l’article [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl::FireClick

Appelé par le cadre lorsque la souris est cliqué sur un contrôle actif.

```cpp
void FireClick();
```

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement Click se produise, la carte de l’événement du contrôle doit avoir un événement de clic stock défini.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::FireDblClick

Appelé par le cadre lorsque la souris est à double clic sur un contrôle actif.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement DblClick se produise, la carte de l’événement du contrôle doit avoir un stock DblClick événement défini.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl::FireError

Le stock a l’événement d’erreur.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*scode*<br/>
La valeur du code d’état à signaler. Pour une liste complète des codes possibles, voir l’article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La description de l’erreur signalée.

*nHelpID (en)*<br/>
L’ID d’aide de l’erreur signalée.

### <a name="remarks"></a>Notes

Cet événement fournit un moyen de signaler, aux endroits appropriés de votre code, qu’une erreur s’est produite sous votre contrôle. Contrairement à d’autres événements boursiers, tels que Click ou MouseMove, Error n’est jamais tiré par le cadre.

Pour signaler une erreur qui se produit au cours d’une propriété obtenir la fonction, la fonction de l’ensemble de propriété, ou la méthode d’automatisation, appelez [COleControl::ThrowError](#throwerror).

La mise en œuvre de l’événement d’erreur d’achat d’actions d’un contrôle OLE utilise une valeur SCODE. Si votre contrôle utilise cet événement et est destiné à être utilisé dans Visual Basic 4.0, vous recevrez des erreurs parce que la valeur SCODE n’est pas prise en charge dans Visual Basic.

Pour résoudre ce problème, modifiez manuellement le paramètre SCODE dans celui du contrôle. Fichier ODL à un **long**. En outre, tout événement personnalisé, méthode ou propriété qui utilise un paramètre SCODE provoque également le même problème.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl::FireEvent

Tire un événement défini par l’utilisateur de votre contrôle avec un certain nombre d’arguments optionnels,.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
L’id de répartition de l’événement à tirer.

*pbParams*<br/>
Un descripteur pour les types de paramètres de l’événement.

### <a name="remarks"></a>Notes

Habituellement, cette fonction ne doit pas être appelée directement. Au lieu de cela, vous appellez les fonctions de tir d’événement dans la section de la carte d’événement de la déclaration de classe de votre contrôle.

*L’argument pbParams* est une liste séparée de **l’espace**de VTS_ . Une ou plusieurs de ces valeurs, séparées par des espaces (et non par des virgules), spécifient la liste des paramètres de la fonction. Les valeurs possibles sont les suivantes :

|Symbole|Type de paramètre|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> D’autres constantes de variantes ont été définies pour tous les types de variantes, à l’exception de VTS_FONT et VTS_PICTURE, qui fournissent un pointeur à la constante de données de variante. Ces constantes sont nommées à l’aide de la`constantname` **convention VTS_P.** Par exemple, VTS_PCOLOR est un pointeur à une constante VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl::FireKeyDown

Appelé par le cadre quand une clé est pressée tandis que le contrôle est actif de l’interface utilisateur.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar (en)*<br/>
Pointeur sur la valeur de code clé virtuelle de la clé pressée. Pour une liste de codes clés virtuels standard, voir Winuser.h

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement KeyDown se produise, la carte de l’événement du contrôle doit avoir un événement KeyDown stock défini.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

Appelé par le cadre quand une clé est pressée et libérée tandis que le contrôle personnalisé est active dans le conteneur.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Paramètres

*pnChar (en)*<br/>
Un pointeur sur la valeur de caractère de la clé pressée.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Le destinataire de l’événement peut modifier *pnChar*, par exemple, convertir tous les caractères minuscules en uppercase. Si vous voulez examiner le caractère `OnKeyPressEvent`modifié, remplacer .

Pour que le tir automatique d’un événement KeyPress se produise, la carte d’événement du contrôle doit avoir un événement KeyPress stock défini.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl::FireKeyUp

Appelé par le cadre quand une clé est libérée tandis que le contrôle personnalisé est active d’interface utilisateur dans le conteneur.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar (en)*<br/>
Pointeur sur la valeur de code clé virtuelle de la clé libérée. Pour une liste de codes clés virtuels standard, voir Winuser.h

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement KeyUp se produise, la carte de l’événement du contrôle doit avoir un événement KeyUp stock défini.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl::FireMouseDown

Appelé par le cadre quand un bouton de souris est appuyé sur un contrôle personnalisé actif.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton (en)*<br/>
La valeur numérique du bouton de la souris a appuyé. Il peut contenir l’une des valeurs suivantes :

- LEFT_BUTTON Le bouton de la souris gauche a été appuyé vers le bas.

- MIDDLE_BUTTON Le bouton de la souris du milieu a été appuyé vers le bas.

- RIGHT_BUTTON Le bouton de la souris droite a été appuyé vers le bas.

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

*x*<br/>
La x-coordonnées du curseur lorsqu’un bouton de souris a été appuyé. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

*y*<br/>
Le y-coordinate du curseur quand un bouton de souris a été appuyé vers le bas. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement MouseDown se produise, la carte d’événement du contrôle doit avoir un stock MouseDown événement défini.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl::FireMouseMove

Appelé par le cadre lorsque le curseur est déplacé sur un contrôle personnalisé actif.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton (en)*<br/>
La valeur numérique des boutons de souris pressé. Contient une combinaison des valeurs suivantes :

- LEFT_BUTTON Le bouton de la souris gauche a été appuyé pendant l’action.

- MIDDLE_BUTTON Le bouton de la souris du milieu a été appuyé vers le bas pendant l’action.

- RIGHT_BUTTON Le bouton de la souris droite a été appuyé pendant l’action.

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

*x*<br/>
La x-coordonnées du curseur. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

*y*<br/>
Le y-coordinate du curseur. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement MouseMove se produise, la carte de l’événement du contrôle doit avoir un stock MouseMove événement défini.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl::FireMouseUp

Appelé par le cadre lorsqu’un bouton de souris est libéré sur un contrôle personnalisé actif.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*nButton (en)*<br/>
La valeur numérique du bouton de souris libérée. Elle peut avoir l’une des valeurs suivantes :

- LEFT_BUTTON Le bouton de la souris gauche a été libéré.

- MIDDLE_BUTTON Le bouton de la souris du milieu a été libéré.

- RIGHT_BUTTON Le bouton de la souris droite a été libéré.

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

*x*<br/>
La x-coordonnées du curseur lors de la libération d’un bouton de souris. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

*y*<br/>
Le y-coordinate d’un curseur lors de la libération d’un bouton de souris. La coordonnées est relative au coin supérieur gauche de la fenêtre de commande.

### <a name="remarks"></a>Notes

Si cet événement est défini comme un événement personnalisé, vous déterminez quand l’événement est déclenché.

Pour que le tir automatique d’un événement MouseUp se produise, la carte de l’événement du contrôle doit avoir un stock MouseUp événement défini.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl::FireReadyStateChange

Déclenche un événement avec la valeur actuelle de l’état de contrôle prêt.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Notes

L’état prêt peut être l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été paradé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactif, mais toutes les données asynchrones sont encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

Utilisez [GetReadyState](#getreadystate) pour déterminer l’état de préparation actuel du contrôle.

[InternalSetReadyState](#internalsetreadystate) modifie l’état prêt à `FireReadyStateChange`la valeur fournie, puis appelle .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl::GetActivationPolicy

Modifie le comportement d’activation par `IPointerInactive` défaut d’un contrôle qui prend en charge l’interface.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valeur de retour

Une combinaison de drapeaux de l’énumération POINTERINACTIVE. Les drapeaux possibles sont les :

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|L’objet doit être activé sur place lorsque la souris y pénètre lors d’une opération de déplacement de la souris.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|L’objet doit être désactivé lorsque la souris quitte l’objet lors d’une opération de déplacement de la souris.|
|POINTERINACTIVE_ACTIVATEONDRAG|L’objet doit être activé sur place lorsque la souris est traînée dessus pendant une opération de traînée et de chute.|

### <a name="remarks"></a>Notes

Lorsque `IPointerInactive` l’interface est activée, le conteneur lui délégue WM_SETCURSOR et lui WM_MOUSEMOVE messages. `COleControl`la mise en œuvre de cette interface enverra ces messages à travers la carte de message de votre contrôle, après ajustement des coordonnées de la souris de manière appropriée.

Chaque fois que le conteneur reçoit un WM_SETCURSOR ou WM_MOUSEMOVE message avec `IPointerInactive`le pointeur `GetActivationPolicy` de la souris sur un support d’objet inactif, il doit faire appel à l’interface et retourner les drapeaux de l’énumération POINTERINACTIVE.

Vous pouvez traiter ces messages comme des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la carte de message. Chez vos gestionnaires, évitez `m_hWnd` d’utiliser la variable du membre (ou les fonctions des membres qui l’utilisent) sans d’abord vérifier que sa valeur n’est pas NULL.

Tout objet destiné à faire plus que régler le curseur de souris et / ou le feu d’un événement de mouvement de souris, comme donner une rétroaction visuelle spéciale, doit retourner le drapeau POINTERINACTIVE_ACTIVATEONENTRY et dessiner la rétroaction seulement lorsqu’il est actif. Si l’objet renvoie ce drapeau, le conteneur doit l’activer immédiatement sur `GetActivationPolicy`place, puis l’envoyer le même message qui a déclenché l’appel à .

Si les POINTERINACTIVE_ACTIVATEONENTRY et les POINTERINACTIVE_DEACTIVATEONLEAVE drapeaux sont retournés, l’objet ne sera activé que lorsque la souris est au-dessus de l’objet. Si seulement le POINTERINACTIVE_ACTIVATEONENTRY drapeau est retourné, alors l’objet ne sera activé qu’une fois lorsque la souris entre dans l’objet.

Vous pouvez également vouloir qu’un contrôle inactif soit la cible d’une opération de traînée et de chute OLE. Cela nécessite d’activer le contrôle au moment où l’utilisateur traîne un objet sur lui, de sorte que la fenêtre du contrôle peut être enregistrée comme une cible de chute. Pour provoquer une activation pendant une traînée, retournez le drapeau POINTERINACTIVE_ACTIVATEONDRAG :

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Les informations `GetActivationPolicy` communiquées par ne doivent pas être mises en cache par un conteneur. Au lieu de cela, cette méthode doit être appelée chaque fois que la souris entre dans un objet inactif.

Si un objet inactif ne demande pas à être activé lorsque la souris y pénètre, son conteneur doit envoyer des messages WM_SETCURSOR ultérieurs à cet objet en appelant [OnInactiveSetCursor](#oninactivesetcursor) tant que le pointeur de souris reste au-dessus de l’objet.

L’activation de l’interface `IPointerInactive` signifie généralement que vous voulez que le contrôle soit capable de traiter les messages de souris en tout temps. Pour obtenir ce comportement dans un conteneur `IPointerInactive` qui ne prend pas en charge l’interface, vous aurez besoin d’avoir votre contrôle toujours activé lorsqu’il est visible, ce qui signifie que le contrôle doit avoir le OLEMISC_ACTIVATEWHENVISIBLE drapeau parmi ses drapeaux divers. Toutefois, pour éviter que ce drapeau ne `IPointerInactive`prenne effet dans un conteneur qui prend en charge, vous pouvez également spécifier le drapeau OLEMISC_IGNOREACTIVATEWHENVISIBLE :

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl::GetAmbientProperty

Obtient la valeur d’une propriété ambiante du conteneur.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Paramètres

*dwDispid*<br/>
L’ID de répartition de la propriété ambiante désirée.

*vtProp (en)*<br/>
Une étiquette de type variante qui spécifie le type de valeur à retourner en *pvProp*.

*pvProp (en)*<br/>
Un pointeur à l’adresse de la variable qui recevra la valeur de la propriété ou la valeur de retour. Le type réel de ce pointeur doit correspondre au type spécifié par *vtProp*.

|vtProp (en)|Type de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valeur de retour

Nonzero si la propriété ambiante est prise en charge; sinon 0.

### <a name="remarks"></a>Notes

Si vous `GetAmbientProperty` utilisez pour récupérer les propriétés ambiantes DisplayName et ScaleUnits, `CString*`définissez *vtProp* pour VT_BSTR et *pvProp* à . Si vous récupérez la propriété Font ambiante, définissez *vtProp* pour VT_FONT et *pvProp* à LPFONTDISPMD.

Notez que des fonctions ont déjà été fournies pour les propriétés ambiantes communes, telles que [AmbientBackColor](#ambientbackcolor) et [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl::GetAppearance

Implémente la fonction Get de la propriété Apparence de stock de votre contrôle.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour spécifie le paramètre d’apparence actuel comme une valeur **courte** (VT_I2), si elle est couronnée de succès. Cette valeur est nulle si l’apparence du contrôle est plate et 1 si l’apparence du contrôle est 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl::GetBackColor

Implémente la fonction Get du stock de votre contrôle BackColor propriété.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour spécifie la couleur de fond actuelle comme une valeur OLE_COLOR, si elle est réussie. Cette valeur peut être traduite à une valeur `TranslateColor`COLORREF avec un appel à .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl::GetBorderStyle

Implémente la fonction Get de la propriété BorderStyle stock de votre contrôle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valeur de retour

1 si le contrôle a une bordure normale; 0 si le contrôle n’a pas de frontière.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl::GetCapture

Détermine si `COleControl` l’objet a la capture de la souris.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valeur de retour

Si le contrôle est activé et sans fenêtre, retourne **ceci** si le contrôle a actuellement la capture de souris (comme déterminé par le récipient du contrôle), ou NULL s’il n’a pas la capture.

Sinon, retourne `CWnd` l’objet qui a `CWnd::GetCapture`la capture de la souris (même que ).

### <a name="remarks"></a>Notes

Un contrôle sans fenêtre activé reçoit la capture de la souris lorsque [SetCapture](#setcapture) est appelé.

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl::GetClassID

Appelé par le cadre pour récupérer l’ID de classe OLE du contrôle.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Paramètres

*pclsid (pclsid)*<br/>
Pointeur à l’emplacement de l’ID de classe.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel n’a pas été réussi; sinon 0.

### <a name="remarks"></a>Notes

Habituellement mis en œuvre par le [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl::GetClientOffset

Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Paramètres

*pdxOffset (pdxOffset)*<br/>
Pointeur sur le décalage horizontal de la zone client du contrôle OLE.

*pdyOffset (en)*<br/>
Pointeur sur le décalage vertical de la zone client du contrôle OLE.

### <a name="remarks"></a>Notes

Le contrôle OLE a une zone rectangulaire dans son conteneur. La zone cliente du contrôle est la zone de contrôle à l’exclusion des bordures et des barres de défilement. Le décalage récupéré `GetClientOffset` par est la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente. Si votre contrôle comporte des éléments non clients autres que les bordures standard et les barres de défilement, remplacez cette fonction de membre pour spécifier le décalage.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl::GetClientRect

Récupère la taille de la zone cliente du contrôle.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointer vers `RECT` une structure contenant les dimensions de la zone cliente du contrôle sans fenêtre; c’est-à-dire, la taille du contrôle moins les bordures de fenêtre, les cadres, les barres de défilement, et ainsi de suite. Le *paramètre lpRect* indique la taille du rectangle du client du contrôle, et non sa position.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl::GetClientSite

Interroge un objet pour le pointeur sur son site client actuel dans son conteneur.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur sur le site client actuel du contrôle dans son conteneur.

### <a name="remarks"></a>Notes

Le pointeur retourné indique `IOleClientSite`une instance de . L’interface, `IOleClientSite` mise en œuvre par conteneurs, est la vue de l’objet de son contexte : où elle est ancrée dans le document, où elle obtient son stockage, son interface utilisateur et d’autres ressources.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl::GetControlFlags

Récupère les paramètres du drapeau de contrôle.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valeur de retour

Une combinaison ORed des drapeaux dans le recensement ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Notes

`GetControlFlags` retourne `fastBeginPaint | clipPaintDC` par défaut.

|||
|-|-|
|`fastBeginPaint`|Si l’ensemble, utilise une fonction de démarrage de peinture adaptée aux commandes OLE au lieu de l’API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (défini par défaut).|
|`clipPaintDC`|S’il n’est pas `IntersectClipRect` réglé, `COleControl` désactive l’appel à passer et gagne un petit avantage de vitesse. Si vous utilisez l’activation sans fenêtre, le drapeau n’a aucun effet.|
|`pointerInactive`|Si l’ensemble, fournit l’interaction de `COleControl`souris tandis que `IPointerInactive` votre contrôle est inactif en permettant la mise en œuvre de l’interface, qui est désactivée par défaut.|
|`noFlickerActivate`|Si l’ensemble, élimine les opérations de dessin supplémentaires et le scintillement visuel qui l’accompagne. Utilisez lorsque votre contrôle se dessine à l’identique dans les états inactifs et actifs. Si vous utilisez l’activation sans fenêtre, le drapeau n’a aucun effet.|
|`windowlessActivate`|Si défini, indique que votre contrôle utilise l’activation sans fenêtre.|
|`canOptimizeDraw`|Si défini, indique que le contrôle effectuera un dessin optimisé, si le conteneur le prend en charge.|

Pour plus `GetControlFlags` d’informations sur et d’autres optimisations des contrôles OLE, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl::GetControlSize

Récupère la taille de la fenêtre de contrôle OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Paramètres

*Pcx*<br/>
Spécifie la largeur du contrôle en pixels.

*pcy (en anglais)*<br/>
Spécifie la hauteur du contrôle en pixels.

### <a name="remarks"></a>Notes

Notez que toutes les coordonnées des fenêtres de contrôle sont relatives au coin supérieur gauche du contrôle.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl::GetDC

Fournit un objet sans fenêtre pour obtenir un écran (ou compatible) contexte de périphérique à partir de son conteneur.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Paramètres

*lprcRect*<br/>
Un pointeur sur le rectangle le contrôle sans fenêtre veut redessiner, dans les coordonnées des clients du contrôle. NULL signifie l’étendue de l’objet complet.

*dwFlags*<br/>
Dessin des attributs du contexte de l’appareil. Les choix sont les :

- OLEDC_NODRAW indique que l’objet n’utilisera pas le contexte de l’appareil pour effectuer un dessin, mais simplement pour obtenir des informations sur l’appareil d’affichage. Le conteneur doit simplement passer le DC de la fenêtre sans traitement ultérieur.

- OLEDC_PAINTBKGND Demande que le récipient peigne l’arrière-plan avant de retourner le DC. Un objet doit utiliser ce drapeau s’il demande à un DC de redessiner une zone avec un fond transparent.

- OLEDC_OFFSCREEN informe le conteneur que l’objet souhaite rendre dans un bitmap hors écran qui doit ensuite être copié à l’écran. Un objet doit utiliser ce drapeau lorsque l’opération de dessin qu’il est sur le point d’effectuer génère beaucoup de scintillement. Le conteneur est libre d’honorer cette demande ou non. Toutefois, si ce drapeau n’est pas réglé, le conteneur doit remettre un DC à l’écran. Cela permet aux objets d’effectuer des opérations d’écran direct telles que la diffusion d’une sélection (via une opération **XOR).**

### <a name="return-value"></a>Valeur de retour

Pointeur vers le contexte `CWnd` de l’appareil d’affichage pour la zone client de conteneur en cas de succès; autrement, la valeur de rendement est NULL. Le contexte de l’appareil d’affichage peut être utilisé dans les fonctions GDI ultérieures pour dessiner dans la zone client de la fenêtre du conteneur.

### <a name="remarks"></a>Notes

La fonction de membre [de ReleaseDC](#releasedc) doit être appelée pour libérer le contexte après la peinture. Lors `GetDC`de l’appel , les objets passent le rectangle qu’ils souhaitent dessiner dans leurs propres coordonnées client. `GetDC`traduit ces coordonnées à la zone des clients conteneurs. L’objet ne doit pas demander un rectangle de dessin désiré plus grand que son propre rectangle de zone client, dont la taille peut être récupérée avec [GetClientRect](#getclientrect). Cela empêche les objets de dessiner par inadvertance là où ils ne sont pas censés le faire.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl::GetEnabled

Implémente la fonction Get de la propriété activée par le stock de votre contrôle.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est activé; sinon 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl::GetExtendedControl

Obtient un pointeur sur un objet entretenu par le conteneur qui représente le contrôle avec un ensemble étendu de propriétés.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers l’objet de commande étendu du conteneur. S’il n’y a pas d’objet disponible, la valeur est NULL.

Cet objet peut être `IDispatch` manipulé à travers son interface. Vous pouvez `QueryInterface` également utiliser pour obtenir d’autres interfaces disponibles fournies par l’objet. Toutefois, l’objet n’est pas nécessaire pour prendre en charge un ensemble spécifique d’interfaces. Notez que le fait de s’appuyer sur les caractéristiques spécifiques de l’objet de commande étendu d’un conteneur limite la portabilité de votre contrôle à d’autres conteneurs arbitraires.

### <a name="remarks"></a>Notes

La fonction qui appelle cette fonction est responsable de la libération du pointeur une fois terminé avec l’objet. Notez que le conteneur n’est pas nécessaire pour prendre en charge cet objet.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl::GetFocus

Détermine si `COleControl` l’objet a la mise au point.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valeur de retour

Si le contrôle est activé et sans fenêtre, retourne **ceci** si le contrôle a actuellement la mise au point de clavier (comme déterminé par le récipient du contrôle), ou NULL s’il n’a pas la mise au point.

Sinon, retourne `CWnd` l’objet qui a `CWnd::GetFocus`la mise au point (même que ).

### <a name="remarks"></a>Notes

Un contrôle sans fenêtre activé reçoit la mise au point lorsque [SetFocus](#setfocus) est appelé.

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl::GetFont

Implémente la fonction Get de la propriété Stock Font.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à l’interface de répartition de police de la propriété de fonte de stock de commande.

### <a name="remarks"></a>Notes

Notez que l’appelant doit libérer l’objet une fois terminé. Dans la mise en `InternalGetFont` œuvre du contrôle, utilisez-le pour accéder à l’objet De fonte de stock du contrôle. Pour plus d’informations sur l’utilisation des polices dans votre contrôle, voir l’article [ActiveX Controls: Using Fonts in an ActiveX Control](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics

Mesure les mesures de `CFontHolder` texte pour tout objet appartenant au contrôle.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*lptm lptm*<br/>
Pointeur vers une structure [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*policeHolder*<br/>
Référence à un objet [CFontHolder.](../../mfc/reference/cfontholder-class.md)

### <a name="remarks"></a>Notes

Une telle police peut être sélectionnée avec le [COleControl::SelectFontObject](#selectfontobject) fonction. `GetFontTextMetrics`initialisera `TEXTMETRIC` la structure pointée par *lptm* `fontHolder`avec des informations valides sur les polices en cas de succès, ou remplira la structure de zéros si elle n’est pas couronnée de succès. Vous devez utiliser cette fonction au lieu de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) lors de la peinture de votre contrôle parce que les contrôles, comme tout objet intégré OLE, peuvent être nécessaires pour se rendre dans un métaafile.

La `TEXTMETRIC` structure de la police par défaut est actualisée lorsque la fonction [SelectFontObject](#selectfontobject) est appelée. Vous ne `GetFontTextMetrics` devez appeler qu’après avoir sélectionné la propriété Stock Font pour vous assurer que les informations qu’elle fournit sont valides.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl::GetForeColor

Implémente la fonction Get de la propriété ForeColor stock.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valeur de retour

La valeur de retour spécifie la couleur actuelle au premier plan comme une valeur OLE_COLOR, si elle est réussie. Cette valeur peut être traduite à une valeur `TranslateColor` [COLORREF](/windows/win32/gdi/colorref) avec un appel à .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl::GetHwnd

Implémente la fonction Get de la propriété hWnd stock.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valeur de retour

Poignée de fenêtre du contrôle OLE, le cas échéant; autrement NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl::GetMessageString

Appelé par le cadre pour obtenir une courte chaîne qui décrit le but de l’élément de menu identifié par *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Une pièce d’identité d’élément de menu.

*rMessage (en)*<br/>
Une référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) à travers lequel une corde sera retournée.

### <a name="remarks"></a>Notes

Ceci peut être utilisé pour obtenir un message pour l’affichage dans une barre d’état pendant que l’élément de menu est mis en évidence. La mise en œuvre par défaut tente de charger une ressource de chaîne identifiée par *nID*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl::GetNotSupported

Empêche l’accès à la valeur de propriété d’un contrôle par l’utilisateur.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Notes

Appelez cette fonction à la place de la fonction Get de toute propriété lorsque la récupération de la propriété par l’utilisateur du contrôle n’est pas prise en charge. Un exemple serait une propriété qui est écrit seulement.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl::GetReadyState

Retourne l’état de préparation du contrôle.

```
long GetReadyState();
```

### <a name="return-value"></a>Valeur de retour

L’état de préparation du contrôle, l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été paradé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactif, mais toutes les données asynchrones sont encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

### <a name="remarks"></a>Notes

La plupart des contrôles simples n’ont jamais besoin de faire la distinction entre LOADED et INTERACTIVE. Toutefois, les contrôles qui prennent en charge les propriétés de trajectoire de données peuvent ne pas être prêts à être interactifs jusqu’à ce qu’au moins certaines données soient reçues asynchronement. Un contrôle devrait tenter de devenir interactif dès que possible.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl::GetRectInContainer

Obtient les coordonnées du rectangle du contrôle par rapport au conteneur, exprimés dans les unités de périphérique.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Un pointeur vers la structure du rectangle dans lequel les coordonnées du contrôle seront copiées.

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est actif en place; sinon 0.

### <a name="remarks"></a>Notes

Le rectangle n’est valide que si le contrôle est actif.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics

Mesure les paramètres de texte pour la propriété De la police des stocks du contrôle, qui peut être sélectionnée avec la fonction [SelectStockFont.](#selectstockfont)

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Paramètres

*lptm lptm*<br/>
Un pointeur vers une structure [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Notes

La `GetStockTextMetrics` fonction sera `TEXTMETRIC` initialiser la structure indiquée par *lptm* avec des informations valides de mesures en cas de succès, ou remplir la structure avec des zéros si elle n’est pas réussie. Utilisez cette fonction au lieu de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) lors de la peinture de votre contrôle parce que les contrôles, comme tout objet intégré OLE, peuvent être nécessaires pour se rendre dans un métaafile.

La `TEXTMETRIC` structure de la police par `SelectStockFont` défaut est actualisée lorsque la fonction est appelée. Vous ne devez appeler cette fonction qu’après avoir sélectionné la police de stock pour vous assurer que les informations qu’elle fournit sont valides.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl::GetText

Implémente la fonction Get du stock Texte ou Caption propriété.

```
BSTR GetText();
```

### <a name="return-value"></a>Valeur de retour

La valeur actuelle de la chaîne de texte de commande ou d’une chaîne de longueur zéro si aucune chaîne n’est présente.

> [!NOTE]
> Pour plus d’informations sur le type de données BSTR, voir [les types de données](../../mfc/reference/data-types-mfc.md) dans la section Macros et Globals.

### <a name="remarks"></a>Notes

Notez que l’appelant de `SysFreeString` cette fonction doit faire appel à la chaîne retournée afin de libérer la ressource. Dans la mise en `InternalGetText` œuvre du contrôle, utilisez-le pour accéder au stock du contrôle Texte ou Propriété caption.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget

Remplacer `GetWindowlessDropTarget` lorsque vous voulez qu’un contrôle sans fenêtre soit la cible d’une opération de drag and drop OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valeur de retour

Pointeur sur l’interface de `IDropTarget` l’objet. Comme il n’a pas de fenêtre, `IDropTarget` un objet sans fenêtre ne peut pas enregistrer une interface. Cependant, pour participer à la traînée et la chute, un `GetWindowlessDropTarget`objet sans fenêtre peut encore implémenter l’interface et le retourner dans .

### <a name="remarks"></a>Notes

Normalement, cela suppose que la fenêtre de contrôle soit stockée en tant que cible de déplacement. Mais comme le contrôle n’a pas de fenêtre propre, le conteneur utilisera sa propre fenêtre comme cible de chute. Le contrôle doit simplement fournir `IDropTarget` une mise en œuvre de l’interface à laquelle le conteneur peut déléguer des appels au moment approprié. Par exemple :

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl::InitializeIIDs

Informe la classe de base des CDS que le contrôle utilisera.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Paramètres

*piidPrimary*<br/>
Pointeur à l’interface ID de l’interface de répartition principale du contrôle.

*piidEvents*<br/>
Pointeur sur l’interface ID de l’interface événement du contrôle.

### <a name="remarks"></a>Notes

Appelez cette fonction dans le constructeur du contrôle pour informer la classe de base de l’interface IDs votre contrôle sera en utilisant.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl::InternalGetFont

Accéde à la propriété Stock Font de votre contrôle

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valeur de retour

Une référence à un objet [CFontHolder](../../mfc/reference/cfontholder-class.md) qui contient l’objet Font stock.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl::InternalGetText

Accéde à la propriété de texte ou de légende de votre contrôle.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valeur de retour

Une référence à la chaîne de texte de contrôle.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::InternalSetReadyState

Définit l’état de préparation du contrôle.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Paramètres

*lNewReadyState*<br/>
L’état de préparation à fixer pour le contrôle, l’une des valeurs suivantes:

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été paradé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactif, mais toutes les données asynchrones sont encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

### <a name="remarks"></a>Notes

La plupart des contrôles simples n’ont jamais besoin de faire la distinction entre LOADED et INTERACTIVE. Toutefois, les contrôles qui prennent en charge les propriétés de trajectoire de données peuvent ne pas être prêts à être interactifs jusqu’à ce qu’au moins certaines données soient reçues asynchronement. Un contrôle devrait tenter de devenir interactif dès que possible.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl::InvalidateControl

Force le contrôle à se redessiner.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Un pointeur à la région du contrôle à invalider.

*bErase (en)*<br/>
Précise si l’arrière-plan de la région de mise à jour doit être effacé lorsque la région de mise à jour est traitée.

### <a name="remarks"></a>Notes

Si *lpRect* a une valeur NULL, l’ensemble du contrôle sera redessiné. Si *lpRect n’est* pas NULL, cela indique la partie du rectangle du contrôle qui doit être invalidée. Dans les cas où le contrôle n’a pas de fenêtre, ou n’est actuellement pas actif, le rectangle est ignoré, et un appel est fait à [IAdviseSink du site client::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) fonction membre. Utilisez cette fonction `CWnd::InvalidateRect` `InvalidateRect`au lieu ou .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl::InvalidateRgn

Invalide la zone cliente de la fenêtre de conteneurs dans la région donnée.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*pRgn (en)*<br/>
Un pointeur vers un objet [CRgn](../../mfc/reference/crgn-class.md) qui identifie la région d’affichage de l’objet OLE à invalider, dans les coordonnées des clients de la fenêtre contenant. Si ce paramètre est NULL, l’étendue est l’objet entier.

*bErase (en)*<br/>
Précise si l’arrière-plan de la région invalidée doit être effacé. Si VRAI, l’arrière-plan est effacé. Si FALSE, l’arrière-plan reste inchangé.

### <a name="remarks"></a>Notes

Cela peut être utilisé pour redessiner les commandes sans fenêtre dans le conteneur. La région invalidée, ainsi que toutes les autres zones de la région de mise à jour, est marquée pour la peinture lorsque le prochain [message WM_PAINT](/windows/win32/gdi/wm-paint) est envoyé.

Si *bErase* est VRAI pour n’importe quelle partie de la région de mise à jour, l’arrière-plan dans toute la région, pas seulement dans la partie donnée, est effacé.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl::IsConvertingVBX

Permet le chargement spécialisé d’un contrôle OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est converti; sinon 0.

### <a name="remarks"></a>Notes

Lors de la conversion d’un formulaire qui utilise des commandes VBX en un formulaire qui utilise des commandes OLE, un code de chargement spécial pour les contrôles OLE peut être nécessaire. Par exemple, si vous chargez une instance de votre contrôle [PX_Font](persistence-of-ole-controls.md#px_font) OLE, vous `DoPropExchange`pourriez avoir un appel pour PX_Font dans votre :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Cependant, les commandes VBX n’avaient pas d’objet Font; chaque propriété de police a été sauvée individuellement. Dans ce cas, `IsConvertingVBX` vous utiliseriez pour faire la distinction entre ces deux cas :

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Un autre cas serait si votre contrôle VBX a enregistré des données binaires exclusives (dans son gestionnaire de message VBM_SAVEPROPERTY), et votre contrôle OLE enregistre ses données binaires dans un format différent. Si vous voulez que votre contrôle OLE soit rétro-compatible avec le contrôle VBX, `IsConvertingVBX` vous pouvez lire les formats anciens et nouveaux en utilisant la fonction en distinguant si le contrôle VBX ou le contrôle OLE était chargé.

Dans la fonction `DoPropExchange` de votre contrôle, vous pouvez vérifier cette condition et si elle est vraie, exécutez le code de charge spécifique à cette conversion (comme les exemples précédents). Si le contrôle n’est pas converti, vous pouvez exécuter le code de charge normal. Cette capacité ne s’applique qu’aux contrôles convertis à partir de contreparties VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed

Permet l’invocation de la méthode d’automatisation.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle a été parasécé; sinon 0.

### <a name="remarks"></a>Notes

La mise en `IDispatch::Invoke` œuvre par le cadre des appels `IsInvokeAllowed` pour déterminer si une fonction donnée (identifiée par `dispid`) peut être invoquée. Le comportement par défaut d’un contrôle OLE est de permettre aux méthodes d’automatisation d’être invoquées uniquement si le contrôle a été initialisé; cependant, `IsInvokeAllowed` est une fonction virtuelle et peut être remplacé si nécessaire (par exemple, lorsque le contrôle est utilisé comme un serveur d’automatisation).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl::IsModified

Détermine si l’état du contrôle a été modifié.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’état du contrôle a été modifié depuis sa dernière économie; sinon 0.

### <a name="remarks"></a>Notes

L’état d’un contrôle est modifié lorsqu’une propriété change de valeur.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl::IsOptimizedDraw

Détermine si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valeur de retour

VRAI si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours; autrement FALSE.

### <a name="remarks"></a>Notes

Si le dessin optimisé est pris en charge, le contrôle n’a pas besoin de sélectionner de vieux objets (stylos, brosses, polices, etc.) dans le contexte de l’appareil lorsque le dessin est terminé.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl

Appelé par le cadre pour déterminer si le contrôle sous-classe un contrôle Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le contrôle est sous-classé; sinon 0.

### <a name="remarks"></a>Notes

Vous devez remplacer cette fonction et retourner VRAI si votre contrôle OLE sous-classe un contrôle Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl::Load

Réinitialise toutes les données précédentes chargées asynchronement et initie un nouveau chargement de la propriété asynchrone du contrôle.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Paramètres

*strNewPath (en)*<br/>
Pointeur d’une chaîne contenant le chemin qui fait référence à l’emplacement absolu de la propriété de contrôle asynchrone.

*Prop*<br/>
Un objet [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) mettant en œuvre une propriété de contrôle asynchrone.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl::LockInPlaceActive

Empêche le conteneur de désactiver votre contrôle.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Paramètres

*Bloc*<br/>
VRAI si l’état actif de contrôle sur place doit être verrouillé; FALSE si elle doit être déverrouillée.

### <a name="return-value"></a>Valeur de retour

Nonzero si la serrure a été couronnée de succès; sinon 0.

### <a name="remarks"></a>Notes

Notez que chaque verrouillage du contrôle doit être jumelé à un déverrouillage du contrôle une fois terminé. Vous ne devez verrouiller votre contrôle que pendant de courtes périodes, par exemple lors du tir d’un événement.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange

Appelé par le cadre quand une propriété ambiante du conteneur a changé de valeur.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*dispID*<br/>
L’ID de répartition de la propriété ambiante qui a changé, ou DISPID_UNKNOWN si plusieurs propriétés ont changé.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl::OnAppearanceChanged

Appelé par le cadre lorsque la valeur de la propriété Apparence stock a changé.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété. Les appels `InvalidateControl`de mise en œuvre par défaut .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged

Appelé par le cadre lorsque la valeur de la propriété BackColor stock a changé.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété. Les appels `InvalidateControl`de mise en œuvre par défaut .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged

Appelé par le cadre lorsque la valeur de la propriété BorderStyle stock a changé.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Notes

Les appels `InvalidateControl`de mise en œuvre par défaut .

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl::OnClick

Appelé par le cadre quand un bouton de souris a été cliqué ou la méthode de stock DoClick a été invoquée.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Paramètres

*iButton (en)*<br/>
Index d’un bouton de souris. Peut avoir l'une des valeurs suivantes :

- LEFT_BUTTON Le bouton de la souris gauche a été cliqué.

- MIDDLE_BUTTON Le bouton de la souris du milieu a été cliqué.

- RIGHT_BUTTON Le bouton de la souris droite a été cliqué.

### <a name="remarks"></a>Notes

Les appels `COleControl::FireClick`de mise en œuvre par défaut .

Remplacer cette fonction de membre pour modifier ou étendre la manipulation par défaut.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl::OnClose

Appelé par le cadre lorsque le conteneur `IOleControl::Close` a appelé la fonction du contrôle.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Paramètres

*dwSaveOption*<br/>
Indicateur indiquant si l’objet doit être enregistré avant le chargement. Les valeurs autorisées sont :

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Notes

Par défaut, `OnClose` enregistre l’objet de commande s’il a été modifié et *dwSaveOption* est soit OLECLOSE_SAVEIFDIRTY ou OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl::OnDoVerb

Appelé par le cadre lorsque `IOleObject::DoVerb` le conteneur appelle la fonction membre.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*iVerb (en)*<br/>
L’index du verbe de contrôle à invoquer.

*lpMsg*<br/>
Un pointeur vers le message Windows qui a causé l’invoque du verbe.

*hWndParent*<br/>
La poignée à la fenêtre parente du contrôle. Si l’exécution du verbe crée une fenêtre (ou des fenêtres), *hWndParent* doit être utilisé comme parent.

*lpRect*<br/>
Un pointeur d’une structure RECT dans laquelle les coordonnées du contrôle, par rapport au conteneur, seront copiées.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel a été un succès; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut utilise les entrées ON_OLEVERB et ON_STDOLEVERB carte de message pour déterminer la fonction appropriée à invoquer.

Remplacer cette fonction pour modifier la manipulation par défaut du verbe.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl::OnDraw

Appelé par le cadre pour dessiner le contrôle OLE dans le rectangle de délimitation spécifié en utilisant le contexte de l’appareil spécifié.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de l’appareil dans lequel le dessin se produit.

*rcBounds*<br/>
La zone rectangulaire du contrôle, y compris la frontière.

*rcInvalid*<br/>
La zone rectangulaire du contrôle qui est invalide.

### <a name="remarks"></a>Notes

`OnDraw`est généralement appelé pour l’affichage de l’écran, en passant un contexte de dispositif d’écran comme *pDC*. Le *paramètre rcBounds* identifie le rectangle dans le contexte de l’appareil cible (par rapport à son mode de cartographie actuel). Le *paramètre rcInvalid* est le rectangle réel qui est invalide. Dans certains cas, il s’agira d’une zone plus petite que *les rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl::OnDrawMetafile

Appelé par le cadre pour dessiner le contrôle OLE dans le rectangle de délimitation spécifié en utilisant le contexte de périphérique métaafile spécifié.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de l’appareil dans lequel le dessin se produit.

*rcBounds*<br/>
La zone rectangulaire du contrôle, y compris la frontière.

### <a name="remarks"></a>Notes

La implémentation par défaut appelle la fonction [OnDraw.](#ondraw)

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::OnEdit

L’interface utilisateur activée par le contrôle est activée.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Un pointeur vers le message Windows qui invoquait le verbe.

*hWndParent*<br/>
Une poignée à la fenêtre parente du contrôle.

*lpRect*<br/>
Un pointeur sur le rectangle utilisé par le contrôle dans le récipient.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel est réussi; sinon 0.

### <a name="remarks"></a>Notes

Cela a le même effet que d’invoquer le verbe OLEIVERB_UIACTIVATE du contrôle.

Cette fonction est généralement utilisée comme fonction de gestionnaire pour une entrée de carte de message ON_OLEVERB. Cela rend un verbe "Edit" disponible sur le menu "Object" du contrôle. Par exemple :

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl::OnEnabledChanged

Appelé par le cadre lorsque la valeur de la propriété activée par le stock a changé.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Notes

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété. La mise en œuvre par défaut appelle [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl::OnEnumVerbs

Appelé par le cadre lorsque `IOleObject::EnumVerbs` le conteneur appelle la fonction membre.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Paramètres

*ppenumOleVerb*<br/>
Un pointeur `IEnumOLEVERB` de l’objet qui énumère les verbes du contrôle.

### <a name="return-value"></a>Valeur de retour

Nonzero si des verbes sont disponibles; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut énumère les entrées ON_OLEVERB dans la carte de message.

Remplacer cette fonction pour modifier la façon par défaut d’énumérer les verbes.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl::OnEventAdvise

Appelé par le cadre lorsqu’un gestionnaire d’événements est connecté ou déconnecté d’un contrôle OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Paramètres

*bAdvise (en)*<br/>
TRUE indique qu’un gestionnaire d’événements a été connecté au contrôle. FALSE indique qu’un gestionnaire d’événements a été déconnecté du contrôle.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::OnFontChanged

Appelé par le cadre lorsque la valeur de la propriété Font stock a changé.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Notes

Les appels `COleControl::InvalidateControl`de mise en œuvre par défaut . Si le contrôle sous-classe un contrôle Windows, l’implémentation par défaut envoie également un message WM_SETFONT à la fenêtre du contrôle.

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl::OnForeColorChanged

Appelé par le cadre lorsque la valeur de la propriété ForeColor stock a changé.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Notes

Les appels `InvalidateControl`de mise en œuvre par défaut .

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl::OnFreezeEvents

Appelé par le cadre `IOleControl::FreezeEvents`après les appels conteneur .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Paramètres

*bFreeze (en)*<br/>
VRAI si la gestion de l’événement du contrôle est gelée; autrement FALSE.

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération.

Remplacez cette fonction si vous voulez un comportement supplémentaire lorsque la manipulation de l’événement est gelée ou non gelée.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl::OnGetColorSet

Appelé par le cadre lorsque `IViewObject::GetColorSet` le conteneur appelle la fonction membre.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Paramètres

*Ptd*<br/>
Points sur le dispositif cible pour lequel l’image doit être rendue. Si cette valeur est NULL, l’image doit être rendue pour un périphérique cible par défaut, généralement un périphérique d’affichage.

*hicTargetDev*<br/>
Spécifie le contexte d’information sur le dispositif cible indiqué par *ptd*. Ce paramètre peut être un contexte d’appareil, mais n’en est pas nécessairement un. Si *le ptd* est NULL, *hicTargetDev* devrait également être NULL.

*ppColorSet (en anglais)*<br/>
Un pointeur à l’emplacement dans lequel l’ensemble de couleurs qui seraient utilisés doit être copié. Si la fonction ne renvoie pas l’ensemble de couleurs, NULL est retourné.

### <a name="return-value"></a>Valeur de retour

Nonzero si un ensemble de couleurs valide est retourné; sinon 0.

### <a name="remarks"></a>Notes

Le conteneur appelle cette fonction pour obtenir toutes les couleurs nécessaires pour dessiner le contrôle OLE. Le récipient peut utiliser les ensembles de couleurs obtenus en conjonction avec les couleurs dont il a besoin pour définir la palette de couleurs globale. La implémentation par défaut renvoie FALSE.

Remplacer cette fonction pour effectuer n’importe quel traitement spécial de cette demande.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo

Appelé par le cadre lorsque le conteneur du contrôle a demandé des informations sur le contrôle.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Paramètres

*pControlInfo (en anglais)*<br/>
Pointeur vers une structure [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) à remplir.

### <a name="remarks"></a>Notes

Ces informations se composent principalement d’une description des clés mnémoniques du contrôle. L’implémentation par défaut remplit *pControlInfo* d’informations par défaut.

Remplacez cette fonction si votre contrôle doit traiter les touches mnémoniques.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString

Appelé par le cadre pour obtenir une chaîne qui représente la valeur actuelle de la propriété identifiée par *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*strValue*<br/>
Une référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) à travers lequel une corde sera retournée.

### <a name="return-value"></a>Valeur de retour

Nonzero si une chaîne a été retournée en *strValue;* sinon 0.

### <a name="remarks"></a>Notes

Remplacer cette fonction si votre contrôle a une propriété dont la valeur ne peut pas être convertie directement en chaîne et vous voulez que la valeur de la propriété soit affichée dans un navigateur de propriété fourni par conteneur.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu

Appelé par le cadre lorsque le contrôle est activé par l’interface utilisateur pour obtenir le menu à fusionner dans le menu existant du conteneur.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valeur de retour

La poignée du menu du contrôle, ou NULL si le contrôle n’en a pas. La mise en œuvre par défaut renvoie NULL.

### <a name="remarks"></a>Notes

Pour plus d’informations sur la fusion des ressources OLE, voir l’article [Menus et Ressources (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent

Appelé par le cadre en réponse `IViewObjectEx::GetNaturalExtent` à la demande d’un conteneur.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Les représentations comprennent du contenu, une icône, une vignette ou un document imprimé. Les valeurs valides sont tirées de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*Lindex*<br/>
La partie de l’objet qui est d’intérêt. Actuellement, seulement -1 est valide.

*Ptd*<br/>
Indique la structure [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) définissant le dispositif cible pour lequel la taille de l’objet doit être retournée.

*hicTargetDev*<br/>
Spécifie le contexte d’information du dispositif cible indiqué par le paramètre *ptd* à partir duquel l’objet peut extraire les paramètres de l’appareil et tester les capacités de l’appareil. Si *le ptd* est NULL, l’objet doit ignorer la valeur du paramètre *hicTargetDev.*

*pExtentInfo*<br/>
Indique la `DVEXTENTINFO` structure qui spécifie les données de dimensionnement. La `DVEXTENTINFO` structure est :

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Le membre `dwExtentMode` de la structure peut prendre l’une des deux valeurs :

- DVEXTENT_CONTENT Renseignez-vous sur l’ampleur du contrôle pour s’adapter exactement au contenu (snap-to-size)

- DVEXTENT_INTEGRAL Lors de la resizing, passez la taille proposée pour contrôler

*psizel*<br/>
Points de dimensionnement des données retournées par contrôle. Les données de dimensionnement retournées sont définies à -1 pour toute dimension qui n’a pas été ajustée.

### <a name="return-value"></a>Valeur de retour

Nonzero s’il retourne ou ajuste avec succès la taille; sinon 0.

### <a name="remarks"></a>Notes

Remplacer cette fonction pour retourner la taille d’affichage de l’objet la plus proche de la taille et du mode d’étendue proposés dans la `DVEXTENTINFO` structure. L’implémentation par défaut renvoie FALSE et ne fait aucun ajustement à la taille.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings

Appelé par le cadre pour obtenir un ensemble de chaînes prédéfinie représentant les valeurs possibles pour une propriété.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*pStringArray*<br/>
Un tableau de cordes à remplir avec des valeurs de retour.

*pCookieArray (en)*<br/>
Un tableau DWORD à remplir de valeurs de retour.

### <a name="return-value"></a>Valeur de retour

Nonzero si des éléments ont été ajoutés à *pStringArray* et *pCookieArray*.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a une propriété avec un ensemble de valeurs possibles qui peuvent être représentés par des cordes. Pour chaque élément ajouté à *pStringArray*, vous devez ajouter un élément correspondant "cookie" à *pCookieArray.* Ces valeurs « cookie » peuvent ensuite `COleControl::OnGetPredefinedValue` être transmises par le cadre à la fonction.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue

Appelé par le cadre pour obtenir la valeur correspondant à l’une des `COleControl::OnGetPredefinedStrings`chaînes prédéfinie précédemment retourné par un remplacement de .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*dwCookie*<br/>
Une valeur de cookie précédemment `COleControl::OnGetPredefinedStrings`retournée par un remplacement de .

*lpvarOut*<br/>
Pointeur `VARIANT` vers une structure par laquelle une valeur de propriété sera retournée.

### <a name="return-value"></a>Valeur de retour

Nonzero si une valeur a été retournée en *lpvarOut;* sinon 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl::OnGetViewExtent

Appelé par le cadre en réponse à [IViewObject2 d’un conteneur::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) demande.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Paramètres

*dwDrawAspect*<br/>
DWORD décrivant la forme ou l’aspect d’un objet doit être affichée. Les valeurs valides sont tirées de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*Lindex*<br/>
La partie de l’objet qui est d’intérêt. Actuellement, seulement -1 est valide.

*Ptd*<br/>
Indique la structure [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) définissant le dispositif cible pour lequel la taille de l’objet doit être retournée.

*lpsizel lpsizel*<br/>
Indique l’endroit où la taille de l’objet est retournée.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’information sur l’étendue est retournée avec succès; sinon 0.

### <a name="remarks"></a>Notes

Remplacer cette fonction si votre contrôle utilise un dessin à deux pas, et ses pièces opaques et transparentes ont des dimensions différentes.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl::OnGetViewRect

Appelé par le cadre en réponse `IViewObjectEx::GetRect` à la demande d’un conteneur.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
DWORD décrivant la forme ou l’aspect d’un objet doit être affichée. Les valeurs valides sont tirées de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2 :

- DVASPECT_CONTENT rectangle de délimitation de l’objet entier. Coin supérieur gauche à l’origine et à la `GetViewExtent`taille de l’objet égales à la mesure retournée par *.*

- DVASPECT_OPAQUE Objets avec une région opaque rectangulaire retournent ce rectangle. D’autres échouent.

- DVASPECT_TRANSPARENT Rectangle couvrant toutes les pièces transparentes ou irrégulières.

*pRect (en)*<br/>
Points à la structure [RECTL](/windows/win32/api/windef/ns-windef-rectl) spécifiant le rectangle dans lequel l’objet doit être dessiné. Ce paramètre contrôle le positionnement et l’étirement de l’objet.

### <a name="return-value"></a>Valeur de retour

Nonzero si le rectangle de taille à l’objet est retourné avec succès; sinon 0.

### <a name="remarks"></a>Notes

La taille de l’objet `OnGetViewRect` est convertie en rectangle à partir d’une position spécifique (la valeur par défaut est le coin supérieur gauche de l’écran). Remplacer cette fonction si votre contrôle utilise un dessin à deux pas, et ses pièces opaques et transparentes ont des dimensions différentes.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl::OnGetViewStatus

Appelé par le cadre en réponse `IViewObjectEx::GetViewStatus` à la demande d’un conteneur.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valeur de retour

Une des valeurs de l’énumération VIEWSTATUS en cas de succès; sinon 0. Les valeurs possibles sont n’importe quelle combinaison des éléments suivants :

|||
|-|-|
|VIEWSTATUS_OPAQUE|L’objet est complètement opaque. Si ce bit n’est pas réglé, l’objet contient des pièces transparentes. Ce bit ne s’applique qu’aux aspects liés au contenu et non aux DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|L’objet a un fond solide (composé d’une couleur solide, pas d’un motif de brosse). Ce bit n’est significatif que si VIEWSTATUS_OPAQUE est défini et ne s’applique qu’aux aspects liés au contenu et non à DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|L’objet prend en charge DVASPECT_OPAQUE. Toutes les méthodes IViewObjectEx qui prennent un aspect de dessin comme un paramètre peuvent être appelés avec cet aspect.|
|VIEWSTATUS_DVASPECTTRANSPARENT|L’objet prend en charge DVASPECT_TRANSPARENT. Toutes `IViewObjectEx` les méthodes qui prennent un aspect de dessin comme un paramètre peuvent être appelées avec cet aspect.|

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle utilise un dessin à deux pas. La mise en œuvre par défaut VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl::OnHideToolBars

Appelé par le cadre lorsque le contrôle est désactivé.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Notes

La mise en œuvre `OnShowToolbars`doit masquer toutes les barres d’outils affichées par .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove

Appelé par le conteneur pour l’objet inactif sous le pointeur de la souris sur la réception d’un message WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Paramètres

*lprcBounds (lprcBounds)*<br/>
Le rectangle de délimitation de l’objet, dans les coordonnées du client de la fenêtre contenante. Indique à l’objet sa position et sa taille exactes à l’écran lorsque le message WM_MOUSEMOVE a été reçu.

*x*<br/>
La coordonnées x de l’emplacement de la souris dans les coordonnées des clients de la fenêtre contenante.

*y*<br/>
La coordonnées y de l’emplacement de la souris dans les coordonnées des clients de la fenêtre contenant.

*dwKeyState (en)*<br/>
Identifie l’état actuel des touches modificateur du clavier sur le clavier. Les valeurs valides peuvent être une combinaison de l’un des drapeaux MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON et MK_RBUTTON.

### <a name="remarks"></a>Notes

Notez que les coordonnées des clients de fenêtre (pixels) sont utilisées pour passer la position du curseur de souris. Ceci est rendu possible en passant également le rectangle de délimitation de l’objet dans le même système de coordonnées.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor

Appelé par le conteneur pour l’objet inactif sous le pointeur de la souris sur la réception d’un message WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Paramètres

*lprcBounds (lprcBounds)*<br/>
Le rectangle de délimitation de l’objet, dans les coordonnées du client de la fenêtre contenante. Indique à l’objet sa position et sa taille exactes à l’écran lorsque le message WM_SETCURSOR a été reçu.

*x*<br/>
La coordonnées x de l’emplacement de la souris dans les coordonnées des clients de la fenêtre contenante.

*y*<br/>
La coordonnées y de l’emplacement de la souris dans les coordonnées des clients de la fenêtre contenant.

*dwMouseMsg*<br/>
L’identifiant du message de souris pour lequel une WM_SETCURSOR s’est produite.

*bSetAlways (en anglais)*<br/>
Précise si l’objet doit ou non régler le curseur. Si VRAI, l’objet doit régler le curseur; si FALSE, le curseur n’est pas obligé de régler le curseur, et doit retourner S_FALSE dans ce cas.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Notez que les coordonnées des clients de fenêtre (pixels) sont utilisées pour passer la position du curseur de souris. Ceci est rendu possible en passant également le rectangle de délimitation de l’objet dans le même système de coordonnées.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl::OnKeyDownEvent

Appelé par le cadre après un événement De stock KeyDown a été traitée.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*Nchar*<br/>
La valeur de code clé virtuelle de la clé pressée. Pour une liste de codes clés virtuels standard, voir Winuser.h

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations clés après le licenciement de l’événement.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::OnKeyPressEvent

Appelé par le cadre après l’événement De stock KeyPress a été tiré.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Paramètres

*Nchar*<br/>
Contient la valeur de code clé virtuelle de la clé pressée. Pour une liste de codes clés virtuels standard, voir Winuser.h

### <a name="remarks"></a>Notes

Notez que la valeur *nChar* peut avoir été modifiée par le conteneur.

Remplacez cette fonction si vous souhaitez être informé après cet événement.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl::OnKeyUpEvent

Appelé par le cadre après un événement De stock KeyDown a été traitée.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*Nchar*<br/>
La valeur de code clé virtuelle de la clé pressée. Pour une liste de codes clés virtuels standard, voir Winuser.h

*nShiftState (en)*<br/>
Contient une combinaison des drapeaux suivants :

- SHIFT_MASK La clé SHIFT a été pressée pendant l’action.

- CTRL_MASK La clé CTRL a été pressée pendant l’action.

- ALT_MASK La clé ALT a été pressée pendant l’action.

### <a name="remarks"></a>Notes

Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations clés après le licenciement de l’événement.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage

Appelé par le cadre pour obtenir l’ID de classe d’une page de propriété qui implémente l’édition de la propriété spécifiée.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Paramètres

*dispid*<br/>
ID de distribution d’une propriété du contrôle.

*lpclsid*<br/>
Pointeur `CLSID` vers une structure par laquelle une pièce d’identité de classe sera retournée.

*pbPageOptional*<br/>
Retourne un indicateur de l’option de l’utilisation de la page de propriété spécifiée.

### <a name="return-value"></a>Valeur de retour

Nonzero si une pièce d’identité de classe a été retournée en *lpclsid;* sinon 0.

### <a name="remarks"></a>Notes

Remplacez cette fonction pour fournir un moyen d’invoquer les pages de propriété de votre contrôle à partir du navigateur de propriété du conteneur.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl::OnMnemonic

Appelé par le cadre lorsque le conteneur a détecté qu’une clé mnémonique du contrôle OLE a été pressée.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Paramètres

*pMsg*<br/>
Pointeur vers le message Windows généré par une pression sur une touche mnémonique.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl::OnProperties

Appelé par le cadre lorsque le verbe des propriétés du contrôle a été invoqué par le conteneur.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Un pointeur vers le message Windows qui invoquait le verbe.

*hWndParent*<br/>
Une poignée à la fenêtre parente du contrôle.

*lpRect*<br/>
Un pointeur sur le rectangle utilisé par le contrôle dans le récipient.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel est réussi; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut affiche une boîte de dialogue de propriété modale.

Vous pouvez également utiliser cette fonction pour provoquer l’affichage des pages de propriété de votre contrôle. Faites un appel `OnProperties` à la fonction, en passant la poignée du parent de votre contrôle dans le paramètre *hWndParent.* Dans ce cas, les valeurs des paramètres *lpMsg* et *lpRect* sont ignorées.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint

Appelé par le cadre en réponse `IViewObjectEx::QueryHitPoint` à la demande d’un conteneur.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Précise comment l’objet est représenté. Les valeurs valides sont tirées de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds (en)*<br/>
Pointeur `RECT` vers une structure spécifiant le rectangle de délimitation de la zone client de contrôle OLE.

*ptlLoc (en)*<br/>
Pointeur `POINT` à la structure spécifiant le point à vérifier pour un coup. Le point est spécifié dans les coordonnées de la zone client OLE.

*lCloseHint*<br/>
La distance qui définit "proche" du point vérifié pour un coup.

*pHitResult*<br/>
Pointeur sur le résultat de la requête à succès. L’une des valeurs suivantes :

- HITRESULT_OUTSIDE *ptlLoc* est à l’extérieur de l’objet OLE et ne se ferme pas.

- HITRESULT_TRANSPARENT *ptlLoc* est dans les limites de l’objet OLE, mais pas près de l’image. Par exemple, un point au milieu d’un cercle transparent pourrait être HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* est à l’intérieur ou à l’extérieur de l’objet OLE, mais assez proche de l’objet pour être considéré à l’intérieur. De petits objets minces ou détaillés peuvent utiliser cette valeur. Même si un point est à l’extérieur du rectangle de délimitation d’un objet, il peut encore être proche (cela est nécessaire pour frapper de petits objets).

- HITRESULT_HIT *ptlLoc* est à l’intérieur de l’image de l’objet.

### <a name="return-value"></a>Valeur de retour

Nonzero si un résultat de coup est retourné avec succès; sinon 0. Un coup est un chevauchement avec la zone d’affichage de contrôle OLE.

### <a name="remarks"></a>Notes

Demande si le rectangle d’affichage d’un objet chevauche le point donné (frappe le point). `QueryHitPoint`peuvent être remplacés pour tester des coups pour des objets non rectangulaires.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl::OnQueryHitRect

Appelé par le cadre en réponse `IViewObjectEx::QueryHitRect` à la demande d’un conteneur.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Les valeurs valides sont tirées de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds (en)*<br/>
Pointeur `RECT` vers une structure spécifiant le rectangle de délimitation de la zone client de contrôle OLE.

*prcLoc (prcLoc)*<br/>
Pointeur `RECT` sur la structure spécifiant le rectangle à vérifier pour un coup (chevauchement avec le rectangle de l’objet), par rapport au coin supérieur gauche de l’objet.

*lCloseHint*<br/>
Non utilisé.

*pHitResult*<br/>
Pointeur sur le résultat de la requête à succès. L’une des valeurs suivantes :

- HITRESULT_OUTSIDE aucun point dans le rectangle n’est touché par l’objet OLE.

- HITRESULT_HIT au moins un point dans le rectangle serait un coup sur l’objet.

### <a name="return-value"></a>Valeur de retour

Nonzero si un résultat de coup est retourné avec succès; sinon 0.

### <a name="remarks"></a>Notes

Demande si le rectangle d’affichage d’un objet chevauche n’importe quel point dans le rectangle donné (frappe le rectangle). `QueryHitRect`peuvent être remplacés pour tester des coups pour des objets non rectangulaires.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl::OnRenderData

Appelé par le cadre pour récupérer les données dans le format spécifié.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Indique la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) précisant le format dans lequel l’information est demandée.

*lpStgMedium*<br/>
Indique une structure [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) dans laquelle les données doivent être retournées.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un format précédemment placé dans l’objet de commande en utilisant les fonctions de membre [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) pour le rendu retardé. La mise en œuvre par défaut de cette fonction appelle `OnRenderFileData` ou, `OnRenderGlobalData`respectivement, si le support de stockage fourni est soit un fichier ou une mémoire. Si le format demandé est CF_METAFILEPICT ou le format de l’ensemble de propriété persistant, la mise en œuvre par défaut rend les données appropriées et renvoie nonzero. Sinon, il revient 0 et ne fait rien.

Si *lpStgMedium->attaché* est TYMED_NULL, le STGMEDIUM doit être attribué et rempli comme spécifié par *lpFormatEtc->tymed*. Si ce n’est pas TYMED_NULL, le STGMEDIUM doit être rempli en place avec les données.

Remplacez cette fonction pour fournir vos données dans le format et le support demandés. Selon vos données, vous pouvez remplacer l’une des autres versions de cette fonction à la place. Si vos données sont petites et `OnRenderGlobalData`fixes en taille, remplacez . Si vos données sont dans un fichier, ou `OnRenderFileData`sont de taille variable, remplacez .

Pour plus d’informations, voir les `FORMATETC` structures et `STGMEDIUM` les structures dans le SDK Windows.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl::OnRenderFileData

Appelé par le cadre pour récupérer les données dans le format spécifié lorsque le support de stockage est un fichier.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Indique la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) précisant le format dans lequel l’information est demandée.

*pFile (en)*<br/>
Indique un objet [CFile](../../mfc/reference/cfile-class.md) dans lequel les données doivent être rendues.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un format précédemment placé dans l’objet de commande en utilisant la fonction membre [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pour le rendu retardé. La mise en œuvre par défaut de cette fonction renvoie simplement FALSE.

Remplacez cette fonction pour fournir vos données dans le format et le support demandés. Selon vos données, vous voudrez peut-être passer outre l’une des autres versions de cette fonction à la place. Si vous voulez gérer plusieurs supports `OnRenderData`de stockage, remplacez . Si vos données sont dans un fichier, ou `OnRenderFileData`sont de taille variable, remplacez .

Pour plus d’informations, voir la `FORMATETC` structure dans le SDK Windows.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData

Appelé par le cadre pour récupérer les données dans le format spécifié lorsque le support de stockage spécifié est la mémoire globale.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Indique la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) précisant le format dans lequel l’information est demandée.

*phGlobal*<br/>
Indique une poignée à la mémoire globale dans laquelle les données doivent être retournées. Si aucune mémoire n’a été allouée, ce paramètre peut être NULL.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le format spécifié est un format précédemment placé dans l’objet de commande en utilisant la fonction membre [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pour le rendu retardé. La mise en œuvre par défaut de cette fonction renvoie simplement FALSE.

Si *phGlobal* est NULL, alors un nouveau HGLOBAL devrait être attribué et retourné en *phGlobal*. Dans le cas contraire, le HGLOBAL spécifié par *phGlobal* doit être rempli avec les données. La quantité de données placées dans le HGLOBAL ne doit pas dépasser la taille actuelle du bloc de mémoire. En outre, le bloc ne peut pas être réaffecté à une plus grande taille.

Remplacez cette fonction pour fournir vos données dans le format et le support demandés. Selon vos données, vous pouvez remplacer l’une des autres versions de cette fonction à la place. Si vous voulez gérer plusieurs supports `OnRenderData`de stockage, remplacez . Si vos données sont dans un fichier, ou `OnRenderFileData`sont de taille variable, remplacez .

Pour plus d’informations, voir la `FORMATETC` structure dans le SDK Windows.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl::OnResetState

Appelé par le cadre lorsque les propriétés du contrôle doivent être définies à leurs valeurs par défaut.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Notes

La implémentation par défaut appelle `CPropExchange` [DoPropExchange](#dopropexchange), en passant un objet qui provoque des propriétés à définir à leurs valeurs par défaut.

L’auteur de contrôle peut insérer le code d’initialisation pour le contrôle OLE dans ce dépassement. Cette fonction est appelée quand [IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) or [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) fails, or [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) or [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) is called, without first calling either `IPersistStream::Load` or `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl::OnSetClientSite

Appelé par le cadre lorsque le conteneur `IOleControl::SetClientSite` a appelé la fonction du contrôle.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Notes

Par défaut, `OnSetClientSite` vérifie si les propriétés de trajectoire `DoDataPathPropExchange`de données sont chargées et, si elles sont, les appels .

Remplacer cette fonction pour effectuer un traitement spécial de cette notification. En particulier, les remplacements de cette fonction devraient appeler la classe de base.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl::OnSetData

Appelé par le cadre pour remplacer les données du contrôle par les données spécifiées.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) spécifiant le format des données.

*lpStgMedium*<br/>
Pointeur vers une structure [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) dans laquelle les données résident.

*bRelease (en)*<br/>
VRAI si le contrôle doit libérer le support de stockage; FALSE si le contrôle ne doit pas libérer le support de stockage.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si les données sont dans le format de l’ensemble de propriété persistant, la mise en œuvre par défaut modifie l’état du contrôle en conséquence. Sinon, la implémentation par défaut ne fait rien. Si *bRelease* est VRAI, `ReleaseStgMedium` alors un appel à est fait; sinon pas.

Remplacer cette fonction pour remplacer les données du contrôle par les données spécifiées.

Pour plus d’informations, voir les `FORMATETC` structures et `STGMEDIUM` les structures dans le SDK Windows.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl::OnSetExtent

Appelé par le cadre lorsque l’étendue du contrôle doit être changé, à la suite d’un appel à [IOleObject:SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Paramètres

*lpSizeL*<br/>
Un pointeur `SIZEL` à la structure qui utilise de longs entiers pour représenter la largeur et la hauteur du contrôle, exprimés dans les unités HIMETRIC.

### <a name="return-value"></a>Valeur de retour

Nonzero si le changement de taille a été accepté; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut gère la resizing de l’étendue du contrôle. Si le contrôle est actif sur place, un `OnPosRectChanged` appel au conteneur est alors effectué.

Remplacer cette fonction pour modifier la resizing par défaut de votre contrôle.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl::OnSetObjectRects

Appelé par le cadre pour mettre en œuvre un appel à [IOleInPlaceObject:SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Paramètres

*lpRectPos*<br/>
Un pointeur `RECT` d’une structure indiquant la nouvelle position et la taille du contrôle par rapport au conteneur.

*lpRectClip*<br/>
Un pointeur `RECT` à une structure indiquant une zone rectangulaire à laquelle le contrôle doit être coupé.

### <a name="return-value"></a>Valeur de retour

Nonzero si le repositionnement a été accepté; sinon 0.

### <a name="remarks"></a>Notes

La implémentation par défaut gère automatiquement le repositionnement et la resizing de la fenêtre de contrôle et renvoie TRUE.

Remplacer cette fonction pour modifier le comportement par défaut de cette fonction.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::OnShowToolBars

Appelé par le cadre lorsque le contrôle a été activé par l’interface utilisateur.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl::OnTextChanged

Appelé par le cadre lorsque la valeur de la propriété de caption ou de texte a changé.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Notes

Les appels `InvalidateControl`de mise en œuvre par défaut .

Remplacez cette fonction si vous souhaitez être informé après les changements de cette propriété.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage

Appelé par le cadre en réponse `IOleInPlaceObjectWindowless::OnWindowMessage` à la demande d’un conteneur.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Paramètres

*Msg*<br/>
Identifiant de message tel que passé par Windows.

*wParam*<br/>
Tel que passé par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur du paramètre *msg.*

*lParam*<br/>
Tel que passé par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur du paramètre *msg.*

*plResult*<br/>
Code de résultat Windows. Spécifie le résultat du traitement du message et dépend du message envoyé.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Traite les messages de fenêtre pour les commandes sans fenêtre. `COleControl`'s `OnWindowlessMessage` doivent être utilisés pour des messages de fenêtre autres que des messages de souris et des messages clavier. `COleControl`fournit [SetCapture](#setcapture) et [SetFocus](#setfocus) spécifiquement pour obtenir la capture de la souris et la mise au point du clavier pour les objets OLE sans fenêtre.

Parce que les objets sans fenêtre n’ont pas de fenêtre, ils ont besoin d’un mécanisme pour laisser le conteneur envoyer des messages pour eux. Un objet OLE sans fenêtre reçoit des `OnWindowMessage` messages `IOleInPlaceObjectWindowless` de son conteneur, à travers la méthode sur l’interface (une extension d’IOleInPlaceObject pour un support sans fenêtre). [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) `OnWindowMessage`ne prend `HWND` pas de paramètre.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::ParentToClient

Traduit les coordonnées de *pPoint* en coordonnées clients.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds (lprcBounds)*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. Pas la zone cliente, mais la zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement.

*pPoint (en)*<br/>
Pointeur au parent (conteneur) à traduire dans les coordonnées de la zone client du contrôle.

*bHitTest (en)*<br/>
Précise si oui ou non les tests de frappe doivent être faits sur le point.

### <a name="return-value"></a>Valeur de retour

Si *bHitTest* est FALSE, retourne HTNOWHERE. Si *bHitTest* est VRAI, retourne l’endroit où le point parent (conteneur) a atterri dans la zone client du contrôle OLE et est l’une des valeurs suivantes de hit-test de souris :

- HTBORDER À la frontière d’une fenêtre qui n’a pas de bordure de taille.

- HTBOTTOM Dans la bordure horizontale inférieure de la fenêtre.

- HTBOTTOMLEFT Dans le coin inférieur gauche de la bordure de la fenêtre.

- HTBOTTOMRIGHT Dans le coin inférieur droit de la bordure de fenêtre.

- HTCAPTION Dans une zone de barre de titre.

- HTCLIENT Dans un secteur client.

- HTERROR Sur le fond de l’écran ou sur une ligne de `DefWndProc` démarcation entre les fenêtres (même que HTNOWHERE sauf que la fonction Windows produit un bip système pour indiquer une erreur).

- HTGROWBOX Dans une boîte de taille.

- HTHSCROLL Dans la barre de défilement horizontal.

- HTLEFT Dans la bordure gauche de la fenêtre.

- HTMAXBUTTON Dans un bouton Maximise.

- HTMENU Dans une zone de menu.

- HTMINBUTTON Dans un bouton Minimiser.

- HTNOWHERE Sur le fond de l’écran ou sur une ligne de démarcation entre les fenêtres.

- HTREDUCE Dans un bouton Minimiser.

- HTRIGHT Dans la bordure droite de la fenêtre.

- HTSIZE Dans une boîte de taille (même que HTGROWBOX).

- HTSYSMENU Dans un menu Contrôle ou dans un bouton Fermer dans une fenêtre enfant.

- HTTOP Dans la bordure horizontale supérieure de la fenêtre.

- HTTOPLEFT Dans le coin supérieur gauche de la bordure de la fenêtre.

- HTTOPRIGHT Dans le coin supérieur droit de la bordure de fenêtre.

- HTTRANSPARENT Dans une fenêtre actuellement recouverte d’une autre fenêtre.

- HTVSCROLL Dans la barre de défilement vertical.

- HTZOOM Dans un bouton Maximise.

### <a name="remarks"></a>Notes

Sur l’entrée *pPoint* est relative à l’origine du parent (coin supérieur gauche du conteneur). Sur la sortie *pPoint* est relative à l’origine de la zone client du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::PostModalDialog

Informe le conteneur qu’une boîte de dialogue modal a été fermée.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Gérer à la fenêtre parente de la boîte de dialogue modal.

### <a name="remarks"></a>Notes

Appelez cette fonction après avoir affiché n’importe quelle boîte de dialogue modal. Vous devez appeler cette fonction afin que le conteneur `PreModalDialog`peut activer toutes les fenêtres de haut niveau désactivées par . Cette fonction doit être jumelée `PreModalDialog`à un appel à .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::PreModalDialog

Informe le conteneur qu’une boîte de dialogue modal est sur le point d’être affichée.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Gérer à la fenêtre parente de la boîte de dialogue modal.

### <a name="remarks"></a>Notes

Appelez cette fonction avant d’afficher n’importe quelle boîte de dialogue modal. Vous devez appeler cette fonction afin que le conteneur puisse désactiver toutes ses fenêtres de haut niveau. Une fois que la boîte de dialogue modal a été affichée, vous devez alors appeler `PostModalDialog`.

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow

Détruit et re-crée la fenêtre du contrôle.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Notes

Cela peut être nécessaire si vous avez besoin de changer les bits de style de la fenêtre.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl::Rafraîchissement

Force un repeindre du contrôle de l’OL.

```cpp
void Refresh();
```

### <a name="remarks"></a>Notes

Cette fonction est `COleControl` prise en charge par la classe de base comme méthode de stock, appelée Refresh. Cela permet aux utilisateurs de votre contrôle OLE de repeindre le contrôle à un moment précis. Pour plus d’informations sur cette méthode, voir l’article [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl::ReleaseCapture

Libère la capture de la souris.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si le contrôle a actuellement la capture de la souris, la capture est libérée. Sinon, cette fonction n’a aucun effet.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl::ReleaseDC

Libère le contexte de l’appareil d’affichage d’un conteneur d’un contrôle sans fenêtre, libérant le contexte de l’appareil pour une utilisation par d’autres applications.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Identifie le contexte de l’appareil de conteneur à libérer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La demande `ReleaseDC` doit appeler pour chaque appel à [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow

Définit le parent du contrôle.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Paramètres

*hWndOuter (en)*<br/>
La poignée de la fenêtre de contrôle.

*hWndParent*<br/>
Le manche de la nouvelle fenêtre parente.

### <a name="remarks"></a>Notes

Appelez cette fonction pour réinitialiser le parent de la fenêtre de contrôle.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl::ResetStockProps

Initialise l’état `COleControl` des propriétés boursières à leurs valeurs par défaut.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Notes

Les propriétés sont: Apparence, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor, hWnd, et Texte. Pour une description des propriétés des actions, voir [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances d’initialisation `ResetVersion` binaire `COleControl::OnResetState`d’un contrôle en utilisant `ResetStockProps` et en déroisonnant . Reportez-vous à l’exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl::ResetVersion

Initialise le numéro de version à une valeur spécifiée.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Paramètres

*dwVersionDefault*<br/>
Le numéro de version à attribuer au contrôle.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances d’initialisation `ResetStockProps` binaire `COleControl::OnResetState`d’un contrôle en utilisant `ResetVersion` et en déroisonnant . Voir l’exemple à [ResetStockProps](#resetstockprops). Pour plus d’informations sur l’optimisation de l’initialisation, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl::ScrollWindow

Permet à un objet OLE sans fenêtre de faire défiler une zone à l’intérieur de son image active sur l’écran.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Paramètres

*xAmount (en)*<br/>
Spécifie la quantité, dans les unités de périphériques, de défilement horizontal. Ce paramètre doit être une valeur négative pour faire défiler vers la gauche.

*yAmount yAmount*<br/>
Spécifie la quantité, dans les unités de périphériques, du défilement vertical. Ce paramètre doit être une valeur négative pour faire défiler vers le haut.

*lpRect*<br/>
Indique un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou une structure RECT qui spécifie la partie de la zone client de l’objet OLE à faire défiler, dans les coordonnées des clients de la fenêtre contenante. Si *lpRect* est NULL, toute la zone client de l’objet OLE est défichée.

*lpClipRect*<br/>
Points à `CRect` un `RECT` objet ou une structure qui spécifie le rectangle à clip. Seuls les pixels à l’intérieur du rectangle sont défilés. Les morceaux à l’extérieur du rectangle ne sont pas affectés même s’ils sont dans le rectangle *lpRect.* Si *lpClipRect* est NULL, aucune coupure n’est effectuée sur le rectangle de défilement.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl::SelectFontObject

Sélectionne une police dans un contexte d’appareil.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers un objet de contexte de périphérique.

*policeHolder*<br/>
Référence à l’objet [CFontHolder](../../mfc/reference/cfontholder-class.md) représentant la police à sélectionner.

### <a name="return-value"></a>Valeur de retour

Un pointeur à la police précédemment sélectionnée. Lorsque l’appelant a terminé toutes les opérations de dessin qui utilisent *la policeHolder,* il doit réélire la police précédemment sélectionnée en la passant comme un paramètre à [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl::SelectStockFont

Sélectionne la propriété Stock Font dans un contexte d’appareil.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Le contexte de l’appareil dans lequel la police sera sélectionnée.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers `CFont` l’objet précédemment sélectionné. Vous devez utiliser [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) pour sélectionner cette police dans le contexte de l’appareil lorsque vous avez terminé.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl::SerializeExtent

Sérialise ou initialise l’état de l’espace d’affichage alloué au contrôle.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*Ar*<br/>
Un `CArchive` objet à sérialiser vers ou depuis.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances de `SerializeExtent`persistance `SerializeStockProps`binaire `SerializeVersion` d’un contrôle en utilisant, , et de remplacer `COleControl::Serialize`. Reportez-vous à l’exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl::SerializeStockProps

Sérialise ou initialise l’état des propriétés `COleControl` du stock : Apparence, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor et Texte.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*Ar*<br/>
Un `CArchive` objet à sérialiser vers ou depuis.

### <a name="remarks"></a>Notes

Pour une description des propriétés des actions, voir [ActiveX Controls: Adding Stock Properties](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances de `SerializeStockProps`persistance `SerializeExtent`binaire `SerializeVersion` d’un contrôle en utilisant, , et de remplacer `COleControl::Serialize`. Par exemple, voir le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl::SerializeVersion

Sérialise ou initialise l’état des informations de version d’un contrôle.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*Ar*<br/>
Un `CArchive` objet à sérialiser vers ou depuis.

*dwVersionDefault*<br/>
Le numéro de version actuel du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties au dernier format lorsqu’elles sont enregistrées, ou maintenues dans le même format qu’elles avaient lorsqu’elles ont été chargées.

### <a name="return-value"></a>Valeur de retour

Le numéro de version du contrôle. Si l’archive spécifiée est en charge, `SerializeVersion` renvoie la version chargée à partir de cette archive. Sinon, il renvoie la version actuellement chargée.

### <a name="remarks"></a>Notes

Vous pouvez améliorer les performances de `SerializeVersion`persistance `SerializeExtent`binaire `SerializeStockProps` d’un contrôle en utilisant, , et de remplacer `COleControl::Serialize`. Par exemple, voir le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, voir [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl::SetAppearance

Définit la valeur de propriété d’apparence d’actions de votre contrôle.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Paramètres

*sAppearance*<br/>
Une **courte** valeur (VT_I2) à utiliser pour l’apparence de votre contrôle. Une valeur de zéro met l’apparence du contrôle à plat et une valeur de 1 définit l’apparence du contrôle en 3D.

### <a name="remarks"></a>Notes

Pour en savoir plus sur les propriétés des actions, voir [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl::SetBackColor

Définit la valeur de propriété BackColor de votre contrôle.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Paramètres

*dwBackColor (en)*<br/>
Une valeur OLE_COLOR à utiliser pour le dessin de fond de votre contrôle.

### <a name="remarks"></a>Notes

Pour plus d’informations sur l’utilisation de cette propriété et d’autres propriétés connexes, voir l’article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl::SetBorderStyle

Définit la valeur de propriété De stock BorderStyle de votre contrôle.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Paramètres

*sBorderStyle (en)*<br/>
Le nouveau style de frontière pour le contrôle; 0 n’indique aucune frontière et 1 indique une frontière normale.

### <a name="remarks"></a>Notes

La fenêtre de contrôle sera `OnBorderStyleChanged` alors recréé et appelée.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl::SetCapture

Provoque la fenêtre de conteneur du contrôle à prendre possession de la capture de la souris au nom du contrôle.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur `CWnd` à l’objet de fenêtre qui a déjà reçu l’entrée de la souris.

### <a name="remarks"></a>Notes

Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre du conteneur du contrôle à prendre possession de la capture de la souris, au nom du contrôle. Sinon, cette fonction provoque le contrôle lui-même de `CWnd::SetCapture`prendre possession de la capture de la souris (même que ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl::SetControlSize

Définit la taille de la fenêtre de contrôle OLE et informe le conteneur que le site de contrôle est en train de changer.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Paramètres

*Cx*<br/>
Spécifie la nouvelle largeur du contrôle en pixels.

*Cy*<br/>
Spécifie la nouvelle hauteur du contrôle en pixels.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel a été réussi; sinon 0.

### <a name="remarks"></a>Notes

Cette fonction ne doit pas être utilisée dans le constructeur de votre contrôle.

Notez que toutes les coordonnées des fenêtres de contrôle sont relatives au coin supérieur gauche du contrôle.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl::SetEnabled

Définit la valeur de propriété activée en stock de votre contrôle.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Paramètres

*bEnabled*<br/>
VRAI si le contrôle doit être activé; autrement FALSE.

### <a name="remarks"></a>Notes

Après avoir défini `OnEnabledChange` cette propriété, est appelé.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl::SetFocus

Fait en fait que la fenêtre de conteneur du contrôle prend possession de l’accent mis sur l’entrée au nom du contrôle.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur `CWnd` à l’objet de fenêtre qui avait précédemment la mise au point d’entrée, ou NULL s’il n’y a pas une telle fenêtre.

### <a name="remarks"></a>Notes

Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre de conteneur du contrôle à prendre possession de l’accent d’entrée, au nom du contrôle. La mise au point de l’entrée dirige l’entrée du clavier vers la fenêtre `SetFocus`du conteneur, et le conteneur envoie tous les messages clavier ultérieurs à l’objet OLE qui appelle . Toute fenêtre qui avait précédemment la mise au point d’entrée le perd.

Si le contrôle n’est pas sans fenêtre, cette fonction provoque le `CWnd::SetFocus`contrôle lui-même de prendre possession de la mise au point d’entrée (même que ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl::SetFont

Définit la propriété De fonte de stock de votre contrôle.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Paramètres

*pFontDisp (en)*<br/>
Un pointeur à une interface de répartition De Font.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl::SetForeColor

Définit la valeur de propriété ForeColor de votre contrôle.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Paramètres

*dwForeColor*<br/>
Une valeur OLE_COLOR à utiliser pour le dessin au premier plan de votre contrôle.

### <a name="remarks"></a>Notes

Pour plus d’informations sur l’utilisation de cette propriété et d’autres propriétés connexes, voir l’article [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats

Appelé par le cadre pour initialiser la liste des formats de données pris en charge par le contrôle.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut spécifie deux formats : CF_METAFILEPICT et l’ensemble de propriétés persistantes.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl::SetInitialSize

Définit la taille d’un contrôle OLE lorsqu’il est affiché pour la première fois dans un conteneur.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Paramètres

*Cx*<br/>
La largeur initiale du contrôle OLE en pixels.

*Cy*<br/>
La hauteur initiale du contrôle OLE en pixels.

### <a name="remarks"></a>Notes

Appelez cette fonction dans votre constructeur pour définir la taille initiale de votre contrôle. La taille initiale est mesurée en unités d’appareils, ou pixels. Il est recommandé que cet appel soit fait dans le constructeur de votre contrôle.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl::SetModifiedFlag

Modifications de l’état modifié d’un contrôle.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Paramètres

*bModifié*<br/>
La nouvelle valeur pour le drapeau modifié du contrôle. TRUE indique que l’état du contrôle a été modifié; FALSE indique que l’état du contrôle vient d’être sauvé.

### <a name="remarks"></a>Notes

Appelez cette fonction chaque fois qu’un changement se produit qui affecterait l’état persistant de votre contrôle. Par exemple, si la valeur d’une propriété persistante change, appelez cette fonction avec *bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl::SetNotPermitted

Indique qu’une demande de modification a échoué.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Notes

Appelez cette `BoundPropertyRequestEdit` fonction en cas d’échec. Cette fonction jette une `COleDispScodeException` exception de type pour indiquer que l’opération définie n’était pas autorisée.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl::SetNotSupported

Empêche la modification de la valeur de propriété d’un contrôle par l’utilisateur.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Notes

Appelez cette fonction à la place de la fonction Set de toute propriété lorsque la modification de la valeur de la propriété par l’utilisateur du contrôle n’est pas prise en charge. Un exemple serait une propriété qui est lue seulement.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl::SetRectInContainer

Définit les coordonnées du rectangle du contrôle par rapport au conteneur, exprimées dans les unités de l’appareil.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur d’un rectangle contenant les nouvelles coordonnées du contrôle par rapport au conteneur.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel a été réussi; sinon 0.

### <a name="remarks"></a>Notes

Si le contrôle est ouvert, il est resized; sinon la fonction `OnPosRectChanged` du conteneur est appelée.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl::SetText

Définit la valeur de la catégorie d’actions de votre contrôle ou de la propriété Text.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Paramètres

*pszText*<br/>
Un pointeur à une chaîne de caractère.

### <a name="remarks"></a>Notes

Notez que les propriétés caption d’actions et texte sont toutes deux cartographiées à la même valeur. Cela signifie que toute modification apportée à l’une ou l’autre propriété changera automatiquement les deux propriétés. En général, un contrôle doit prendre en charge soit la catégorie des actions ou la propriété Text, mais pas les deux.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl::ThrowError

Signale l’apparition d’une erreur dans votre contrôle.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*Sc*<br/>
La valeur du code d’état à signaler. Pour une liste complète des codes possibles, voir l’article [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID (en)*<br/>
L’ID de la ressource de chaîne de l’exception à signaler.

*nHelpID (en)*<br/>
L’id d’aide du sujet à signaler.

*pszDescription*<br/>
Une chaîne contenant une explication de l’exception à signaler.

### <a name="remarks"></a>Notes

Cette fonction ne doit être appelée qu’à partir d’une fonction Get or Set pour une propriété OLE, ou la mise en œuvre d’une méthode d’automatisation OLE. Si vous avez besoin de signaler les erreurs qui se produisent à d’autres moments, vous devez tirer l’événement d’erreur de stock.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl::TransformCoords

Transforme les valeurs de coordonnées entre les unités HIMETRIC et les unités indigènes du conteneur.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Paramètres

*lpptlHimétrique*<br/>
Pointeur `POINTL` vers une structure contenant des coordonnées dans les unités HIMETRIC.

*lpptfContainer*<br/>
Pointeur `POINTF` vers une structure contenant des coordonnées dans la taille de l’unité du conteneur.

*flags*<br/>
Une combinaison des valeurs suivantes :

- XFORMCOORDS_POSITION une position dans le conteneur.

- XFORMCOORDS_SIZE taille A dans le conteneur.

- XFORMCOORDS_HIMETRICTOCONTAINER Transformer les unités HIMETRIC en unités du conteneur.

- XFORMCOORDS_CONTAINERTOHIMETRIC Transformez les unités du conteneur en unités HIMETRIC.

### <a name="remarks"></a>Notes

Les deux premiers drapeaux, XFORMCOORDS_POSITION et XFORMCOORDS_SIZE, indiquent si les coordonnées doivent être traitées comme une position ou une taille. Les deux autres drapeaux indiquent la direction de la transformation.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl::TraduitColor

Convertit une valeur de couleur du type de données OLE_COLOR au type de données [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Paramètres

*clrColor*<br/>
Un type de données OLE_COLOR. Pour plus d’informations, consultez la fonction Windows [OleTranslateColor.](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)

*hpal hpal*<br/>
Une poignée à une palette facultative; peut être NULL.

### <a name="return-value"></a>Valeur de retour

Une valeur de couleur 32 bits RGB (rouge, vert, bleu) qui définit la couleur solide la plus proche de la valeur *clrColor* que l’appareil peut représenter.

### <a name="remarks"></a>Notes

Cette fonction est utile pour traduire les propriétés ForeColor et BackColor de stock aux types COLORREF utilisés par les fonctions des membres [des CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad

Détermine si votre contrôle doit utiliser les valeurs des propriétés ambiantes comme valeurs par défaut, lorsqu’il est ensuite chargé à partir de son état persistant.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valeur de retour

Nonzero indique que les propriétés ambiantes seront valides; sinon les propriétés ambiantes ne seront pas valides.

### <a name="remarks"></a>Notes

Dans certains conteneurs, votre contrôle peut ne pas avoir accès à `COleControl::DoPropExchange`ses propriétés ambiantes au cours de l’appel initial à la dérogation de . C’est le cas si le conteneur appelle [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) or [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) before calling [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (c’est-à-dire, si elle n’honore pas le OLEMISC_SETCLIENTSITEFIRST bit statut).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl::WindowProc

Fournit une procédure `COleControl` Windows pour un objet.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Paramètres

*message*<br/>
Spécifie le message Windows à traiter.

*wParam*<br/>
Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.

*lParam*<br/>
Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.

### <a name="return-value"></a>Valeur de retour

La valeur de retour du message envoyé.

### <a name="remarks"></a>Notes

Appelez cette fonction pour envoyer des messages spécifiques à travers la carte de message du contrôle.

## <a name="see-also"></a>Voir aussi

[MFC Échantillon CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC Échantillon TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage, classe](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder, classe](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder, classe](../../mfc/reference/cpictureholder-class.md)<br/>
