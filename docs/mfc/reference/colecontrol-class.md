---
title: COleControl (classe) | Documents Microsoft
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs: C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: "25"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 895091131bf8a62a13527f717831a34764c931ff
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/21/2017
---
# <a name="colecontrol-class"></a>COleControl (classe)
Classe de base puissante pour développer des contrôles OLE.  
  
## <a name="syntax"></a>Syntaxe  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Membres  
  
### <a name="public-constructors"></a>Constructeurs publics  
  
|Nom|Description|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Crée un objet `COleControl`.|  
  
### <a name="public-methods"></a>M&#233;thodes publiques  
  
|Nom|Description|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Récupère l’apparence actuelle du contrôle.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retourne la valeur de la propriété BackColor ambiante.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Retourne le nom du contrôle comme spécifié par le conteneur.|  
|[COleControl::AmbientFont](#ambientfont)|Retourne la valeur de la propriété de police ambiante.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Retourne la valeur de la propriété de couleur de premier plan ambiante.|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Retourne l’ID de paramètres régionaux. du conteneur|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Retourne le type d’unités utilisées par le conteneur.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Détermine si les poignées de manipulation doivent s’afficher.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Détermine si le hachurage doit s’afficher.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Retourne le type d’alignement de texte spécifié par le conteneur.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Détermine si le contrôle doit répondre aux actions de l’interface utilisateur.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Détermine le mode du conteneur.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Avertit le conteneur qu’une propriété liée a été modifiée.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Demande une autorisation pour modifier la valeur de propriété.|  
|[COleControl::ClientToParent](#clienttoparent)|Convertit un point par rapport à l’origine du contrôle à un point par rapport à l’origine de son conteneur.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Ajuste un rectangle du point d’insertion si elle est chevauché par un contrôle.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Appelez cette fonction une fois que l’ensemble des mnémoniques gérés par le contrôle a changé.|  
|[COleControl::DisplayError](#displayerror)|Affiche les événements d’erreur stock à l’utilisateur du contrôle.|  
|[COleControl::DoClick](#doclick)|Implémentation de l’action `DoClick` (méthode).|  
|[COleControl::DoPropExchange](#dopropexchange)|Sérialise les propriétés d’un `COleControl` objet.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Permet la prise en charge de cadre simple pour un contrôle.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Sérialise la largeur et la hauteur du contrôle.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Sérialise les propriétés du contrôle stock.|  
|[COleControl::ExchangeVersion](#exchangeversion)|Sérialise le numéro de version du contrôle.|  
|[COleControl::FireClick](#fireclick)|Déclenche l’action `Click` événement.|  
|[COleControl::FireDblClick](#firedblclick)|Déclenche l’action `DblClick` événement.|  
|[COleControl::FireError](#fireerror)|Déclenche l’action `Error` événement.|  
|[COleControl::FireEvent](#fireevent)|Déclenche un événement personnalisé.|  
|[COleControl::FireKeyDown](#firekeydown)|Déclenche l’action `KeyDown` événement.|  
|[COleControl::FireKeyPress](#firekeypress)|Déclenche l’action `KeyPress` événement.|  
|[COleControl::FireKeyUp](#firekeyup)|Déclenche l’action `KeyUp` événement.|  
|[COleControl::FireMouseDown](#firemousedown)|Déclenche l’action `MouseDown` événement.|  
|[COleControl::FireMouseMove](#firemousemove)|Déclenche l’action `MouseMove` événement.|  
|[COleControl::FireMouseUp](#firemouseup)|Déclenche l’action `MouseUp` événement.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Déclenche un événement lorsque l’état prêt du contrôle change.|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Modifie le comportement de l’activation par défaut d’un contrôle qui prend en charge la `IPointerInactive` interface.|  
|[COleControl::GetAmbientProperty](#getambientproperty)|Retourne la valeur de la propriété ambiante spécifiée.|  
|[COleControl::GetAppearance](#getappearance)|Retourne la valeur de la propriété Appearance du stock.|  
|[COleControl::GetBackColor](#getbackcolor)|Retourne la valeur de la propriété BackColor de stock.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Retourne la valeur de la propriété BorderStyle de stock.|  
|[COleControl::GetCapture](#getcapture)|Détermine si un objet de contrôle sans fenêtre, activé a la capture de la souris.|  
|[COleControl::GetClassID](#getclassid)|Récupère l’ID de classe du contrôle.|  
|[COleControl::GetClientOffset](#getclientoffset)|Récupère la différence entre le coin supérieur gauche de la zone du contrôle rectangulaire et le coin supérieur gauche de la zone cliente.|  
|[COleControl::GetClientRect](#getclientrect)|Récupère la taille de la zone du contrôle client.|  
|[COleControl::GetClientSite](#getclientsite)|Interroge un objet pour le pointeur à son site client actif dans son conteneur.|  
|[COleControl::GetControlFlags](#getcontrolflags)|Récupère les paramètres d’indicateur de contrôle.|  
|[COleControl::GetControlSize](#getcontrolsize)|Retourne la position et la taille du contrôle OLE.|  
|[COleControl::GetDC](#getdc)|Fournit un moyen d’un contrôle sans fenêtre obtenir un contexte de périphérique à partir de son conteneur.|  
|[COleControl::GetEnabled](#getenabled)|Retourne la valeur de la propriété Enabled de l’action.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Récupère un pointeur vers un objet de contrôle étendu appartenant au conteneur.|  
|[COleControl::GetFocus](#getfocus)|Détermine si le contrôle a le focus.|  
|[COleControl::GetFont](#getfont)|Retourne la valeur de la propriété stock Font.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Retourne les métriques d’un `CFontHolder` objet.|  
|[COleControl::GetForeColor](#getforecolor)|Retourne la valeur de la propriété ForeColor du stock.|  
|[COleControl::GetHwnd](#gethwnd)|Retourne la valeur de la propriété stock hWnd.|  
|[COleControl::GetMessageString](#getmessagestring)|Fournit le texte de barre d’état pour un élément de menu.|  
|[COleControl::GetNotSupported](#getnotsupported)|Empêche l’accès à la valeur de la propriété d’un contrôle par l’utilisateur.|  
|[COleControl::GetReadyState](#getreadystate)|Retourne l’état de préparation du contrôle.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Retourne le rectangle du contrôle par rapport à son conteneur.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Retourne les métriques de la propriété stock Font.|  
|[COleControl::GetText](#gettext)|Retourne la valeur de la propriété Text ou Caption stock.|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Substituer pour permettre à un contrôle sans fenêtre être la cible de glissement et les opérations de déplacement.|  
|[COleControl::InitializeIIDs](#initializeiids)|Indique la classe de base de l’IID utilise le contrôle.|  
|[COleControl::InternalGetFont](#internalgetfont)|Retourne un `CFontHolder` objet pour la propriété stock Font.|  
|[COleControl::InternalGetText](#internalgettext)|Récupère la propriété de légende ou le texte stock.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Définit l’état de préparation du contrôle et déclenche l’événement de changement d’état prêt.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalide une zone du contrôle affiché, à l’origine de ce dernier à être redessiné.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Invalide la zone cliente de la fenêtre conteneur dans une zone donnée. Peut servir à redessiner les contrôles sans fenêtre dans la région.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Permet de spécialisées lors du chargement d’un contrôle OLE.|  
|[COleControl::IsModified](#ismodified)|Détermine si l’état du contrôle a changé.|  
|[Fonction membre COleControl::IsOptimizedDraw](#isoptimizeddraw)|Indique si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Appelé pour déterminer si le contrôle sous-classe un contrôle Windows.|  
|[COleControl::Load](#load)|Réinitialise les données asynchrones antérieures et déclenche un nouveau chargement de la propriété du contrôle asynchrone.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Détermine si votre contrôle peut être désactivé par le conteneur.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Appelé quand une propriété ambiante est modifiée.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Appelé lorsque la propriété Appearance du stock est modifiée.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Appelé lorsque la propriété BackColor stock est modifiée.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Appelé lorsque la propriété BorderStyle stock est modifiée.|  
|[COleControl::OnClick](#onclick)|Appelée pour déclencher le clic événement.|  
|[COleControl::OnClose](#onclose)|Avertit le contrôle que `IOleControl::Close` a été appelée.|  
|[COleControl::OnDoVerb](#ondoverb)|Appelé après l’exécution d’un verbe de contrôle.|  
|[COleControl::OnDraw](#ondraw)|Appelé lorsqu’un contrôle doit redessiner.|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Appelée par le conteneur lorsqu’un contrôle est demandé pour redessiner lui-même à l’aide d’un contexte de périphérique de métafichier.|  
|[COleControl::OnEdit](#onedit)|Appelée par le conteneur d’interface utilisateur Activer un contrôle OLE.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Appelé lorsque la propriété Enabled de stock est modifié.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Appelée par le conteneur pour énumérer les verbes d’un contrôle.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Appelé lorsque des gestionnaires d’événements sont connectés ou déconnectés d’un contrôle.|  
|[COleControl::OnFontChanged](#onfontchanged)|Appelé lorsque la propriété stock Font a changé.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Appelé lorsque la propriété ForeColor du stock est modifiée.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Appelé lorsque des événements d’un contrôle sont figées ou non figées.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Avertit le contrôle que `IOleObject::GetColorSet` a été appelée.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fournit des informations mnémoniques au conteneur.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Appelée pour obtenir une chaîne représentant une valeur de propriété.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Demande le handle de menu du contrôle qui est fusionné avec le menu du conteneur.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Substituez pour récupérer la taille d’affichage du contrôle le plus proche pour le mode de taille et l’étendue proposé.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Retourne des chaînes représentant les valeurs possibles pour une propriété.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Retourne la valeur correspondant à une chaîne prédéfinie.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Substituez pour récupérer la taille des zones d’affichage du contrôle (peut être utilisé pour activer le dessin en deux temps).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Substituez pour convertir la taille du contrôle dans un rectangle, en commençant à une position spécifique.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Substituez pour récupérer l’état d’affichage du contrôle.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Appelée par le conteneur lorsque le contrôle est l’interface utilisateur désactivé.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Remplacement pour le conteneur pour le contrôle inactif sous la distribution de pointeur de souris `WM_MOUSEMOVE` messages au contrôle.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Remplacement pour le conteneur pour le contrôle inactif sous la distribution de pointeur de souris `WM_SETCURSOR` messages au contrôle.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Appelé après que l’événement KeyDown stock a été déclenché.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Appelé après que l’événement KeyPress stock a été déclenché.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Appelé après que l’événement KeyUp stock a été déclenché.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indique la page de propriétés à utiliser pour modifier une propriété.|  
|[COleControl::OnMnemonic](#onmnemonic)|Appelé lorsqu’une touche mnémonique du contrôle a été enfoncée.|  
|[COleControl::OnProperties](#onproperties)|Appelé lorsque le verbe de « Propriétés » du contrôle a été appelée.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Substituer pour la requête si l’affichage d’un contrôle chevauche un point donné.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Substituer pour la requête si n’importe quel point dans un rectangle donné chevauche l’affichage d’un contrôle.|  
|[COleControl::OnRenderData](#onrenderdata)|Appelé par l’infrastructure pour récupérer des données dans le format spécifié.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Appelé par l’infrastructure pour récupérer des données à partir d’un fichier au format spécifié.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Appelé par l’infrastructure pour récupérer des données à partir de la mémoire globale dans le format spécifié.|  
|[COleControl::OnResetState](#onresetstate)|Réinitialise les propriétés d’un contrôle pour les valeurs par défaut.|  
|[COleControl::OnSetClientSite](#onsetclientsite)|Avertit le contrôle que `IOleControl::SetClientSite` a été appelée.|  
|[COleControl::OnSetData](#onsetdata)|Remplace les données du contrôle à une autre valeur.|  
|[COleControl::OnSetExtent](#onsetextent)|Appelé après que l’étendue du contrôle a changé.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Appelé après que les dimensions du contrôle ont été modifiées.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Appelé lorsque le contrôle a été activée UI.|  
|[COleControl::OnTextChanged](#ontextchanged)|Appelé lorsque le stock texte ou la propriété Caption est modifiée.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Traite les messages de fenêtre (autres que les messages de clavier et souris) pour les contrôles sans fenêtre.|  
|[COleControl::ParentToClient](#parenttoclient)|Convertit un point par rapport à l’origine du conteneur à un point par rapport à l’origine du contrôle.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Avertit le conteneur qu’une boîte de dialogue modale a été fermée.|  
|[COleControl::PreModalDialog](#premodaldialog)|Avertit le conteneur de boîte de dialogue modale est sur le point d’être affiché.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Détruit et recrée la fenêtre du contrôle.|  
|[COleControl::Refresh](#refresh)|Force la mise à jour de l’apparence d’un contrôle.|  
|[COleControl::ReleaseCapture](#releasecapture)|Libère la capture de la souris.|  
|[COleControl::ReleaseDC](#releasedc)|Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Réinitialise le parent de la fenêtre de contrôle.|  
|[COleControl::ResetStockProps](#resetstockprops)|Initialise `COleControl` stock propriétés à leurs valeurs par défaut.|  
|[COleControl::ResetVersion](#resetversion)|Initialise le numéro de version à une valeur donnée.|  
|[COleControl::ScrollWindow](#scrollwindow)|Permet à un contrôle sans fenêtre faire défiler une zone au sein de son image actif sur place sur l’affichage.|  
|[COleControl::SelectFontObject](#selectfontobject)|Sélectionne une propriété de police personnalisée dans un contexte de périphérique.|  
|[COleControl::SelectStockFont](#selectstockfont)|Sélectionne la propriété stock Font dans un contexte de périphérique.|  
|[COleControl::SerializeExtent](#serializeextent)|Sérialise ou initialise l’espace d’affichage pour le contrôle.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Sérialise ou initialise le `COleControl` propriétés stock.|  
|[COleControl::SerializeVersion](#serializeversion)|Sérialise ou initialise les informations de version du contrôle.|  
|[COleControl::SetAppearance](#setappearance)|Définit la valeur de la propriété Appearance du stock.|  
|[COleControl::SetBackColor](#setbackcolor)|Définit la valeur de la propriété BackColor de stock.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Définit la valeur de la propriété BorderStyle de stock.|  
|[COleControl::SetCapture](#setcapture)|Provoque la fenêtre du contrôle conteneur prendre possession de la capture de souris procuration du contrôle.|  
|[COleControl::SetControlSize](#setcontrolsize)|Définit la position et la taille du contrôle OLE.|  
|[COleControl::SetEnabled](#setenabled)|Définit la valeur de la propriété Enabled de l’action.|  
|[COleControl::SetFocus](#setfocus)|Provoque la fenêtre du contrôle conteneur prendre possession du focus d’entrée procuration du contrôle.|  
|[COleControl::SetFont](#setfont)|Définit la valeur de la propriété stock Font.|  
|[COleControl::SetForeColor](#setforecolor)|Définit la valeur de la propriété ForeColor du stock.|  
|[COleControl::SetInitialSize](#setinitialsize)|Définit la taille d’un contrôle OLE premier affichage dans un conteneur.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Modifie l’état de modification d’un contrôle.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Indique qu’une demande de modification a échoué.|  
|[Courants](#setnotsupported)|Empêche la modification de la valeur de la propriété d’un contrôle par l’utilisateur.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Définit le rectangle du contrôle par rapport à son conteneur.|  
|[COleControl::SetText](#settext)|Définit la valeur de la propriété Text ou Caption stock.|  
|[COleControl::ThrowError](#throwerror)|Indique qu’une erreur s’est produite dans un contrôle OLE.|  
|[COleControl::TransformCoords](#transformcoords)|Transformations coordonnent les valeurs comprises entre un conteneur et le contrôle.|  
|[Fonction membre COleControl::TranslateColor](#translatecolor)|Convertit un **OLE_COLOR** valeur un **COLORREF** valeur.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Détermine si les propriétés ambiantes sera disponibles la prochaine fois que le contrôle est chargé.|  
|[COleControl::WindowProc](#windowproc)|Fournit une procédure de Windows pour un `COleControl` objet.|  
  
### <a name="protected-methods"></a>Méthodes protégées  
  
|Nom|Description|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Appelé par le framework lorsque l’apparence du contrôle doit être mis à jour.|  
|[COleControl::DrawMetafile](#drawmetafile)|Appelé par l’infrastructure quand le contexte de périphérique de métafichier est utilisé.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Permet l’appel de méthode automation.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.|  
  
## <a name="remarks"></a>Notes  
 Dérivée de `CWnd`, cette classe hérite de toutes les fonctionnalités d’un objet de la fenêtre Windows ainsi que des fonctionnalités supplémentaires spécifiques à OLE, telles que le déclenchement des événements et la possibilité de prendre en charge les méthodes et propriétés.  
  
 Contrôles OLE peuvent être insérées dans des applications conteneur OLE et communiquent avec le conteneur à l’aide d’un système bidirectionnels de déclenchement des événements et exposition des méthodes et des propriétés pour le conteneur. Notez que les conteneurs OLE standards prennent uniquement en charge les fonctionnalités de base d’un contrôle OLE. Ils ne peuvent pas prendre en charge des fonctionnalités étendues d’un contrôle OLE. Déclenchement d’un événement se produit lorsque des événements sont envoyés au conteneur suite à certaines actions se produisent dans le contrôle. À son tour, le conteneur communique avec le contrôle à l’aide d’un jeu exposé des méthodes et propriétés analogues aux fonctions membres et les membres de données d’une classe C++. Cette approche permet au développeur de contrôler l’apparence du contrôle et de notifier au conteneur lorsque certaines actions se produisent.  
  
## <a name="windowless-controls"></a>Contrôles sans fenêtre  
 Contrôles OLE peuvent être utilisé actif en place sans fenêtre. Les contrôles sans fenêtre ont des avantages importants :  
  
-   Les contrôles sans fenêtre peuvent être transparent et non rectangulaire  
  
-   Les contrôles sans fenêtre réduisent le temps de taille et de la création d’instance de l’objet  
  
 Contrôles n’ont pas besoin d’une fenêtre. Services offre d’une fenêtre peuvent facilement être fournis via une fenêtre unique partagée (généralement du conteneur) et un peu de code de distribution. Une fenêtre est essentiellement une complication inutile sur l’objet.  
  
 Lors de l’activation sans fenêtre est utilisée, le conteneur (qui possède de fenêtre) est chargé de fournir des services qui auraient sinon été fournis par la fenêtre du contrôle. Par exemple, si votre contrôle doit interroger le focus clavier, interrogez la capture de la souris ou obtenir un contexte de périphérique, ces opérations sont gérées par le conteneur. Le `COleControl` [fonctions membres de l’opération sans fenêtre](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) appeler ces opérations sur le conteneur.  
  
 Lorsque l’activation sans fenêtre est activée, les délégués de conteneur d’entrée de messages du contrôle `IOleInPlaceObjectWindowless` interface (une extension de [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) pour la prise en charge sans fenêtre). `COleControl`d’implémentation de cette interface distribue ces messages dans la table des messages de votre contrôle, une fois le réglage de la souris en coordonnées en conséquence. Vous pouvez traiter ces messages, comme les messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages.  
  
 Dans un contrôle sans fenêtre, vous devez toujours utiliser le `COleControl` correspondant à la place, les fonctions membres `CWnd` les fonctions membres ou les fonctions API Windows associées.  
  
 Objets de contrôle OLE peuvent également créer une fenêtre uniquement quand elles deviennent actives, mais augmente la quantité de travail nécessaire pour la transition d’actif / inactif et la vitesse de la transition tombe en panne. Il existe des cas lorsqu’il s’agit d’un problème : par exemple, considérez une grille de zones de texte. Lorsque le curseur haut et bas dans la colonne, chaque contrôle doit être en place activées et désactivées puis. La vitesse de la transition inactif/active affecte directement la vitesse de défilement.  
  
 Pour plus d’informations sur le développement d’une infrastructure de contrôle OLE, consultez les articles [contrôles ActiveX MFC](../../mfc/mfc-activex-controls.md) et [vue d’ensemble : création d’un programme de contrôle ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Pour plus d’informations sur l’optimisation des contrôles OLE, y compris les contrôles sans fenêtre sans scintillement, consultez [contrôles ActiveX MFC : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Configuration requise  
 **En-tête :** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 Retourne la valeur de la propriété BackColor ambiante.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur actuelle de la propriété ambiante du conteneur BackColor, le cas échéant. Si la propriété n’est pas pris en charge, cette fonction retourne la couleur d’arrière-plan définie par le système Windows.  
  
### <a name="remarks"></a>Notes  
 La propriété BackColor ambiante est disponible à tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 Le nom que du conteneur est assigné au contrôle peut être utilisé dans les messages d’erreur affichés à l’utilisateur.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Le nom du contrôle OLE. La valeur par défaut est une chaîne de longueur nulle.  
  
### <a name="remarks"></a>Notes  
 Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 Retourne la valeur de la propriété de police ambiante.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers l’interface de dispatch de police ambiante du conteneur. La valeur par défaut est **NULL**. Si la valeur de retour n’est pas égal à **NULL**, vous êtes responsable de la libération de la police en appelant son [IUnknown::Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) fonction membre.  
  
### <a name="remarks"></a>Notes  
 La propriété de police ambiante est définie par le conteneur et disponible à tous les contrôles. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 Retourne la valeur de la propriété de couleur de premier plan ambiante.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur actuelle de la propriété ambiante du conteneur couleur de premier plan, le cas échéant. Si non pris en charge, cette fonction retourne la couleur du texte défini par le système Windows.  
  
### <a name="remarks"></a>Notes  
 La propriété de couleur de premier plan ambiante est disponible à tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientlocaleid"></a>COleControl::AmbientLocaleID  
 Retourne l’ID de paramètres régionaux. du conteneur  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur de la propriété du conteneur LocaleID, le cas échéant. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.  
  
### <a name="remarks"></a>Notes  
 Le contrôle peut utiliser l’identificateur des paramètres régionaux d’adapter son interface utilisateur pour les paramètres régionaux spécifiques. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 Récupère le paramètre d’apparence actuelle pour l’objet contrôle.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Valeur de retour  
 L’apparence du contrôle :  
  
- **0** plats apparence  
  
- **1** apparence 3D  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction pour extraire la valeur actuelle de la **DISPID_AMBIENT_APPEARANCE** propriété du contrôle.  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 Retourne le type d’unités utilisées par le conteneur.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Chaîne contenant les unités d’échelle ambiantes du conteneur. Si cette propriété n’est pas pris en charge, cette fonction retourne une chaîne de longueur nulle.  
  
### <a name="remarks"></a>Notes  
 Propriété des unités d’échelle ambiante du conteneur peut être utilisée pour afficher les positions ou dimensions, soit étiquetées au moyen de l’unité choisie, telles que twips ou en centimètres. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 Détermine si le conteneur autorise le contrôle afficher les poignées de manipulation pour lui-même lorsqu’il est actif.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si les poignées de manipulation doivent être affichées ; Sinon, 0. Si cette propriété n’est pas pris en charge, cette fonction retourne zéro.  
  
### <a name="remarks"></a>Notes  
 Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 Détermine si le conteneur autorise le contrôle à afficher avec un hachurée modèle lorsque l’interface utilisateur actif.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le motif hachuré doit être affiché ; Sinon, 0. Si cette propriété n’est pas pris en charge, cette fonction retourne zéro.  
  
### <a name="remarks"></a>Notes  
 Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 Détermine l’alignement du texte ambiant préféré par le conteneur de contrôle.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Valeur de retour  
 L’état de la propriété de TextAlign ambiante du conteneur. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.  
  
 Voici une liste de valeurs de retournés valides :  
  
|Valeur de retour|Signification|  
|------------------|-------------|  
|0|Alignement général (nombres pour le texte de droit à gauche).|  
|1|Aligner à gauche|  
|2|Centre|  
|3|Aligner à droite|  
  
### <a name="remarks"></a>Notes  
 Cette propriété est disponible pour tous les contrôles imbriqués et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 Détermine si le conteneur souhaite que le contrôle de répondre aux actions de l’interface utilisateur.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle doit répondre aux actions de l’interface utilisateur ; Sinon, 0. Si cette propriété n’est pas pris en charge, cette fonction retourne 0.  
  
### <a name="remarks"></a>Notes  
 Par exemple, un conteneur peut affectez la valeur **TRUE** en mode Création.  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 Détermine si le conteneur est en mode Création ou en mode utilisateur.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le conteneur est en mode utilisateur ; 0 dans le cas contraire (en mode Création). Si cette propriété n’est pas pris en charge, cette fonction retourne la valeur TRUE.  
  
### <a name="remarks"></a>Notes  
 Par exemple, un conteneur peut affectez la valeur **FALSE** en mode Création.  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 Indique que la valeur de la propriété liée a changé.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété liée du contrôle.  
  
### <a name="remarks"></a>Notes  
 Cela doit être appelé chaque fois que la valeur de la propriété modifiée, même dans les cas où la modification a été apportée pas via la propriété Set, méthode. Tenez compte notamment des propriétés liées qui sont mappées à des variables de membre. Chaque fois que ces un membre variable change, `BoundPropertyChanged` doit être appelée.  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 Demande l’autorisation à partir de la `IPropertyNotifySink` interface pour modifier une valeur de propriété liée fournie par le contrôle.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété liée du contrôle.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si la modification est autorisée ; Sinon, 0. La valeur par défaut est différente de zéro.  
  
### <a name="remarks"></a>Notes  
 Si l’autorisation est refusée, le contrôle ne doit pas à la valeur de la modification de propriété. Pour cela, en ignorant ou en échec de l’action qui a tenté de modifier la valeur de propriété.  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 Convertit les coordonnées de `pPoint` dans les coordonnées parent.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 `lprcBounds`  
 Pointeur vers les limites du contrôle OLE dans le conteneur. La zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement, mais pas dans la zone cliente.  
  
 `pPoint`  
 Pointeur vers le point de zone client OLE sera traduite dans les coordonnées du parent (conteneur).  
  
### <a name="remarks"></a>Notes  
 Dans l’entrée `pPoint` est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle). Dans la sortie `pPoint` est relatif à l’origine du parent (coin supérieur gauche du conteneur).  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 Ajuste un rectangle du point d’insertion s’il est entièrement ou partiellement couvert par les objets qui se chevauchent, opaques.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpRect`  
 Lors de l’entrée, un pointeur vers un [RECT](../../mfc/reference/rect-structure1.md) structure qui contient la zone du point d’insertion à ajuster. En sortie, la zone ajustée du point d’insertion, ou **NULL** si le rectangle du point d’insertion est intégralement couvert.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Un point d’insertion est une ligne, un bloc ou bitmap qui indique généralement qu’où sera inséré texte ou des graphiques clignotant.  
  
 Un objet sans fenêtre ne peut pas afficher en toute sécurité d’un point d’insertion sans vérifier au préalable si le point d’insertion est partiellement ou totalement masquée par objets superposés. Pour que cela soit possible, un objet peut utiliser `ClipCaretRect` pour obtenir le point d’insertion ajustée (réduit) pour vous assurer qu’il rentre dans la zone de découpage.  
  
 Création d’un point d’insertion des objets doivent envoyer le rectangle du point d’insertion à `ClipCaretRect` et utiliser le rectangle pour le point d’insertion. Si le point d’insertion est complètement masqué, cette méthode retournera **FALSE** et le point d’insertion ne doit pas être affiché dans ce cas.  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 Construit un objet `COleControl`.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Notes  
 Cette fonction n’est normalement pas appelée directement. À la place du contrôle OLE est généralement créé par la fabrique de classe.  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 Appelez cette fonction lorsque l’ensemble des mnémoniques pris en charge par le contrôle a été modifiée.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Notes  
 Lors de la réception de cette notification, le conteneur du contrôle obtienne le nouvel ensemble de mnémoniques en effectuant un appel à [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Notez que le conteneur n’est pas nécessaire pour répondre à cette notification.  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 Appelé par l’infrastructure après que l’événement d’erreur stock a été gérée (sauf si le Gestionnaire d’événements a supprimé l’affichage de l’erreur).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Paramètres  
 *SCODE*  
 La valeur de code d’état doit être signalée. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Description de l’erreur signalée.  
  
 *lpszSource*  
 Le nom du module génère l’erreur (en règle générale, le nom du module de contrôle OLE).  
  
 `lpszHelpFile`  
 Le nom du fichier d’aide qui contient une description de l’erreur.  
  
 `nHelpID`  
 L’ID de contexte aide de l’erreur signalée.  
  
### <a name="remarks"></a>Notes  
 Le comportement par défaut affiche une boîte de message qui contient la description de l’erreur contenue dans `lpszDescription`.  
  
 Remplacez cette fonction pour personnaliser l’affichent des erreurs.  
  
##  <a name="doclick"></a>COleControl::DoClick  
 Simule la souris sur l’action sur le contrôle.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Notes  
 Les paramètres substituables `COleControl::OnClick` fonction membre sera appelée et un clic événement sera déclenché si le contrôle prend en charge.  
  
 Cette fonction est prise en charge par le `COleControl` comme une méthode stock DoClick d’appelée classe de base. Pour plus d’informations, consultez l’article [contrôles ActiveX : méthodes](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 Appelé par l’infrastructure lors du chargement ou le stockage d’un contrôle à partir d’une représentation d’un stockage persistant, comme un ensemble de flux de données ou de la propriété.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Paramètres  
 `pPX`  
 Un pointeur vers un `CPropExchange` objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.  
  
### <a name="remarks"></a>Notes  
 Cette fonction appelle normalement pour la **PX_** famille de fonctions pour charger ou stocker des propriétés spécifiques définies par l’utilisateur d’un contrôle OLE.  
  
 Si l’Assistant de contrôle a été utilisé pour créer le projet de contrôle OLE, la version substituée de cette fonction sérialise les propriétés stock prises en charge par `COleControl` avec un appel à la fonction de la classe de base, `COleControl::DoPropExchange`. Lorsque vous ajoutez des propriétés définies par l’utilisateur à votre contrôle OLE, vous devrez modifier cette fonction pour sérialiser vos nouvelles propriétés. Pour plus d’informations sur la sérialisation, consultez l’article [contrôles ActiveX : sérialisation](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Pointeur vers le contexte de périphérique du conteneur de contrôle.  
  
 `rcBounds`  
 La zone dans laquelle le contrôle doit être dessiné.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction pour gérer correctement la peinture d’un contrôle OLE non active. Cette fonction doit être utilisée uniquement si le OLE contrôle sous-classe un contrôle Windows et doit être appelé dans le `OnDraw` fonction de votre contrôle.  
  
 Pour plus d’informations sur cette fonction et le sous-classement d’un contrôle Windows, consultez l’article [contrôles ActiveX : sous-classement d’un contrôle Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 Appelé par le framework lorsque l’apparence du contrôle doit être mis à jour.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Pointeur vers le contexte de périphérique.  
  
 `rc`  
 Zone rectangulaire à dessiner.  
  
### <a name="remarks"></a>Notes  
 Cette fonction appelle directement la substituable `OnDraw` (fonction).  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 Appelé par l’infrastructure quand le contexte de périphérique de métafichier est utilisé.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Pointeur vers le contexte de périphérique de métafichier.  
  
 `rc`  
 Zone rectangulaire à dessiner.  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 Permet la caractéristique de cadre simple pour un contrôle OLE.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Notes  
 Cette caractéristique permet à un contrôle prendre en charge la relation contenant-contenu visuel d’autres contrôles, mais pas true relation contenant-contenu OLE. Un exemple serait avec plusieurs contrôles à l’intérieur d’une zone de groupe. Ces contrôles ne sont pas OLE contenu, mais ils se trouvent dans la même zone de groupe.  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 Sérialise ou initialise l’état de l’étendue du contrôle (ses dimensions dans **HIMETRIC** unités).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Paramètres  
 `pPX`  
 Un pointeur vers un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si la fonction a réussi ; 0 dans le cas contraire.  
  
### <a name="remarks"></a>Notes  
 Cette fonction est généralement appelée par l’implémentation par défaut de `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 Sérialise ou initialise l’état de propriétés stock du contrôle.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Paramètres  
 `pPX`  
 Un pointeur vers un [CPropExchange](../../mfc/reference/cpropexchange-class.md) objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.  
  
### <a name="remarks"></a>Notes  
 Cette fonction est généralement appelée par l’implémentation par défaut de `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 Sérialise ou initialise l’état d’un contrôle informations de version.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 `pPX`  
 Un pointeur vers un `CPropExchange` objet. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriété, notamment sa direction.  
  
 `dwVersionDefault`  
 Le numéro de version actuel du contrôle.  
  
 `bConvert`  
 Indique si les données persistantes doivent être converties au format plus récent lorsque enregistré ou mis à jour dans le même format que celui qui a été chargé.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro de la fonction a réussi ; 0 dans le cas contraire.  
  
### <a name="remarks"></a>Notes  
 En règle générale, il s’agit de la première fonction appelée par une substitution de `COleControl::DoPropExchange`. Lors du chargement, cette fonction lit le numéro de version des données persistantes et définit l’attribut de version de la [CPropExchange](../../mfc/reference/cpropexchange-class.md) de l’objet en conséquence. Lors de l’enregistrement, cette fonction écrit le numéro de version des données persistantes.  
  
 Pour plus d’informations sur la persistance et le contrôle de version, consultez l’article [contrôles ActiveX : sérialisation](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 Appelé par le framework lorsque l’utilisateur clique sur un contrôle actif.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique de l’événement Click se produise, table d’événements du contrôle doit avoir un clic événement défini.  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 Appelé par le framework lorsque la souris est double-cliqué sur un contrôle actif.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement double clic se produise, table d’événements du contrôle doit avoir un événement de double clic stock défini.  
  
##  <a name="fireerror"></a>COleControl::FireError  
 Déclenche l’événement d’erreur stock.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Paramètres  
 *SCODE*  
 La valeur de code d’état doit être signalée. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `lpszDescription`  
 Description de l’erreur signalée.  
  
 `nHelpID`  
 L’ID d’aide de l’erreur signalée.  
  
### <a name="remarks"></a>Notes  
 Cet événement offre un moyen de signalisation dans des lieux appropriés dans votre code, qu’une erreur s’est produite dans votre contrôle. Contrairement à d’autres événements stock, telles que le clic ou MouseMove, erreur n’est jamais déclenchée par l’infrastructure.  
  
 Pour signaler une erreur qui se produit pendant une fonction get de propriété, une fonction set de propriété ou une méthode automation, appelez [COleControl::ThrowError](#throwerror).  
  
 L’implémentation de l’erreur de Stock d’un contrôle OLE événement utilise un `SCODE` valeur. Si votre contrôle utilise cet événement et est destiné à être utilisée dans Visual Basic 4.0, vous recevez des erreurs, car le `SCODE` valeur n’est pas prise en charge dans Visual Basic.  
  
 Pour résoudre ce problème, modifiez manuellement le `SCODE` paramètre du contrôle. Fichier ODL pour un **long**. En outre, n’importe quel événement personnalisé, une méthode ou une propriété qui utilise un `SCODE` paramètre entraîne également le même problème.  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 Déclenche un événement défini par l’utilisateur à partir de votre contrôle avec un nombre quelconque d’arguments facultatifs.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 L’ID de dispatch de l’événement à déclencher.  
  
 `pbParams`  
 Un descripteur pour les types de paramètres de l’événement.  
  
### <a name="remarks"></a>Notes  
 En général cette fonction ne doit pas appelée directement. Au lieu de cela, vous appellerez les fonctions de déclenchement d’événement dans la section de mappage d’événement de déclaration de classe de votre contrôle.  
  
 Le `pbParams` argument est une liste séparée par des espaces de **VTS_**. Une ou plusieurs de ces valeurs, séparées par des espaces (et non par des virgules), spécifient la liste des paramètres de la fonction. Les valeurs possibles sont les suivantes :  
  
|Symbole|Type de paramètre|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Les constantes de type variant supplémentaires ont été définis pour tous les types variants, à l’exception de **VTS_FONT** et **VTS_PICTURE**, qui fournissent un pointeur vers la constante de données variant. Ces constantes sont nommées à l’aide de la **VTS_P** `constantname` convention. Par exemple, **VTS_PCOLOR** est un pointeur vers un **VTS_COLOR** constante.  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 Appelé par le framework lorsqu’une touche est enfoncée alors que le contrôle est l’interface utilisateur active.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Paramètres  
 `pnChar`  
 Pointeur vers la valeur de code de touche virtuelle de la touche enfoncée. Pour une liste des codes de touches virtuelles, consultez Winuser.h  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement KeyDown se produise, table d’événements du contrôle doit avoir un événement KeyDown stock défini.  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 Appelé par le framework lorsqu’une touche est enfoncée et relâchée alors que le contrôle personnalisé est actif de l’interface utilisateur du conteneur.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Paramètres  
 `pnChar`  
 Pointeur vers la valeur de caractère de la touche enfoncée.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Le destinataire de l’événement peut modifier `pnChar`, par exemple, convertir tous les caractères minuscules en majuscules. Si vous souhaitez examiner le caractère modifié, remplacez `OnKeyPressEvent`.  
  
 Pour le déclenchement automatique d’un événement KeyPress, table d’événements du contrôle doit avoir un événement KeyPress stock défini.  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 Appelé par le framework lorsqu’une touche est relâchée alors que le contrôle personnalisé est actif de l’interface utilisateur du conteneur.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Paramètres  
 `pnChar`  
 Pointeur vers la valeur de code de touche virtuelle de la clé finale. Pour une liste des codes de touches virtuelles, consultez Winuser.h  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement KeyUp se produise, table d’événements du contrôle doit avoir un événement KeyUp stock défini.  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 Appelé par l’infrastructure lorsqu’un bouton de la souris est enfoncé sur un contrôle personnalisé actif.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Paramètres  
 `nButton`  
 La valeur numérique du bouton de la souris est enfoncé. Il peut contenir l’une des valeurs suivantes :  
  
- **LEFT_BUTTON** le bouton gauche de la souris a été enfoncé.  
  
- **MIDDLE_BUTTON** le bouton central de la souris a été enfoncé.  
  
- **RIGHT_BUTTON** le bouton droit de la souris a été enfoncé.  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
 *x*  
 Coordonnée x du curseur lorsqu’un bouton de la souris a été enfoncé. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
 *y*  
 Coordonnée y du curseur lorsqu’un bouton de la souris a été enfoncé. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement MouseDown se produise, table d’événements du contrôle doit avoir un événement MouseDown stock défini.  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 Appelé par le framework lorsque le curseur est placé sur un contrôle personnalisé actif.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Paramètres  
 `nButton`  
 La valeur numérique de boutons de la souris est enfoncé. Contient une combinaison des valeurs suivantes :  
  
- **LEFT_BUTTON** le bouton gauche de la souris a été enfoncé pendant l’opération.  
  
- **MIDDLE_BUTTON** le bouton central de la souris a été enfoncé pendant l’opération.  
  
- **RIGHT_BUTTON** le bouton droit de la souris a été enfoncé pendant l’opération.  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
 *x*  
 Coordonnée x du curseur. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
 *y*  
 Coordonnée y du curseur. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement MouseMove se produise, table d’événements du contrôle doit avoir un événement MouseMove stock défini.  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 Appelé par l’infrastructure lorsqu’un bouton de la souris est relâché sur actif d’un contrôle personnalisé.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Paramètres  
 `nButton`  
 La valeur numérique de relâchement du bouton de la souris. Il peut avoir l’une des valeurs suivantes :  
  
- **LEFT_BUTTON** le bouton gauche de la souris a été relâché.  
  
- **MIDDLE_BUTTON** le bouton central de la souris a été relâché.  
  
- **RIGHT_BUTTON** le bouton droit de la souris a été relâché.  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
 *x*  
 Coordonnée x du curseur lorsqu’un bouton de la souris a été relâché. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
 *y*  
 Coordonnée y d’un curseur lorsqu’un bouton de la souris a été relâché. Les coordonnées sont par rapport à l’angle supérieur gauche de la fenêtre de contrôle.  
  
### <a name="remarks"></a>Notes  
 Si cet événement est défini comme un événement personnalisé, vous déterminez lorsque l’événement est déclenché.  
  
 Pour le déclenchement automatique d’un événement MouseUp se produise, table d’événements du contrôle doit avoir un événement MouseUp stock défini.  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 Déclenche un événement avec la valeur actuelle de l’état prêt du contrôle.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Notes  
 L’état prêt peut être une des valeurs suivantes :  
  
 **READYSTATE_UNINITIALIZED**  
 État de l’initialisation par défaut  
  
 **READYSTATE_LOADING**  
 Contrôle est en cours de chargement ses propriétés  
  
 **READYSTATE_LOADED**  
 Contrôle a été initialisé.  
  
 **READYSTATE_INTERACTIVE**  
 Contrôle a suffisamment de données pour être interactive, mais pas tous les asynchrone des données sont encore chargées.  
  
 `READYSTATE_COMPLETE`  
 Contrôle a toutes ses données  
  
 Utilisez [GetReadyState](#getreadystate) pour déterminer le niveau de préparation actuel du contrôle.  
  
 [InternalSetReadyState](#internalsetreadystate) modifie l’état prêt à la valeur fournie, puis appelle `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 Modifie le comportement de l’activation par défaut d’un contrôle qui prend en charge la `IPointerInactive` interface.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une combinaison d’indicateurs à partir de la **POINTERINACTIVE** énumération. Les indicateurs possibles sont :  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 L’objet doit être activé lorsque la souris entre dans pendant une opération de déplacement de la souris sur place.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 L’objet doit être désactivé lorsque la souris quitte l’objet pendant une opération de déplacement de la souris.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 L’objet doit être activé lorsque vous faites glisser la souris dessus pendant une opération de glissement sur place et supprimer l’opération.  
  
### <a name="remarks"></a>Notes  
 Lorsque le `IPointerInactive` interface est activée, le conteneur délègue `WM_SETCURSOR` et `WM_MOUSEMOVE` messages. `COleControl`d’implémentation de cette interface distribue ces messages dans la table des messages de votre contrôle, une fois le réglage de la souris en coordonnées en conséquence.  
  
 Chaque fois que le conteneur reçoit une `WM_SETCURSOR` ou `WM_MOUSEMOVE` message avec le pointeur de la souris sur un objet inactif prise en charge `IPointerInactive`, il doit appeler `GetActivationPolicy` sur les indicateurs d’interface et de retour à partir de la **POINTERINACTIVE** énumération.  
  
 Vous pouvez traiter ces messages, tout comme les messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages. Dans les gestionnaires, évitez d’utiliser le `m_hWnd` variable membre (ou toutes les fonctions membres qui l’utilise) sans d’abord vérifier que sa valeur est non - **NULL**.  
  
 N’importe quel objet destiné à de plus de définir le curseur de souris et/ou de déclencher un événement de déplacement de la souris, tels que des commentaires spéciaux visual, doivent retourner le **POINTERINACTIVE_ACTIVATEONENTRY** indicateur et dessiner les commentaires uniquement lorsqu’il est actif. Si l’objet retourné cet indicateur, le conteneur doit l’activer sur place immédiatement et le transmet le même message qui a déclenché l’appel à `GetActivationPolicy`.  
  
 Si les deux le **POINTERINACTIVE_ACTIVATEONENTRY** et **POINTERINACTIVE_DEACTIVATEONLEAVE** indicateurs sont renvoyés, puis l’objet sera activé uniquement lorsque la souris se trouve sur l’objet. Si seul le **POINTERINACTIVE_ACTIVATEONENTRY** indicateur est retourné, puis l’objet n’est activée une fois lorsque la souris pénètre dans l’objet.  
  
 Vous pouvez également être la cible d’une glisser et déplacer un contrôle inactif. Cela nécessite l’activation du contrôle au moment où que l’utilisateur fait glisser un objet, afin que la fenêtre du contrôle peut être enregistrée comme une cible de dépôt. Pour que l’activation se produisent pendant une opération de glissement, retourner le **POINTERINACTIVE_ACTIVATEONDRAG** indicateur :  
  
 [!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 Les informations communiquées par `GetActivationPolicy` ne doit pas être mis en cache par un conteneur. Au lieu de cela, cette méthode doit être appelée chaque fois que la souris entre dans un objet inactif.  
  
 Si un objet inactif ne demande pas à être activé lorsque la souris pénètre il sur place, son conteneur doit distribuer ultérieures `WM_SETCURSOR` messages à cet objet en appelant [OnInactiveSetCursor](#oninactivesetcursor) tant que le pointeur de souris reste sur l’objet.  
  
 L’activation de la `IPointerInactive` interface signifie généralement que vous souhaitez le contrôle doit être capable de traiter des messages de la souris en permanence. Pour obtenir ce comportement dans un conteneur qui ne prend en charge la `IPointerInactive` interface, vous devez toujours activé quand il est visible, ce qui signifie que le contrôle doit avoir la **OLEMISC_ACTIVATEWHENVISIBLE** indicateur parmi ses indicateurs divers. Toutefois, pour empêcher cet indicateur de prise d’effet dans un conteneur qui prend en charge `IPointerInactive`, vous pouvez également spécifier le **OLEMISC_IGNOREACTIVATEWHENVISIBLE** indicateur :  
  
 [!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 Obtient la valeur d’une propriété ambiante du conteneur.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Paramètres  
 *dwDispid*  
 L’ID de dispatch de la propriété ambiante souhaitée.  
  
 `vtProp`  
 Une balise de type variant qui spécifie le type de la valeur doit être retournée dans `pvProp`.  
  
 `pvProp`  
 Pointeur vers l’adresse de la variable qui recevra la valeur de propriété ou valeur de retour. Le type réel de ce pointeur doit correspondre au type spécifié par `vtProp`.  
  
|vtProp|Type de pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**courte\***|  
|`VT_I4`|**long\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**Double\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si la propriété ambiante est pris en charge ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Si vous utilisez `GetAmbientProperty` pour récupérer les propriétés ambiantes DisplayName et unités d’échelle, définissez `vtProp` à `VT_BSTR` et `pvProp` à **CString\***. Si vous récupérez la propriété de police ambiante, la valeur `vtProp` à **VT_FONT** et `pvProp` à **LPFONTDISP\***.  
  
 Notez que les fonctions déjà fournies pour les propriétés ambiantes courantes, telles que [AmbientBackColor](#ambientbackcolor) et [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 Implémente la fonction Get de propriété Appearance du stock de votre contrôle.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur de retour Spécifie le paramètre d’apparence actuel en tant qu’un **court** ( `VT_I2`) valeur, en cas de réussite. Cette valeur est zéro si l’apparence du contrôle est plat et 1 si l’apparence du contrôle est 3D.  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 Implémente la fonction Get de propriété de couleur d’arrière-plan de votre contrôle stock.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur de retour spécifie la couleur d’arrière-plan actuelle comme un **OLE_COLOR** valeur, en cas de réussite. Cette valeur peut être convertie en un **COLORREF** valeur avec un appel à `TranslateColor`.  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 Implémente la fonction Get de propriété BorderStyle stock de votre contrôle.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Valeur de retour  
 1 si le contrôle a une bordure normale ; 0 si le contrôle n’a pas de bordure.  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 Détermine si le `COleControl` objet possède la capture de la souris.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Si le contrôle est activé et sans fenêtre, retourne **cela** si le contrôle a actuellement la capture de la souris (comme déterminé par le conteneur du contrôle), ou **NULL** si elle n’a pas de la capture.  
  
 Sinon, retourne la `CWnd` objet qui a la capture de souris (identique à `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Notes  
 Un contrôle sans fenêtre activé reçoit la souris lorsque capture [SetCapture](#setcapture) est appelée.  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 Appelé par l’infrastructure pour récupérer l’ID de classe du contrôle.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Paramètres  
 *pclsid*  
 Pointeur vers l’emplacement de l’ID de classe.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel n’a pas réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Généralement implémentée par le [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 Récupère la différence entre le coin supérieur gauche de la zone du contrôle rectangulaire et le coin supérieur gauche de la zone cliente.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 *pdxOffset*  
 Pointeur vers le décalage horizontal de la zone cliente du contrôle de l’OLE.  
  
 *pdyOffset*  
 Pointeur vers le décalage vertical de la zone cliente du contrôle de l’OLE.  
  
### <a name="remarks"></a>Notes  
 Le contrôle OLE a une zone rectangulaire dans son conteneur. La zone cliente du contrôle est la zone de contrôle à l’exclusion des bordures et des barres de défilement. Le décalage est récupérée par `GetClientOffset` est la différence entre le coin supérieur gauche de la zone du contrôle rectangulaire et le coin supérieur gauche de la zone cliente. Si le contrôle a des éléments non clients autres que les bordures standards et les barres de défilement, remplacer cette fonction membre pour spécifier le décalage.  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 Récupère la taille de la zone du contrôle client.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 `lpRect`  
 Pointeur vers un `RECT` structure qui contient les dimensions de la zone du client du contrôle sans fenêtre ; autrement dit, la taille du contrôle moins les bordures de fenêtre, images, barres de défilement et ainsi de suite. Le `lpRect` paramètre indique la taille du rectangle client du contrôle de pas sa position.  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 Interroge un objet pour le pointeur à son site client actif dans son conteneur.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers le site de client en cours d' un contrôle dans son conteneur.  
  
### <a name="remarks"></a>Notes  
 Le pointeur retourné pointe vers une instance de `IOleClientSite`. Le `IOleClientSite` interface implémentée par les conteneurs, est la vue de l’objet de son contexte : où il est ancré dans le document, où il obtient son stockage, de l’interface utilisateur et d’autres ressources.  
  
##  <a name="getcontrolflags"></a>COleControl::GetControlFlags  
 Récupère les paramètres d’indicateur de contrôle.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une combinaison ORed des indicateurs de l’énumération ControlFlags :  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Notes  
 Par défaut, `GetControlFlags` retourne `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Si la valeur, utilise une peinture de début (fonction) adapté aux contrôles OLE au lieu du [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (valeur par défaut).  
  
 `clipPaintDC`  
 Si ce n’est pas définie, désactive l’appel à `IntersectClipRect` par `COleControl` et un gain de vitesse limité. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.  
  
 `pointerInactive`  
 Si défini, fournit l’interaction souris pendant que votre contrôle est inactif en activant `COleControl`d’implémentation de la `IPointerInactive` interface, qui est désactivée par défaut.  
  
 `noFlickerActivate`  
 Si la valeur, élimine les opérations de dessin supplémentaires et le scintillement qui l’accompagne. À utiliser lorsque votre contrôle se dessine lui-même de façon identique dans les états inactifs et actifs. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.  
  
 `windowlessActivate`  
 Si la valeur, indique à votre contrôle utilise l’activation sans fenêtre.  
  
 `canOptimizeDraw`  
 Si la valeur, indique que le contrôle effectue un dessin optimisé, si le conteneur prend en charge.  
  
 Pour plus d’informations sur `GetControlFlags` et autres optimisations des contrôles OLE, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 Récupère la taille de la fenêtre de contrôle OLE.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Paramètres  
 *PCX*  
 Spécifie la largeur du contrôle en pixels.  
  
 *pcy*  
 Spécifie la hauteur du contrôle en pixels.  
  
### <a name="remarks"></a>Notes  
 Notez que toutes les coordonnées pour les fenêtres de contrôle sont par rapport à l’angle supérieur gauche du contrôle.  
  
##  <a name="getdc"></a>COleControl::GetDC  
 Fournit à un écran (ou compatible) contexte périphérique pour un objet sans fenêtre à partir de son conteneur.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Paramètres  
 *lprcRect*  
 Un pointeur vers le rectangle du contrôle sans fenêtre souhaite redessiner, en coordonnées clientes du contrôle. **NULL** signifie l’étendue de l’objet complet.  
  
 `dwFlags`  
 Attributs de dessin du contexte de périphérique. Choix possibles sont :  
  
- **OLEDC_NODRAW** indique que l’objet ne sera pas utiliser le contexte de périphérique pour effectuer un dessin, mais simplement pour obtenir des informations sur le périphérique d’affichage. Le conteneur doit simplement transmettre le contrôleur de domaine de la fenêtre sans traitement supplémentaire.  
  
- **OLEDC_PAINTBKGND** demande que le conteneur de peindre l’arrière-plan avant de retourner le contrôleur de domaine. Un objet doit utiliser cet indicateur si elle demande un contrôleur de domaine pour être redessiné une zone avec un arrière-plan transparent.  
  
- **OLEDC_OFFSCREEN** informe le conteneur de l’objet souhaite effectuer le rendu dans une bitmap hors écran doit alors être copiée sur l’écran. Un objet doit utiliser cet indicateur lorsqu’il est sur le point d’effectuer l’opération de dessin génère un grand nombre de scintillement. Le conteneur est libre d’honorer cette demande ou non. Toutefois, si cet indicateur n’est pas défini, le conteneur doit transmettre dans un écran contrôleur de domaine. Cela permet aux objets effectuer des opérations d’écran direct comme affichant une sélection (via une **XOR** opération).  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers le contexte de périphérique d’affichage pour le conteneur `CWnd` zone cliente si réussi ; sinon, la valeur de retour est **NULL**. Le contexte de périphérique d’affichage peut être utilisé dans les fonctions GDI suivantes à dessiner dans la zone cliente de la fenêtre du conteneur.  
  
### <a name="remarks"></a>Notes  
 Le [ReleaseDC](#releasedc) fonction membre doit être appelée pour libérer le contexte après la peinture. Lors de l’appel `GetDC`, les objets passent le rectangle qu’ils souhaitent introduire dans leurs propres coordonnées clientes. `GetDC`Convertit les coordonnées de la zone cliente de conteneur. L’objet ne doit pas demander un rectangle de dessin souhaité supérieur à sa propre rectangle de zone client, dont la taille peut être récupérée avec [GetClientRect](#getclientrect). Cela empêche les objets de dessin par inadvertance où ils ne sont pas supposés.  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 Implémente la fonction Get de l’action de votre contrôle propriété Enabled.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle est activé ; Sinon, 0.  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 Obtient un pointeur vers un objet géré par le conteneur qui représente le contrôle avec un ensemble de propriétés.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers le conteneur étendus d’un objet de contrôle. Si aucun objet n’est disponible, la valeur est **NULL**.  
  
 Cet objet peut être manipulé via son `IDispatch` interface. Vous pouvez également utiliser `QueryInterface` pour obtenir d’autres interfaces disponibles fournies par l’objet. Toutefois, l’objet n’est pas requis pour prendre en charge un ensemble spécifique d’interfaces. Notez que sur les fonctionnalités spécifiques de l’objet de contrôle étendu d’un conteneur de partie de confiance limite la portabilité de votre contrôle à d’autres conteneurs arbitraires.  
  
### <a name="remarks"></a>Notes  
 La fonction qui appelle cette fonction est chargée de libérer le pointeur, une fois terminé avec l’objet. Notez que le conteneur n’est pas requis pour prendre en charge de cet objet.  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 Détermine si le `COleControl` objet a le focus.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Si le contrôle est activé et sans fenêtre, retourne **cela** si le contrôle a actuellement le focus clavier (comme déterminé par le conteneur du contrôle), ou **NULL** si elle n’a pas le focus.  
  
 Sinon, retourne la `CWnd` objet qui a le focus (identique à `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Notes  
 Un contrôle sans fenêtre activé reçoit le focus lorsque [SetFocus](#setfocus) est appelée.  
  
##  <a name="getfont"></a>COleControl::GetFont  
 Implémente la fonction Get de la propriété stock Font.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers l’interface de dispatch de police de propriété stock sa Font.  
  
### <a name="remarks"></a>Notes  
 Notez que l’appelant doit libérer l’objet lorsqu’il est terminé. Dans l’implémentation du contrôle, utilisez `InternalGetFont` pour accéder à l’objet du contrôle stock police. Pour plus d’informations sur l’utilisation de polices dans votre contrôle, consultez l’article [contrôles ActiveX : utilisation des polices dans un contrôle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 Les métriques de texte pour une des mesures `CFontHolder` objet détenu par le contrôle.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Paramètres  
 `lptm`  
 Pointeur vers un [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure.  
  
 `fontHolder`  
 Référence à un [CFontHolder](../../mfc/reference/cfontholder-class.md) objet.  
  
### <a name="remarks"></a>Notes  
 Une telle police peut être sélectionnée avec la [COleControl::SelectFontObject](#selectfontobject) (fonction). `GetFontTextMetrics`initialisera le `TEXTMETRIC` structure vers laquelle pointe `lptm` avec des informations sur les métriques valide `fontHolder`de police en cas de réussite, ou remplir la structure avec des zéros en cas d’échec. Vous devez utiliser cette fonction au lieu de [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) lorsque peinture de votre contrôle, car les contrôles, comme les incorporant OLE, peuvent être nécessaires pour s’afficher dans un métafichier.  
  
 Le `TEXTMETRIC` de la structure de la police par défaut est actualisé lorsque le [SelectFontObject](#selectfontobject) est appelée. Vous devez appeler `GetFontTextMetrics` uniquement après la sélection de la propriété stock Font afin d’assurer les informations fournies n’est valide.  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 Implémente la fonction Get de la propriété ForeColor du stock.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur de retour spécifie la couleur de premier plan actuelle comme un **OLE_COLOR** valeur, en cas de réussite. Cette valeur peut être convertie en un [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) valeur avec un appel à `TranslateColor`.  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 Implémente la fonction Get de la propriété stock hWnd.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Handle de fenêtre du contrôle OLE, le cas échéant ; dans le cas contraire **NULL**.  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 Appelé par l’infrastructure pour obtenir une chaîne courte qui décrit l’objectif de l’élément de menu identifié par `nID`.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 `nID`  
 Un ID d’élément de menu.  
  
 `rMessage`  
 Une référence à un [CString](../../atl-mfc-shared/reference/cstringt-class.md) via laquelle une chaîne est retournée.  
  
### <a name="remarks"></a>Notes  
 Cela peut servir à obtenir un message à afficher dans une barre d’état pendant que l’élément de menu est mise en surbrillance. L’implémentation par défaut tente de charger une ressource de chaîne identifiée par `nID`.  
  
##  <a name="getnotsupported"></a>COleControl::GetNotSupported  
 Empêche l’accès à la valeur de la propriété d’un contrôle par l’utilisateur.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction à la place de la fonction Get de n’importe quelle propriété dans lequel la récupération de la propriété par l’utilisateur du contrôle n’est pas pris en charge. Un exemple serait une propriété en écriture seule.  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 Retourne l’état de préparation du contrôle.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Valeur de retour  
 État de préparation du contrôle, une des valeurs suivantes :  
  
 **READYSTATE_UNINITIALIZED**  
 État de l’initialisation par défaut  
  
 **READYSTATE_LOADING**  
 Contrôle est en cours de chargement ses propriétés  
  
 **READYSTATE_LOADED**  
 Contrôle a été initialisé.  
  
 **READYSTATE_INTERACTIVE**  
 Contrôle a suffisamment de données pour être interactive, mais pas tous les asynchrone des données sont encore chargées.  
  
 `READYSTATE_COMPLETE`  
 Contrôle a toutes ses données  
  
### <a name="remarks"></a>Notes  
 La plupart des contrôles simples jamais besoin de faire la différence entre **LOADED** et `INTERACTIVE`. Toutefois, les contrôles qui prennent en charge les propriétés de chemin d’accès de données peut-être pas prêts à être interactive jusqu'à la réception d’au moins certaines données de façon asynchrone. Un contrôle doit tenter de devenir interactives dès que possible.  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 Obtient les coordonnées du rectangle du contrôle relatifs au conteneur, exprimé en unités de périphérique.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpRect`  
 Pointeur vers la structure du rectangle dans lequel les coordonnées du contrôle seront copiées.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle est actif en place ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Le rectangle est uniquement valide si le contrôle est actif en place.  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 Mesure les métriques de texte pour propriété stock Font du contrôle, qui peut être sélectionnée avec la [SelectStockFont](#selectstockfont) (fonction).  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Paramètres  
 `lptm`  
 Un pointeur vers un [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) structure.  
  
### <a name="remarks"></a>Notes  
 Le `GetStockTextMetrics` fonction initialisera le `TEXTMETRIC` structure vers laquelle pointe `lptm` avec les informations de métriques valide en cas de réussite ou d’un remplissage la structure avec des zéros en cas d’échec. Utilisez cette fonction au lieu de [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) lorsque peinture de votre contrôle, car les contrôles, comme les incorporant OLE, peuvent être nécessaires pour s’afficher dans un métafichier.  
  
 Le `TEXTMETRIC` de la structure de la police par défaut est actualisé lorsque le `SelectStockFont` est appelée. Vous devez appeler cette fonction uniquement après que la sélection de la police du stock afin d’assurer les informations fournies n’est valide.  
  
##  <a name="gettext"></a>COleControl::GetText  
 Implémente la fonction Get de la propriété Text ou Caption stock.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur actuelle de la chaîne de texte de contrôle ou une chaîne de longueur nulle si aucune chaîne n’est présent.  
  
> [!NOTE]
>  Pour plus d’informations sur la `BSTR` de type de données, consultez [des Types de données](../../mfc/reference/data-types-mfc.md) dans la section Macros and Globals.  
  
### <a name="remarks"></a>Notes  
 Notez que l’appelant de cette fonction doit appeler `SysFreeString` sur la chaîne retournée de libre la ressource. Dans l’implémentation du contrôle, utilisez `InternalGetText` pour accéder à la propriété du contrôle stock Text ou Caption.  
  
##  <a name="getwindowlessdroptarget"></a>COleControl::GetWindowlessDropTarget  
 Substituer `GetWindowlessDropTarget` lorsque vous souhaitez un contrôle sans fenêtre soit la cible d’OLE opération glisser-déplacer.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers l’objet `IDropTarget` interface. Dans la mesure où il n’est pas une fenêtre, un objet sans fenêtre ne peut pas inscrire un `IDropTarget` interface. Toutefois, pour faire partie d’un glisser- déposer, un objet sans fenêtre peut toujours implémenter l’interface et retourner dans `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Notes  
 Normalement, cela suppose que la fenêtre de contrôle soit stockée en tant que cible de dépôt. Mais puisque le contrôle n’a pas de fenêtre, le conteneur utilise sa propre fenêtre comme cible de dépôt. Le contrôle doit simplement fournir une implémentation de la `IDropTarget` interface à laquelle le conteneur peut déléguer des appels au moment opportun. Exemple :  
  
 [!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 Indique la classe de base de l’IID utilise le contrôle.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Paramètres  
 *piidPrimary*  
 Pointeur vers l’ID de l’interface de dispatch principale du contrôle.  
  
 *piidEvents*  
 Pointeur vers l’ID de l’interface d’événement du contrôle.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction dans le constructeur du contrôle pour informer de la classe de base de l’interface ID utiliseront votre contrôle.  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 Accède à la propriété stock Font de votre contrôle  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une référence à un [CFontHolder](../../mfc/reference/cfontholder-class.md) objet qui contient l’objet de police de stock.  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 Accède à la propriété Text ou Caption stock de votre contrôle.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une référence à la chaîne de texte du contrôle.  
  
##  <a name="internalsetreadystate"></a>COleControl::InternalSetReadyState  
 Définit l’état de préparation du contrôle.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Paramètres  
 *lNewReadyState*  
 L’état de disponibilité à définir pour le contrôle, une des valeurs suivantes :  
  
 **READYSTATE_UNINITIALIZED**  
 État de l’initialisation par défaut  
  
 **READYSTATE_LOADING**  
 Contrôle est en cours de chargement ses propriétés  
  
 **READYSTATE_LOADED**  
 Contrôle a été initialisé.  
  
 **READYSTATE_INTERACTIVE**  
 Contrôle a suffisamment de données pour être interactive, mais pas tous les asynchrone des données sont encore chargées.  
  
 `READYSTATE_COMPLETE`  
 Contrôle a toutes ses données  
  
### <a name="remarks"></a>Notes  
 La plupart des contrôles simples jamais besoin de faire la différence entre **LOADED** et `INTERACTIVE`. Toutefois, les contrôles qui prennent en charge les propriétés de chemin d’accès de données peut-être pas prêts à être interactive jusqu'à la réception d’au moins certaines données de façon asynchrone. Un contrôle doit tenter de devenir interactives dès que possible.  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 Force le contrôle à redessiner.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpRect`  
 Pointeur vers la région du contrôle à invalider.  
  
 `bErase`  
 Spécifie si l’arrière-plan dans la région de mise à jour doit être effacé lors du traitement de la région de mise à jour.  
  
### <a name="remarks"></a>Notes  
 Si `lpRect` a un **NULL** valeur, l’ensemble du contrôle est redessiné. Si `lpRect` n’est pas **NULL**, cela indique la partie du rectangle du contrôle à invalider. Dans les cas où le contrôle n’a aucune fenêtre, ou n’est pas actif, le rectangle est ignoré, et un appel est fait pour le site client [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) fonction membre. Utilisez cette fonction au lieu de `CWnd::InvalidateRect` ou `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 Invalide la zone cliente de la fenêtre conteneur dans une zone donnée.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 `pRgn`  
 Un pointeur vers un [CRgn](../../mfc/reference/crgn-class.md) objet qui identifie la zone d’affichage de l’objet OLE à invalider, en coordonnées clientes de la fenêtre. Si ce paramètre est **NULL**, l’étendue est l’objet entier.  
  
 `bErase`  
 Spécifie si l’arrière-plan dans la région non valide doit être effacées. Si **TRUE**, l’arrière-plan est effacé. Si **FALSE**, l’arrière-plan reste inchangé.  
  
### <a name="remarks"></a>Notes  
 Cela peut servir à redessiner les contrôles sans fenêtre dans le conteneur. La région non valide, ainsi que toutes les autres zones dans la région de mise à jour, est marquée pour la peinture lorsque la prochaine [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) message est envoyé.  
  
 Si `bErase` est **TRUE** pour une partie de la région de mise à jour, l’arrière-plan de la région entière, pas seulement dans la partie spécifiée, est effacée.  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 Permet de spécialisées lors du chargement d’un contrôle OLE.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle est en cours de conversion ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Lors de la conversion d’un formulaire qui utilise VBX des contrôles à un objet qui utilise des contrôles OLE, le code de chargement spéciale pour les contrôles OLE peut être nécessaire. Par exemple, si vous chargez une instance de votre contrôle OLE, vous pouvez avoir un appel à [PX_Font](persistence-of-ole-controls.md#px_font) dans votre `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 Toutefois, les contrôles VBX n’ont pas d’un objet police ; chaque propriété de la police a été enregistrée individuellement. Dans ce cas, vous utiliseriez `IsConvertingVBX` faire la distinction entre ces deux cas :  
  
 [!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Un autre cas serait si votre contrôle VBX a enregistré les données binaires propriétaires (dans son **VBM_SAVEPROPERTY** le Gestionnaire de messages), et votre contrôle OLE enregistre ses données binaires dans un format différent. Si vous souhaitez que votre contrôle OLE à compatibilité descendante avec le contrôle VBX, vous pouvez lire les deux formats anciens et nouveaux en utilisant le `IsConvertingVBX` fonction en distinguant si le contrôle VBX ou le contrôle OLE a été chargé.  
  
 Dans de votre contrôle `DoPropExchange` (fonction), vous pouvez vérifier cette condition et si la valeur est true, exécuter du code de charge spécifique pour cette conversion (par exemple, les exemples précédents). Si le contrôle n’est pas en cours de conversion, vous pouvez exécuter le code de la charge normale. Cette possibilité s’applique uniquement aux contrôles en cours de conversion à partir des équivalents VBX.  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 Permet l’appel de méthode automation.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle a été initialisé ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Implémentation de l’infrastructure de **IDispatch::Invoke** appelle **IsInvokeAllowed** pour déterminer si une fonction donnée (identifié par `dispid`) peut être appelée. Le comportement par défaut pour un contrôle OLE est pour autoriser des méthodes automation d’être appelée uniquement si le contrôle a été initialisé ; Toutefois, **IsInvokeAllowed** est une fonction virtuelle et ne peut être remplacée si nécessaire (par exemple, lorsque le contrôle est utilisé en tant que serveur automation). Pour plus d’informations, consultez l’article de la Base de connaissances Q166472, « comment faire : utiliser un contrôle OLE en tant que serveur Automation. » Articles de la Base de connaissances sont disponibles dans [http://support.microsoft.com](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 Détermine si l’état du contrôle a été modifiée.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’état du contrôle a été modifié depuis son dernier enregistrement ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’état d’un contrôle est modifié lorsqu’une propriété change de valeur.  
  
##  <a name="isoptimizeddraw"></a>Fonction membre COleControl::IsOptimizedDraw  
 Détermine si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Valeur de retour  
 **TRUE** si le conteneur prend en charge optimisée pour l’opération de dessin en cours ; sinon **FALSE**.  
  
### <a name="remarks"></a>Notes  
 Si le dessin optimisé est pris en charge, puis le contrôle doive ne pas sélectionner ancien objets (stylets, pinceaux, polices, etc.) dans le contexte de périphérique lorsque le dessin est terminé.  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 Appelé par l’infrastructure pour déterminer si le contrôle sous-classe un contrôle Windows.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le contrôle est sous-classée ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Vous devez substituer cette fonction et retourner **TRUE** si votre OLE contrôle sous-classe un contrôle Windows.  
  
##  <a name="load"></a>COleControl::Load  
 Réinitialise les données antérieures chargées de façon asynchrone et lance un nouveau chargement de la propriété du contrôle asynchrone.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Paramètres  
 *strNewPath*  
 Un pointeur vers une chaîne contenant le chemin d’accès qui fait référence à l’emplacement absolu de la propriété de contrôle asynchrone.  
  
 *propriétés de l’abonnement*  
 A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) objet qui implémente une propriété de contrôle asynchrone.  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 Empêche le conteneur à partir de la désactivation de votre contrôle.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Paramètres  
 `bLock`  
 **TRUE** si l’état actif sur place du contrôle doit être verrouillé ; **FALSE** s’il doit être déverrouillé.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le verrou a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Notez que chaque verrouillage du contrôle doit être associé avec un déverrouillage du contrôle une fois. Vous devez uniquement verrouiller votre contrôle de courtes périodes, telles que lors de l’activation d’un événement.  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 Appelé par l’infrastructure quand une propriété ambiante du conteneur a changé de valeur.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Paramètres  
 *dispID*  
 L’ID de dispatch de la propriété ambiante qui a changé, ou **DISPID_UNKNOWN** si plusieurs propriétés ont été modifiées.  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 Appelé par le framework lorsque la valeur de propriété d’apparence stock a été modifiée.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété. L’implémentation par défaut appelle `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 Appelé par le framework lorsque la valeur de propriété BackColor stock a été modifiée.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété. L’implémentation par défaut appelle `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 Appelé par le framework lorsque la valeur de la propriété BorderStyle stock a été modifiée.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle `InvalidateControl`.  
  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété.  
  
##  <a name="onclick"></a>COleControl::OnClick  
 Appelé par l’infrastructure lorsqu’un clic de souris ou la méthode stock DoClick a été appelée.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Paramètres  
 *iButton*  
 Index d’un bouton de la souris. Peut avoir l’une des valeurs suivantes :  
  
- **LEFT_BUTTON** l’utilisateur a cliqué sur le bouton gauche de la souris.  
  
- **MIDDLE_BUTTON** l’utilisateur a cliqué sur le bouton central de la souris.  
  
- **RIGHT_BUTTON** l’utilisateur a cliqué sur le bouton droit de la souris.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle `COleControl::FireClick`.  
  
 Remplacez cette fonction membre pour modifier ou étendre la gestion par défaut.  
  
##  <a name="onclose"></a>COleControl::OnClose  
 Appelé par le framework lorsque le conteneur a appelé du contrôle **IOleControl::Close** (fonction).  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwSaveOption`  
 Indicateur qui indique si l’objet doit être enregistré avant le chargement. Les valeurs valides sont les suivantes :  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Notes  
 Par défaut, `OnClose` enregistre l’objet de contrôle s’il a été modifié et `dwSaveOption` est `OLECLOSE_SAVEIFDIRTY` ou `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 Appelé par le framework lorsque le conteneur appelle le **IOleObject::DoVerb** fonction membre.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `iVerb`  
 L’index du verbe de contrôle à appeler.  
  
 `lpMsg`  
 Pointeur vers le message Windows qui a provoqué le verbe à appeler.  
  
 `hWndParent`  
 Descripteur de la fenêtre parente du contrôle. Si l’exécution du verbe crée une fenêtre (ou windows), `hWndParent` doit être utilisé en tant que parent.  
  
 `lpRect`  
 Pointeur vers une structure RECT dans lequel les coordonnées du contrôle, relatifs au conteneur, seront copiées.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut utilise le `ON_OLEVERB` et `ON_STDOLEVERB` message des entrées de mappage pour déterminer la fonction à appeler.  
  
 Remplacez cette fonction pour modifier la gestion par défaut du verbe.  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié en utilisant le contexte de périphérique spécifié.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Le contexte de périphérique dans lequel le dessin se produit.  
  
 `rcBounds`  
 La zone rectangulaire du contrôle, y compris la bordure.  
  
 `rcInvalid`  
 La zone rectangulaire du contrôle qui n’est pas valide.  
  
### <a name="remarks"></a>Notes  
 `OnDraw`est généralement appelée pour afficher l’écran, en passant un contexte de périphérique en tant que `pDC`. Le `rcBounds` paramètre identifie le rectangle dans le contexte de périphérique cible (par rapport à son mode de mappage en cours). Le `rcInvalid` paramètre est le rectangle réel qui n’est pas valide. Dans certains cas, il s’agit une plus petite zone que `rcBounds`.  
  
##  <a name="ondrawmetafile"></a>COleControl::OnDrawMetafile  
 Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié en utilisant le contexte de périphérique de métafichier spécifié.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Le contexte de périphérique dans lequel le dessin se produit.  
  
 `rcBounds`  
 La zone rectangulaire du contrôle, y compris la bordure.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle la [OnDraw](#ondraw) (fonction).  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 Force le contrôle à l’interface utilisateur activé.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpMsg`  
 Pointeur vers le message Windows qui a appelé le verbe.  
  
 `hWndParent`  
 Handle vers la fenêtre parente du contrôle.  
  
 `lpRect`  
 Pointeur vers le rectangle utilisé par le contrôle dans le conteneur.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Cela a le même effet que l’appel du contrôle `OLEIVERB_UIACTIVATE` verbe.  
  
 Cette fonction est généralement utilisée en tant que la fonction de gestionnaire pour un `ON_OLEVERB` message d’entrée de mappage. Cela rend un verbe « Edit » disponible sur le menu du contrôle « Objet ». Exemple :  
  
 [!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 Appelé par le framework lorsque la valeur de la propriété Enabled du stock a été modifiée.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété. L’implémentation par défaut appelle [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 Appelé par le framework lorsque le conteneur appelle le **IOleObject::EnumVerbs** fonction membre.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Paramètres  
 `ppenumOleVerb`  
 Un pointeur vers le **IEnumOLEVERB** objet qui énumère les verbes du contrôle.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si les verbes sont disponibles. Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut énumère les `ON_OLEVERB` entrées dans la table des messages.  
  
 Remplacez cette fonction pour modifier le mode par défaut de l’énumération des verbes.  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 Appelé par l’infrastructure quand un gestionnaire d’événements est connecté à ou déconnecté d’un contrôle OLE.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Paramètres  
 `bAdvise`  
 **TRUE** indique qu’un gestionnaire d’événements a été connecté au contrôle. **FALSE** indique qu’un gestionnaire d’événements a été déconnecté du contrôle.  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 Appelé par le framework lorsque la valeur de propriété de police stock a été modifiée.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle `COleControl::InvalidateControl`. Si le contrôle sous-classe un contrôle Windows, l’implémentation par défaut envoie également un **WM_SETFONT** message à la fenêtre du contrôle.  
  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété.  
  
### <a name="example"></a>Exemple  
 [!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 Appelé par le framework lorsque la valeur de la propriété ForeColor stock a été modifiée.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle `InvalidateControl`.  
  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété.  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 Appelé par le framework après les appels de conteneur **IOleControl::FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Paramètres  
 `bFreeze`  
 **TRUE** si du contrôle la gestion des événements sont figée ; sinon **FALSE**.  
  
### <a name="remarks"></a>Notes  
 L'implémentation par défaut n'exécute aucune opération.  
  
 Remplacez cette fonction si vous souhaitez que le comportement supplémentaire lors de la gestion des événements sont figée ou non figées.  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 Appelé par le framework lorsque le conteneur appelle le **IViewObject::GetColorSet** fonction membre.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Paramètres  
 `ptd`  
 Pointe vers le périphérique cible pour lequel l’image doit être restitué. Si cette valeur est **NULL**, l’image doit être restituée pour un périphérique cible par défaut, généralement un périphérique d’affichage.  
  
 `hicTargetDev`  
 Spécifie le contexte d’informations sur le périphérique cible indiqué par `ptd`. Ce paramètre peut être un contexte de périphérique, mais il n’est pas un nécessairement. Si `ptd` est **NULL**, `hicTargetDev` doit également être **NULL**.  
  
 *ppColorSet*  
 Pointeur vers l’emplacement dans lequel le jeu de couleurs qui seraient utilisés doit être copié. Si la fonction ne retourne pas le jeu de couleurs, **NULL** est retourné.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un jeu de couleurs valide est retourné ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Le conteneur appelle cette fonction pour obtenir toutes les couleurs nécessaires pour dessiner le contrôle OLE. Le conteneur peut utiliser des jeux de couleurs obtenus conjointement avec les couleurs que nécessaires à la palette de couleurs globale. L’implémentation par défaut retourne **FALSE**.  
  
 Remplacez cette fonction pour effectuer tout traitement spécial de cette demande.  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 Appelé par le framework lorsque le conteneur du contrôle a demandé des informations à propos du contrôle.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Paramètres  
 `pControlInfo`  
 Pointeur vers un [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) structure doit être renseigné.  
  
### <a name="remarks"></a>Notes  
 Ces informations se composent principalement d’une description des clés de mnémonique du contrôle. L’implémentation par défaut se remplit `pControlInfo` avec les informations par défaut.  
  
 Remplacez cette fonction si votre contrôle doit traiter des touches mnémoniques.  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 Appelé par l’infrastructure pour obtenir une chaîne qui représente la valeur actuelle de la propriété identifiée par `dispid`.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété du contrôle.  
  
 `strValue`  
 Une référence à un [CString](../../atl-mfc-shared/reference/cstringt-class.md) via laquelle une chaîne est retournée.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si une chaîne a été retournée dans *strValue ;* sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si le contrôle a une propriété dont la valeur ne peut pas être directement convertie en une chaîne et que vous souhaitez que la valeur de propriété à afficher dans un navigateur fourni par le conteneur de la propriété.  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 Appelé par le framework lorsque le contrôle est l’interface utilisateur activé pour obtenir le menu à fusionner dans le menu du conteneur existant.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Le handle du menu du contrôle ou **NULL** si le contrôle n’a aucun. L’implémentation par défaut retourne **NULL**.  
  
### <a name="remarks"></a>Notes  
 Pour plus d’informations sur la fusion des ressources OLE, consultez l’article [Menus et ressources (OLE)](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 Appelé par l’infrastructure en réponse à d’un conteneur **IViewObjectEx::GetNaturalExtent** demande.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwAspect`  
 Spécifie la représentation de l'objet. Inclure des représentations sous forme de contenu, une icône, une vignette ou un document imprimé. Les valeurs valides sont effectuées à partir de l’énumération [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 *lIndex Valeur de type*  
 La partie de l’objet d’intérêt. Actuellement, seuls -1 est valide.  
  
 `ptd`  
 Pointe vers le [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure définissant le périphérique cible pour lequel la taille de l’objet doit être retournée.  
  
 `hicTargetDev`  
 Spécifie le contexte d’informations pour le périphérique cible indiqué par le `ptd` paramètre à partir duquel l’objet peut extraire les métriques du périphérique et tester les fonctions du périphérique. Si `ptd` est **NULL**, l’objet doit ignorer la valeur dans la `hicTargetDev` paramètre.  
  
 *pExtentInfo*  
 Pointe vers le **DVEXTENTINFO** structure qui spécifie les données de dimensionnement. Le **DVEXTENTINFO** structure est :  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 Le membre de structure `dwExtentMode` peut prendre une des deux valeurs :  
  
- **DVEXTENT_CONTENT** rechercher la taille que le contrôle doit être pour qu’elle corresponde à contenu (composant logiciel enfichable de taille)  
  
- **DVEXTENT_INTEGRAL** lors du redimensionnement, taille proposée de passer au contrôle  
  
 `psizel`  
 Pointe vers les données retournées par le contrôle de dimensionnement. Les données de dimensionnement retourné a la valeur -1 pour n’importe quelle dimension qui n’est pas ajustée.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si elle retourne correctement ou que vous ajuste la taille ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction pour retourner la taille d’affichage de l’objet le plus proche pour le mode de taille et l’étendue proposé dans la **DVEXTENTINFO** structure. L’implémentation par défaut retourne **FALSE** et aucun ajustement de la taille.  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 Appelé par l’infrastructure pour obtenir un ensemble de chaînes prédéfinies qui représente les valeurs possibles pour une propriété.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété du contrôle.  
  
 `pStringArray`  
 Un tableau de chaînes doit être remplie avec les valeurs de retour.  
  
 `pCookieArray`  
 A `DWORD` tableau à remplir avec les valeurs de retour.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si les éléments ont été ajoutés à `pStringArray` et `pCookieArray`.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si le contrôle a une propriété avec un ensemble de valeurs possibles qui peuvent être représentées par des chaînes. Pour chaque élément ajouté à `pStringArray`, vous devez ajouter un élément « cookie » correspondant à *pCookieArray.* Ces valeurs de « cookie » peuvent être passés ultérieurement par l’infrastructure pour le `COleControl::OnGetPredefinedValue` (fonction).  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 Appelé par l’infrastructure pour obtenir la valeur correspondant à une des chaînes prédéfinies précédemment retournés par une substitution de `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété du contrôle.  
  
 `dwCookie`  
 Une valeur de cookie précédemment retournée par une substitution de `COleControl::OnGetPredefinedStrings`.  
  
 `lpvarOut`  
 Pointeur vers un **VARIANT** de la structure dans laquelle une valeur de propriété sera retournée.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si une valeur a été retournée dans `lpvarOut`; sinon, 0.  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 Appelé par l’infrastructure en réponse à d’un conteneur [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) demande.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Paramètres  
 *dwDrawAspect*  
 `DWORD`décrivant le formulaire, ou aspect, d’un objet doit être affichée. Les valeurs valides sont effectuées à partir de l’énumération [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 *lIndex Valeur de type*  
 La partie de l’objet d’intérêt. Actuellement, seuls -1 est valide.  
  
 `ptd`  
 Pointe vers le [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) structure définissant le périphérique cible pour lequel la taille de l’objet doit être retournée.  
  
 *lpsizel*  
 Pointe vers l’emplacement où la taille de l’objet est retournée.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si les informations de mesure sont renvoyées avec succès ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si votre contrôle utilise de dessin en deux temps, et ses parties opaques et transparentes ont différentes dimensions.  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 Appelé par l’infrastructure en réponse à d’un conteneur **IViewObjectEx::GetRect** demande.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwAspect`  
 `DWORD`décrivant le formulaire, ou aspect, d’un objet doit être affichée. Les valeurs valides sont effectuées à partir de l’énumération [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**:  
  
- `DVASPECT_CONTENT`Rectangle englobant de l’objet entier. Angle supérieur gauche à l’origine et de taille égale dans la mesure retournée par l’objet **GetViewExtent***.*  
  
- **DVASPECT_OPAQUE** objets avec une zone rectangulaire d’opaque retournent ce rectangle. D’autres échouent.  
  
- **DVASPECT_TRANSPARENT** Rectangle couvrant toutes les parties transparents ou irréguliers.  
  
 `pRect`  
 Pointe vers le [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) structure qui spécifie le rectangle dans lequel l’objet doit être dessiné. Ce paramètre contrôle le positionnement et l’étirement de l’objet.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le rectangle de taille pour l’objet est retourné avec succès ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Taille de l’objet est convertie en `OnGetViewRect` dans un rectangle, en commençant à une position spécifique (la valeur par défaut est le coin supérieur gauche de l’affichage). Remplacez cette fonction si votre contrôle utilise de dessin en deux temps, et ses parties opaques et transparentes ont différentes dimensions.  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 Appelé par l’infrastructure en réponse à d’un conteneur **IViewObjectEx::GetViewStatus** demande.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Une des valeurs de la **VIEWSTATUS** énumération en cas de réussite ; sinon, 0. Les valeurs possibles sont n’importe quelle combinaison des éléments suivants :  
  
 **VIEWSTATUS_OPAQUE**  
 L’objet est complètement opaque. Si ce bit n’est pas défini, l’objet contient des zones transparentes. Ce bit s’applique uniquement aux aspects relatifs à un contenu et non `DVASPECT_ICON` ou `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 Objet a un arrière-plan uni (consistant en une couleur unie, pas un motif de pinceau). Ce bit est significatif uniquement si **VIEWSTATUS_OPAQUE** est défini et s’applique uniquement aux aspects relatifs à un contenu et non `DVASPECT_ICON` ou `DVASPECT_DOCPRINT`.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 Prend en charge de l’objet **DVASPECT_OPAQUE**. Tous les **IViewObjectEx** méthodes qui prennent un aspect de dessin comme un paramètre peut être appelé avec cet aspect.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 Prend en charge de l’objet **DVASPECT_TRANSPARENT**. Tous les **IViewObjectEx** méthodes qui prennent un aspect de dessin comme un paramètre peut être appelé avec cet aspect.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si votre contrôle utilise de dessin en deux temps. L’implémentation par défaut retourne **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 Appelé par le framework lorsque le contrôle est l’interface utilisateur désactivé.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation doit masquer toutes les barres d’outils affichés par `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 Appelée par le conteneur pour l’objet inactif sous le pointeur de souris sur la réception d’un `WM_MOUSEMOVE` message.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Paramètres  
 `lprcBounds`  
 L’objet rectangle, en coordonnées clientes de la fenêtre englobant. Indique à l’objet sa position exacte et la taille à l’écran lorsque le `WM_MOUSEMOVE` message a été reçu.  
  
 *x*  
 Coordonnée x de l’emplacement de la souris en coordonnées clientes de la fenêtre.  
  
 *y*  
 Coordonnée y de l’emplacement de la souris en coordonnées clientes de la fenêtre.  
  
 `dwKeyState`  
 Identifie l’état actuel des touches de modification du clavier. Les valeurs valides peuvent être une combinaison d’un des indicateurs **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_ LBUTTON**, **MK_MBUTTON**, et **MK_RBUTTON**.  
  
### <a name="remarks"></a>Notes  
 Notez que les coordonnées clientes de fenêtre (pixels) sont utilisées pour passer de la position du curseur de la souris. Cela est possible en passant également le rectangle englobant de l’objet dans le même système de coordonnées.  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 Appelée par le conteneur pour l’objet inactif sous le pointeur de souris sur la réception d’un `WM_SETCURSOR` message.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Paramètres  
 `lprcBounds`  
 L’objet rectangle, en coordonnées clientes de la fenêtre englobant. Indique à l’objet sa position exacte et la taille à l’écran lorsque le `WM_SETCURSOR` message a été reçu.  
  
 *x*  
 Coordonnée x de l’emplacement de la souris en coordonnées clientes de la fenêtre.  
  
 *y*  
 Coordonnée y de l’emplacement de la souris en coordonnées clientes de la fenêtre.  
  
 *dwMouseMsg*  
 L’identificateur du message de la souris pour lequel un `WM_SETCURSOR` s’est produite.  
  
 *bSetAlways*  
 Spécifie si l’objet doit définir le curseur. Si **TRUE**, l’objet doit définir le curseur ; si **FALSE**, le curseur n’est pas obligé de définir le curseur et doit retourner **S_FALSE** dans ce cas.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Notez que les coordonnées clientes de fenêtre (pixels) sont utilisées pour passer de la position du curseur de la souris. Cela est possible en passant également le rectangle englobant de l’objet dans le même système de coordonnées.  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 Appelé par le framework après le traitement d’un événement KeyDown stock.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Paramètres  
 `nChar`  
 La valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations de clé une fois que l’événement a été déclenché.  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 Appelé par le framework après le stock KeyPress (événement) a été déclenché.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Paramètres  
 `nChar`  
 Contient la valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h  
  
### <a name="remarks"></a>Notes  
 Notez que le `nChar` valeur ont peut-être été modifiée par le conteneur.  
  
 Remplacez cette fonction si vous souhaitez une notification une fois que cet événement se produit.  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 Appelé par le framework après le traitement d’un événement KeyDown stock.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Paramètres  
 `nChar`  
 La valeur de code de touche virtuelle de la touche enfoncée. Pour obtenir la liste de codes de touches virtuelles, consultez Winuser.h  
  
 `nShiftState`  
 Contient une combinaison des indicateurs suivants :  
  
- **SHIFT_MASK** la touche MAJ a été activée lors de l’action.  
  
- **CTRL_MASK** CTRL la touche lors de l’action.  
  
- **ALT_MASK** ALT la touche a été enfoncée pendant l’opération.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction si votre contrôle a besoin d’accéder aux informations de clé une fois que l’événement a été déclenché.  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 Appelé par l’infrastructure pour obtenir l’ID de classe d’une page de propriétés qui implémente la modification de la propriété spécifiée.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Paramètres  
 `dispid`  
 ID de distribution d’une propriété du contrôle.  
  
 `lpclsid`  
 Pointeur vers un **CLSID** structure via lequel un ID de classe s’affichera.  
  
 *pbPageOptional*  
 Retourne un indicateur de si l’utilisation de la page de la propriété spécifiée est facultative.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un ID de classe a été retourné dans `lpclsid`; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Remplacez cette fonction pour fournir un moyen pour appeler des pages de propriétés de votre contrôle à partir de l’Explorateur de propriétés du conteneur.  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 Appelé par le framework lorsque le conteneur a détecté qu’une touche mnémonique du contrôle OLE a été enfoncée.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Paramètres  
 `pMsg`  
 Pointeur vers le message Windows généré par une pression sur une touche mnémonique.  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 Appelé par le framework lorsque le verbe de propriétés du contrôle a été appelée par le conteneur.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpMsg`  
 Pointeur vers le message Windows qui a appelé le verbe.  
  
 `hWndParent`  
 Handle vers la fenêtre parente du contrôle.  
  
 `lpRect`  
 Pointeur vers le rectangle utilisé par le contrôle dans le conteneur.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut affiche une boîte de dialogue de propriétés modale.  
  
 Vous pouvez également utiliser cette fonction pour que l’affichage des pages de propriétés de votre contrôle. Effectuez un appel à la `OnProperties` fonction, en passant le handle du parent de votre contrôle dans le `hWndParent` paramètre. Dans ce cas, les valeurs de la `lpMsg` et `lpRect` paramètres sont ignorés.  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 Appelé par l’infrastructure en réponse à d’un conteneur **IViewObjectEx::QueryHitPoint** demande.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwAspect`  
 Spécifie la façon dont l’objet est représenté. Les valeurs valides sont effectuées à partir de l’énumération [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 `pRectBounds`  
 Pointeur vers un `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.  
  
 `ptlLoc`  
 Pointeur vers le **POINT** spécifiant le point doit être vérifiée pour effectuer un test de structure. Le point est spécifié dans les coordonnées de la zone client OLE.  
  
 `lCloseHint`  
 La distance qui définit « fermer » pour le point d’activée pour effectuer un test.  
  
 `pHitResult`  
 Pointeur vers le résultat de la requête d’accès. Une des valeurs suivantes :  
  
- **HITRESULT_OUTSIDE** `ptlLoc` est en dehors de l’OLE de l’objet et ne fermez pas.  
  
- **HITRESULT_TRANSPARENT** *ptlLoc* est dans les limites de l’objet OLE, mais pas proche de l’image. Par exemple, un point au milieu d’un cercle transparent peut être **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` est à l’intérieur ou à l’extérieur de l’objet OLE, mais suffisamment près à l’objet soit considérée comme à l’intérieur. Les objets de petites, dynamiques ou détaillées peuvent utiliser cette valeur. Même si un point est à l’extérieur du cadre englobant rectangle d’un objet, il peut encore être fermer (cela est nécessaire pour atteindre les petits objets).  
  
- **HITRESULT_HIT** `ptlLoc` se trouve dans l’image de l’objet.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un résultat de recherche est renvoyé avec succès ; Sinon, 0. Un accès est un chevauchement avec la zone d’affichage de contrôle OLE.  
  
### <a name="remarks"></a>Notes  
 Si le rectangle d’affichage d’un objet chevauche le point donné des requêtes (atteint le point). `QueryHitPoint`peut être substituée pour tester l’accès pour les objets non rectangulaires.  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 Appelé par l’infrastructure en réponse à d’un conteneur **IViewObjectEx::QueryHitRect** demande.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwAspect`  
 Spécifie la représentation de l'objet. Les valeurs valides sont effectuées à partir de l’énumération [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) ou **DVASPECT2**.  
  
 `pRectBounds`  
 Pointeur vers un `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.  
  
 *prcLoc*  
 Pointeur vers le `RECT` structure qui spécifie le rectangle à vérifier pour effectuer un test (chevauchement avec le rectangle de l’objet), par rapport à l’angle supérieur gauche de l’objet.  
  
 `lCloseHint`  
 Non utilisé.  
  
 `pHitResult`  
 Pointeur vers le résultat de la requête d’accès. Une des valeurs suivantes :  
  
- **HITRESULT_OUTSIDE** aucun point dans le rectangle n’est atteint par l’objet OLE.  
  
- **HITRESULT_HIT** au moins un point dans le rectangle serait d’atteinte sur l’objet.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si un résultat de recherche est renvoyé avec succès ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Si le rectangle d’affichage d’un objet chevauche n’importe quel point dans le rectangle donné (atteint le rectangle) des requêtes. `QueryHitRect`peut être substituée pour tester l’accès pour les objets non rectangulaires.  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 Appelé par l’infrastructure pour récupérer des données dans le format spécifié.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpFormatEtc`  
 Pointe vers le [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure qui spécifie le format dans lequel les informations sont demandées.  
  
 `lpStgMedium`  
 Pointe vers un [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure dans laquelle les données sont à retourner.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Le format spécifié est un auparavant placé dans l’objet de contrôle à l’aide de la [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) les fonctions membres pour le rendu retardé. L’implémentation par défaut de cette fonction appelle `OnRenderFileData` ou `OnRenderGlobalData`, respectivement, si le support de stockage fourni est un fichier ou la mémoire. Si le format demandé est `CF_METAFILEPICT` ou la propriété persistante définie format, l’implémentation par défaut restitue les données appropriées et retourne différente de zéro. Sinon, elle retourne 0 et n’exécute aucune opération.  
  
 Si *lpStgMedium -> tymed* est **TYMED_NULL**, le **STGMEDIUM** doit être alloué et rempli comme spécifié par *lpFormatEtc -> tymed*. Si ce n’est pas **TYMED_NULL**, le **STGMEDIUM** devrait normalement être en place avec les données.  
  
 Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez substituer l’une des autres versions de cette fonction à la place. Si vos données soient petite et une taille fixe, substituez `OnRenderGlobalData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.  
  
 Pour plus d’informations, consultez la **FORMATETC** et **STGMEDIUM** structures dans le SDK Windows.  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 Appelé par l’infrastructure pour récupérer des données dans le format spécifié lorsque le support de stockage est un fichier.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpFormatEtc`  
 Pointe vers le [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure qui spécifie le format dans lequel les informations sont demandées.  
  
 `pFile`  
 Pointe vers un [CFile](../../mfc/reference/cfile-class.md) objet dans lequel les données doivent être rendus.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Le format spécifié est un auparavant placé dans l’objet de contrôle à l’aide de la [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) fonction membre pour le rendu retardé. L’implémentation par défaut de cette fonction retourne simplement **FALSE**.  
  
 Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez peut-être substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, remplacez `OnRenderData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.  
  
 Pour plus d’informations, consultez la **FORMATETC** structure dans le SDK Windows.  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 Appelé par l’infrastructure pour récupérer des données dans le format spécifié lorsque le support de stockage spécifié est la mémoire globale.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpFormatEtc`  
 Pointe vers le [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure qui spécifie le format dans lequel les informations sont demandées.  
  
 `phGlobal`  
 Pointe vers un handle de mémoire globale dans laquelle les données sont à retourner. Si aucune mémoire n’a été allouée, ce paramètre peut être **NULL**.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Le format spécifié est un auparavant placé dans l’objet de contrôle à l’aide de la [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) fonction membre pour le rendu retardé. L’implémentation par défaut de cette fonction retourne simplement **FALSE**.  
  
 Si `phGlobal` est **NULL**, puis une nouvelle `HGLOBAL` doit être allouée et retournée dans `phGlobal`. Dans le cas contraire, le `HGLOBAL` spécifié par `phGlobal` doit être rempli avec les données. La quantité de données placées dans le `HGLOBAL` ne doit pas dépasser la taille actuelle du bloc de mémoire. En outre, le bloc ne peut pas être réaffecté à une plus grande taille.  
  
 Remplacez cette fonction pour fournir vos données dans le format demandé et le support. En fonction de vos données, vous souhaiterez substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, remplacez `OnRenderData`. Si vos données sont dans un fichier, ou de taille variable, substituez `OnRenderFileData`.  
  
 Pour plus d’informations, consultez la **FORMATETC** structure dans le SDK Windows.  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 Appelé par l’infrastructure lorsque les propriétés du contrôle doivent être définies sur leurs valeurs par défaut.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle [DoPropExchange](#dopropexchange), en passant un `CPropExchange` objet qui provoque des propriétés à leurs valeurs par défaut.  
  
 L’enregistreur de contrôle peut insérer le code d’initialisation pour le contrôle OLE dans ce substituable. Cette fonction est appelée lorsque [IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) ou [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) échoue, ou [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) ou [IPersistStorage : : InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) est appelée sans appeler auparavant soit **IPersistStream::Load** ou **IPersistStorage::Load**.  
  
##  <a name="onsetclientsite"></a>COleControl::OnSetClientSite  
 Appelé par le framework lorsque le conteneur a appelé du contrôle **IOleControl::SetClientSite** (fonction).  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Notes  
 Par défaut, `OnSetClientSite` vérifie si les propriétés de chemin d’accès de données sont chargées et, s’ils sont, appelle `DoDataPathPropExchange`.  
  
 Remplacez cette fonction pour effectuer tout traitement spécial de cette notification. En particulier, les substitutions de cette fonction doivent appeler la classe de base.  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 Appelé par l’infrastructure pour remplacer les données du contrôle avec les données spécifiées.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpFormatEtc`  
 Pointeur vers un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) structure qui spécifie le format des données.  
  
 `lpStgMedium`  
 Pointeur vers un [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) structure dans laquelle les données résident.  
  
 `bRelease`  
 **TRUE** si le contrôle doit libérer le support de stockage ; **FALSE** si le contrôle ne doit pas libérer le support de stockage.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Si les données sont définies dans la propriété persistent le format, l’implémentation par défaut modifie l’état du contrôle en conséquence. Dans le cas contraire, l’implémentation par défaut n’exécute aucune opération. Si `bRelease` est **TRUE**, puis un appel à **ReleaseStgMedium** est effectuée ; n’est pas dans le cas contraire.  
  
 Remplacez cette fonction pour remplacer les données du contrôle avec les données spécifiées.  
  
 Pour plus d’informations, consultez la **FORMATETC** et **STGMEDIUM** structures dans le SDK Windows.  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 Appelé par le framework lorsque l’étendue du contrôle doit être modifiée, suite à un appel à [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpSizeL`  
 Un pointeur vers le **permet** structure qui utilise des entiers longs pour représenter la largeur et la hauteur du contrôle, exprimé en **HIMETRIC** unités.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si la modification de la taille a été acceptée ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut gère le redimensionnement de l’étendue du contrôle. Si le contrôle est actif en place, un appel à du conteneur **OnPosRectChanged** est alors effectuée.  
  
 Remplacez cette fonction pour modifier le redimensionnement par défaut de votre contrôle.  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 Appelé par le framework pour implémenter un appel à [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Paramètres  
 *lpRectPos*  
 Pointeur vers une structure RECT indiquant la nouvelle position et la taille par rapport au conteneur du contrôle.  
  
 `lpRectClip`  
 Un pointeur vers un `RECT` structure indiquant une zone rectangulaire à laquelle le contrôle est tronquée.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si le repositionnement a été accepté ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut gère le repositionnement et le redimensionnement de la fenêtre de contrôle et retourne automatiquement **TRUE**.  
  
 Remplacez cette fonction pour modifier le comportement par défaut de cette fonction.  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 Appelé par le framework lorsque le contrôle a été activée UI.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Notes  
 L'implémentation par défaut n'exécute aucune opération.  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 Appelé par le framework lorsque la valeur de propriété stock légende ou le texte a été modifiée.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut appelle `InvalidateControl`.  
  
 Remplacez cette fonction si vous souhaitez notification après cette modification de propriété.  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 Appelé par l’infrastructure en réponse à d’un conteneur **IOleInPlaceObjectWindowless::OnWindowMessage** demande.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Paramètres  
 `msg`  
 Identificateur de message passés par Windows.  
  
 `wParam`  
 Passés par Windows. Spécifie des informations supplémentaires spécifiques du message. Le contenu de ce paramètre dépend de la valeur de le `msg` paramètre.  
  
 `lParam`  
 Passés par Windows. Spécifie des informations supplémentaires spécifiques du message. Le contenu de ce paramètre dépend de la valeur de le `msg` paramètre.  
  
 *plResult*  
 Code de résultat de Windows. Spécifie le résultat du traitement du message et varie selon le message envoyé.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Traite les messages de fenêtre pour les contrôles sans fenêtre. `COleControl`de `OnWindowlessMessage` doit être utilisé pour les messages de fenêtre autre que les messages de la souris et clavier. `COleControl`Fournit des [SetCapture](#setcapture) et [SetFocus](#setfocus) spécifiquement pour obtenir le focus clavier et la capture de la souris pour les objets OLE sans fenêtre.  
  
 Étant donné que les objets sans fenêtre ne disposez pas d’une fenêtre, ils ont besoin d’un mécanisme pour vous permettre des messages de répartition de conteneur pour les. Un objet OLE sans fenêtre obtient des messages à partir de son conteneur, via le `OnWindowMessage` méthode sur le `IOleInPlaceObjectWindowless` interface (une extension de [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) pour la prise en charge sans fenêtre). `OnWindowMessage`n’accepte pas un `HWND` paramètre.  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 Convertit les coordonnées de `pPoint` en coordonnées client.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 `lprcBounds`  
 Pointeur vers les limites du contrôle OLE dans le conteneur. La zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement, mais pas dans la zone cliente.  
  
 `pPoint`  
 Pointeur vers le parent (conteneur) point sera traduite dans les coordonnées de la zone cliente du contrôle.  
  
 `bHitTest`  
 Spécifie si le test de positionnement est à effectuer sur le point.  
  
### <a name="return-value"></a>Valeur de retour  
 Si `bHitTest` est **FALSE**, retourne **HTNOWHERE**. Si `bHitTest` est **TRUE**, retourne l’emplacement dans lequel le parent (conteneur) point étant récupérées dans la zone cliente du contrôle OLE et de la souris suivante les valeurs de test de positionnement :  
  
- **HTBORDER** dans la bordure d’une fenêtre qui ne dispose pas d’une bordure de redimensionnement.  
  
- **HTBOTTOM** dans la bordure horizontale inférieure de la fenêtre.  
  
- **HTBOTTOMLEFT** dans le coin inférieur gauche de la bordure de fenêtre.  
  
- **HTBOTTOMRIGHT** dans le coin inférieur droit de la bordure de fenêtre.  
  
- **HTCAPTION** dans une zone de la barre de titre.  
  
- **HTCLIENT** dans une zone cliente.  
  
- **HTERROR** sur l’arrière-plan de l’écran ou sur une ligne de séparation entre les fenêtres (identique à **HTNOWHERE** , sauf que la **DefWndProc** fonction Windows génère un signal sonore pour indiquer une erreur).  
  
- **HTGROWBOX** dans une zone de taille.  
  
- **HTHSCROLL** dans la barre de défilement horizontale.  
  
- **HTLEFT** dans la bordure gauche de la fenêtre.  
  
- **HTMAXBUTTON** dans optimiser un bouton.  
  
- **HTMENU** dans une zone de menu.  
  
- **HTMINBUTTON** dans réduit le bouton.  
  
- **HTNOWHERE** sur l’arrière-plan de l’écran ou sur une ligne de séparation entre les fenêtres.  
  
- **HTREDUCE** dans réduit le bouton.  
  
- **HTRIGHT** dans la bordure droite de la fenêtre.  
  
- **HTSIZE** dans une zone de taille (identique à **HTGROWBOX**).  
  
- **HTSYSMENU** dans un menu de contrôle ou un bouton Fermer dans une fenêtre enfant.  
  
- **HTTOP** dans la bordure horizontale supérieure de la fenêtre.  
  
- **HTTOPLEFT** dans le coin supérieur gauche de la bordure de fenêtre.  
  
- **HTTOPRIGHT** dans le coin supérieur droit de la bordure de fenêtre.  
  
- **HTTRANSPARENT** dans une fenêtre actuellement couverte par une autre fenêtre.  
  
- **HTVSCROLL** dans la barre de défilement verticale.  
  
- **HTZOOM** dans optimiser un bouton.  
  
### <a name="remarks"></a>Notes  
 Dans l’entrée `pPoint` est relatif à l’origine du parent (coin supérieur gauche du conteneur). Dans la sortie `pPoint` est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle).  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 Avertit le conteneur qu’une boîte de dialogue modale a été fermée.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 `hWndParent`  
 Handle vers la fenêtre parente de la boîte de dialogue modale.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction après l’affichage d’une boîte de dialogue modale. Vous devez appeler cette fonction afin que le conteneur peut activer des fenêtres de niveau supérieur désactivées par `PreModalDialog`. Cette fonction doit être associée à un appel à `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 Avertit le conteneur de boîte de dialogue modale est sur le point d’être affiché.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 `hWndParent`  
 Handle vers la fenêtre parente de la boîte de dialogue modale.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction avant d’afficher une boîte de dialogue modale. Vous devez appeler cette fonction afin que le conteneur peut désactiver toutes ses fenêtres de niveau supérieur. Après avoir affiché la boîte de dialogue modale, vous devez appeler `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 Détruit et recrée la fenêtre du contrôle.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Notes  
 Cela peut être nécessaire si vous avez besoin modifier les bits de style de la fenêtre.  
  
##  <a name="refresh"></a>COleControl::Refresh  
 Force la mise à jour du contrôle OLE.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Notes  
 Cette fonction est prise en charge par la `COleControl` classe de base comme une méthode stock, appelée l’actualisation. Cela permet aux utilisateurs de votre contrôle OLE de redessiner le contrôle à un moment donné. Pour plus d’informations sur cette méthode, consultez l’article [contrôles ActiveX : méthodes](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 Libère la capture de la souris.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Si le contrôle a actuellement la capture de la souris, la capture est libérée. Sinon, cette fonction n’a aucun effet.  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre, libérer le contexte de périphérique pour une utilisation par d’autres applications.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Identifie le contexte de périphérique de conteneur doit être libéré.  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur différente de zéro cas de réussite ; sinon, 0.  
  
### <a name="remarks"></a>Notes  
 L’application doit appeler `ReleaseDC` pour chaque appel à [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 Définit le parent du contrôle.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Paramètres  
 *hWndOuter*  
 Le handle de la fenêtre de contrôle.  
  
 `hWndParent`  
 Le handle de la nouvelle fenêtre parent.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction pour réinitialiser le parent de la fenêtre de contrôle.  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 Initialise l’état de la `COleControl` stock propriétés à leurs valeurs par défaut.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Notes  
 Les propriétés sont : apparence, BackColor, BorderStyle, légende, Enabled, police, couleur de premier plan, hWnd et texte. Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : ajout de propriétés Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Vous pouvez améliorer les performances de binaire de l’initialisation d’un contrôle à l’aide de `ResetStockProps` et `ResetVersion` à substituer `COleControl::OnResetState`. Lisez l'exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Exemple  
 [!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 Initialise le numéro de version à la valeur spécifiée.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Paramètres  
 `dwVersionDefault`  
 Le numéro de version à assigner au contrôle.  
  
### <a name="remarks"></a>Notes  
 Vous pouvez améliorer les performances de binaire de l’initialisation d’un contrôle à l’aide de `ResetVersion` et `ResetStockProps` à substituer `COleControl::OnResetState`. Consultez l’exemple [ResetStockProps](#resetstockprops). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 Permet à un objet OLE sans fenêtre faire défiler une zone au sein de son image actif sur place sur l’écran.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 `xAmount`  
 Spécifie la quantité, en unités de périphérique de défilement horizontal. Ce paramètre doit être une valeur négative pour faire défiler vers la gauche.  
  
 `yAmount`  
 Spécifie la quantité, en unités de périphérique de défilement verticale. Ce paramètre doit être une valeur négative pour faire défiler vers le haut.  
  
 `lpRect`  
 Pointe vers un [CRect](../../atl-mfc-shared/reference/crect-class.md) objet ou une structure RECT qui spécifie la partie de la zone cliente de l’objet OLE à faire défiler, en coordonnées clientes de la fenêtre. Si `lpRect` est **NULL**, défile de la zone cliente de l’objet OLE entier.  
  
 `lpClipRect`  
 Pointe vers un `CRect` objet ou `RECT` structure qui spécifie le rectangle de découpage pour. Défilement uniquement les pixels à l’intérieur du rectangle. Bits en dehors du rectangle ne sont pas affectées même s’ils sont dans le `lpRect` rectangle. Si `lpClipRect` est **NULL**, aucun extrait n’est effectuée sur le rectangle de défilement.  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 Sélectionne une police dans un contexte de périphérique.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Pointeur vers un objet de contexte de périphérique.  
  
 `fontHolder`  
 Référence à la [CFontHolder](../../mfc/reference/cfontholder-class.md) objet représentant la police à être sélectionné.  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers la police sélectionnée précédemment. Lorsque l’appelant a terminé toutes les opérations de dessin qui utilisent *fontHolder,* il doit sélectionner à nouveau la police sélectionnée précédemment en lui passant comme paramètre à [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 Sélectionne la propriété stock Font dans un contexte de périphérique.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Paramètres  
 `pDC`  
 Le contexte de périphérique dans lequel la police est sélectionnée.  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers sélectionné précédemment `CFont` objet. Vous devez utiliser [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) pour sélectionner cette police dans le contexte de périphérique lorsque vous avez terminé.  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 Sérialise ou initialise l’état de l’espace alloué au contrôle d’affichage.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Paramètres  
 `ar`  
 A `CArchive` objet à sérialiser vers ou depuis.  
  
### <a name="remarks"></a>Notes  
 Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeExtent`, `SerializeStockProps`, et `SerializeVersion` à substituer **COleControl::Serialize**. Lisez l'exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Exemple  
 [!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 Sérialise ou initialise l’état de la `COleControl` propriétés stock : apparence, BackColor, BorderStyle, légende, activé, police, couleur de premier plan et texte.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Paramètres  
 `ar`  
 A `CArchive` objet à sérialiser vers ou depuis.  
  
### <a name="remarks"></a>Notes  
 Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : ajout de propriétés Stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeStockProps`, `SerializeExtent`, et `SerializeVersion` à substituer **COleControl::Serialize**. Pour obtenir un exemple, consultez le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 Sérialise ou initialise l’état d’un contrôle informations de version.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 `ar`  
 A `CArchive` objet à sérialiser vers ou depuis.  
  
 `dwVersionDefault`  
 Le numéro de version actuel du contrôle.  
  
 `bConvert`  
 Indique si les données persistantes doivent être converties au format plus récent lorsqu’il est enregistré ou mis à jour dans le même format qu’elle avait lorsqu’il a été chargé.  
  
### <a name="return-value"></a>Valeur de retour  
 Le numéro de version du contrôle. Si la charge de l’archive spécifiée, `SerializeVersion` retourne la version chargée à partir de cette archive. Sinon, elle retourne la version actuellement chargée.  
  
### <a name="remarks"></a>Notes  
 Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeVersion`, `SerializeExtent`, et `SerializeStockProps` à substituer **COleControl::Serialize**. Pour obtenir un exemple, consultez le code à [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 Définit la valeur de propriété stock apparence de votre contrôle.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Paramètres  
 *sAppearance*  
 A **court** ( `VT_I2`) la valeur à utiliser pour l’apparence de votre contrôle. Une valeur égale à zéro définit l’apparence du contrôle à plat et affecte la valeur 1 l’apparence du contrôle en 3D.  
  
### <a name="remarks"></a>Notes  
 Pour plus d’informations sur les propriétés stock, consultez [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 Définit la valeur de propriété stock BackColor de votre contrôle.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Paramètres  
 *dwBackColor*  
 Un **OLE_COLOR** valeur à utiliser pour l’arrière-plan de votre contrôle de dessin.  
  
### <a name="remarks"></a>Notes  
 Pour plus d’informations sur l’utilisation de cette propriété et autres propriétés, consultez l’article [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 Définit la valeur de la propriété BorderStyle stock de votre contrôle.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Paramètres  
 *sBorderStyle*  
 Le nouveau style de bordure pour le contrôle ; 0 n’indique aucune bordure et 1 indique une bordure normale.  
  
### <a name="remarks"></a>Notes  
 La fenêtre du contrôle sera recréée et `OnBorderStyleChanged` appelée.  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 Provoque la fenêtre du contrôle conteneur prendre possession de la capture de souris procuration du contrôle.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers le **CWnd** objet window qui précédemment a reçu une entrée de la souris.  
  
### <a name="remarks"></a>Notes  
 Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre du contrôle conteneur prendre possession de la capture de la souris, procuration du contrôle. Sinon, cette fonction provoque le contrôle lui-même pour prendre possession de la capture de souris (identique à `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 Définit la taille de la fenêtre de contrôle OLE et avertit le conteneur que le site du contrôle change.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Paramètres  
 `cx`  
 Spécifie la nouvelle largeur du contrôle en pixels.  
  
 `cy`  
 Spécifie la nouvelle hauteur du contrôle en pixels.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Cette fonction ne doit pas être utilisée dans le constructeur de votre contrôle.  
  
 Notez que toutes les coordonnées pour les fenêtres de contrôle sont par rapport à l’angle supérieur gauche du contrôle.  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 Définit la valeur de la propriété Enabled de votre contrôle de stock.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Paramètres  
 `bEnabled`  
 **TRUE** si le contrôle doit être activé ; sinon **FALSE**.  
  
### <a name="remarks"></a>Notes  
 Après avoir défini cette propriété, **OnEnabledChange** est appelée.  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 Provoque la fenêtre du contrôle conteneur prendre possession du focus d’entrée procuration du contrôle.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers le **CWnd** objet window qui avait le focus d’entrée, ou **NULL** s’il n’existe pas de fenêtre.  
  
### <a name="remarks"></a>Notes  
 Si le contrôle est activé et sans fenêtre, cette fonction provoque la fenêtre du contrôle conteneur prendre possession du focus d’entrée, procuration du contrôle. Le focus d’entrée dirige l’entrée au clavier pour la fenêtre du conteneur et le conteneur distribue à tous les messages de clavier suivants à l’objet OLE qui appelle `SetFocus`. Perd toutes les fenêtres qui avaient le focus d’entrée.  
  
 Si le contrôle n’est pas sans fenêtre, cette fonction provoque le contrôle lui-même pour prendre possession du focus d’entrée (identique à `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>COleControl::SetFont  
 Définit la propriété stock Font de votre contrôle.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Paramètres  
 *pFontDisp*  
 Pointeur vers une interface de dispatch de police.  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 Définit la valeur de propriété stock ForeColor de votre contrôle.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Paramètres  
 *dwForeColor*  
 Un **OLE_COLOR** valeur à utiliser pour le dessin de votre contrôle de premier plan.  
  
### <a name="remarks"></a>Notes  
 Pour plus d’informations sur l’utilisation de cette propriété et autres propriétés, consultez l’article [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Notes  
 L’implémentation par défaut spécifie deux formats : `CF_METAFILEPICT` et la propriété persistante.  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 Définit la taille d’un contrôle OLE premier affichage dans un conteneur.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Paramètres  
 `cx`  
 La largeur initiale du contrôle OLE en pixels.  
  
 `cy`  
 La hauteur initiale du contrôle OLE en pixels.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction dans votre constructeur pour définir la taille initiale de votre contrôle. La taille initiale est mesurée en unités de périphérique, ou en pixels. Il est recommandé que cet appel est effectué dans le constructeur de votre contrôle.  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 Modifie l’état de modification d’un contrôle.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 `bModified`  
 La nouvelle valeur pour le contrôle de modification indicateur. **TRUE** indique que l’état du contrôle a été modifié ; **FALSE** indique que l’état du contrôle a simplement été enregistré.  
  
### <a name="remarks"></a>Notes  
 Appel de cette fonction chaque fois qu’une modification produit, qui affecte un état persistant de votre contrôle. Par exemple, si la valeur d’une propriété persistante change, appelez cette fonction avec `bModified` **TRUE**.  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 Indique qu’une demande de modification a échoué.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction lorsque `BoundPropertyRequestEdit` échoue. Cette fonction lève une exception de type **COleDispScodeException** pour indiquer que l’opération de définition n’a pas été autorisée.  
  
##  <a name="setnotsupported"></a>Courants  
 Empêche la modification de la valeur de la propriété d’un contrôle par l’utilisateur.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction à la place de la fonction de n’importe quelle propriété où la modification de la valeur de propriété par l’utilisateur du contrôle n’est pas pris en charge. Un exemple serait une propriété qui est en lecture seule.  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 Définit les coordonnées du rectangle du contrôle relatifs au conteneur, exprimé en unités de périphérique.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Paramètres  
 `lpRect`  
 Pointeur vers un rectangle qui contient les coordonnées de nouveau du contrôle relatifs au conteneur.  
  
### <a name="return-value"></a>Valeur de retour  
 Différent de zéro si l’appel a réussi ; Sinon, 0.  
  
### <a name="remarks"></a>Notes  
 Si le contrôle est ouvert, il est redimensionné ; dans le cas contraire du conteneur **OnPosRectChanged** est appelée.  
  
##  <a name="settext"></a>COleControl::SetText  
 Définit la valeur de propriété stock de légende ou le texte de votre contrôle.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Paramètres  
 `pszText`  
 Pointeur vers une chaîne de caractères.  
  
### <a name="remarks"></a>Notes  
 Notez que les propriétés stock de légende et le texte sont tous deux mappées à la même valeur. Cela signifie que toute modification apportée à des propriétés change automatiquement les deux propriétés. En règle générale, un contrôle doit prendre en charge le stock de légende ou propriété de texte, mais pas les deux.  
  
##  <a name="throwerror"></a>COleControl::ThrowError  
 Signale l’occurrence d’une erreur dans votre contrôle.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Paramètres  
 `sc`  
 La valeur de code d’état doit être signalée. Pour obtenir une liste complète des codes possibles, consultez l’article [contrôles ActiveX : rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 `nDescriptionID`  
 La chaîne ID de ressource de l’exception doit être signalée.  
  
 `nHelpID`  
 ID de la rubrique d’aide à étudier.  
  
 `pszDescription`  
 Chaîne contenant une explication de l’exception doit être signalée.  
  
### <a name="remarks"></a>Notes  
 Cette fonction doit uniquement être appelée à partir d’une fonction Get ou Set pour une propriété OLE, ou l’implémentation d’une méthode d’automatisation OLE. Si vous avez besoin de signaler les erreurs qui se produisent à d’autres moments, vous devez déclencher l’événement d’erreur stock.  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 Les valeurs entre des coordonnées de transformations **HIMETRIC** unités et les unités de native du conteneur.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Paramètres  
 *lpptlHimetric*  
 Pointeur vers un **POINTL** structure contenant les coordonnées de **HIMETRIC** unités.  
  
 *lpptfContainer*  
 Pointeur vers un **POINTF** structure contenant les coordonnées de la taille d’unité du conteneur.  
  
 `flags`  
 Une combinaison des valeurs suivantes :  
  
- **XFORMCOORDS_POSITION** une position dans le conteneur.  
  
- **XFORMCOORDS_SIZE** une taille dans le conteneur.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** transformer **HIMETRIC** unités à des unités du conteneur.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** transformer les unités du conteneur à **HIMETRIC** unités.  
  
### <a name="remarks"></a>Notes  
 Les deux premiers indicateurs, **XFORMCOORDS_POSITION** et **XFORMCOORDS_SIZE**, indiquent si les coordonnées doivent être traitées comme une position ou d’une taille. Les deux autres indicateurs indiquent le sens de la transformation.  
  
##  <a name="translatecolor"></a>Fonction membre COleControl::TranslateColor  
 Convertit une valeur de couleur à partir de la **OLE_COLOR** type de données à la [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) type de données.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 `clrColor`  
 A **OLE_COLOR** type de données. Pour plus d’informations, consultez les fenêtres [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) (fonction).  
  
 `hpal`  
 Un handle vers une palette facultatif ; peut être **NULL**.  
  
### <a name="return-value"></a>Valeur de retour  
 Une valeur de 32 bits couleur RVB (rouge, vert, bleu) qui définit le solide de couleur plus proche de la `clrColor` valeur représentant l’appareil.  
  
### <a name="remarks"></a>Notes  
 Cette fonction est utile pour traduire les propriétés stock ForeColor et BackColor à **COLORREF** les types utilisés par [CDC](../../mfc/reference/cdc-class.md) fonctions membres.  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 Détermine si votre contrôle doit utiliser en tant que valeurs par défaut, les valeurs des propriétés ambiantes quand il est chargé par la suite de son état persistant.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Valeur de retour  
 NonZero indique que les propriétés ambiantes sera valides. propriétés ambiantes ne seront plus valides.  
  
### <a name="remarks"></a>Notes  
 Dans certains conteneurs, votre contrôle peut-être pas accès à ses propriétés ambiantes lors de l’appel initial à la substitution de `COleControl::DoPropExchange`. C’est le cas si le conteneur appelle [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) ou [IPersistStorage::Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) avant d’appeler [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (autrement dit, s’il n’existe pas respecter la **OLEMISC_SETCLIENTSITEFIRST** bit d’état).  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 Fournit une procédure de Windows pour un `COleControl` objet.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Paramètres  
 `message`  
 Spécifie le message Windows à traiter.  
  
 `wParam`  
 Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.  
  
 `lParam`  
 Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.  
  
### <a name="return-value"></a>Valeur de retour  
 La valeur de retour du message distribué.  
  
### <a name="remarks"></a>Notes  
 Appelez cette fonction pour distribuer les messages spécifiques à la table des messages du contrôle.  
  
## <a name="see-also"></a>Voir aussi  
 [MFC exemple CIRC3](../../visual-cpp-samples.md)   
 [Exemple MFC TESTHELP](../../visual-cpp-samples.md)   
 [Classe de COlePropertyPage](../../mfc/reference/colepropertypage-class.md)   
 [CWnd (classe)](../../mfc/reference/cwnd-class.md)   
 [Graphique hiérarchique](../../mfc/hierarchy-chart.md)   
 [Classe de CFontHolder](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder, classe](../../mfc/reference/cpictureholder-class.md)
