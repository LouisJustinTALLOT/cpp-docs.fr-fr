---
title: Classe COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 7d75ec6fa111c8c26b4390ac0ac62160d71c185b
ms.sourcegitcommit: 13f42c339fb7af935e3a93ac80e350d5e784c9f1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/31/2020
ms.locfileid: "87470917"
---
# <a name="colecontrol-class"></a>Classe COleControl

Classe de base puissante pour développer des contrôles OLE.

## <a name="syntax"></a>Syntax

```
class COleControl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleControl :: COleControl](#colecontrol)|Crée un objet `COleControl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleControl :: AmbientAppearance](#ambientappearance)|Récupère l’apparence actuelle du contrôle.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Retourne la valeur de la propriété de couleur d’ambiance ambiante.|
|[COleControl :: AmbientDisplayName](#ambientdisplayname)|Retourne le nom du contrôle tel que spécifié par le conteneur.|
|[COleControl :: AmbientFont](#ambientfont)|Retourne la valeur de la propriété de police ambiante.|
|[COleControl :: AmbientForeColor](#ambientforecolor)|Retourne la valeur de la propriété ForeColor ambiante.|
|[COleControl :: AmbientLocaleID](#ambientlocaleid)|Retourne l’ID de paramètres régionaux du conteneur.|
|[COleControl :: AmbientScaleUnits](#ambientscaleunits)|Retourne le type d’unités utilisé par le conteneur.|
|[COleControl :: AmbientShowGrabHandles](#ambientshowgrabhandles)|Détermine si les poignées de manipulation doivent être affichées.|
|[COleControl :: AmbientShowHatching](#ambientshowhatching)|Détermine si le hachurage doit être affiché.|
|[COleControl :: AmbientTextAlign](#ambienttextalign)|Retourne le type d’alignement de texte spécifié par le conteneur.|
|[COleControl :: AmbientUIDead](#ambientuidead)|Détermine si le contrôle doit répondre aux actions de l’interface utilisateur.|
|[COleControl :: AmbientUserMode](#ambientusermode)|Détermine le mode du conteneur.|
|[COleControl :: BoundPropertyChanged](#boundpropertychanged)|Notifie le conteneur qu’une propriété liée a été modifiée.|
|[COleControl :: BoundPropertyRequestEdit](#boundpropertyrequestedit)|Demande l’autorisation de modifier la valeur de la propriété.|
|[COleControl :: ClientToParent](#clienttoparent)|Convertit un point relatif à l’origine du contrôle en un point relatif à l’origine de son conteneur.|
|[COleControl :: ClipCaretRect](#clipcaretrect)|Ajuste un rectangle d’insertion s’il est superposé à un contrôle.|
|[COleControl :: ControlInfoChanged](#controlinfochanged)|Appelez cette fonction après que l’ensemble de mnémoniques géré par le contrôle a changé.|
|[COleControl ::D isplayError](#displayerror)|Affiche les événements d’erreur de stock à l’utilisateur du contrôle.|
|[COleControl ::D oClick](#doclick)|Implémentation de la `DoClick` méthode stock.|
|[COleControl ::D oPropExchange](#dopropexchange)|Sérialise les propriétés d’un `COleControl` objet.|
|[COleControl ::D oSuperclassPaint](#dosuperclasspaint)|Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.|
|[COleControl :: EnableSimpleFrame](#enablesimpleframe)|Active la prise en charge des frames simples pour un contrôle.|
|[COleControl :: ExchangeExtent](#exchangeextent)|Sérialise la largeur et la hauteur du contrôle.|
|[COleControl :: ExchangeStockProps](#exchangestockprops)|Sérialise les propriétés stock du contrôle.|
|[COleControl :: ExchangeVersion](#exchangeversion)|Sérialise le numéro de version du contrôle.|
|[COleControl :: FireClick](#fireclick)|Déclenche l' `Click` événement stock.|
|[COleControl :: FireDblClick](#firedblclick)|Déclenche l' `DblClick` événement stock.|
|[COleControl :: FireError (](#fireerror)|Déclenche l' `Error` événement stock.|
|[COleControl :: FireEvent](#fireevent)|Déclenche un événement personnalisé.|
|[COleControl :: FireKeyDown](#firekeydown)|Déclenche l' `KeyDown` événement stock.|
|[COleControl :: FireKeyPress](#firekeypress)|Déclenche l' `KeyPress` événement stock.|
|[COleControl :: FireKeyUp](#firekeyup)|Déclenche l' `KeyUp` événement stock.|
|[COleControl :: FireMouseDown](#firemousedown)|Déclenche l' `MouseDown` événement stock.|
|[COleControl :: FireMouseMove](#firemousemove)|Déclenche l' `MouseMove` événement stock.|
|[COleControl :: FireMouseUp](#firemouseup)|Déclenche l' `MouseUp` événement stock.|
|[COleControl :: FireReadyStateChange](#firereadystatechange)|Déclenche un événement lorsque l’état prêt du contrôle change.|
|[COleControl :: GetActivationPolicy](#getactivationpolicy)|Modifie le comportement d’activation par défaut d’un contrôle qui prend en charge l' `IPointerInactive` interface.|
|[COleControl :: GetAmbientProperty](#getambientproperty)|Retourne la valeur de la propriété ambiante spécifiée.|
|[COleControl :: GetAppearance](#getappearance)|Retourne la valeur de la propriété d’apparence de stock.|
|[COleControl :: GetBackColor](#getbackcolor)|Retourne la valeur de la propriété stock BackColor.|
|[COleControl :: GetBorderStyle](#getborderstyle)|Retourne la valeur de la propriété BorderStyle de stock.|
|[COleControl :: GetCapture](#getcapture)|Détermine si un objet de contrôle activé sans fenêtre a la capture de la souris.|
|[COleControl :: GetClassID](#getclassid)|Récupère l’ID de classe OLE du contrôle.|
|[COleControl :: GetClientOffset](#getclientoffset)|Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.|
|[COleControl :: GetClientRect](#getclientrect)|Récupère la taille de la zone cliente du contrôle.|
|[COleControl :: GetClientSite](#getclientsite)|Interroge un objet pour le pointeur vers son site client actuel dans son conteneur.|
|[COleControl :: GetControlFlags](#getcontrolflags)|Récupère les paramètres d’indicateur de contrôle.|
|[COleControl :: GetControlSize](#getcontrolsize)|Retourne la position et la taille du contrôle OLE.|
|[COleControl :: GetDC](#getdc)|Fournit un moyen pour un contrôle sans fenêtre d’obtenir un contexte de périphérique à partir de son conteneur.|
|[COleControl :: GetEnabled](#getenabled)|Retourne la valeur de la propriété stock activé.|
|[COleControl :: GetExtendedControl](#getextendedcontrol)|Récupère un pointeur vers un objet de contrôle étendu appartenant au conteneur.|
|[COleControl :: GetFocus](#getfocus)|Détermine si le contrôle a le focus.|
|[COleControl :: GetFont](#getfont)|Retourne la valeur de la propriété stock font.|
|[COleControl :: GetFontTextMetrics](#getfonttextmetrics)|Retourne les métriques d’un `CFontHolder` objet.|
|[COleControl :: GetForeColor](#getforecolor)|Retourne la valeur de la propriété stock ForeColor.|
|[COleControl :: GetHwnd](#gethwnd)|Retourne la valeur de la propriété stock hWnd.|
|[COleControl :: GetMessageString](#getmessagestring)|Fournit le texte de la barre d’État pour un élément de menu.|
|[COleControl :: GetNotSupported](#getnotsupported)|Empêche l’utilisateur d’accéder à la valeur de propriété d’un contrôle.|
|[COleControl :: GetReadyState](#getreadystate)|Retourne l’état de préparation du contrôle.|
|[COleControl :: GetRectInContainer](#getrectincontainer)|Retourne le rectangle du contrôle par rapport à son conteneur.|
|[COleControl :: GetStockTextMetrics](#getstocktextmetrics)|Retourne les métriques de la propriété stock font.|
|[COleControl :: GetText](#gettext)|Retourne la valeur de la propriété de texte ou de légende de l’action.|
|[COleControl :: GetWindowlessDropTarget](#getwindowlessdroptarget)|Substituez pour autoriser un contrôle sans fenêtre à être la cible des opérations de glisser-déplacer.|
|[COleControl :: InitializeIIDs](#initializeiids)|Informe la classe de base des IID que le contrôle utilisera.|
|[COleControl :: InternalGetFont](#internalgetfont)|Retourne un `CFontHolder` objet pour la propriété stock font.|
|[COleControl :: InternalGetText](#internalgettext)|Récupère la légende ou la propriété de texte stock.|
|[COleControl :: InternalSetReadyState](#internalsetreadystate)|Définit l’état de préparation du contrôle et déclenche l’événement Ready-State-change.|
|[COleControl :: InvalidateControl](#invalidatecontrol)|Invalide une zone du contrôle affiché, provoquant son redessin.|
|[COleControl :: InvalidateRgn](#invalidatergn)|Invalide la zone cliente de la fenêtre de conteneur dans la région donnée. Peut être utilisé pour redessiner des contrôles sans fenêtre dans la région.|
|[COleControl :: IsConvertingVBX](#isconvertingvbx)|Permet le chargement spécialisé d’un contrôle OLE.|
|[COleControl :: IsModified](#ismodified)|Détermine si l’état du contrôle a changé.|
|[COleControl :: IsOptimizedDraw](#isoptimizeddraw)|Indique si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.|
|[COleControl :: IsSubclassedControl](#issubclassedcontrol)|Appelé pour déterminer si le contrôle sous-classe un contrôle Windows.|
|[COleControl :: Load](#load)|Réinitialise toutes les données asynchrones précédentes et Initialise une nouvelle charge de la propriété asynchrone du contrôle.|
|[COleControl :: LockInPlaceActive](#lockinplaceactive)|Détermine si votre contrôle peut être désactivé par le conteneur.|
|[COleControl :: OnAmbientPropertyChange](#onambientpropertychange)|Appelée lorsqu’une propriété ambiante est modifiée.|
|[COleControl :: OnAppearanceChanged](#onappearancechanged)|Appelé lorsque la propriété d’apparence de stock est modifiée.|
|[COleControl :: OnBackColorChanged](#onbackcolorchanged)|Appelé lorsque la propriété stock BackColor est modifiée.|
|[COleControl :: OnBorderStyleChanged](#onborderstylechanged)|Appelée lorsque la propriété de la propriété BorderStyle stock est modifiée.|
|[COleControl :: OnClick](#onclick)|Appelé pour déclencher l’événement de clic stock.|
|[COleControl :: OnClose](#onclose)|Notifie le contrôle qui `IOleControl::Close` a été appelé.|
|[COleControl :: OnDoVerb](#ondoverb)|Appelé après l’exécution d’un verbe de contrôle.|
|[COleControl :: OnDraw](#ondraw)|Appelé lorsqu’un contrôle est demandé pour se redessiner lui-même.|
|[COleControl :: OnDrawMetafile](#ondrawmetafile)|Appelé par le conteneur lorsqu’un contrôle est demandé à se redessiner à l’aide d’un contexte de périphérique de métafichier.|
|[COleControl :: OnEdit](#onedit)|Appelé par le conteneur pour activer l’interface utilisateur d’un contrôle OLE.|
|[COleControl :: OnEnabledChanged](#onenabledchanged)|Appelé lorsque la propriété stock activée est modifiée.|
|[COleControl :: OnEnumVerbs](#onenumverbs)|Appelé par le conteneur pour énumérer les verbes d’un contrôle.|
|[COleControl :: OnEventAdvise](#oneventadvise)|Appelé lorsque les gestionnaires d’événements sont connectés ou déconnectés d’un contrôle.|
|[COleControl :: OnFontChanged](#onfontchanged)|Appelé lorsque la propriété stock font est modifiée.|
|[COleControl :: OnForeColorChanged](#onforecolorchanged)|Appelé lorsque la propriété ForeColor ForeColor est modifiée.|
|[COleControl :: OnFreezeEvents](#onfreezeevents)|Appelé lorsque les événements d’un contrôle sont figés ou non figés.|
|[COleControl :: OnGetColorSet](#ongetcolorset)|Notifie le contrôle qui `IOleObject::GetColorSet` a été appelé.|
|[COleControl :: OnGetControlInfo](#ongetcontrolinfo)|Fournit des informations mnémoniques au conteneur.|
|[COleControl :: OnGetDisplayString](#ongetdisplaystring)|Appelé pour obtenir une chaîne représentant une valeur de propriété.|
|[COleControl :: OnGetInPlaceMenu](#ongetinplacemenu)|Demande le handle du menu du contrôle qui sera fusionné avec le menu du conteneur.|
|[COleControl :: OnGetNaturalExtent](#ongetnaturalextent)|Substituez pour récupérer la taille d’affichage du contrôle la plus proche de la taille proposée et le mode d’étendue.|
|[COleControl :: OnGetPredefinedStrings](#ongetpredefinedstrings)|Retourne des chaînes représentant les valeurs possibles d’une propriété.|
|[COleControl :: OnGetPredefinedValue](#ongetpredefinedvalue)|Retourne la valeur correspondant à une chaîne prédéfinie.|
|[COleControl :: OnGetViewExtent](#ongetviewextent)|Substituez pour récupérer la taille des zones d’affichage du contrôle (peut être utilisé pour activer le dessin en deux passes).|
|[COleControl :: OnGetViewRect](#ongetviewrect)|Substituez pour convertir la taille du contrôle en rectangle en commençant à une position spécifique.|
|[COleControl :: OnGetViewStatus](#ongetviewstatus)|Substituez pour récupérer l’état d’affichage du contrôle.|
|[COleControl :: OnHideToolBars](#onhidetoolbars)|Appelé par le conteneur lorsque le contrôle est désactivé par l’interface utilisateur.|
|[COleControl :: OnInactiveMouseMove](#oninactivemousemove)|Substituez pour que le conteneur du contrôle inactif sous le pointeur de la souris Dispatch WM_MOUSEMOVE des messages au contrôle.|
|[COleControl :: OnInactiveSetCursor](#oninactivesetcursor)|Substituez pour que le conteneur du contrôle inactif sous le pointeur de la souris Dispatch WM_SETCURSOR des messages au contrôle.|
|[COleControl :: OnKeyDownEvent](#onkeydownevent)|Appelée après le déclenchement de l’événement keyplace de stock.|
|[COleControl :: OnKeyPressEvent](#onkeypressevent)|Appelé après le déclenchement de l’événement de touche de la stock.|
|[COleControl :: OnKeyUpEvent](#onkeyupevent)|Appelée après le déclenchement de l’événement de retouche de stock.|
|[COleControl :: OnMapPropertyToPage](#onmappropertytopage)|Indique la page de propriétés à utiliser pour modifier une propriété.|
|[COleControl :: OnMnemonic](#onmnemonic)|Appelée lorsqu’une touche mnémonique du contrôle a été enfoncée.|
|[COleControl :: OnProperties](#onproperties)|Appelé lorsque le verbe « Properties » du contrôle a été appelé.|
|[COleControl :: OnQueryHitPoint](#onqueryhitpoint)|Substituez pour demander si l’affichage d’un contrôle chevauche un point donné.|
|[COleControl :: OnQueryHitRect](#onqueryhitrect)|Substituez pour demander si l’affichage d’un contrôle chevauche un point quelconque dans un rectangle donné.|
|[COleControl :: OnRenderData](#onrenderdata)|Appelé par le Framework pour récupérer des données dans le format spécifié.|
|[COleControl :: OnRenderFileData](#onrenderfiledata)|Appelé par le Framework pour récupérer des données d’un fichier dans le format spécifié.|
|[COleControl :: OnRenderGlobalData](#onrenderglobaldata)|Appelé par le Framework pour récupérer des données de la mémoire globale dans le format spécifié.|
|[COleControl :: OnResetState](#onresetstate)|Rétablit les valeurs par défaut des propriétés d’un contrôle.|
|[COleControl :: OnSetClientSite](#onsetclientsite)|Notifie le contrôle qui `IOleControl::SetClientSite` a été appelé.|
|[COleControl :: OnSetData](#onsetdata)|Remplace les données du contrôle par une autre valeur.|
|[COleControl :: OnSetExtent](#onsetextent)|Appelé après la modification de l’étendue du contrôle.|
|[COleControl :: OnSetObjectRects](#onsetobjectrects)|Appelée une fois que les dimensions du contrôle ont été modifiées.|
|[COleControl :: OnShowToolBars](#onshowtoolbars)|Appelé lorsque le contrôle a été activé par l’interface utilisateur.|
|[COleControl :: OnTextChanged](#ontextchanged)|Appelé lorsque la propriété de texte stock ou de légende est modifiée.|
|[COleControl :: OnWindowlessMessage](#onwindowlessmessage)|Traite les messages de fenêtre (autres que les messages de souris et de clavier) pour les contrôles sans fenêtre.|
|[COleControl ::P arentToClient](#parenttoclient)|Convertit un point relatif à l’origine du conteneur en un point relatif à l’origine du contrôle.|
|[COleControl ::P ostModalDialog](#postmodaldialog)|Notifie le conteneur qu’une boîte de dialogue modale a été fermée.|
|[COleControl ::P reModalDialog](#premodaldialog)|Notifie le conteneur qu’une boîte de dialogue modale va être affichée.|
|[COleControl :: RecreateControlWindow](#recreatecontrolwindow)|Détruit et recrée la fenêtre du contrôle.|
|[COleControl :: Refresh](#refresh)|Force un redessin de l’apparence d’un contrôle.|
|[COleControl :: ReleaseCapture](#releasecapture)|Libère la capture de la souris.|
|[COleControl :: ReleaseDC](#releasedc)|Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre.|
|[COleControl :: ReparentControlWindow](#reparentcontrolwindow)|Réinitialise le parent de la fenêtre de contrôle.|
|[COleControl :: ResetStockProps](#resetstockprops)|Initialise `COleControl` les propriétés stock avec leurs valeurs par défaut.|
|[COleControl :: ResetVersion](#resetversion)|Initialise le numéro de version à une valeur donnée.|
|[COleControl :: ScrollWindow](#scrollwindow)|Permet à un contrôle sans fenêtre de faire défiler une zone dans son image active sur place à l’affichage.|
|[COleControl :: SelectFontObject](#selectfontobject)|Sélectionne une propriété de police personnalisée dans un contexte de périphérique.|
|[COleControl :: SelectStockFont](#selectstockfont)|Sélectionne la propriété stock font dans un contexte de périphérique.|
|[COleControl :: SerializeExtent](#serializeextent)|Sérialise ou Initialise l’espace d’affichage pour le contrôle.|
|[COleControl :: SerializeStockProps](#serializestockprops)|Sérialise ou initialise les `COleControl` propriétés stock.|
|[COleControl :: SerializeVersion](#serializeversion)|Sérialise ou initialise les informations de version du contrôle.|
|[COleControl :: SetAppearance](#setappearance)|Définit la valeur de la propriété d’apparence de stock.|
|[COleControl :: SetBackColor](#setbackcolor)|Définit la valeur de la propriété stock BackColor.|
|[COleControl :: SetBorderStyle](#setborderstyle)|Définit la valeur de la propriété BorderStyle de stock.|
|[COleControl :: SetCapture](#setcapture)|Fait en sorte que la fenêtre de conteneur du contrôle prenne possession de la capture de la souris pour le compte du contrôle.|
|[COleControl :: SetControlSize](#setcontrolsize)|Définit la position et la taille du contrôle OLE.|
|[COleControl :: SetEnabled](#setenabled)|Définit la valeur de la propriété stock activé.|
|[COleControl :: SetFocus](#setfocus)|Fait en sorte que la fenêtre de conteneur du contrôle prenne possession du focus d’entrée au nom du contrôle.|
|[COleControl :: SetFont](#setfont)|Définit la valeur de la propriété stock font.|
|[COleControl :: SetForeColor](#setforecolor)|Définit la valeur de la propriété stock ForeColor.|
|[COleControl :: SetInitialSize](#setinitialsize)|Définit la taille d’un contrôle OLE lorsqu’il est affiché pour la première fois dans un conteneur.|
|[COleControl :: SetModifiedFlag](#setmodifiedflag)|Modifie l’état modifié d’un contrôle.|
|[COleControl :: SetNotPermitted](#setnotpermitted)|Indique qu’une demande de modification a échoué.|
|[COleControl :: SetNotSupported](#setnotsupported)|Empêche la modification de la valeur de la propriété d’un contrôle par l’utilisateur.|
|[COleControl :: SetRectInContainer](#setrectincontainer)|Définit le rectangle du contrôle par rapport à son conteneur.|
|[COleControl :: SetText](#settext)|Définit la valeur de la propriété du texte ou de la légende de l’action.|
|[COleControl :: ThrowError](#throwerror)|Signale qu’une erreur s’est produite dans un contrôle OLE.|
|[COleControl :: TransformCoords](#transformcoords)|Transforme des valeurs de coordonnées entre un conteneur et le contrôle.|
|[COleControl :: TranslateColor](#translatecolor)|Convertit une valeur OLE_COLOR en valeur COLORREF.|
|[COleControl :: WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Détermine si les propriétés ambiantes seront disponibles lors du prochain chargement du contrôle.|
|[COleControl :: WindowProc](#windowproc)|Fournit une procédure Windows pour un `COleControl` objet.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleControl ::D rawContent](#drawcontent)|Appelé par le Framework lorsque l’apparence du contrôle doit être mise à jour.|
|[COleControl ::D rawMetafile](#drawmetafile)|Appelé par le Framework lorsque le contexte de périphérique de métafichier est utilisé.|
|[COleControl :: IsInvokeAllowed](#isinvokeallowed)|Active l’appel de la méthode Automation.|
|[COleControl :: SetInitialDataFormats](#setinitialdataformats)|Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.|

## <a name="remarks"></a>Remarques

Dérivée de `CWnd` , cette classe hérite de toutes les fonctionnalités d’un objet fenêtre Windows, ainsi que des fonctionnalités supplémentaires spécifiques à OLE, telles que le déclenchement d’événements et la possibilité de prendre en charge des méthodes et des propriétés.

Les contrôles OLE peuvent être insérés dans des applications de conteneur OLE et communiquer avec le conteneur à l’aide d’un système bidirectionnel de déclenchement d’événements et d’exposition des méthodes et des propriétés au conteneur. Notez que les conteneurs OLE standard prennent uniquement en charge les fonctionnalités de base d’un contrôle OLE. Ils ne peuvent pas prendre en charge les fonctionnalités étendues d’un contrôle OLE. Le déclenchement d’événements se produit lorsque des événements sont envoyés au conteneur suite à certaines actions qui se produisent dans le contrôle. À son tour, le conteneur communique avec le contrôle à l’aide d’un ensemble de méthodes et de propriétés exposées analogues aux fonctions membres et aux données membres d’une classe C++. Cette approche permet au développeur de contrôler l’apparence du contrôle et d’avertir le conteneur lorsque certaines actions se produisent.

## <a name="windowless-controls"></a>Contrôles sans fenêtre

Les contrôles OLE peuvent être utilisés sur place sans fenêtre. Les contrôles sans fenêtre présentent des avantages significatifs :

- Les contrôles sans fenêtre peuvent être transparents et non rectangulaires

- Les contrôles sans fenêtre réduisent la taille de l’instance et l’heure de création de l’objet

Les contrôles n’ont pas besoin d’une fenêtre. Les services qu’offre une fenêtre peuvent être facilement fournis via une seule fenêtre partagée (généralement le conteneur) et un peu de code de distribution. Avoir une fenêtre est principalement une complication inutile sur l’objet.

Lorsque l’activation sans fenêtre est utilisée, le conteneur (qui possède une fenêtre) est chargé de fournir des services qui autrement auraient été fournis par la propre fenêtre du contrôle. Par exemple, si votre contrôle doit interroger le focus clavier, interroger la capture de la souris ou obtenir un contexte de périphérique, ces opérations sont gérées par le conteneur. Les `COleControl` fonctions membres sans fenêtre appellent ces opérations sur le conteneur.

Lorsque l’activation sans fenêtre est activée, le conteneur délègue les messages d’entrée à l’interface du contrôle `IOleInPlaceObjectWindowless` (une extension de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pour la prise en charge sans fenêtre). `COleControl`l’implémentation de cette interface distribuera ces messages via la table des messages de votre contrôle, après avoir ajusté les coordonnées de la souris de manière appropriée. Vous pouvez traiter ces messages comme des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages.

Dans un contrôle sans fenêtre, vous devez toujours utiliser les `COleControl` fonctions membres à la place des fonctions membres correspondantes ou des fonctions d' `CWnd` API Windows associées.

Les objets de contrôle OLE peuvent également créer une fenêtre uniquement lorsqu’ils deviennent actifs, mais la quantité de travail nécessaire pour la transition inactive-active s’affiche et la vitesse de la transition diminue. Il y a des cas où il s’agit d’un problème : par exemple, envisagez une grille de zones de texte. En cas de curseur vers le haut et vers le haut dans la colonne, chaque contrôle doit être activé sur place, puis désactivé. La vitesse de la transition inactive/active aura une incidence directe sur la vitesse de défilement.

Pour plus d’informations sur le développement d’une infrastructure de contrôle OLE, consultez les articles [contrôles ActiveX MFC](../../mfc/mfc-activex-controls.md) et [vue d’ensemble : création d’un programme de contrôle ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Pour plus d’informations sur l’optimisation des contrôles OLE, y compris les contrôles sans fenêtre et sans scintillement, consultez [contrôles ActiveX MFC : optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxctl. h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COleControl :: AmbientBackColor

Retourne la valeur de la propriété de couleur d’ambiance ambiante.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur actuelle de la propriété BackColor ambiante du conteneur, le cas échéant. Si la propriété n’est pas prise en charge, cette fonction retourne la couleur d’arrière-plan Windows définie par le système.

### <a name="remarks"></a>Remarques

La propriété BackColor ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl :: AmbientDisplayName

Le nom que le conteneur a affecté au contrôle peut être utilisé dans les messages d’erreur affichés à l’utilisateur.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valeur renvoyée

Nom du contrôle OLE. La valeur par défaut est une chaîne de longueur zéro.

### <a name="remarks"></a>Remarques

Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl :: AmbientFont

Retourne la valeur de la propriété de police ambiante.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’interface de distribution de polices ambiantes du conteneur. La valeur par défaut est NULL. Si le retour n’est pas égal à NULL, vous êtes chargé de libérer la police en appelant sa fonction membre [IUnknown :: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) .

### <a name="remarks"></a>Remarques

La propriété de police ambiante est définie par le conteneur et disponible pour tous les contrôles. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl :: AmbientForeColor

Retourne la valeur de la propriété ForeColor ambiante.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur actuelle de la propriété ForeColor ambiante du conteneur, le cas échéant. Si elle n’est pas prise en charge, cette fonction retourne la couleur de texte Windows définie par le système.

### <a name="remarks"></a>Remarques

La propriété ForeColor ambiante est disponible pour tous les contrôles et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl :: AmbientLocaleID

Retourne l’ID de paramètres régionaux du conteneur.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur de la propriété LocaleID du conteneur, le cas échéant. Si cette propriété n’est pas prise en charge, cette fonction retourne 0.

### <a name="remarks"></a>Remarques

Le contrôle peut utiliser le LocaleID pour adapter son interface utilisateur à des paramètres régionaux spécifiques. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl :: AmbientAppearance

Récupère le paramètre d’apparence actuel pour l’objet de contrôle.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valeur renvoyée

Apparence du contrôle :

- **0** apparence plate

- **1** apparence 3D

### <a name="remarks"></a>Remarques

Appelez cette fonction pour récupérer la valeur actuelle de la propriété DISPID_AMBIENT_APPEARANCE pour le contrôle.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COleControl :: AmbientScaleUnits

Retourne le type d’unités utilisé par le conteneur.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valeur renvoyée

Chaîne contenant le unités ambiant du conteneur. Si cette propriété n’est pas prise en charge, cette fonction retourne une chaîne de longueur nulle.

### <a name="remarks"></a>Remarques

La propriété unités ambiante du conteneur peut être utilisée pour afficher les positions ou les dimensions, étiquetées avec l’unité choisie, par exemple twips ou centimètres. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COleControl :: AmbientShowGrabHandles

Détermine si le conteneur permet au contrôle d’afficher des handles de manipulation pour lui-même lorsqu’il est actif.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si les poignées de manipulation doivent être affichées ; Sinon, 0. Si cette propriété n’est pas prise en charge, cette fonction retourne une valeur différente de zéro.

### <a name="remarks"></a>Remarques

Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COleControl :: AmbientShowHatching

Détermine si le conteneur permet au contrôle de s’afficher avec un modèle hachuré lorsque l’interface utilisateur est active.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si le motif hachuré doit être affiché. Sinon, 0. Si cette propriété n’est pas prise en charge, cette fonction retourne une valeur différente de zéro.

### <a name="remarks"></a>Remarques

Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COleControl :: AmbientTextAlign

Détermine l’alignement du texte ambiant préféré par le conteneur de contrôle.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valeur renvoyée

État de la propriété TextAlign ambiante du conteneur. Si cette propriété n’est pas prise en charge, cette fonction retourne 0.

La liste suivante répertorie les valeurs de retour valides :

|Valeur retournée|Signification|
|------------------|-------------|
|0|Alignement général (nombres à droite, texte à gauche).|
|1|Justifier à gauche|
|2|Center|
|3|Justifier à droite|

### <a name="remarks"></a>Remarques

Cette propriété est disponible pour tous les contrôles incorporés et est définie par le conteneur. Notez que le conteneur n’est pas requis pour prendre en charge cette propriété.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl :: AmbientUIDead

Détermine si le conteneur souhaite que le contrôle réponde aux actions de l’interface utilisateur.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle doit répondre aux actions de l’interface utilisateur ; Sinon, 0. Si cette propriété n’est pas prise en charge, cette fonction retourne 0.

### <a name="remarks"></a>Remarques

Par exemple, un conteneur peut affecter la valeur TRUE en mode création.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COleControl :: AmbientUserMode

Détermine si le conteneur est en mode création ou en mode utilisateur.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le conteneur est en mode utilisateur ; Sinon, 0 (en mode création). Si cette propriété n’est pas prise en charge, cette fonction retourne TRUE.

### <a name="remarks"></a>Remarques

Par exemple, un conteneur peut affecter la valeur FALSe en mode création.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COleControl :: BoundPropertyChanged

Signale que la valeur de la propriété liée a changé.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de dispatch d’une propriété liée du contrôle.

### <a name="remarks"></a>Remarques

Cela doit être appelé chaque fois que la valeur de la propriété change, même dans les cas où la modification n’a pas été effectuée par le biais de la méthode Property Set. Soyez particulièrement conscient des propriétés liées mappées à des variables de membre. Chaque fois qu’une variable membre est modifiée, `BoundPropertyChanged` doit être appelé.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COleControl :: BoundPropertyRequestEdit

Demande l’autorisation de l' `IPropertyNotifySink` interface pour modifier une valeur de propriété liée fournie par le contrôle.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de dispatch d’une propriété liée du contrôle.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la modification est autorisée ; Sinon, 0. La valeur par défaut est différente de zéro.

### <a name="remarks"></a>Remarques

Si l’autorisation est refusée, le contrôle ne doit pas autoriser la modification de la valeur de la propriété. Pour ce faire, vous pouvez ignorer ou faire échouer l’action qui a tenté de modifier la valeur de la propriété.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COleControl :: ClientToParent

Convertit les coordonnées de *PPoint* en coordonnées parentes.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. Pas la zone cliente, mais la zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement.

*pPoint*<br/>
Pointeur vers le point de zone client OLE à traduire en coordonnées du parent (conteneur).

### <a name="remarks"></a>Remarques

Sur l’entrée *PPoint* est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle). Sur la sortie *PPoint* est relatif à l’origine du parent (dans le coin supérieur gauche du conteneur).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COleControl :: ClipCaretRect

Ajuste un rectangle d’insertion s’il est entièrement ou partiellement couvert par des objets opaques qui se chevauchent.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
En entrée, pointeur vers une structure [Rect](/windows/win32/api/windef/ns-windef-rect) qui contient la zone du signe insertion à ajuster. Lors de la sortie, la zone de signe insertion ajustée ou NULL si le rectangle du signe insertion est entièrement couvert.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Un signe insertion est une ligne, un bloc ou un bitmap clignotant qui indique généralement où le texte ou les graphiques seront insérés.

Un objet sans fenêtre ne peut pas afficher en toute sécurité un signe insertion sans vérifier d’abord si le signe insertion est partiellement ou totalement masqué en chevauchant des objets. Pour que cela soit possible, un objet peut utiliser pour faire en `ClipCaretRect` sorte que le signe insertion soit ajusté (réduit) pour s’assurer qu’il s’ajuste à la zone de découpage.

Les objets qui créent un signe insertion doivent envoyer le rectangle du signe insertion à `ClipCaretRect` et utiliser le rectangle ajusté pour le signe insertion. Si le signe insertion est entièrement masqué, cette méthode retourne la valeur FALSe et le signe insertion ne doit pas être affiché du tout dans ce cas.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COleControl :: COleControl

Construit un objet `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Remarques

Cette fonction n’est normalement pas appelée directement. Au lieu de cela, le contrôle OLE est généralement créé par sa fabrique de classe.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COleControl :: ControlInfoChanged

Appelez cette fonction lorsque l’ensemble de mnémoniques pris en charge par le contrôle a changé.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Remarques

Lors de la réception de cette notification, le conteneur du contrôle obtient le nouvel ensemble de mnémoniques en effectuant un appel à [IOleControl :: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Notez que le conteneur n’est pas requis pour répondre à cette notification.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl ::D isplayError

Appelée par l’infrastructure après que l’événement d’erreur stock a été traité (sauf si le gestionnaire d’événements a supprimé l’affichage de l’erreur).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Paramètres

*SCODE*<br/>
Valeur de code d’État à signaler. Pour obtenir la liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Description de l’erreur signalée.

*lpszSource*<br/>
Nom du module générant l’erreur (en général, le nom du module de contrôle OLE).

*lpszHelpFile*<br/>
Nom du fichier d’aide contenant une description de l’erreur.

*nHelpID*<br/>
ID de contexte d’aide de l’erreur signalée.

### <a name="remarks"></a>Remarques

Le comportement par défaut affiche une boîte de message contenant la description de l’erreur, contenue dans *lpszDescription*.

Remplacez cette fonction pour personnaliser la façon dont les erreurs sont affichées.

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl ::D oClick

Simule une action de clic de souris sur le contrôle.

```cpp
void DoClick();
```

### <a name="remarks"></a>Remarques

La `COleControl::OnClick` fonction membre Overridable sera appelée et un événement de clic sur les actions sera déclenché, s’il est pris en charge par le contrôle.

Cette fonction est prise en charge par la `COleControl` classe de base comme méthode stock, appelée inclick. Pour plus d’informations, consultez l’article [contrôles ActiveX : méthodes](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl ::D oPropExchange

Appelé par le Framework lors du chargement ou du stockage d’un contrôle à partir d’une représentation de stockage persistante, telle qu’un flux ou un jeu de propriétés.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet `CPropExchange`. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriétés, y compris sa direction.

### <a name="remarks"></a>Remarques

Cette fonction effectue normalement des appels à la famille de fonctions **PX_** pour charger ou stocker des propriétés spécifiques définies par l’utilisateur d’un contrôle OLE.

Si l’Assistant contrôle a été utilisé pour créer le projet de contrôle OLE, la version substituée de cette fonction sérialise les propriétés stock prises en charge par `COleControl` avec un appel à la fonction de classe de base, `COleControl::DoPropExchange` . Lorsque vous ajoutez des propriétés définies par l’utilisateur à votre contrôle OLE, vous devez modifier cette fonction pour sérialiser vos nouvelles propriétés. Pour plus d’informations sur la sérialisation, consultez l’article [contrôles ActiveX : sérialisation](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl ::D oSuperclassPaint

Redessine un contrôle OLE qui a été sous-classé à partir d’un contrôle Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Pointeur vers le contexte de périphérique (Device Context) du conteneur de contrôle.

*rcBounds*<br/>
Zone dans laquelle le contrôle doit être dessiné.

### <a name="remarks"></a>Remarques

Appelez cette fonction pour gérer correctement la peinture d’un contrôle OLE non actif. Cette fonction doit être utilisée uniquement si le contrôle OLE sous-classe un contrôle Windows et doit être appelé dans la `OnDraw` fonction de votre contrôle.

Pour plus d’informations sur cette fonction et sur la sous-classe d’un contrôle Windows, consultez l’article [contrôles ActiveX : sous-classement d’un contrôle Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl ::D rawContent

Appelé par le Framework lorsque l’apparence du contrôle doit être mise à jour.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Pointeur vers le contexte de périphérique (Device Context).

*Release*<br/>
Zone rectangulaire à dessiner.

### <a name="remarks"></a>Remarques

Cette fonction appelle directement la fonction Overridable `OnDraw` .

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl ::D rawMetafile

Appelé par le Framework lorsque le contexte de périphérique de métafichier est utilisé.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Pointeur vers le contexte de périphérique de métafichier.

*Release*<br/>
Zone rectangulaire à dessiner.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COleControl :: EnableSimpleFrame

Active les caractéristiques de frame simple pour un contrôle OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Remarques

Cette caractéristique permet à un contrôle de prendre en charge la relation contenant-contenu visuelle d’autres contrôles, mais pas de la relation contenant-contenu OLE. Par exemple, une zone de groupe avec plusieurs contrôles à l’intérieur de. Ces contrôles ne sont pas OLE contenus, mais ils se trouvent dans la même zone de groupe.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl :: ExchangeExtent

Sérialise ou Initialise l’état de l’étendue du contrôle (ses dimensions en unités HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet [CPropExchange](../../mfc/reference/cpropexchange-class.md) . L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriétés, y compris sa direction.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la fonction a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

Cette fonction est normalement appelée par l’implémentation par défaut de `COleControl::DoPropExchange` .

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl :: ExchangeStockProps

Sérialise ou Initialise l’état des propriétés stock du contrôle.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet [CPropExchange](../../mfc/reference/cpropexchange-class.md) . L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriétés, y compris sa direction.

### <a name="remarks"></a>Remarques

Cette fonction est normalement appelée par l’implémentation par défaut de `COleControl::DoPropExchange` .

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl :: ExchangeVersion

Sérialise ou Initialise l’état des informations de version d’un contrôle.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*pPX*<br/>
Pointeur vers un objet `CPropExchange`. L’infrastructure fournit cet objet pour établir le contexte de l’échange de propriétés, y compris sa direction.

*dwVersionDefault*<br/>
Numéro de la version actuelle du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties au format le plus récent lorsqu’elles sont enregistrées ou conservées dans le même format que celui qui a été chargé.

### <a name="return-value"></a>Valeur renvoyée

Une valeur différente de zéro de la fonction a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

En général, il s’agit de la première fonction appelée par la substitution d’un contrôle de `COleControl::DoPropExchange` . Lors du chargement, cette fonction lit le numéro de version des données persistantes et définit l’attribut de version de l’objet [CPropExchange](../../mfc/reference/cpropexchange-class.md) en conséquence. Lors de l’enregistrement, cette fonction écrit le numéro de version des données persistantes.

Pour plus d’informations sur la persistance et le contrôle de version, consultez l’article [contrôles ActiveX : sérialisation](../../mfc/mfc-activex-controls-serializing.md).

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COleControl :: FireClick

Appelé par le Framework lorsque l’utilisateur clique sur un contrôle actif.

```cpp
void FireClick();
```

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement Click se produise, la table des événements du contrôle doit avoir un événement de clic stock défini.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl :: FireDblClick

Appelé par le Framework lorsque l’utilisateur double-clique sur un contrôle actif.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement DblClick se produise, la table des événements du contrôle doit avoir un événement stock DblClick défini.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleControl :: FireError (

Déclenche l’événement d’erreur stock.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*SCODE*<br/>
Valeur de code d’État à signaler. Pour obtenir la liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Description de l’erreur signalée.

*nHelpID*<br/>
ID d’aide de l’erreur signalée.

### <a name="remarks"></a>Remarques

Cet événement permet de signaler, à des emplacements appropriés dans votre code, qu’une erreur s’est produite dans votre contrôle. Contrairement à d’autres événements stock, tels que Click ou MouseMove, l’erreur n’est jamais déclenchée par l’infrastructure.

Pour signaler une erreur qui se produit pendant une fonction d’extraction de propriété, une fonction de jeu de propriétés ou une méthode Automation, appelez [COleControl :: ThrowError](#throwerror).

L’implémentation d’un événement d’erreur stock d’un contrôle OLE utilise une valeur SCODE. Si votre contrôle utilise cet événement et s’il est destiné à être utilisé dans Visual Basic 4,0, vous recevrez des erreurs, car la valeur SCODE n’est pas prise en charge dans Visual Basic.

Pour résoudre ce problème, modifiez manuellement le paramètre SCODE dans le du contrôle. Fichier ODL en **`long`** . De plus, tout événement, méthode ou propriété personnalisé qui utilise un paramètre SCODE provoque également le même problème.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COleControl :: FireEvent

Déclenche un événement défini par l’utilisateur à partir de votre contrôle avec un nombre quelconque d’arguments facultatifs,.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de dispatch de l’événement à déclencher.

*pbParams*<br/>
Descripteur des types de paramètres de l’événement.

### <a name="remarks"></a>Remarques

En règle générale, cette fonction ne doit pas être appelée directement. Au lieu de cela, vous appellerez les fonctions de déclenchement d’événements dans la section de la table des événements de la déclaration de classe de votre contrôle.

L’argument *pbParams* est une liste séparée par des espaces de **VTS_**. Une ou plusieurs de ces valeurs, séparées par des espaces (et non par des virgules), spécifient la liste des paramètres de la fonction. Les valeurs possibles sont les suivantes :

|Symbole|Type de paramètre|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Des constantes variant supplémentaires ont été définies pour tous les types variant, à l’exception de VTS_FONT et VTS_PICTURE, qui fournissent un pointeur vers la constante de données Variant. Ces constantes sont nommées à l’aide de la Convention de **VTS_P** `constantname` . Par exemple, VTS_PCOLOR est un pointeur vers une constante VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COleControl :: FireKeyDown

Appelé par le Framework lorsqu’une touche est enfoncée alors que le contrôle est activé par l’interface utilisateur.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de code de la touche virtuelle de la touche enfoncée. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que l’activation automatique d’un événement keyversion se produise, la table des événements du contrôle doit avoir un événement KeyOut stock défini.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl :: FireKeyPress

Appelé par le Framework lorsqu’une touche est enfoncée et libérée alors que le contrôle personnalisé est l’interface utilisateur active dans le conteneur.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de caractère de la touche enfoncée.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Le destinataire de l’événement peut modifier *pnChar*, par exemple, convertir tous les caractères minuscules en majuscules. Si vous souhaitez examiner le caractère modifié, remplacez `OnKeyPressEvent` .

Pour que le déclenchement automatique d’un événement KeyPress se produise, la table des événements du contrôle doit avoir un événement KeyPress de stock défini.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COleControl :: FireKeyUp

Appelé par le Framework lorsqu’une touche est relâchée alors que le contrôle personnalisé est l’interface utilisateur active dans le conteneur.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Paramètres

*pnChar*<br/>
Pointeur vers la valeur de code de la touche virtuelle de la clé publiée. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement KeyUp se produise, la table des événements du contrôle doit avoir un événement de touche relâchée défini.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl :: FireMouseDown

Appelé par le Framework quand un bouton de la souris est enfoncé sur un contrôle personnalisé actif.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*Nbouton*<br/>
Valeur numérique du bouton de la souris enfoncé. Il peut contenir l’une des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été enfoncé.

- MIDDLE_BUTTON le bouton central de la souris a été enfoncé.

- RIGHT_BUTTON le bouton droit de la souris a été enfoncé.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

*x*<br/>
Coordonnée x du curseur lorsqu’un bouton de la souris a été enfoncé. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y du curseur lorsqu’un bouton de la souris a été enfoncé. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement MouseDown se produise, la table des événements du contrôle doit avoir un événement action MouseDown défini.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl :: FireMouseMove

Appelé par le Framework lorsque le curseur est déplacé sur un contrôle personnalisé actif.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*Nbouton*<br/>
Valeur numérique des boutons de la souris appuyée. Contient une combinaison des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été enfoncé pendant l’action.

- MIDDLE_BUTTON le bouton central de la souris a été enfoncé pendant l’action.

- RIGHT_BUTTON le bouton droit de la souris a été enfoncé pendant l’action.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

*x*<br/>
Coordonnée x du curseur. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y du curseur. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement MouseMove se produise, la table des événements du contrôle doit avoir un événement MouseMove MouseMove défini.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl :: FireMouseUp

Appelé par le Framework quand un bouton de la souris est relâché sur un contrôle personnalisé actif.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Paramètres

*Nbouton*<br/>
Valeur numérique du bouton de la souris relâché. Elle peut avoir l’une des valeurs suivantes :

- LEFT_BUTTON le bouton gauche de la souris a été relâché.

- MIDDLE_BUTTON le bouton central de la souris a été relâché.

- RIGHT_BUTTON le bouton droit de la souris a été relâché.

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

*x*<br/>
Coordonnée x du curseur lorsqu’un bouton de la souris a été relâché. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

*y*<br/>
Coordonnée y d’un curseur lorsqu’un bouton de la souris a été relâché. La coordonnée est relative au coin supérieur gauche de la fenêtre de contrôle.

### <a name="remarks"></a>Remarques

Si cet événement est défini comme un événement personnalisé, vous déterminez le moment où l’événement est déclenché.

Pour que le déclenchement automatique d’un événement MouseUp se produise, la table des événements du contrôle doit avoir un événement MouseUp de stock défini.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COleControl :: FireReadyStateChange

Déclenche un événement avec la valeur actuelle de l’état prêt du contrôle.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Remarques

L’état prêt peut prendre l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été initialisé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactives, mais toutes les données asynchrones ne sont pas encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

Utilisez [GetReadyState](#getreadystate) pour déterminer la disponibilité actuelle du contrôle.

[InternalSetReadyState](#internalsetreadystate) passe l’état prêt à la valeur fournie, puis appelle `FireReadyStateChange` .

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl :: GetActivationPolicy

Modifie le comportement d’activation par défaut d’un contrôle qui prend en charge l' `IPointerInactive` interface.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valeur renvoyée

Combinaison d’indicateurs de l’énumération POINTERINACTIVE. Les indicateurs possibles sont les suivants :

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|L’objet doit être activé sur place lorsque la souris l’entre au cours d’une opération de déplacement de la souris.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|L’objet doit être désactivé lorsque la souris quitte l’objet pendant une opération de déplacement de la souris.|
|POINTERINACTIVE_ACTIVATEONDRAG|L’objet doit être activé sur place lorsque la souris est glissée au-dessus de lui au cours d’une opération de glisser-déplacer.|

### <a name="remarks"></a>Remarques

Lorsque l' `IPointerInactive` interface est activée, le conteneur délègue WM_SETCURSOR et WM_MOUSEMOVE messages à celle-ci. `COleControl`l’implémentation de cette interface distribuera ces messages via la table des messages de votre contrôle, après avoir ajusté les coordonnées de la souris de manière appropriée.

Chaque fois que le conteneur reçoit un message WM_SETCURSOR ou WM_MOUSEMOVE avec le pointeur de la souris sur un objet inactif qui prend en charge `IPointerInactive` , il doit appeler `GetActivationPolicy` sur l’interface et retourner des indicateurs à partir de l’énumération POINTERINACTIVE.

Vous pouvez traiter ces messages comme des messages de fenêtre ordinaires, en ajoutant les entrées correspondantes à la table des messages. Dans vos gestionnaires, évitez d’utiliser la `m_hWnd` variable membre (ou les fonctions membres qui l’utilisent) sans vérifier d’abord que sa valeur n’est pas null.

Tout objet destiné à faire plus que définir le curseur de la souris et/ou déclencher un événement de déplacement de la souris, par exemple donner une rétroaction visuelle spéciale, doit retourner l’indicateur POINTERINACTIVE_ACTIVATEONENTRY et dessiner les commentaires uniquement lorsqu’ils sont actifs. Si l’objet retourne cet indicateur, le conteneur doit l’activer sur place immédiatement, puis lui transférer le même message qui a déclenché l’appel à `GetActivationPolicy` .

Si les indicateurs POINTERINACTIVE_ACTIVATEONENTRY et POINTERINACTIVE_DEACTIVATEONLEAVE sont retournés, l’objet est activé uniquement lorsque la souris se trouve sur l’objet. Si seul l’indicateur POINTERINACTIVE_ACTIVATEONENTRY est retourné, l’objet n’est activé qu’une seule fois lorsque la souris entre pour la première fois dans l’objet.

Vous pouvez également souhaiter qu’un contrôle inactif soit la cible d’une opération glisser-déplacer OLE. Cela nécessite l’activation du contrôle au moment où l’utilisateur fait glisser un objet sur lui, afin que la fenêtre du contrôle puisse être enregistrée en tant que cible de déplacement. Pour faire en sorte que l’activation se produise pendant un glisser-déplacer, retournez l’indicateur POINTERINACTIVE_ACTIVATEONDRAG :

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Les informations communiquées par ne `GetActivationPolicy` doivent pas être mises en cache par un conteneur. Au lieu de cela, cette méthode doit être appelée chaque fois que la souris entre dans un objet inactif.

Si un objet inactif ne demande pas à être activé sur place lorsque la souris l’entre, son conteneur doit distribuer les messages WM_SETCURSOR suivants à cet objet en appelant [OnInactiveSetCursor](#oninactivesetcursor) tant que le pointeur de la souris reste sur l’objet.

L’activation de l' `IPointerInactive` interface signifie généralement que vous souhaitez que le contrôle soit capable de traiter des messages de souris à tout moment. Pour obtenir ce comportement dans un conteneur qui ne prend pas en charge l' `IPointerInactive` interface, vous devez que votre contrôle soit toujours activé quand il est visible, ce qui signifie que le contrôle doit avoir l’indicateur OLEMISC_ACTIVATEWHENVISIBLE parmi ses différents indicateurs. Toutefois, pour éviter que cet indicateur prenne effet dans un conteneur qui prend en charge `IPointerInactive` , vous pouvez également spécifier l’indicateur OLEMISC_IGNOREACTIVATEWHENVISIBLE :

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl :: GetAmbientProperty

Obtient la valeur d’une propriété ambiante du conteneur.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Paramètres

*dwDispid*<br/>
ID de dispatch de la propriété ambiante souhaitée.

*vtProp*<br/>
Une balise de type Variant qui spécifie le type de la valeur à retourner dans *pvProp*.

*pvProp*<br/>
Pointeur vers l’adresse de la variable qui recevra la valeur de propriété ou la valeur de retour. Le type réel de ce pointeur doit correspondre au type spécifié par *vtProp*.

|vtProp|Type de pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la propriété ambiante est prise en charge ; Sinon, 0.

### <a name="remarks"></a>Remarques

Si vous utilisez `GetAmbientProperty` pour récupérer les propriétés DisplayName et unités ambiantes, affectez à *vtProp* la valeur VT_BSTR et à *pvProp* `CString*` . Si vous récupérez la propriété de police ambiante, affectez à *vtProp* la valeur VT_FONT et *pvProp* à LPFONTDISP *.

Notez que des fonctions ont déjà été fournies pour les propriétés ambiantes courantes, telles que [AmbientBackColor](#ambientbackcolor) et [AmbientFont](#ambientfont).

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl :: GetAppearance

Implémente la fonction d’extraction de la propriété d’apparence de stock de votre contrôle.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valeur renvoyée

La valeur de retour spécifie le paramètre d’apparence actuel en tant que **`short`** valeur (VT_I2), en cas de réussite. Cette valeur est égale à zéro si l’apparence du contrôle est plate et 1 si l’apparence du contrôle est 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl :: GetBackColor

Implémente la fonction d’extraction de la propriété stock BackColor de votre contrôle.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valeur renvoyée

La valeur de retour spécifie la couleur d’arrière-plan actuelle en tant que OLE_COLOR valeur, en cas de réussite. Cette valeur peut être convertie en valeur COLORREF avec un appel à `TranslateColor` .

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COleControl :: GetBorderStyle

Implémente la fonction d’extraction de la propriété BorderStyle stock de votre contrôle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valeur renvoyée

1 si le contrôle a une bordure normale ; 0 si le contrôle n’a pas de bordure.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COleControl :: GetCapture

Détermine si l' `COleControl` objet a la capture de la souris.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valeur renvoyée

Si le contrôle est activé et sans fenêtre, retourne **`this`** si le contrôle a actuellement la capture de la souris (comme déterminé par le conteneur du contrôle), ou null s’il n’a pas la capture.

Sinon, retourne l' `CWnd` objet qui a la capture de la souris (identique à `CWnd::GetCapture` ).

### <a name="remarks"></a>Remarques

Un contrôle sans fenêtre activé reçoit la capture de la souris quand [SetCapture](#setcapture) est appelé.

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COleControl :: GetClassID

Appelé par l’infrastructure pour récupérer l’ID de classe OLE du contrôle.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Paramètres

*pclsid*<br/>
Pointeur vers l’emplacement de l’ID de classe.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel a échoué ; Sinon, 0.

### <a name="remarks"></a>Remarques

Généralement implémenté par l' [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COleControl :: GetClientOffset

Récupère la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Paramètres

*pdxOffset*<br/>
Pointeur vers le décalage horizontal de la zone cliente du contrôle OLE.

*pdyOffset*<br/>
Pointeur vers le décalage vertical de la zone cliente du contrôle OLE.

### <a name="remarks"></a>Remarques

Le contrôle OLE a une zone rectangulaire dans son conteneur. La zone cliente du contrôle est la zone de contrôle qui exclut les bordures et les barres de défilement. Le décalage récupéré par `GetClientOffset` est la différence entre le coin supérieur gauche de la zone rectangulaire du contrôle et le coin supérieur gauche de sa zone cliente. Si votre contrôle a des éléments non-clients autres que les bordures et les barres de défilement standard, substituez cette fonction membre pour spécifier le décalage.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl :: GetClientRect

Récupère la taille de la zone cliente du contrôle.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers une `RECT` structure contenant les dimensions de la zone cliente du contrôle sans fenêtre ; autrement dit, la taille du contrôle moins les bordures de la fenêtre, les cadres, les barres de défilement, etc. Le paramètre *lpRect* indique la taille du rectangle client du contrôle, et non sa position.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl :: GetClientSite

Interroge un objet pour le pointeur vers son site client actuel dans son conteneur.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers le site client actuel du contrôle dans son conteneur.

### <a name="remarks"></a>Remarques

Le pointeur retourné pointe vers une instance de `IOleClientSite` . L' `IOleClientSite` interface, implémentée par les conteneurs, est la vue de l’objet de son contexte : où elle est ancrée dans le document, où elle obtient son stockage, son interface utilisateur et d’autres ressources.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COleControl :: GetControlFlags

Récupère les paramètres d’indicateur de contrôle.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valeur renvoyée

Combinaison associée des indicateurs dans l’énumération ControlFlags :

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Remarques

`GetControlFlags` retourne `fastBeginPaint | clipPaintDC` par défaut.

|||
|-|-|
|`fastBeginPaint`|Si cette option est définie, elle utilise une fonction de début de dessin personnalisée pour les contrôles OLE au lieu de l’API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (définie par défaut).|
|`clipPaintDC`|Si la valeur n’est pas définie, désactive l’appel à `IntersectClipRect` par `COleControl` et gagne un avantage de petite vitesse. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.|
|`pointerInactive`|Si cette option est définie, elle fournit une interaction avec la souris pendant que votre contrôle est inactif en activant l' `COleControl` implémentation de l' `IPointerInactive` interface, qui est désactivée par défaut.|
|`noFlickerActivate`|Si cette valeur est définie, élimine les opérations de dessin supplémentaires et le scintillement visuel qui l’accompagne. Utilisez lorsque votre contrôle se dessine de la même façon dans les États inactif et actif. Si vous utilisez l’activation sans fenêtre, l’indicateur n’a aucun effet.|
|`windowlessActivate`|Si cette valeur est définie, votre contrôle utilise l’activation sans fenêtre.|
|`canOptimizeDraw`|S’il est défini, indique que le contrôle effectuera un dessin optimisé, si le conteneur le prend en charge.|

Pour plus d’informations sur `GetControlFlags` et d’autres optimisations des contrôles OLE, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COleControl :: GetControlSize

Récupère la taille de la fenêtre de contrôle OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Paramètres

*PCX*<br/>
Spécifie la largeur du contrôle en pixels.

*pcy*<br/>
Spécifie la hauteur du contrôle en pixels.

### <a name="remarks"></a>Remarques

Notez que toutes les coordonnées des fenêtres de contrôle sont relatives au coin supérieur gauche du contrôle.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COleControl :: GetDC

Fournit un objet sans fenêtre pour obtenir un contexte de périphérique d’écran (ou compatible) à partir de son conteneur.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Paramètres

*lprcRect*<br/>
Pointeur vers le rectangle que le contrôle sans fenêtre souhaite redessiner, dans les coordonnées clientes du contrôle. NULL correspond à l’étendue de l’objet complet.

*dwFlags*<br/>
Attributs de dessin du contexte de périphérique. Les choix sont les suivants :

- OLEDC_NODRAW indique que l’objet n’utilise pas le contexte de périphérique pour effectuer un dessin, mais simplement pour obtenir des informations sur le périphérique d’affichage. Le conteneur doit simplement passer le DC de la fenêtre sans traitement supplémentaire.

- OLEDC_PAINTBKGND demande que le conteneur dessine l’arrière-plan avant de retourner le DC. Un objet doit utiliser cet indicateur s’il demande un contrôleur de domaine pour redessiner une zone avec un arrière-plan transparent.

- OLEDC_OFFSCREEN informe le conteneur que l’objet souhaite restituer dans une image bitmap hors écran qui doit ensuite être copiée à l’écran. Un objet doit utiliser cet indicateur lorsque l’opération de dessin sur le sujet de son exécution génère un grand nombre de scintillement. Le conteneur est libre de respecter cette requête ou non. Toutefois, si cet indicateur n’est pas défini, le conteneur doit remettre à la main un contrôleur de périphérique à l’écran. Cela permet aux objets d’effectuer des opérations d’écran directes, telles que l’affichage d’une sélection (par le biais d’une opération **Xor** ).

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers le contexte de périphérique d’affichage pour la zone de client conteneur en `CWnd` cas de réussite ; sinon, la valeur de retour est null. Le contexte de périphérique d’affichage peut être utilisé dans les fonctions GDI suivantes pour dessiner dans la zone cliente de la fenêtre du conteneur.

### <a name="remarks"></a>Remarques

La fonction membre [ReleaseDC](#releasedc) doit être appelée pour libérer le contexte après la peinture. Lors de `GetDC` l’appel de, les objets passent le rectangle qu’ils souhaitent dessiner dans leurs propres coordonnées clientes. `GetDC`convertit ces derniers en coordonnées de la zone cliente du conteneur. L’objet ne doit pas demander un rectangle de dessin souhaité supérieur à son propre rectangle de zone client, dont la taille peut être récupérée avec [GetClientRect](#getclientrect). Cela évite que les objets dessinent par inadvertance là où ils ne sont pas supposés.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COleControl :: GetEnabled

Implémente la fonction d’extraction de la propriété stock activée de votre contrôle.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est activé ; Sinon, 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COleControl :: GetExtendedControl

Obtient un pointeur vers un objet géré par le conteneur qui représente le contrôle avec un jeu de propriétés étendu.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’objet de contrôle étendu du conteneur. Si aucun objet n’est disponible, la valeur est NULL.

Cet objet peut être manipulé par le biais de son `IDispatch` interface. Vous pouvez également utiliser `QueryInterface` pour obtenir d’autres interfaces disponibles fournies par l’objet. Toutefois, l’objet n’est pas requis pour prendre en charge un ensemble spécifique d’interfaces. Notez que le fait de s’appuyer sur les fonctionnalités spécifiques de l’objet de contrôle étendu d’un conteneur limite la portabilité de votre contrôle à d’autres conteneurs arbitraires.

### <a name="remarks"></a>Remarques

La fonction qui appelle cette fonction est chargée de libérer le pointeur lorsque l’objet est terminé. Notez que le conteneur n’est pas requis pour prendre en charge cet objet.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl :: GetFocus

Détermine si l' `COleControl` objet a le focus.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valeur renvoyée

Si le contrôle est activé et sans fenêtre, retourne **`this`** si le contrôle a actuellement le focus clavier (tel que déterminé par le conteneur du contrôle), ou null s’il n’a pas le focus.

Sinon, retourne l' `CWnd` objet qui a le focus (identique à `CWnd::GetFocus` ).

### <a name="remarks"></a>Remarques

Un contrôle sans fenêtre activé reçoit le focus lorsque [SetFocus](#setfocus) est appelé.

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl :: GetFont

Implémente la fonction d’extraction de la propriété stock font.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’interface de dispatch de police de la propriété stock font du contrôle.

### <a name="remarks"></a>Remarques

Notez que l’appelant doit libérer l’objet une fois l’opération terminée. Dans l’implémentation du contrôle, utilisez `InternalGetFont` pour accéder à l’objet de police stock du contrôle. Pour plus d’informations sur l’utilisation des polices dans votre contrôle, consultez l’article [contrôles ActiveX : utilisation de polices dans un contrôle ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl :: GetFontTextMetrics

Mesure les métriques de texte pour tout `CFontHolder` objet détenu par le contrôle.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*lptm*<br/>
Pointeur vers une structure [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

*fontHolder*<br/>
Référence à un objet [CFontHolder](../../mfc/reference/cfontholder-class.md) .

### <a name="remarks"></a>Remarques

Une telle police peut être sélectionnée avec la fonction [COleControl :: SelectFontObject](#selectfontobject) . `GetFontTextMetrics`Initialise la structure vers `TEXTMETRIC` laquelle pointe *lptm* avec des informations de métriques valides sur la `fontHolder` police de en cas de réussite, ou remplit la structure avec des zéros si elle échoue. Vous devez utiliser cette fonction à la place de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) quand vous peignez votre contrôle, car des contrôles, comme tout objet OLE incorporé, peuvent être nécessaires pour s’afficher dans un métafichier.

La `TEXTMETRIC` structure de la police par défaut est actualisée lorsque la fonction [SelectFontObject](#selectfontobject) est appelée. Vous devez appeler `GetFontTextMetrics` uniquement après avoir sélectionné la propriété stock font pour vous assurer que les informations qu’elle fournit sont valides.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl :: GetForeColor

Implémente la fonction d’extraction de la propriété stock ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valeur renvoyée

La valeur de retour spécifie la couleur de premier plan actuelle comme valeur de OLE_COLOR, en cas de réussite. Cette valeur peut être convertie en valeur [COLORREF](/windows/win32/gdi/colorref) avec un appel à `TranslateColor` .

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl :: GetHwnd

Implémente la fonction d’extraction de la propriété stock hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valeur renvoyée

Handle de fenêtre du contrôle OLE, le cas échéant ; Sinon, NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COleControl :: GetMessageString

Appelée par l’infrastructure pour obtenir une chaîne abrégée qui décrit l’objectif de l’élément de menu identifié par *nid*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
ID d’élément de menu.

*rMessage*<br/>
Référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) par le biais duquel une chaîne est retournée.

### <a name="remarks"></a>Remarques

Cela peut être utilisé pour obtenir un message à afficher dans une barre d’État lorsque l’élément de menu est mis en surbrillance. L’implémentation par défaut tente de charger une ressource de type chaîne identifiée par *nid*.

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COleControl :: GetNotSupported

Empêche l’utilisateur d’accéder à la valeur de propriété d’un contrôle.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Remarques

Appelez cette fonction à la place de la fonction d’extraction de toute propriété dans laquelle la récupération de la propriété par l’utilisateur du contrôle n’est pas prise en charge. Un exemple serait une propriété qui est en écriture seule.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl :: GetReadyState

Retourne l’état de préparation du contrôle.

```
long GetReadyState();
```

### <a name="return-value"></a>Valeur renvoyée

État de préparation du contrôle, l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été initialisé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactives, mais toutes les données asynchrones ne sont pas encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

### <a name="remarks"></a>Remarques

La plupart des contrôles simples n’ont jamais besoin de faire la distinction entre le chargement et l’interactivité. Toutefois, les contrôles qui prennent en charge les propriétés de chemin de données peuvent ne pas être prêts à être interactifs jusqu’à ce que certaines données soient reçues de manière asynchrone. Un contrôle doit essayer de devenir interactif dès que possible.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COleControl :: GetRectInContainer

Obtient les coordonnées du rectangle du contrôle par rapport au conteneur, exprimé en unités de périphérique.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers la structure Rectangle dans laquelle les coordonnées du contrôle seront copiées.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est actif sur place ; Sinon, 0.

### <a name="remarks"></a>Remarques

Le rectangle est valide uniquement si le contrôle est actif sur place.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl :: GetStockTextMetrics

Mesure les mesures de texte pour la propriété stock font du contrôle, qui peut être sélectionnée avec la fonction [SelectStockFont](#selectstockfont) .

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Paramètres

*lptm*<br/>
Pointeur vers une structure [TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw) .

### <a name="remarks"></a>Remarques

La `GetStockTextMetrics` fonction initialise la `TEXTMETRIC` structure désignée par *lptm* avec des informations de métriques valides en cas de réussite, ou remplit la structure avec des zéros si elle échoue. Utilisez cette fonction à la place de [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) quand vous peignez votre contrôle, car des contrôles, comme tout objet OLE incorporé, peuvent être nécessaires pour s’afficher dans un métafichier.

La `TEXTMETRIC` structure de la police par défaut est actualisée lorsque la `SelectStockFont` fonction est appelée. Vous devez appeler cette fonction uniquement après avoir sélectionné la police stock pour vous assurer que les informations qu’elle fournit sont valides.

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl :: GetText

Implémente la fonction d’extraction de la propriété de texte stock ou de légende.

```
BSTR GetText();
```

### <a name="return-value"></a>Valeur renvoyée

La valeur actuelle de la chaîne de texte du contrôle ou une chaîne de longueur nulle si aucune chaîne n’est présente.

> [!NOTE]
> Pour plus d’informations sur le type de données BSTR, consultez [types de données](../../mfc/reference/data-types-mfc.md) dans la section macros et globales.

### <a name="remarks"></a>Remarques

Notez que l’appelant de cette fonction doit appeler `SysFreeString` sur la chaîne retournée pour libérer la ressource. Dans l’implémentation du contrôle, utilisez `InternalGetText` pour accéder à la propriété de texte stock ou de légende du contrôle.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COleControl :: GetWindowlessDropTarget

Substituez `GetWindowlessDropTarget` lorsque vous souhaitez qu’un contrôle sans fenêtre soit la cible d’une opération glisser-déplacer OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’interface de l’objet `IDropTarget` . Dans la mesure où il n’a pas de fenêtre, un objet sans fenêtre ne peut pas inscrire une `IDropTarget` interface. Toutefois, pour participer au glisser-déplacer, un objet sans fenêtre peut toujours implémenter l’interface et le retourner dans `GetWindowlessDropTarget` .

### <a name="remarks"></a>Remarques

Normalement, cela suppose que la fenêtre de contrôle soit stockée en tant que cible de déplacement. Toutefois, étant donné que le contrôle n’a pas de fenêtre propre, le conteneur utilise sa propre fenêtre comme cible de déplacement. Le contrôle doit simplement fournir une implémentation de l' `IDropTarget` interface à laquelle le conteneur peut déléguer des appels au moment opportun. Par exemple :

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COleControl :: InitializeIIDs

Informe la classe de base des IID que le contrôle utilisera.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Paramètres

*piidPrimary*<br/>
Pointeur vers l’ID d’interface de l’interface de dispatch principale du contrôle.

*piidEvents*<br/>
Pointeur vers l’ID d’interface de l’interface d’événement du contrôle.

### <a name="remarks"></a>Remarques

Appelez cette fonction dans le constructeur du contrôle pour informer la classe de base des ID d’interface que votre contrôle utilisera.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl :: InternalGetFont

Accède à la propriété stock font de votre contrôle

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valeur renvoyée

Référence à un objet [CFontHolder](../../mfc/reference/cfontholder-class.md) qui contient l’objet de police de stock.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl :: InternalGetText

Accède à la propriété de texte stock ou de légende de votre contrôle.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valeur renvoyée

Référence à la chaîne de texte du contrôle.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl :: InternalSetReadyState

Définit l’état de préparation du contrôle.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Paramètres

*lNewReadyState*<br/>
État de préparation à définir pour le contrôle, l’une des valeurs suivantes :

|||
|-|-|
|READYSTATE_UNINITIALIZED|État d’initialisation par défaut|
|READYSTATE_LOADING|Le contrôle charge actuellement ses propriétés|
|READYSTATE_LOADED|Le contrôle a été initialisé|
|READYSTATE_INTERACTIVE|Le contrôle a suffisamment de données pour être interactives, mais toutes les données asynchrones ne sont pas encore chargées|
|READYSTATE_COMPLETE|Le contrôle a toutes ses données|

### <a name="remarks"></a>Remarques

La plupart des contrôles simples n’ont jamais besoin de faire la distinction entre le chargement et l’interactivité. Toutefois, les contrôles qui prennent en charge les propriétés de chemin de données peuvent ne pas être prêts à être interactifs jusqu’à ce que certaines données soient reçues de manière asynchrone. Un contrôle doit essayer de devenir interactif dès que possible.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COleControl :: InvalidateControl

Force le contrôle à se redessiner lui-même.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers la région du contrôle à invalider.

*bErase*<br/>
Spécifie si l’arrière-plan dans la région de mise à jour doit être effacé lors du traitement de la région de mise à jour.

### <a name="remarks"></a>Remarques

Si *lpRect* a une valeur null, le contrôle entier est redessiné. Si *lpRect* n’a pas la valeur null, cela indique la partie du rectangle du contrôle qui doit être invalidée. Dans les cas où le contrôle n’a pas de fenêtre ou n’est pas actif, le rectangle est ignoré et un appel est effectué vers la fonction membre [IAdviseSink :: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) du site client. Utilisez cette fonction à la place de `CWnd::InvalidateRect` ou `InvalidateRect` .

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl :: InvalidateRgn

Invalide la zone cliente de la fenêtre de conteneur dans la région donnée.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Paramètres

*pRgn*<br/>
Pointeur vers un objet [CRgn](../../mfc/reference/crgn-class.md) qui identifie la zone d’affichage de l’objet OLE à invalider, dans les coordonnées clientes de la fenêtre conteneur. Si ce paramètre a la valeur NULL, l’étendue est l’objet entier.

*bErase*<br/>
Spécifie si l’arrière-plan dans la région invalidée doit être effacé. Si la valeur est TRUE, l’arrière-plan est effacé. Si la valeur est FALSe, l’arrière-plan reste inchangé.

### <a name="remarks"></a>Remarques

Cela peut être utilisé pour redessiner des contrôles sans fenêtre dans le conteneur. La région invalidée, ainsi que toutes les autres zones de la région de mise à jour, sont marquées pour être peintes lors de l’envoi du message de [WM_PAINT](/windows/win32/gdi/wm-paint) suivant.

Si *bErase* a la valeur true pour n’importe quelle partie de la région de mise à jour, l’arrière-plan de la région entière, pas seulement dans la partie donnée, est effacé.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl :: IsConvertingVBX

Permet le chargement spécialisé d’un contrôle OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est en cours de conversion ; Sinon, 0.

### <a name="remarks"></a>Remarques

Lors de la conversion d’un formulaire qui utilise des contrôles VBX en un formulaire qui utilise des contrôles OLE, du code de chargement spécial pour les contrôles OLE peut être requis. Par exemple, si vous chargez une instance de votre contrôle OLE, vous pouvez avoir un appel à [PX_Font](persistence-of-ole-controls.md#px_font) dans votre `DoPropExchange` :

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Toutefois, les contrôles VBX n’avaient pas d’objet font ; chaque propriété de police a été enregistrée individuellement. Dans ce cas, vous devez utiliser `IsConvertingVBX` pour faire la distinction entre ces deux cas :

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Un autre cas serait si votre contrôle VBX enregistrait des données binaires propriétaires (dans son gestionnaire de messages VBM_SAVEPROPERTY) et que votre contrôle OLE enregistre ses données binaires dans un format différent. Si vous souhaitez que votre contrôle OLE soit à compatibilité descendante avec le contrôle VBX, vous pouvez lire les formats anciens et nouveaux à l’aide de la `IsConvertingVBX` fonction en distinguant si le contrôle VBX ou le contrôle OLE était chargé.

Dans la fonction de votre contrôle `DoPropExchange` , vous pouvez vérifier cette condition et, si la valeur est true, exécuter le code de chargement spécifique à cette conversion (comme les exemples précédents). Si le contrôle n’est pas converti, vous pouvez exécuter le code de chargement normal. Cette capacité n’est applicable que pour les contrôles convertis à partir des homologues VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COleControl :: IsInvokeAllowed

Active l’appel de la méthode Automation.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle a été initialisé ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation de l’infrastructure des `IDispatch::Invoke` appels `IsInvokeAllowed` pour déterminer si une fonction donnée (identifiée par `dispid` ) peut être appelée. Le comportement par défaut d’un contrôle OLE est de permettre aux méthodes Automation d’être appelées uniquement si le contrôle a été initialisé ; Toutefois, `IsInvokeAllowed` est une fonction virtuelle qui peut être substituée si nécessaire (par exemple, lorsque le contrôle est utilisé en tant que serveur Automation).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COleControl :: IsModified

Détermine si l’état du contrôle a été modifié.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’état du contrôle a été modifié depuis son dernier enregistrement ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’état d’un contrôle est modifié lorsqu’une propriété change de valeur.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl :: IsOptimizedDraw

Détermine si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le conteneur prend en charge le dessin optimisé pour l’opération de dessin en cours ; Sinon, FALSe.

### <a name="remarks"></a>Remarques

Si le dessin optimisé est pris en charge, le contrôle n’a pas besoin de sélectionner des objets anciens (stylets, pinceaux, polices, etc.) dans le contexte de périphérique une fois le dessin terminé.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COleControl :: IsSubclassedControl

Appelé par l’infrastructure pour déterminer si le contrôle sous-classe un contrôle Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le contrôle est sous-classé ; Sinon, 0.

### <a name="remarks"></a>Remarques

Vous devez substituer cette fonction et retourner la valeur TRUE si votre contrôle OLE sous-classe un contrôle Windows.

## <a name="colecontrolload"></a><a name="load"></a>COleControl :: Load

Réinitialise toutes les données précédentes chargées de façon asynchrone et lance un nouveau chargement de la propriété asynchrone du contrôle.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Paramètres

*strNewPath*<br/>
Pointeur vers une chaîne contenant le chemin d’accès qui référence l’emplacement absolu de la propriété de contrôle asynchrone.

*béquill*<br/>
Objet [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) qui implémente une propriété de contrôle asynchrone.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COleControl :: LockInPlaceActive

Empêche le conteneur de désactiver votre contrôle.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Paramètres

*Plage*<br/>
TRUE si l’état actif sur place du contrôle doit être verrouillé ; FALSe si elle doit être déverrouillée.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le verrou a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

Notez que chaque verrouillage du contrôle doit être associé à un déverrouillage du contrôle lorsqu’il est terminé. Vous devez verrouiller votre contrôle uniquement pendant de courtes périodes, par exemple lors du déclenchement d’un événement.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl :: OnAmbientPropertyChange

Appelé par le Framework quand une propriété ambiante du conteneur a changé de valeur.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Paramètres

*Égal*<br/>
ID de dispatch de la propriété ambiante qui a changé, ou DISPID_UNKNOWN si plusieurs propriétés ont été modifiées.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COleControl :: OnAppearanceChanged

Appelé par le Framework lorsque la valeur de la propriété d’apparence de stock a changé.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Remarques

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété. L’implémentation par défaut appelle `InvalidateControl` .

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COleControl :: OnBackColorChanged

Appelé par le Framework lorsque la valeur de la propriété de la couleur de l’action en cours a changé.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Remarques

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété. L’implémentation par défaut appelle `InvalidateControl` .

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COleControl :: OnBorderStyleChanged

Appelée par l’infrastructure lorsque la valeur de la propriété de la propriété BorderStyle stock a changé.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle `InvalidateControl` .

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété.

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl :: OnClick

Appelé par le Framework lorsque l’utilisateur a cliqué sur un bouton de la souris ou lorsque la méthode stocke de clics a été appelée.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Paramètres

*iButton*<br/>
Index du bouton de la souris. Peut avoir l'une des valeurs suivantes :

- LEFT_BUTTON l’utilisateur a cliqué sur le bouton gauche de la souris.

- MIDDLE_BUTTON l’utilisateur a cliqué sur le bouton central de la souris.

- RIGHT_BUTTON l’utilisateur a cliqué sur le bouton droit de la souris.

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle `COleControl::FireClick` .

Substituez cette fonction membre pour modifier ou étendre la gestion par défaut.

## <a name="colecontrolonclose"></a><a name="onclose"></a>COleControl :: OnClose

Appelée par l’infrastructure quand le conteneur a appelé la fonction du contrôle `IOleControl::Close` .

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Paramètres

*dwSaveOption*<br/>
Indicateur qui spécifie si l’objet doit être enregistré avant le chargement. Les valeurs autorisées sont :

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Remarques

Par défaut, `OnClose` enregistre l’objet de contrôle s’il a été modifié et *dwSaveOption* a la valeur OLECLOSE_SAVEIFDIRTY ou OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl :: OnDoVerb

Appelée par l’infrastructure quand le conteneur appelle la `IOleObject::DoVerb` fonction membre.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*iVerb*<br/>
Index du verbe de contrôle à appeler.

*lpMsg*<br/>
Pointeur vers le message Windows qui a provoqué l’appel du verbe.

*hWndParent*<br/>
Handle de la fenêtre parente du contrôle. Si l’exécution du verbe crée une fenêtre (ou des fenêtres), *hwndParent* doit être utilisé comme parent.

*lpRect*<br/>
Pointeur vers une structure RECT dans laquelle les coordonnées du contrôle, relatives au conteneur, sont copiées.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation par défaut utilise les entrées de la table des messages ON_OLEVERB et ON_STDOLEVERB pour déterminer la fonction appropriée à appeler.

Substituez cette fonction pour modifier la gestion par défaut du verbe.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl :: OnDraw

Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié à l’aide du contexte de périphérique spécifié.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Contexte de périphérique dans lequel le dessin se produit.

*rcBounds*<br/>
Zone rectangulaire du contrôle, y compris la bordure.

*rcInvalid*<br/>
Zone rectangulaire du contrôle qui n’est pas valide.

### <a name="remarks"></a>Remarques

`OnDraw`est généralement appelé pour l’affichage à l’écran, passant un contexte de périphérique d’écran en tant que *contrôleur de domaine principal*. Le paramètre *rcBounds* identifie le rectangle dans le contexte de périphérique cible (par rapport à son mode de mappage actuel). Le paramètre *rcInvalid* est le rectangle réel qui n’est pas valide. Dans certains cas, il s’agit d’une zone plus petite que *rcBounds*.

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl :: OnDrawMetafile

Appelé par l’infrastructure pour dessiner le contrôle OLE dans le rectangle englobant spécifié à l’aide du contexte de périphérique de métafichier spécifié.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Contexte de périphérique dans lequel le dessin se produit.

*rcBounds*<br/>
Zone rectangulaire du contrôle, y compris la bordure.

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle la fonction [OnDraw](#ondraw) .

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl :: OnEdit

Provoque l’activation de l’interface utilisateur par le contrôle.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Pointeur vers le message Windows qui A appelé le verbe.

*hWndParent*<br/>
Handle de la fenêtre parente du contrôle.

*lpRect*<br/>
Pointeur vers le rectangle utilisé par le contrôle dans le conteneur.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel réussit ; Sinon, 0.

### <a name="remarks"></a>Remarques

Cela a le même effet que l’appel du verbe OLEIVERB_UIACTIVATE du contrôle.

Cette fonction est généralement utilisée comme fonction de gestionnaire pour une entrée de la table des messages ON_OLEVERB. Un verbe « Edit » est alors disponible dans le menu « Object » (objet) du contrôle. Par exemple :

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COleControl :: OnEnabledChanged

Appelée par l’infrastructure lorsque la valeur de la propriété stock Enabled a changé.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Remarques

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété. L’implémentation par défaut appelle [InvalidateControl](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl :: OnEnumVerbs

Appelée par l’infrastructure quand le conteneur appelle la `IOleObject::EnumVerbs` fonction membre.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Paramètres

*ppenumOleVerb*<br/>
Pointeur vers l' `IEnumOLEVERB` objet qui énumère les verbes du contrôle.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si les verbes sont disponibles ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation par défaut énumère les entrées ON_OLEVERB dans la table des messages.

Substituez cette fonction pour modifier le mode d’énumération des verbes par défaut.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl :: OnEventAdvise

Appelée par l’infrastructure quand un gestionnaire d’événements est connecté ou déconnecté d’un contrôle OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Paramètres

*bAdvise*<br/>
TRUE indique qu’un gestionnaire d’événements a été connecté au contrôle. La valeur FALSe indique qu’un gestionnaire d’événements a été déconnecté du contrôle.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl :: OnFontChanged

Appelé par le Framework lorsque la valeur de propriété stock font change.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle `COleControl::InvalidateControl` . Si le contrôle sous-classe un contrôle Windows, l’implémentation par défaut envoie également un message WM_SETFONT à la fenêtre du contrôle.

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl :: OnForeColorChanged

Appelée par l’infrastructure lorsque la valeur de propriété de la propriété ForeColor de stock a changé.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle `InvalidateControl` .

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl :: OnFreezeEvents

Appelée par le Framework après que le conteneur a appelé `IOleControl::FreezeEvents` .

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Paramètres

*bFreeze*<br/>
TRUE si la gestion des événements du contrôle est figée ; Sinon, FALSe.

### <a name="remarks"></a>Remarques

L'implémentation par défaut n'exécute aucune opération.

Substituez cette fonction si vous souhaitez un comportement supplémentaire lorsque la gestion des événements est figée ou non figée.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl :: OnGetColorSet

Appelée par l’infrastructure quand le conteneur appelle la `IViewObject::GetColorSet` fonction membre.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Paramètres

*PTD*<br/>
Pointe vers l’appareil cible pour lequel l’image doit être affichée. Si cette valeur est NULL, l’image doit être rendue pour un appareil cible par défaut, généralement un périphérique d’affichage.

*hicTargetDev*<br/>
Spécifie le contexte d’information sur le périphérique cible indiqué par *PTD*. Ce paramètre peut être un contexte de périphérique, mais n’est pas nécessairement un. Si *PTD* a la valeur null, *hicTargetDev* doit également avoir la valeur null.

*ppColorSet*<br/>
Pointeur vers l’emplacement dans lequel le jeu de couleurs qui serait utilisé doit être copié. Si la fonction ne retourne pas le jeu de couleurs, la valeur NULL est retournée.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si un jeu de couleurs valide est retourné ; Sinon, 0.

### <a name="remarks"></a>Remarques

Le conteneur appelle cette fonction pour obtenir toutes les couleurs nécessaires au dessin du contrôle OLE. Le conteneur peut utiliser les jeux de couleurs obtenus avec les couleurs dont il a besoin pour définir la palette de couleurs globale. L’implémentation par défaut retourne FALSe.

Remplacez cette fonction pour effectuer tout traitement spécial de cette requête.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl :: OnGetControlInfo

Appelée par l’infrastructure quand le conteneur du contrôle a demandé des informations sur le contrôle.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Paramètres

*pControlInfo*<br/>
Pointeur vers une structure [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) à remplir.

### <a name="remarks"></a>Remarques

Ces informations se composent principalement d’une description des clés mnémoniques du contrôle. L’implémentation par défaut remplit *pControlInfo* avec les informations par défaut.

Substituez cette fonction si votre contrôle a besoin de traiter des touches mnémoniques.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COleControl :: OnGetDisplayString

Appelé par l’infrastructure pour obtenir une chaîne qui représente la valeur actuelle de la propriété identifiée par *DISPID*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de distribution d’une propriété du contrôle.

*strValue*<br/>
Référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) par le biais duquel une chaîne est retournée.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si une chaîne a été retournée dans *strValue ;* sinon, 0.

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle a une propriété dont la valeur ne peut pas être convertie directement en chaîne et que vous souhaitez que la valeur de la propriété s’affiche dans un Explorateur de propriétés fourni par le conteneur.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl :: OnGetInPlaceMenu

Appelé par le Framework lorsque le contrôle est activé par l’interface utilisateur pour obtenir le menu à fusionner dans le menu existant du conteneur.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valeur renvoyée

Handle du menu du contrôle, ou NULL si le contrôle n’en a aucun. L’implémentation par défaut retourne la valeur NULL.

### <a name="remarks"></a>Remarques

Pour plus d’informations sur la fusion des ressources OLE, consultez l’article [menus et ressources (OLE)](../../mfc/menus-and-resources-ole.md).

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl :: OnGetNaturalExtent

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IViewObjectEx::GetNaturalExtent` .

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Les représentations incluent du contenu, une icône, une miniature ou un document imprimé. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*lindex*<br/>
Partie de l’objet qui présente un intérêt. Actuellement, seul-1 est valide.

*PTD*<br/>
Pointe vers la structure [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) qui définit l’appareil cible pour lequel la taille de l’objet doit être retournée.

*hicTargetDev*<br/>
Spécifie le contexte d’informations pour le périphérique cible indiqué par le paramètre *PTD* à partir duquel l’objet peut extraire les métriques de l’appareil et tester les fonctionnalités de l’appareil. Si *PTD* a la valeur null, l’objet doit ignorer la valeur dans le paramètre *hicTargetDev* .

*pExtentInfo*<br/>
Pointe vers la `DVEXTENTINFO` structure qui spécifie les données de dimensionnement. La `DVEXTENTINFO` structure est la suivante :

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Le membre `dwExtentMode` de structure peut prendre l’une des deux valeurs suivantes :

- DVEXTENT_CONTENT déterminer la taille du contrôle pour qu’il corresponde exactement au contenu (alignement sur la taille)

- DVEXTENT_INTEGRAL lors du redimensionnement, passage de la taille proposée au contrôle

*psizel*<br/>
Pointe vers le dimensionnement des données retournées par le contrôle. Les données de dimensionnement retournées ont la valeur-1 pour toutes les dimensions qui n’ont pas été ajustées.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si elle retourne ou ajuste correctement la taille ; Sinon, 0.

### <a name="remarks"></a>Remarques

Substituez cette fonction pour retourner la taille d’affichage de l’objet la plus proche de la taille proposée et le mode d’étendue dans la `DVEXTENTINFO` structure. L’implémentation par défaut retourne la valeur FALSe et n’ajuste pas la taille.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COleControl :: OnGetPredefinedStrings

Appelée par l’infrastructure pour obtenir un jeu de chaînes prédéfinies représentant les valeurs possibles pour une propriété.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de distribution d’une propriété du contrôle.

*pStringArray*<br/>
Tableau de chaînes à remplir avec les valeurs de retour.

*pCookieArray*<br/>
Tableau de DWORD à remplir avec les valeurs de retour.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si des éléments ont été ajoutés à *pStringArray* et *pCookieArray*.

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle a une propriété avec un ensemble de valeurs possibles qui peuvent être représentées par des chaînes. Pour chaque élément ajouté à *pStringArray*, vous devez ajouter un élément « cookie » correspondant à *pCookieArray.* Ces valeurs de « cookie » peuvent être passées ultérieurement par l’infrastructure à la `COleControl::OnGetPredefinedValue` fonction.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COleControl :: OnGetPredefinedValue

Appelée par l’infrastructure pour obtenir la valeur correspondant à l’une des chaînes prédéfinies précédemment retournées par une substitution de `COleControl::OnGetPredefinedStrings` .

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de distribution d’une propriété du contrôle.

*dwCookie*<br/>
Valeur de cookie précédemment retournée par une substitution de `COleControl::OnGetPredefinedStrings` .

*lpvarOut*<br/>
Pointeur vers une `VARIANT` structure par le biais de laquelle une valeur de propriété sera retournée.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si une valeur a été retournée dans *lpvarOut*; Sinon, 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl :: OnGetViewExtent

Appelée par l’infrastructure en réponse à la demande [IViewObject2 :: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) d’un conteneur.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Paramètres

*dwDrawAspect*<br/>
DWORD décrivant le formulaire ou l’aspect d’un objet à afficher. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*lindex*<br/>
Partie de l’objet qui présente un intérêt. Actuellement, seul-1 est valide.

*PTD*<br/>
Pointe vers la structure [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) qui définit l’appareil cible pour lequel la taille de l’objet doit être retournée.

*lpsizel*<br/>
Pointe vers l’emplacement où la taille de l’objet est retournée.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si les informations d’étendue sont correctement retournées ; Sinon, 0.

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle utilise le dessin en deux passes, et ses parties opaques et transparentes ont des dimensions différentes.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl :: OnGetViewRect

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IViewObjectEx::GetRect` .

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
DWORD décrivant le formulaire ou l’aspect d’un objet à afficher. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2 :

- DVASPECT_CONTENT rectangle englobant de l’objet entier. L’angle supérieur gauche à l’origine de l’objet et la taille égale à l’étendue retournée par `GetViewExtent` *.*

- DVASPECT_OPAQUE objets avec une région opaque rectangulaire retournent ce rectangle. D’autres échouent.

- DVASPECT_TRANSPARENT rectangle qui couvre toutes les parties transparentes ou irrégulières.

*pRect*<br/>
Pointe vers la structure [Rect](/windows/win32/api/windef/ns-windef-rectl) qui spécifie le rectangle dans lequel l’objet doit être dessiné. Ce paramètre contrôle le positionnement et l’étirement de l’objet.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le rectangle dimensionné à l’objet est retourné avec succès ; Sinon, 0.

### <a name="remarks"></a>Remarques

La taille de l’objet est convertie par en `OnGetViewRect` un rectangle commençant à une position spécifique (la valeur par défaut est le coin supérieur gauche de l’affichage). Substituez cette fonction si votre contrôle utilise le dessin en deux passes, et ses parties opaques et transparentes ont des dimensions différentes.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl :: OnGetViewStatus

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IViewObjectEx::GetViewStatus` .

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valeur renvoyée

L’une des valeurs de l’énumération VIEWSTATUS en cas de réussite ; Sinon, 0. Les valeurs possibles sont n’importe quelle combinaison des éléments suivants :

|||
|-|-|
|VIEWSTATUS_OPAQUE|L’objet est complètement opaque. Si ce bit n’est pas défini, l’objet contient des parties transparentes. Ce bit s’applique uniquement aux aspects liés au contenu et non à DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|L’objet a un arrière-plan Uni (composé d’une couleur unie, et non d’un modèle de pinceau). Ce bit est significatif uniquement si VIEWSTATUS_OPAQUE est défini et s’applique uniquement aux aspects liés au contenu, et non à DVASPECT_ICON ou DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|L’objet prend en charge DVASPECT_OPAQUE. Toutes les méthodes IViewObjectEx qui prennent un aspect de dessin en tant que paramètre peuvent être appelées avec cet aspect.|
|VIEWSTATUS_DVASPECTTRANSPARENT|L’objet prend en charge DVASPECT_TRANSPARENT. Toutes les `IViewObjectEx` méthodes qui prennent un aspect de dessin en tant que paramètre peuvent être appelées avec cet aspect.|

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle utilise le dessin en deux passes. L’implémentation par défaut retourne VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COleControl :: OnHideToolBars

Appelé par le Framework lorsque le contrôle est désactivé par l’interface utilisateur.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Remarques

L’implémentation doit masquer toutes les barres d’outils affichées par `OnShowToolbars` .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COleControl :: OnInactiveMouseMove

Appelé par le conteneur pour l’objet inactif sous le pointeur de la souris sur la réception d’un message de WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Le rectangle englobant de l’objet, dans les coordonnées clientes de la fenêtre conteneur. Indique à l’objet sa position et sa taille exactes à l’écran lors de la réception du message de WM_MOUSEMOVE.

*x*<br/>
Coordonnée x de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*y*<br/>
Coordonnée y de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*dwKeyState*<br/>
Identifie l’état actuel des touches de modification du clavier sur le clavier. Les valeurs valides peuvent être une combinaison de l’un des indicateurs MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON et MK_RBUTTON.

### <a name="remarks"></a>Remarques

Notez que les coordonnées clientes de la fenêtre (pixels) sont utilisées pour passer la position du curseur de la souris. Cela est rendu possible grâce à la transmission du rectangle englobant de l’objet dans le même système de coordonnées.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COleControl :: OnInactiveSetCursor

Appelé par le conteneur pour l’objet inactif sous le pointeur de la souris sur la réception d’un message de WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Le rectangle englobant de l’objet, dans les coordonnées clientes de la fenêtre conteneur. Indique à l’objet sa position et sa taille exactes à l’écran lors de la réception du message de WM_SETCURSOR.

*x*<br/>
Coordonnée x de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*y*<br/>
Coordonnée y de l’emplacement de la souris dans les coordonnées clientes de la fenêtre conteneur.

*dwMouseMsg*<br/>
Identificateur du message de souris pour lequel un WM_SETCURSOR s’est produit.

*bSetAlways*<br/>
Spécifie si l’objet doit définir le curseur. Si la valeur est TRUE, l’objet doit définir le curseur ; Si la valeur est FALSe, le curseur n’est pas obligé de définir le curseur et doit retourner S_FALSE dans ce cas.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Notez que les coordonnées clientes de la fenêtre (pixels) sont utilisées pour passer la position du curseur de la souris. Cela est rendu possible grâce à la transmission du rectangle englobant de l’objet dans le même système de coordonnées.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl :: OnKeyDownEvent

Appelée par l’infrastructure après le traitement d’un événement KeyOut stock.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
Valeur de code de la touche virtuelle de la touche enfoncée. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle a besoin d’accéder aux informations de clé après le déclenchement de l’événement.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl :: OnKeyPressEvent

Appelé par le Framework après que l’événement de touche de stock a été déclenché.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
Contient la valeur de code de la touche virtuelle de la touche enfoncée. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

### <a name="remarks"></a>Remarques

Notez que la valeur *nchar* a peut-être été modifiée par le conteneur.

Substituez cette fonction si vous souhaitez une notification après cet événement.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl :: OnKeyUpEvent

Appelée par l’infrastructure après le traitement d’un événement KeyOut stock.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
Valeur de code de la touche virtuelle de la touche enfoncée. Pour obtenir la liste des codes de touches virtuelles standard, consultez Winuser. h

*nShiftState*<br/>
Contient une combinaison des indicateurs suivants :

- SHIFT_MASK la touche Maj a été enfoncée pendant l’action.

- CTRL_MASK la touche CTRL a été enfoncée pendant l’action.

- ALT_MASK la touche ALT a été enfoncée pendant l’action.

### <a name="remarks"></a>Remarques

Substituez cette fonction si votre contrôle a besoin d’accéder aux informations de clé après le déclenchement de l’événement.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl :: OnMapPropertyToPage

Appelé par l’infrastructure pour obtenir l’ID de classe d’une page de propriétés qui implémente la modification de la propriété spécifiée.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Paramètres

*égal*<br/>
ID de distribution d’une propriété du contrôle.

*lpclsid*<br/>
Pointeur vers une `CLSID` structure par le biais de laquelle un ID de classe sera retourné.

*pbPageOptional*<br/>
Retourne un indicateur spécifiant si l’utilisation de la page de propriétés spécifiée est facultative.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro si un ID de classe a été retourné dans *lpclsid*; Sinon, 0.

### <a name="remarks"></a>Remarques

Substituez cette fonction pour fournir un moyen d’appeler les pages de propriétés de votre contrôle à partir de l’Explorateur de propriétés du conteneur.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl :: OnMnemonic

Appelée par l’infrastructure quand le conteneur a détecté qu’une clé mnémonique du contrôle OLE a été enfoncée.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Paramètres

*pMsg*<br/>
Pointeur vers le message Windows généré par une pression sur une touche mnémonique.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COleControl :: OnProperties

Appelé par le Framework lorsque le verbe des propriétés du contrôle a été appelé par le conteneur.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpMsg*<br/>
Pointeur vers le message Windows qui A appelé le verbe.

*hWndParent*<br/>
Handle de la fenêtre parente du contrôle.

*lpRect*<br/>
Pointeur vers le rectangle utilisé par le contrôle dans le conteneur.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel réussit ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation par défaut affiche une boîte de dialogue de propriétés modale.

Vous pouvez également utiliser cette fonction pour afficher les pages de propriétés de votre contrôle. Effectuez un appel à la `OnProperties` fonction, en passant le handle du parent de votre contrôle dans le paramètre *hwndParent* . Dans ce cas, les valeurs des paramètres *lpMsg* et *lpRect* sont ignorées.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COleControl :: OnQueryHitPoint

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IViewObjectEx::QueryHitPoint` .

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie le mode de représentation de l’objet. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Pointeur vers une `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.

*ptlLoc*<br/>
Pointeur vers la `POINT` structure spécifiant le point à vérifier pour un accès. Le point est spécifié dans les coordonnées de la zone cliente OLE.

*lCloseHint*<br/>
Distance qui définit « Close » sur le point vérifié pour un accès.

*pHitResult*<br/>
Pointeur vers le résultat de la requête d’accès. Une des valeurs suivantes :

- HITRESULT_OUTSIDE *ptlLoc* est en dehors de l’objet OLE et n’est pas fermé.

- HITRESULT_TRANSPARENT *ptlLoc* se trouve dans les limites de l’objet OLE, mais pas près de l’image. Par exemple, un point au milieu d’un cercle transparent peut être HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* se trouve à l’intérieur ou à l’extérieur de l’objet OLE, mais est suffisamment proche de l’objet à prendre en compte. Les objets de petite taille, fins ou détaillés peuvent utiliser cette valeur. Même si un point se trouve en dehors du rectangle englobant d’un objet, il peut encore être fermé (cela est nécessaire pour toucher les petits objets).

- HITRESULT_HIT *ptlLoc* se trouve dans l’image de l’objet.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si un résultat atteint est retourné avec succès ; Sinon, 0. Un accès est un chevauchement avec la zone d’affichage du contrôle OLE.

### <a name="remarks"></a>Remarques

Interroge si le rectangle d’affichage d’un objet chevauche le point donné (atteint le point). `QueryHitPoint`peut être substitué pour tester les accès aux objets non rectangulaires.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl :: OnQueryHitRect

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IViewObjectEx::QueryHitRect` .

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Paramètres

*dwAspect*<br/>
Spécifie la représentation de l'objet. Les valeurs valides sont extraites de l’énumération [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) ou DVASPECT2.

*pRectBounds*<br/>
Pointeur vers une `RECT` structure qui spécifie le rectangle englobant de la zone cliente du contrôle OLE.

*prcLoc*<br/>
Pointeur vers la `RECT` structure qui spécifie le rectangle à vérifier pour un accès (chevauchement avec le rectangle de l’objet), par rapport au coin supérieur gauche de l’objet.

*lCloseHint*<br/>
Non utilisé.

*pHitResult*<br/>
Pointeur vers le résultat de la requête d’accès. Une des valeurs suivantes :

- HITRESULT_OUTSIDE aucun point du rectangle n’est atteint par l’objet OLE.

- HITRESULT_HIT au moins un point du rectangle serait un accès à l’objet.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si un résultat atteint est retourné avec succès ; Sinon, 0.

### <a name="remarks"></a>Remarques

Interroge si le rectangle d’affichage d’un objet chevauche un point quelconque dans le rectangle donné (atteint le rectangle). `QueryHitRect`peut être substitué pour tester les accès aux objets non rectangulaires.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COleControl :: OnRenderData

Appelé par le Framework pour récupérer des données dans le format spécifié.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en spécifiant le format dans lequel les informations sont demandées.

*lpStgMedium*<br/>
Pointe vers une structure [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) dans laquelle les données doivent être retournées.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Le format spécifié est un précédemment placé dans l’objet de contrôle à l’aide des fonctions membres [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) ou [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) pour un rendu retardé. L’implémentation par défaut de cette fonction appelle `OnRenderFileData` ou `OnRenderGlobalData` , respectivement, si le support de stockage fourni est un fichier ou une mémoire. Si le format demandé est CF_METAFILEPICT ou le format de jeu de propriétés persistant, l’implémentation par défaut génère le rendu des données appropriées et retourne une valeur différente de zéro. Sinon, elle retourne 0 et ne fait rien.

Si *lpStgMedium->TYMED* est TYMED_NULL, STGMEDIUM doit être alloué et rempli comme spécifié par *lpFormatEtc->TYMED*. Si ce n’est pas TYMED_NULL, STGMEDIUM doit être renseigné avec les données.

Substituez cette fonction pour fournir vos données au format et au support demandés. Selon vos données, vous souhaiterez peut-être substituer l’une des autres versions de cette fonction à la place. Si vos données sont de taille petite et fixe, remplacez `OnRenderGlobalData` . Si vos données se trouvent dans un fichier ou sont de taille variable, remplacez `OnRenderFileData` .

Pour plus d’informations, consultez `FORMATETC` les `STGMEDIUM` structures et dans le SDK Windows.

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COleControl :: OnRenderFileData

Appelé par le Framework pour récupérer des données dans le format spécifié lorsque le support de stockage est un fichier.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en spécifiant le format dans lequel les informations sont demandées.

*pFile*<br/>
Pointe vers un objet [CFile](../../mfc/reference/cfile-class.md) dans lequel les données doivent être restituées.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Le format spécifié est un précédemment placé dans l’objet de contrôle à l’aide de la fonction membre [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pour un rendu retardé. L’implémentation par défaut de cette fonction retourne simplement FALSe.

Substituez cette fonction pour fournir vos données au format et au support demandés. Selon vos données, vous souhaiterez peut-être substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, remplacez `OnRenderData` . Si vos données se trouvent dans un fichier ou sont de taille variable, remplacez `OnRenderFileData` .

Pour plus d’informations, consultez la `FORMATETC` structure dans le SDK Windows.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COleControl :: OnRenderGlobalData

Appelé par le Framework pour récupérer des données dans le format spécifié lorsque le support de stockage spécifié est une mémoire globale.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointe vers la structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) en spécifiant le format dans lequel les informations sont demandées.

*phGlobal*<br/>
Pointe vers un handle vers la mémoire globale dans laquelle les données doivent être retournées. Si aucune mémoire n’a été allouée, ce paramètre peut avoir la valeur NULL.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Le format spécifié est un précédemment placé dans l’objet de contrôle à l’aide de la fonction membre [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) pour un rendu retardé. L’implémentation par défaut de cette fonction retourne simplement FALSe.

Si *phGlobal* a la valeur null, un nouveau HGLOBAL doit être alloué et retourné dans *phGlobal*. Dans le cas contraire, le HGLOBAL spécifié par *phGlobal* doit être rempli avec les données. La quantité de données placées dans le HGLOBAL ne doit pas dépasser la taille actuelle du bloc de mémoire. En outre, le bloc ne peut pas être réalloué à une plus grande taille.

Substituez cette fonction pour fournir vos données au format et au support demandés. Selon vos données, vous souhaiterez peut-être substituer l’une des autres versions de cette fonction à la place. Si vous souhaitez gérer plusieurs supports de stockage, remplacez `OnRenderData` . Si vos données se trouvent dans un fichier ou sont de taille variable, remplacez `OnRenderFileData` .

Pour plus d’informations, consultez la `FORMATETC` structure dans le SDK Windows.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COleControl :: OnResetState

Appelée par l’infrastructure quand les propriétés du contrôle doivent être définies sur leurs valeurs par défaut.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle [DoPropExchange](#dopropexchange), en passant un `CPropExchange` objet qui entraîne la définition des valeurs par défaut des propriétés.

Le writer de contrôle peut insérer le code d’initialisation pour le contrôle OLE dans ce substituable. Cette fonction est appelée quand [IPersistStream :: Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) ou [IPersistStorage :: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) échoue, ou si [IPersistStreamInit :: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) ou [IPersistStorage :: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) est appelé, sans appeler d’abord `IPersistStream::Load` ou `IPersistStorage::Load` .

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl :: OnSetClientSite

Appelée par l’infrastructure quand le conteneur a appelé la fonction du contrôle `IOleControl::SetClientSite` .

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Remarques

Par défaut, `OnSetClientSite` vérifie si les propriétés du chemin d’accès aux données sont chargées et, le cas échéant, appelle `DoDataPathPropExchange` .

Remplacez cette fonction pour effectuer tout traitement spécial de cette notification. En particulier, les substitutions de cette fonction doivent appeler la classe de base.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl :: OnSetData

Appelé par l’infrastructure pour remplacer les données du contrôle par les données spécifiées.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Paramètres

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) spécifiant le format des données.

*lpStgMedium*<br/>
Pointeur vers une structure [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) dans laquelle les données résident.

*bRelease*<br/>
TRUE si le contrôle doit libérer le support de stockage ; FALSe si le contrôle ne doit pas libérer le support de stockage.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Si les données sont au format de jeu de propriétés persistant, l’implémentation par défaut modifie l’état du contrôle en conséquence. Dans le cas contraire, l’implémentation par défaut ne fait rien. Si *bRelease* a la valeur true, un appel à `ReleaseStgMedium` est effectué ; sinon,.

Substituez cette fonction pour remplacer les données du contrôle par les données spécifiées.

Pour plus d’informations, consultez `FORMATETC` les `STGMEDIUM` structures et dans le SDK Windows.

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COleControl :: OnSetExtent

Appelé par le Framework lorsque l’étendue du contrôle doit être modifiée, à la suite d’un appel à [IOleObject ::](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)seversion.

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Paramètres

*lpSizeL*<br/>
Pointeur vers la `SIZEL` structure qui utilise des entiers longs pour représenter la largeur et la hauteur du contrôle, exprimée en unités HIMETRIC.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la modification de la taille a été acceptée ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation par défaut gère le redimensionnement de l’étendue du contrôle. Si le contrôle est actif sur place, un appel au conteneur `OnPosRectChanged` est ensuite effectué.

Substituez cette fonction pour modifier le redimensionnement par défaut de votre contrôle.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COleControl :: OnSetObjectRects

Appelé par l’infrastructure pour implémenter un appel à [IOleInPlaceObject :: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Paramètres

*lpRectPos*<br/>
Pointeur vers une `RECT` structure indiquant la nouvelle position et la nouvelle taille du contrôle par rapport au conteneur.

*lpRectClip*<br/>
Pointeur vers une `RECT` structure indiquant une zone rectangulaire dans laquelle le contrôle doit être coupé.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le repositionnement a été accepté ; Sinon, 0.

### <a name="remarks"></a>Remarques

L’implémentation par défaut gère automatiquement le repositionnement et le redimensionnement de la fenêtre de contrôle et retourne la valeur TRUE.

Substituez cette fonction pour modifier le comportement par défaut de cette fonction.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl :: OnShowToolBars

Appelée par l’infrastructure quand le contrôle a été activé par l’interface utilisateur.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Remarques

L'implémentation par défaut n'exécute aucune opération.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COleControl :: OnTextChanged

Appelé par le Framework lorsque la valeur de la propriété de texte ou de la légende stock a changé.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut appelle `InvalidateControl` .

Substituez cette fonction si vous souhaitez une notification après la modification de cette propriété.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl :: OnWindowlessMessage

Appelé par l’infrastructure en réponse à la demande d’un conteneur `IOleInPlaceObjectWindowless::OnWindowMessage` .

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Paramètres

*msg*<br/>
Identificateur de message tel qu’il a été passé par Windows.

*wParam*<br/>
Comme passé par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur du paramètre *MSG* .

*lParam*<br/>
Comme passé par Windows. Spécifie des informations supplémentaires spécifiques au message. Le contenu de ce paramètre dépend de la valeur du paramètre *MSG* .

*plResult*<br/>
Code de résultat Windows. Spécifie le résultat du traitement du message et dépend du message envoyé.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Traite les messages de fenêtre pour les contrôles sans fenêtre. `COleControl``OnWindowlessMessage`doit être utilisé pour les messages de fenêtre autres que les messages de souris et de clavier. `COleControl`fournit [SetCapture](#setcapture) et [SetFocus](#setfocus) spécifiquement pour obtenir la capture de la souris et le focus clavier pour les objets OLE sans fenêtre.

Étant donné que les objets sans fenêtre n’ont pas de fenêtre, ils ont besoin d’un mécanisme pour permettre au conteneur de les distribuer. Un objet OLE sans fenêtre obtient les messages de son conteneur, via la `OnWindowMessage` méthode sur l' `IOleInPlaceObjectWindowless` interface (une extension de [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) pour la prise en charge sans fenêtre). `OnWindowMessage`ne prend pas de `HWND` paramètre.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl ::P arentToClient

Convertit les coordonnées de *PPoint* en coordonnées clientes.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Paramètres

*lprcBounds*<br/>
Pointeur vers les limites du contrôle OLE dans le conteneur. Pas la zone cliente, mais la zone de l’ensemble du contrôle, y compris les bordures et les barres de défilement.

*pPoint*<br/>
Pointeur vers le point parent (conteneur) à traduire en coordonnées de la zone cliente du contrôle.

*bHitTest*<br/>
Spécifie si le test de positionnement doit être effectué sur le point.

### <a name="return-value"></a>Valeur renvoyée

Si *bHitTest* a la valeur false, retourne HTNOWHERE. Si *bHitTest* a la valeur true, retourne l’emplacement où le point parent (conteneur) est placé dans la zone cliente du contrôle OLE et est l’une des valeurs de test de positionnement de souris suivantes :

- HTBORDER dans la bordure d’une fenêtre qui n’a pas de bordure de redimensionnement.

- HTBOTTOM dans la bordure horizontale inférieure de la fenêtre.

- HTBOTTOMLEFT dans le coin inférieur gauche de la bordure de la fenêtre.

- HTBOTTOMRIGHT dans le coin inférieur droit de la bordure de la fenêtre.

- HTCAPTION dans une zone de barre de titre.

- HTCLIENT dans une zone cliente.

- HTERROR sur l’arrière-plan de l’écran ou sur une ligne de séparation entre les fenêtres (identique à HTNOWHERE, sauf que la `DefWndProc` fonction Windows produit un bip système pour indiquer une erreur).

- HTGROWBOX dans une zone de taille.

- HTHSCROLL dans la barre de défilement horizontale.

- HTLEFT dans la bordure gauche de la fenêtre.

- HTMAXBUTTON dans un bouton d’agrandissement.

- HTMENU dans une zone de menu.

- HTMINBUTTON dans un bouton réduire.

- HTNOWHERE sur l’arrière-plan de l’écran ou sur une ligne de séparation entre les fenêtres.

- HTREDUCE dans un bouton réduire.

- HTRIGHT dans la bordure droite de la fenêtre.

- HTSIZE dans une zone de taille (identique à HTGROWBOX).

- HTSYSMENU dans un menu de contrôle ou dans un bouton Fermer dans une fenêtre enfant.

- HTTOP dans la bordure supérieure horizontale de la fenêtre.

- HTTOPLEFT dans le coin supérieur gauche de la bordure de la fenêtre.

- HTTOPRIGHT dans le coin supérieur droit de la bordure de la fenêtre.

- HTTRANSPARENT dans une fenêtre actuellement couverte par une autre fenêtre.

- HTVSCROLL dans la barre de défilement verticale.

- HTZOOM dans un bouton d’agrandissement.

### <a name="remarks"></a>Remarques

Sur l’entrée *PPoint* est relatif à l’origine du parent (dans le coin supérieur gauche du conteneur). Sur la sortie *PPoint* est relatif à l’origine de la zone cliente du contrôle OLE (coin supérieur gauche de la zone cliente du contrôle).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl ::P ostModalDialog

Notifie le conteneur qu’une boîte de dialogue modale a été fermée.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Handle de la fenêtre parente de la boîte de dialogue modale.

### <a name="remarks"></a>Remarques

Appelez cette fonction après avoir affiché une boîte de dialogue modale. Vous devez appeler cette fonction afin que le conteneur puisse activer toutes les fenêtres de niveau supérieur désactivées par `PreModalDialog` . Cette fonction doit être associée à un appel à `PreModalDialog` .

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl ::P reModalDialog

Notifie le conteneur qu’une boîte de dialogue modale va être affichée.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Paramètres

*hWndParent*<br/>
Handle de la fenêtre parente de la boîte de dialogue modale.

### <a name="remarks"></a>Remarques

Appelez cette fonction avant d’afficher une boîte de dialogue modale. Vous devez appeler cette fonction afin que le conteneur puisse désactiver toutes ses fenêtres de niveau supérieur. Une fois la boîte de dialogue modale affichée, vous devez appeler `PostModalDialog` .

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COleControl :: RecreateControlWindow

Détruit et recrée la fenêtre du contrôle.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Remarques

Cela peut s’avérer nécessaire si vous avez besoin de modifier les bits de style de la fenêtre.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COleControl :: Refresh

Force un redessin du contrôle OLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Remarques

Cette fonction est prise en charge par la `COleControl` classe de base comme méthode stock, appelée Refresh. Cela permet aux utilisateurs de votre contrôle OLE de repeindre le contrôle à un moment donné. Pour plus d’informations sur cette méthode, consultez l’article [contrôles ActiveX : méthodes](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COleControl :: ReleaseCapture

Libère la capture de la souris.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

Si le contrôle a actuellement la capture de la souris, la capture est libérée. Dans le cas contraire, cette fonction n’a aucun effet.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COleControl :: ReleaseDC

Libère le contexte de périphérique d’affichage d’un conteneur d’un contrôle sans fenêtre, en libérant le contexte de périphérique pour une utilisation par d’autres applications.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Identifie le contexte de périphérique de conteneur à libérer.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Remarques

L’application doit appeler `ReleaseDC` pour chaque appel à [GetDC](#getdc).

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COleControl :: ReparentControlWindow

Définit le parent du contrôle.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Paramètres

*hWndOuter*<br/>
Handle de la fenêtre de contrôle.

*hWndParent*<br/>
Handle de la nouvelle fenêtre parente.

### <a name="remarks"></a>Remarques

Appelez cette fonction pour réinitialiser le parent de la fenêtre de contrôle.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COleControl :: ResetStockProps

Initialise l’état des `COleControl` propriétés stock avec leurs valeurs par défaut.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Remarques

Les propriétés sont : Appearance, BackColor, BorderStyle, Caption, Enabled, font, ForeColor, hWnd et Text. Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : ajout de propriétés stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances d’initialisation binaire d’un contrôle à l’aide de `ResetStockProps` et `ResetVersion` de substituer `COleControl::OnResetState` . Reportez-vous à l’exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COleControl :: ResetVersion

Initialise le numéro de version à la valeur spécifiée.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Paramètres

*dwVersionDefault*<br/>
Numéro de version à assigner au contrôle.

### <a name="remarks"></a>Remarques

Vous pouvez améliorer les performances d’initialisation binaire d’un contrôle à l’aide de `ResetVersion` et `ResetStockProps` de substituer `COleControl::OnResetState` . Consultez l’exemple sur [ResetStockProps](#resetstockprops). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COleControl :: ScrollWindow

Permet à un objet OLE sans fenêtre de faire défiler une zone dans son image active sur place à l’écran.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Paramètres

*xAmount*<br/>
Spécifie la quantité, en unités de périphérique, du défilement horizontal. Ce paramètre doit être une valeur négative pour faire défiler vers la gauche.

*yAmount*<br/>
Spécifie la quantité, en unités de périphérique, du défilement vertical. Ce paramètre doit être une valeur négative pour faire défiler vers le haut.

*lpRect*<br/>
Pointe vers un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou une structure Rect qui spécifie la partie de la zone cliente de l’objet OLE à faire défiler, dans les coordonnées clientes de la fenêtre conteneur. Si *lpRect* a la valeur null, l’intégralité de la zone cliente de l’objet OLE est défilant.

*lpClipRect*<br/>
Pointe vers un `CRect` objet ou une `RECT` structure qui spécifie le rectangle à découper. Seuls les pixels situés à l’intérieur du rectangle sont défilant. Les bits en dehors du rectangle ne sont pas affectés, même s’ils se trouvent dans le rectangle *lpRect* . Si *lpClipRect* a la valeur null, aucun découpage n’est effectué sur le rectangle de défilement.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COleControl :: SelectFontObject

Sélectionne une police dans un contexte de périphérique.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Pointeur vers un objet de contexte de périphérique.

*fontHolder*<br/>
Référence à l’objet [CFontHolder](../../mfc/reference/cfontholder-class.md) qui représente la police à sélectionner.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la police précédemment sélectionnée. Lorsque l’appelant a terminé toutes les opérations de dessin qui utilisent *fontHolder,* il doit resélectionner la police sélectionnée précédemment en la transmettant en tant que paramètre à [CDC :: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl :: SelectStockFont

Sélectionne la propriété stock font dans un contexte de périphérique.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

*Maîtres*<br/>
Contexte de périphérique dans lequel la police sera sélectionnée.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’objet précédemment sélectionné `CFont` . Vous devez utiliser [CDC :: SelectObject](../../mfc/reference/cdc-class.md#selectobject) pour sélectionner de nouveau cette police dans le contexte de périphérique lorsque vous avez terminé.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COleControl :: SerializeExtent

Sérialise ou Initialise l’état de l’espace d’affichage alloué au contrôle.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*AR*<br/>
`CArchive`Objet à sérialiser vers ou à partir de.

### <a name="remarks"></a>Remarques

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeExtent` , `SerializeStockProps` et `SerializeVersion` pour remplacer `COleControl::Serialize` . Reportez-vous à l’exemple ci-dessous. Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COleControl :: SerializeStockProps

Sérialise ou Initialise l’état des `COleControl` propriétés stock : Appearance, BackColor, BorderStyle, Caption, Enabled, font, ForeColor et Text.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Paramètres

*AR*<br/>
`CArchive`Objet à sérialiser vers ou à partir de.

### <a name="remarks"></a>Remarques

Pour obtenir une description des propriétés stock, consultez [contrôles ActiveX : ajout de propriétés stock](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeStockProps` , `SerializeExtent` et `SerializeVersion` pour remplacer `COleControl::Serialize` . Pour obtenir un exemple, consultez le code sur [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COleControl :: SerializeVersion

Sérialise ou Initialise l’état des informations de version d’un contrôle.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Paramètres

*AR*<br/>
`CArchive`Objet à sérialiser vers ou à partir de.

*dwVersionDefault*<br/>
Numéro de la version actuelle du contrôle.

*bConvert*<br/>
Indique si les données persistantes doivent être converties au format le plus récent lorsqu’elles sont enregistrées ou conservées dans le même format que celui dans lequel elles ont été chargées.

### <a name="return-value"></a>Valeur renvoyée

Numéro de version du contrôle. Si l’archive spécifiée est en cours `SerializeVersion` de chargement, retourne la version chargée à partir de cette archive. Sinon, elle retourne la version actuellement chargée.

### <a name="remarks"></a>Remarques

Vous pouvez améliorer les performances de persistance binaire d’un contrôle à l’aide de `SerializeVersion` , `SerializeExtent` et `SerializeStockProps` pour remplacer `COleControl::Serialize` . Pour obtenir un exemple, consultez le code sur [SerializeExtent](#serializeextent). Pour plus d’informations sur l’optimisation de l’initialisation, consultez [contrôles ActiveX : optimisation](../../mfc/mfc-activex-controls-optimization.md).

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COleControl :: SetAppearance

Définit la valeur de la propriété d’apparence de stock de votre contrôle.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Paramètres

*sAppearance*<br/>
**`short`** Valeur (VT_I2) à utiliser pour l’apparence de votre contrôle. La valeur zéro définit l’apparence du contrôle sur Flat et la valeur 1 définit l’apparence du contrôle sur 3D.

### <a name="remarks"></a>Remarques

Pour plus d’informations sur les propriétés stock, consultez [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COleControl :: SetBackColor

Définit la valeur de la propriété stock BackColor de votre contrôle.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Paramètres

*dwBackColor*<br/>
Valeur OLE_COLOR à utiliser pour le dessin en arrière-plan de votre contrôle.

### <a name="remarks"></a>Remarques

Pour plus d’informations sur l’utilisation de cette propriété et d’autres propriétés associées, consultez l’article [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COleControl :: SetBorderStyle

Définit la valeur de la propriété BorderStyle de stock de votre contrôle.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Paramètres

*sBorderStyle*<br/>
Nouveau style de bordure pour le contrôle ; 0 indique qu’il n’y a aucune bordure et 1 indique une bordure normale.

### <a name="remarks"></a>Remarques

La fenêtre de contrôle sera ensuite recréée et `OnBorderStyleChanged` appelée.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COleControl :: SetCapture

Fait en sorte que la fenêtre de conteneur du contrôle prenne possession de la capture de la souris pour le compte du contrôle.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l' `CWnd` objet fenêtre qui a précédemment reçu l’entrée de la souris.

### <a name="remarks"></a>Remarques

Si le contrôle est activé et sans fenêtre, cette fonction fait en sorte que la fenêtre de conteneur du contrôle prenne possession de la capture de la souris, à la place du contrôle. Dans le cas contraire, cette fonction entraîne le contrôle lui-même à prendre possession de la capture de la souris (identique à `CWnd::SetCapture` ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COleControl :: SetControlSize

Définit la taille de la fenêtre de contrôle OLE et notifie le conteneur que le site de contrôle change.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Paramètres

*adéquat*<br/>
Spécifie la nouvelle largeur du contrôle en pixels.

*CY*<br/>
Spécifie la nouvelle hauteur du contrôle en pixels.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

Cette fonction ne doit pas être utilisée dans le constructeur de votre contrôle.

Notez que toutes les coordonnées des fenêtres de contrôle sont relatives au coin supérieur gauche du contrôle.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COleControl :: SetEnabled

Définit la valeur de la propriété stock activé de votre contrôle.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Paramètres

*bEnabled*<br/>
TRUE si le contrôle doit être activé ; Sinon, FALSe.

### <a name="remarks"></a>Remarques

Une fois cette propriété définie, `OnEnabledChange` est appelée.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COleControl :: SetFocus

Fait en sorte que la fenêtre de conteneur du contrôle prenne possession du focus d’entrée au nom du contrôle.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l' `CWnd` objet de fenêtre qui avait précédemment le focus d’entrée, ou null s’il n’existe aucune fenêtre de ce type.

### <a name="remarks"></a>Remarques

Si le contrôle est activé et sans fenêtre, cette fonction fait en sorte que la fenêtre de conteneur du contrôle prenne possession du focus d’entrée, pour le compte du contrôle. Le focus d’entrée dirige l’entrée au clavier vers la fenêtre du conteneur, et le conteneur distribue tous les messages de clavier suivants à l’objet OLE qui appelle `SetFocus` . Toute fenêtre qui avait précédemment le focus d’entrée l’a perdante.

Si le contrôle n’a pas de fenêtre, cette fonction fait en sorte que le contrôle lui-même prenne possession du focus d’entrée (identique à `CWnd::SetFocus` ).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COleControl :: SetFont

Définit la propriété stock font de votre contrôle.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Paramètres

*pFontDisp*<br/>
Pointeur vers une interface de dispatch de police.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl :: SetForeColor

Définit la valeur de la propriété ForeColor ForeColor de votre contrôle.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Paramètres

*dwForeColor*<br/>
Valeur OLE_COLOR à utiliser pour le dessin de premier plan de votre contrôle.

### <a name="remarks"></a>Remarques

Pour plus d’informations sur l’utilisation de cette propriété et d’autres propriétés associées, consultez l’article [contrôles ActiveX : propriétés](../../mfc/mfc-activex-controls-properties.md).

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl :: SetInitialDataFormats

Appelé par l’infrastructure pour initialiser la liste des formats de données pris en charge par le contrôle.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Remarques

L’implémentation par défaut spécifie deux formats : CF_METAFILEPICT et le jeu de propriétés persistantes.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COleControl :: SetInitialSize

Définit la taille d’un contrôle OLE lorsqu’il est affiché pour la première fois dans un conteneur.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Paramètres

*adéquat*<br/>
Largeur initiale du contrôle OLE en pixels.

*CY*<br/>
Hauteur initiale du contrôle OLE en pixels.

### <a name="remarks"></a>Remarques

Appelez cette fonction dans votre constructeur pour définir la taille initiale de votre contrôle. La taille initiale est mesurée en unités de périphérique, ou en pixels. Il est recommandé d’effectuer cet appel dans le constructeur de votre contrôle.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COleControl :: SetModifiedFlag

Modifie l’état modifié d’un contrôle.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Paramètres

*bModified*<br/>
Nouvelle valeur de l’indicateur modifié du contrôle. TRUE indique que l’état du contrôle a été modifié ; FALSe indique que l’état du contrôle vient d’être enregistré.

### <a name="remarks"></a>Remarques

Appelez cette fonction chaque fois qu’une modification affectant l’état persistant de votre contrôle se produit. Par exemple, si la valeur d’une propriété persistante change, appelez cette fonction avec *bModified* **true**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COleControl :: SetNotPermitted

Indique qu’une demande de modification a échoué.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Remarques

Appelez cette fonction lorsque `BoundPropertyRequestEdit` échoue. Cette fonction lève une exception de type `COleDispScodeException` pour indiquer que l’opération de définition n’a pas été autorisée.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COleControl :: SetNotSupported

Empêche la modification de la valeur de la propriété d’un contrôle par l’utilisateur.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Remarques

Appelez cette fonction à la place de la fonction Set de toute propriété dans laquelle la modification de la valeur de propriété par l’utilisateur du contrôle n’est pas prise en charge. Une propriété en lecture seule en est un exemple.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COleControl :: SetRectInContainer

Définit les coordonnées du rectangle du contrôle par rapport au conteneur, exprimé en unités de périphérique.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
Pointeur vers un rectangle contenant les nouvelles coordonnées du contrôle par rapport au conteneur.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l’appel a réussi ; Sinon, 0.

### <a name="remarks"></a>Remarques

Si le contrôle est ouvert, il est redimensionné. Sinon, la fonction du conteneur `OnPosRectChanged` est appelée.

## <a name="colecontrolsettext"></a><a name="settext"></a>COleControl :: SetText

Définit la valeur de la légende ou de la propriété de texte stock de votre contrôle.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Paramètres

*pszText*<br/>
Pointeur vers une chaîne de caractères.

### <a name="remarks"></a>Remarques

Notez que les propriétés Text Caption et Text sont mappées à la même valeur. Cela signifie que toutes les modifications apportées à l’une des propriétés modifieront automatiquement les deux propriétés. En général, un contrôle doit prendre en charge la propriété de texte ou de légende stock, mais pas les deux.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COleControl :: ThrowError

Signale l’occurrence d’une erreur dans votre contrôle.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Paramètres

*SC*<br/>
Valeur de code d’État à signaler. Pour obtenir la liste complète des codes possibles, consultez l’article [contrôles ActiveX : Rubriques avancées](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
ID de ressource de chaîne de l’exception à signaler.

*nHelpID*<br/>
ID d’aide de la rubrique à signaler.

*pszDescription*<br/>
Chaîne contenant une explication de l’exception à signaler.

### <a name="remarks"></a>Remarques

Cette fonction doit uniquement être appelée à partir d’une fonction d’extraction ou de définition pour une propriété OLE, ou de l’implémentation d’une méthode OLE Automation. Si vous avez besoin de signaler des erreurs qui se produisent à d’autres moments, vous devez déclencher l’événement d’erreur stock.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COleControl :: TransformCoords

Transforme les valeurs de coordonnée entre les unités HIMETRIC et les unités natives du conteneur.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Paramètres

*lpptlHimetric*<br/>
Pointeur vers une `POINTL` structure contenant des coordonnées en unités HIMETRIC.

*lpptfContainer*<br/>
Pointeur vers une `POINTF` structure contenant des coordonnées dans la taille d’unité du conteneur.

*flags*<br/>
Une combinaison des valeurs suivantes :

- XFORMCOORDS_POSITION une position dans le conteneur.

- XFORMCOORDS_SIZE une taille dans le conteneur.

- XFORMCOORDS_HIMETRICTOCONTAINER transformer les unités HIMETRIC en unités du conteneur.

- XFORMCOORDS_CONTAINERTOHIMETRIC transformer les unités du conteneur en unités HIMETRIC.

### <a name="remarks"></a>Remarques

Les deux premiers indicateurs, XFORMCOORDS_POSITION et XFORMCOORDS_SIZE, indiquent si les coordonnées doivent être traitées comme une position ou une taille. Les deux indicateurs restants indiquent le sens de la transformation.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl :: TranslateColor

Convertit une valeur de couleur du type de données OLE_COLOR au type de données [COLORREF](/windows/win32/gdi/colorref) .

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Paramètres

*clrColor*<br/>
Type de données OLE_COLOR. Pour plus d’informations, consultez la fonction [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) de Windows.

*hpal*<br/>
Handle d’une palette facultative ; peut avoir la valeur NULL.

### <a name="return-value"></a>Valeur renvoyée

Valeur de couleur RVB (rouge, vert, bleu) 32 bits qui définit la couleur unie la plus proche de la valeur *clrColor* que l’appareil peut représenter.

### <a name="remarks"></a>Remarques

Cette fonction est utile pour convertir les propriétés de ForeColor et BackColor en types COLORREF utilisés par les fonctions membres [CDC](../../mfc/reference/cdc-class.md) .

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COleControl :: WillAmbientsBeValidDuringLoad

Détermine si votre contrôle doit utiliser les valeurs des propriétés ambiantes comme valeurs par défaut, lorsqu’il est chargé par la suite à partir de son état persistant.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valeur renvoyée

Une valeur différente de zéro indique que les propriétés ambiantes sont valides ; Sinon, les propriétés ambiantes ne sont pas valides.

### <a name="remarks"></a>Remarques

Dans certains conteneurs, votre contrôle peut ne pas avoir accès à ses propriétés ambiantes lors de l’appel initial à la substitution de `COleControl::DoPropExchange` . C’est le cas si le conteneur appelle [IPersistStreamInit :: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) ou [IPersistStorage :: Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) avant d’appeler [IOleObject :: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (autrement dit, s’il ne respecte pas le bit d’État OLEMISC_SETCLIENTSITEFIRST).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COleControl :: WindowProc

Fournit une procédure Windows pour un `COleControl` objet.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Paramètres

*message*<br/>
Spécifie le message Windows à traiter.

*wParam*<br/>
Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.

*lParam*<br/>
Fournit des informations supplémentaires utilisées dans le traitement du message. La valeur du paramètre dépend du message.

### <a name="return-value"></a>Valeur renvoyée

Valeur de retour du message distribué.

### <a name="remarks"></a>Remarques

Appelez cette fonction pour distribuer des messages spécifiques par le biais de la table des messages du contrôle.

## <a name="see-also"></a>Voir aussi

[Exemple MFC CIRC3](../../overview/visual-cpp-samples.md)<br/>
[Exemple MFC TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage (classe)](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder, classe](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder, classe](../../mfc/reference/cpictureholder-class.md)<br/>
