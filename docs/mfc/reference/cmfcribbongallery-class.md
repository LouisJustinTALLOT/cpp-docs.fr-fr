---
title: Cmfcribbongallery, classe
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: 818ce55e44d91520e568308a1a1e8a1fa0c8658d
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/18/2019
ms.locfileid: "58780390"
---
# <a name="cmfcribbongallery-class"></a>Cmfcribbongallery, classe

Implémente les galeries de ruban de style Office 2007.
Pour plus d’informations, consultez le code source situé dans le **VC\\atlmfc\\src\\mfc** dossier de votre installation de Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|Construit et initialise un objet `CMFCRibbonGallery`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::AddGroup](#addgroup)|Ajoute un nouveau groupe dans la galerie.|
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|Ajoute un nouvel élément de menu au menu de liste déroulante.|
|[CMFCRibbonGallery::Clear](#clear)|Efface le contenu de la galerie.|
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|Active ou désactive le redimensionnement du Panneau de menu.|
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|Active ou désactive la barre latérale à gauche du menu contextuel.|
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(Substitue [CMFCRibbonButton::GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).)|
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(Substitue [CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown).)|
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|Retourne le nom du groupe qui se trouve à l’index spécifié.|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|Retourne le nombre d’éléments dans une ligne de la galerie du ruban.|
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|Retourne le texte d’info-bulle qui est associé à un élément dans la galerie.|
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|Retourne l’index du dernier élément dans la galerie sélectionné par l’utilisateur.|
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|Retourne l’ID de commande de la galerie en cours.|
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(Substitue [CMFCRibbonButton::GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).)|
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(Substitue [CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).)|
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|Spécifie si la galerie est contenue dans un bouton de la galerie.|
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|Spécifie si le redimensionnement de menu est activé ou désactivé.|
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|Spécifie si la barre latérale est activée ou désactivée.|
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(Substitue `CMFCRibbonButton::OnAfterChangeRect`.)|
|[CMFCRibbonGallery::OnDraw](#ondraw)|(Substitue [CMFCRibbonButton::OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).)|
|[CMFCRibbonGallery::OnEnable](#onenable)|(Substitue `CMFCRibbonBaseElement::OnEnable`.)|
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(Substitue [CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).)|
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|Redessine la galerie.|
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|Supprime les info-bulles de tous les éléments de la galerie.|
|[CMFCRibbonGallery::SelectItem](#selectitem)||
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(Substitue [CMFCRibbonButton::SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).)|
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|Spécifie s’il faut afficher la galerie du ruban, comme un bouton de liste déroulante ou comme une palette directement sur le ruban.|
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|Définit le nom d’un groupe.|
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|Définit le nombre d’éléments par ligne dans la galerie.|
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|Définit le texte d’info-bulle pour un élément dans la galerie.|
|[CMFCRibbonGallery::SetPalette](#setpalette)|Attache une palette dans une galerie de ruban.|
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|Définit l’ID de commande qui est envoyé dans le message WM_COMMAND quand un élément de galerie a été sélectionné.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|Appelé par le framework lorsqu’une icône de la galerie est dessinée.|

## <a name="remarks"></a>Notes

Un bouton de la galerie se comporte comme un bouton de menu standard, à ceci près qu’il affiche une galerie lorsqu’un utilisateur l’ouvre. Lorsque vous sélectionnez un élément dans une galerie, le framework envoie le message WM_COMMAND avec l’ID de commande du bouton. Lorsque vous gérez le message, vous devez appeler [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) pour déterminer quel élément a été sélectionné à partir de la galerie.

## <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser différentes méthodes de la `CMFCRibbonGallery` classe permettant de configurer un `CMFCRibbonGallery` objet. L’exemple montre comment spécifier le nombre d’éléments par ligne dans la galerie, activer le redimensionnement du Panneau de menu, la barre latérale à gauche du menu contextuel et afficher la galerie du ruban sous la forme d’une palette directement sur la barre du ruban. Cet extrait de code fait partie de l’ [exemple Draw Client](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>Configuration requise

**En-tête :** afxRibbonPaletteGallery.h

##  <a name="addgroup"></a>  CMFCRibbonGallery::AddGroup

Ajoute un nouveau groupe dans la galerie.

```
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>Paramètres

*lpszGroupName*<br/>
[in] Spécifie le nom du groupe.

*uiImagesPaletteResID*<br/>
[in] Spécifie l’ID de ressource de la liste d’images qui contient les images pour le groupe.

*cxPaletteImage*<br/>
[in] Spécifie la largeur en pixels d’une image.

*imagesGroup*<br/>
[in] Une référence à la liste d’images qui contient des images de groupe.

*nIconsNum*<br/>
[in] Spécifie le nombre d’icônes dans le groupe. Ce paramètre doit être spécifié uniquement pour l’installation personnalisée (owner-drawn) groupes.

### <a name="remarks"></a>Notes

Vous pouvez diviser les éléments sur une galerie de ruban en plusieurs groupes en appelant cette méthode. Chaque groupe peut avoir une légende.

##  <a name="addsubitem"></a>  CMFCRibbonGallery::AddSubItem

Ajoute un nouvel élément de menu au menu de liste déroulante.

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>Paramètres

*pSubItem*<br/>
[in] Pointeur vers l’élément à ajouter au menu.

*nIndex*<br/>
[in] Spécifie l’index de base zéro d’un emplacement où insérer l’élément.

*bOnTop*<br/>
[in] TRUE pour spécifier que l’élément doit être inséré avant la galerie du ruban ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Vous pouvez combiner des galeries de fenêtre contextuelle avec les éléments de menu contextuel en appelant cette méthode. Éléments de menu peuvent être placés avant ou après la galerie.

Pour insérer l’élément avant de la galerie, définissez *bOnTop* sur TRUE. Définissez *bOnTop* sur FALSE pour insérer l’élément au-dessous de la galerie.

> [!NOTE]
>  Le paramètre *nIndex* Spécifie l’index d’insertion à la fois en haut de la galerie et en bas de la galerie. Par exemple, si vous avez besoin d’insérer un élément d’une position avant de la galerie, définissez *nIndex* 1 et *bOnTop* sur TRUE. De même, si vous avez besoin d’insérer un élément d’une position au-dessous de la galerie, définissez *nIndex* 1 et *bOnTop* sur FALSE.

##  <a name="clear"></a>  CMFCRibbonGallery::Clear

Efface le contenu de la galerie.

```
virtual void Clear();
```

### <a name="remarks"></a>Notes

Appelez cette méthode pour supprimer tout le contenu de la galerie du ruban. Ceci doit être fait avant d’attacher une nouvelle galerie du ruban ou un ensemble de groupes à la galerie du ruban.

##  <a name="cmfcribbongallery"></a>  CMFCRibbonGallery::CMFCRibbonGallery

Crée et initialise un [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md) objet.

```
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Spécifie l’ID de commande de la commande à exécuter quand un utilisateur clique sur le bouton.

*lpszText*<br/>
Spécifie le texte à afficher sur le bouton.

*nSmallImageIndex*<br/>
Index de base zéro de la petite image à afficher sur le bouton.

*nLargeImageIndex*<br/>
Index de base zéro de la grande image à afficher sur le bouton.

*imagesPalette*<br/>
Une référence à la [CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) objet qui contient les images à afficher dans la galerie.

*uiImagesPaletteResID*<br/>
L’ID de ressource de la liste des images à afficher dans la galerie.

*cxPaletteImage*<br/>
Spécifie la largeur, en pixels, de l’image dans la galerie.

*sizeIcon*<br/>
Spécifie la taille, en pixels, de l’image de galerie.

*nIconsNum*<br/>
Spécifie le nombre d’icônes dans la galerie.

*bDefaultButtonStyle*<br/>
Spécifie s’il faut utiliser la valeur par défaut ou le style de bouton owner-drawn.

### <a name="remarks"></a>Notes

##  <a name="enablemenuresize"></a>  CMFCRibbonGallery::EnableMenuResize

Active ou désactive le redimensionnement du Panneau de menu.

```
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[in] TRUE pour activer le redimensionnement du menu ; Sinon, FALSE.

*bVertcalOnly*<br/>
[in] TRUE pour spécifier que la galerie peut être redimensionnée uniquement verticalement ; FALSE pour indiquer que la galerie peut être redimensionnée verticalement et horizontalement.

### <a name="remarks"></a>Notes

Utilisez cette méthode pour activer ou désactiver le redimensionnement de la galerie du ruban. Lorsque le redimensionnement est activé, la galerie du ruban affiche une barre de redimensionnement un utilisateur peut utiliser pour la redimensionner.

##  <a name="enablemenusidebar"></a>  CMFCRibbonGallery::EnableMenuSideBar

Active ou désactive la barre latérale à gauche du menu contextuel.

```
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[in] TRUE pour spécifier que la barre latérale est activée ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Appelez cette méthode pour activer ou désactiver la barre latérale de style Office XP sur le côté gauche du menu.

##  <a name="getcompactsize"></a>  CMFCRibbonGallery::GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getgroupname"></a>  CMFCRibbonGallery::GetGroupName

Retourne le nom du groupe qui se trouve à l’index spécifié.

```
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>Paramètres

*nGroupIndex*<br/>
[in] Spécifie l’index de base zéro pour le groupe dont vous souhaitez récupérer le nom.

### <a name="return-value"></a>Valeur de retour

Le nom du groupe situé à l’index spécifié. En passant un index non valide entraîne un échec d’assertion.

### <a name="remarks"></a>Notes

##  <a name="getgroupoffset"></a>  CMFCRibbonGallery::GetGroupOffset

```
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="geticonsinrow"></a>  CMFCRibbonGallery::GetIconsInRow

Retourne le nombre d’éléments dans une ligne de la galerie du ruban.

```
int GetIconsInRow() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’éléments dans une ligne.

### <a name="remarks"></a>Notes

##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip

Retourne le texte d’info-bulle qui est associé à un élément dans la galerie.

```
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>Paramètres

*nItemIndex*<br/>
[in] Spécifie l’index de base zéro de l’élément pour lequel récupérer le texte d’info-bulle.

### <a name="return-value"></a>Valeur de retour

Pointeur vers la chaîne d’info-bulle assignée à un élément dans la galerie du ruban. Il peut être NULL si aucune info-bulle n’est affecté à cet élément.

### <a name="remarks"></a>Notes

##  <a name="getlastselecteditem"></a>  CMFCRibbonGallery::GetLastSelectedItem

Retourne l’index du dernier élément dans la galerie du ruban sélectionné par l’utilisateur.

```
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>Paramètres

*uiCmdID*<br/>
[in] Spécifie l’ID de commande de l’élément de menu qui a ouvert la galerie du ruban.

### <a name="return-value"></a>Valeur de retour

Lorsque l’utilisateur sélectionne un élément dans la galerie du ruban, la bibliothèque envoie le message WM_COMMAND avec l’ID de commande du bouton de menu qui a ouvert la galerie du ruban.

### <a name="remarks"></a>Notes

##  <a name="getpaletteid"></a>  CMFCRibbonGallery::GetPaletteID

Retourne l’ID de commande de la palette en cours.

```
int GetPaletteID() const;
```

### <a name="return-value"></a>Valeur de retour

L’ID de commande de la palette actuellement sélectionnée.

### <a name="remarks"></a>Notes

##  <a name="getregularsize"></a>  CMFCRibbonGallery::GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getselecteditem"></a>  CMFCRibbonGallery::GetSelectedItem

```
int GetSelectedItem() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="hasmenu"></a>  CMFCRibbonGallery::HasMenu

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isbuttonmode"></a>  CMFCRibbonGallery::IsButtonMode

Spécifie si la palette est contenue dans un bouton de la galerie.

```
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la palette est affichée comme un bouton de menu déroulant ; FALSE si la palette s’affiche directement sur le ruban.

### <a name="remarks"></a>Notes

##  <a name="ismenuresizeenabled"></a>  CMFCRibbonGallery::IsMenuResizeEnabled

Spécifie si le redimensionnement de menu est activé.

```
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le redimensionnement de menu a été activé ; Sinon, FALSE.

### <a name="remarks"></a>Notes

##  <a name="ismenuresizevertical"></a>  CMFCRibbonGallery::IsMenuResizeVertical

```
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="ismenusidebar"></a>  CMFCRibbonGallery::IsMenuSideBar

Spécifie si la barre latérale est activée ou désactivée.

```
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si la barre latérale de style Office XP est dessinée sur le côté gauche du menu contextuel ; Sinon, FALSE.

### <a name="remarks"></a>Notes

##  <a name="onafterchangerect"></a>  CMFCRibbonGallery::OnAfterChangeRect

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>

### <a name="remarks"></a>Notes

##  <a name="ondraw"></a>  CMFCRibbonGallery::OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[in] *pDC*<br/>

### <a name="remarks"></a>Notes

##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon

Appelé par le framework lorsqu’une icône de la galerie est dessinée.

```
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[in] Pointeur vers le contexte de périphérique qui est utilisé pour le dessin.

*rectIcon*<br/>
[in] Spécifie le rectangle englobant de l’icône à dessiner.

*nIconIndex*<br/>
[in] Spécifie l’index de base zéro dans la liste d’images d’icônes de la galerie de l’icône à dessiner.

*pIcon*<br/>
[in] Pointeur vers l’icône qui est dessiné.

*clrText*<br/>
[in] Spécifie la couleur du texte de l’élément à dessiner.

### <a name="remarks"></a>Notes

Vous pouvez substituer cette méthode dans une classe dérivée pour personnaliser l’apparence d’une galerie de ruban.

##  <a name="onenable"></a>  CMFCRibbonGallery::OnEnable

```
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

[in] *bActivez*<br/>

### <a name="remarks"></a>Notes

##  <a name="onrtlchanged"></a>  CMFCRibbonGallery::OnRTLChanged

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>Paramètres

[in] *bIsRTL*<br/>

### <a name="remarks"></a>Notes

##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons

Redessine la galerie.

```
void RedrawIcons();
```

### <a name="remarks"></a>Notes

Appelez cette fonction pour redessiner la galerie. Vous devez appeler cette méthode si vous avez modifié le contenu de la galerie lors de l’exécution.

##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips

Supprime les info-bulles de tous les éléments de la galerie.

```
void RemoveItemToolTips();
```

### <a name="remarks"></a>Notes

##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem

```
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>Paramètres

[in] *nItemIndex*<br/>

### <a name="remarks"></a>Notes

##  <a name="setaccdata"></a>  CMFCRibbonGallery::SetACCData

Remplit l’objet `CAccessibilityData` spécifié avec des données d’accessibilité à partir de la galerie du ruban.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
[in] La fenêtre parente de la fenêtre de la galerie du ruban.

*data*<br/>
[out] Un `CAccessibilityData` objet qui reçoit les données d’accessibilité à partir de la galerie du ruban.

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

TRUE si la méthode a réussi ; Sinon, FALSE.

##  <a name="setbuttonmode"></a>  CMFCRibbonGallery::SetButtonMode

Détermine s’il faut afficher la galerie du ruban, comme un bouton de liste déroulante ou comme une palette directement sur le ruban.

```
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet*<br/>
[in] True pour afficher la galerie du ruban comme un bouton de menu déroulant ; Pour afficher le contenu de la galerie du ruban directement sur le ruban, la valeur est FALSE.

### <a name="remarks"></a>Notes

##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName

Définit le nom d’un groupe.

```
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>Paramètres

*nGroupIndex*<br/>
[in] Spécifie l’index de base zéro pour le groupe pour lequel le nom est en cours de modification.

*lpszGroupName*<br/>
[in] Spécifie le nouveau nom pour le groupe.

### <a name="remarks"></a>Notes

Le groupe dont le nom est en cours de modification doit avoir été ajouté à l’aide de la [CMFCRibbonGallery::AddGroup](#addgroup) (méthode).

##  <a name="seticonsinrow"></a>  CMFCRibbonGallery::SetIconsInRow

Spécifie le nombre d’éléments par ligne dans la galerie.

```
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>Paramètres

*nIconsInRow*<br/>
[in] Spécifie le nombre d’éléments à afficher dans chaque ligne de la galerie.

### <a name="remarks"></a>Notes

Utilisez cette méthode pour spécifier la largeur de la galerie du ruban.

##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip

Définit le texte d’info-bulle pour un élément dans la galerie.

```
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>Paramètres

*nItemIndex*<br/>
[in] Index de base zéro de l’élément de la palette à laquelle associer l’info-bulle.

*lpszToolTip*<br/>
[in] Le texte s’affiche sur l’info-bulle.

### <a name="remarks"></a>Notes

##  <a name="setpalette"></a>  CMFCRibbonGallery::SetPalette

Attache une palette dans une galerie de ruban.

```
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>Paramètres

*imagesPalette*<br/>
[in] Spécifie la liste d’images qui contient les icônes à afficher dans la galerie.

*uiImagesPaletteResID*<br/>
[in] Spécifie l’ID de ressource de la liste d’images qui contient les icônes à afficher dans la galerie.

*cxPaletteImage*<br/>
[in] Spécifie la largeur, en pixels, d’une image dans la galerie.

### <a name="remarks"></a>Notes

##  <a name="setpaletteid"></a>  CMFCRibbonGallery::SetPaletteID

Définit l’ID de commande qui est envoyé dans le message WM_COMMAND lorsqu’un utilisateur sélectionne un élément de la galerie.

```
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[in] Spécifie l’ID de commande qui est envoyé dans le message WM_COMMAND lorsqu’un utilisateur sélectionne un élément de la galerie.

### <a name="remarks"></a>Notes

Pour déterminer l’élément spécifique qu’un utilisateur sélectionnés à partir de la galerie, appelez le [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) méthode statique.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCRibbonButton, classe](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFCRibbonGalleryMenuButton, classe](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
