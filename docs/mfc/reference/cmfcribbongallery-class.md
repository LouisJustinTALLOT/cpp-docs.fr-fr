---
title: Classe CMFCRibbonGallery
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: f1ef68cba0012ad5b5d0eb6d3322acc6a1c6555c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375146"
---
# <a name="cmfcribbongallery-class"></a>Classe CMFCRibbonGallery

Implémente les galeries de ruban de style Office 2007.
Pour plus de détails, consultez le code source situé dans le dossier **VC\\\\atlmfc src\\mfc** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```cpp
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|Construit et initialise un objet `CMFCRibbonGallery`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::AddGroup](#addgroup)|Ajoute un nouveau groupe à la galerie.|
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|Ajoute un nouvel élément de menu au menu de dépôt.|
|[CMFCRibbonGallery::Clair](#clear)|Efface le contenu de la galerie.|
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|Permet ou désactive la résizing du panneau de menu.|
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|Permet ou désactive la barre latérale à gauche du menu popup.|
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(Overrides [CMFCRibbonButton::GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).)|
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(Overrides [CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown).)|
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|Retourne le nom du groupe qui se trouve à l’index spécifié.|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|Retourne le nombre d’objets dans une rangée de la galerie de ruban.|
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|Retourne le texte de pointe qui est associé à un élément dans la galerie.|
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|Retourne l’index du dernier élément dans la galerie que l’utilisateur a choisi.|
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|Retourne l’ID de commande de la galerie actuelle.|
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(Overrides [CMFCRibbonButton::GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).)|
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(Overrides [CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).)|
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|Précise si la galerie est contenue dans un bouton de galerie.|
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|Précise si la resizing du menu est activée ou désactivée.|
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|Précise si la barre latérale est activée ou désactivée.|
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(Substitue `CMFCRibbonButton::OnAfterChangeRect`.)|
|[CMFCRibbonGallery::OnDraw](#ondraw)|(Overrides [CMFCRibbonButton::OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).)|
|[CMFCRibbonGallery::OnEnable](#onenable)|(Substitue `CMFCRibbonBaseElement::OnEnable`.)|
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(Overrides [CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).)|
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|Redessiner la galerie.|
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|Supprime les outils de tous les articles de la galerie.|
|[CMFCRibbonGallery::SelectItem](#selectitem)||
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(Overrides [CMFCRibbonButton::SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).)|
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|Précise s’il faut afficher la galerie de rubans comme un bouton de chute ou comme une palette directement sur le ruban.|
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|Définit le nom d’un groupe.|
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|Définit le nombre d’articles par rangée dans la galerie.|
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|Définit le texte de la pointe d’outil pour un article dans la galerie.|
|[CMFCRibbonGallery::SetPalette](#setpalette)|Attache une palette à une galerie de rubans.|
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|Définit l’ID de commande qui est envoyé dans le WM_COMMAND message lorsqu’un élément de galerie a été sélectionné.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|Appelé par le cadre quand une icône de galerie est dessinée.|

## <a name="remarks"></a>Notes

Un bouton de galerie se comporte comme un bouton de menu régulier, sauf qu’il affiche une galerie quand un utilisateur l’ouvre. Lorsque vous sélectionnez un élément dans une galerie, le cadre envoie le message WM_COMMAND ainsi que l’ID de commande du bouton. Lorsque vous gérez le message, vous devez appeler [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) pour déterminer quel élément a été sélectionné à partir de la galerie.

## <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser `CMFCRibbonGallery` différentes méthodes `CMFCRibbonGallery` dans la classe pour configurer un objet. L’exemple illustre comment spécifier le nombre d’articles par rangée dans la galerie, permettre la redimensionnement du panneau de menu, activer la barre latérale à gauche du menu pop-up, et afficher la galerie ruban comme une palette directement sur la barre de ruban. Cet extrait de code fait partie de l’ [exemple Draw Client](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)\
&nbsp;[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>Spécifications

**En-tête:** afxRibbonPaletteGallery.h

## <a name="cmfcribbongalleryaddgroup"></a><a name="addgroup"></a>CMFCRibbonGallery::AddGroup

Ajoute un nouveau groupe à la galerie.

```cpp
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>Paramètres

*lpszGroupName (en anglais)*<br/>
[dans] Précise le nom du groupe.

*uiImagesPaletteResID*<br/>
[dans] Spécifie l’ID de ressources de la liste d’images qui contient les images pour le groupe.

*cxPaletteImage*<br/>
[dans] Spécifie la largeur des pixels d’une image.

*imagesGroup*<br/>
[dans] Une référence à la liste d’images qui contient des images de groupe.

*nIconsNum (en)*<br/>
[dans] Spécifie le nombre d’icônes dans le groupe. Ce paramètre ne doit être spécifié que pour les groupes personnalisés (dessinés par le propriétaire).

### <a name="remarks"></a>Notes

Vous pouvez diviser les éléments sur une galerie de ruban en plusieurs groupes en appelant cette méthode. Chaque groupe peut avoir une légende.

## <a name="cmfcribbongalleryaddsubitem"></a><a name="addsubitem"></a>CMFCRibbonGallery::AddSubItem

Ajoute un nouvel élément de menu au menu de dépôt.

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>Paramètres

*pSubItem (en)*<br/>
[dans] Un pointeur à l’élément à ajouter au menu.

*nIndex*<br/>
[dans] Spécifie l’index zéro d’un emplacement où insérer l’élément.

*bOnTop*<br/>
[dans] VRAI pour spécifier que l’article doit être inséré avant la galerie de ruban; autrement, FALSE.

### <a name="remarks"></a>Notes

Vous pouvez combiner des galeries popup avec des éléments de menu popup en appelant cette méthode. Les éléments du menu peuvent être placés avant ou après la galerie.

Pour insérer l’article avant la galerie, définissez *bOnTop* à TRUE. Définissez *bOnTop* à FALSE pour insérer l’élément sous la galerie.

> [!NOTE]
> Le paramètre *nIndex* spécifie l’indice d’insertion à la fois en haut de la galerie et au bas de la galerie. Par exemple, si vous avez besoin d’insérer un élément une position avant la galerie, définissez *nIndex* à 1 et *bOnTop* à TRUE. De même, si vous avez besoin d’insérer un élément une position en dessous de la galerie, définissez *nIndex* à 1 et *bOnTop* à FALSE.

## <a name="cmfcribbongalleryclear"></a><a name="clear"></a>CMFCRibbonGallery::Clair

Efface le contenu de la galerie.

```cpp
virtual void Clear();
```

### <a name="remarks"></a>Notes

Appelez cette méthode pour supprimer tout le contenu de la galerie de ruban. Cela doit être fait avant d’attacher une nouvelle galerie de ruban ou un ensemble de groupes à la galerie de ruban.

## <a name="cmfcribbongallerycmfcribbongallery"></a><a name="cmfcribbongallery"></a>CMFCRibbonGallery::CMFCRibbonGallery

Construit et initialise un objet [CMFCRibbonGallery.](../../mfc/reference/cmfcribbongallery-class.md)

```cpp
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Spécifie l’ID de commande de la commande à exécuter lorsqu’un utilisateur clique sur le bouton.

*lpszText*<br/>
Spécifie le texte pour apparaître sur le bouton.

*nSmallImageIndex*<br/>
L’index zéro de la petite image à apparaître sur le bouton.

*nLargeImageIndex*<br/>
L’index zéro de la grande image à apparaître sur le bouton.

*imagesPalette*<br/>
Une référence à l’objet [CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) qui contient les images à apparaître sur la galerie.

*uiImagesPaletteResID*<br/>
L’ID de ressource de la liste des images à afficher sur la galerie.

*cxPaletteImage*<br/>
Spécifie la largeur, en pixels, de l’image sur la galerie.

*tailleIcon*<br/>
Spécifie la taille, en pixels, de l’image de la galerie.

*nIconsNum (en)*<br/>
Spécifie le nombre d’icônes dans la galerie.

*bDefaultButtonStyle (en)*<br/>
Précise s’il faut utiliser le modèle par défaut ou le bouton tiré par le propriétaire.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryenablemenuresize"></a><a name="enablemenuresize"></a>CMFCRibbonGallery::EnableMenuResize

Permet ou désactive la résizing du panneau de menu.

```cpp
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour permettre la resizing du menu; autrement, FALSE.

*bVertcalOnly*<br/>
[dans] VRAI pour spécifier que la galerie ne peut être resized que verticalement; FALSE pour spécifier que la galerie peut être resized verticalement et horizontalement.

### <a name="remarks"></a>Notes

Utilisez cette méthode pour activer ou désactiver la refonte de la galerie de ruban. Lors de la resizing est activée, la galerie ruban affiche une pincement qu’un utilisateur peut utiliser pour le resize.

## <a name="cmfcribbongalleryenablemenusidebar"></a><a name="enablemenusidebar"></a>CMFCRibbonGallery::EnableMenuSideBar

Permet ou désactive la barre latérale à gauche du menu popup.

```cpp
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour spécifier que la barre latérale est activée; autrement, FALSE.

### <a name="remarks"></a>Notes

Appelez cette méthode pour activer ou désactiver la barre latérale de style Office XP sur le côté gauche du menu.

## <a name="cmfcribbongallerygetcompactsize"></a><a name="getcompactsize"></a>CMFCRibbonGallery::GetCompactSize

```cpp
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetdroppeddown"></a><a name="getdroppeddown"></a>CMFCRibbonGallery::GetDroppedDown

```cpp
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetgroupname"></a><a name="getgroupname"></a>CMFCRibbonGallery::GetGroupName

Retourne le nom du groupe qui se trouve à l’index spécifié.

```cpp
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>Paramètres

*nGroupIndex (en anglais)*<br/>
[dans] Spécifie l’indice zéro pour le groupe dont vous souhaitez récupérer le nom.

### <a name="return-value"></a>Valeur de retour

Le nom du groupe situé à l’index spécifié. L’adoption d’un indice invalide entraînera un échec de l’affirmation.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetgroupoffset"></a><a name="getgroupoffset"></a>CMFCRibbonGallery::GetGroupOffset

```cpp
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygeticonsinrow"></a><a name="geticonsinrow"></a>CMFCRibbonGallery::GetIconsInRow

Retourne le nombre d’objets dans une rangée de la galerie de ruban.

```cpp
int GetIconsInRow() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’articles d’affilée.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetitemtooltip"></a><a name="getitemtooltip"></a>CMFCRibbonGallery::GetItemToolTip

Retourne le texte de pointe qui est associé à un élément dans la galerie.

```cpp
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>Paramètres

*nItemIndex*<br/>
[dans] Spécifie l’index zéro de l’élément pour lequel récupérer le texte de la pointe d’outil.

### <a name="return-value"></a>Valeur de retour

Un pointeur à la chaîne de pointe assignée à un élément dans la galerie de ruban. Il peut être NULL si aucun tooltip n’est affecté à cet élément.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetlastselecteditem"></a><a name="getlastselecteditem"></a>CMFCRibbonGallery::GetLastSelectedItem

Retourne l’index du dernier élément dans la galerie de ruban que l’utilisateur a sélectionnée.

```cpp
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>Paramètres

*uiCmdID*<br/>
[dans] Précise l’ID de commande de l’élément du menu qui a ouvert la galerie de ruban.

### <a name="return-value"></a>Valeur de retour

Lorsque l’utilisateur sélectionne n’importe quel élément dans la galerie de ruban, la bibliothèque envoie le message WM_COMMAND ainsi que l’ID de commande du bouton de menu qui a ouvert la galerie de ruban.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetpaletteid"></a><a name="getpaletteid"></a>CMFCRibbonGallery::GetPaletteID

Retourne l’ID de commande de la palette actuelle.

```cpp
int GetPaletteID() const;
```

### <a name="return-value"></a>Valeur de retour

L’ID de commande de la palette actuellement sélectionnée.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetregularsize"></a><a name="getregularsize"></a>CMFCRibbonGallery::GetRegularSize

```cpp
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerygetselecteditem"></a><a name="getselecteditem"></a>CMFCRibbonGallery::GetSelectedItem

```cpp
int GetSelectedItem() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryhasmenu"></a><a name="hasmenu"></a>CMFCRibbonGallery::HasMenu

```cpp
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryisbuttonmode"></a><a name="isbuttonmode"></a>CMFCRibbonGallery::IsButtonMode

Précise si la palette est contenue dans un bouton de galerie.

```cpp
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la palette est affichée sous forme de bouton de menu déroulant; FALSE si la palette est affichée directement sur le ruban.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryismenuresizeenabled"></a><a name="ismenuresizeenabled"></a>CMFCRibbonGallery::IsMenuResizeEnabled

Précise si la resizing du menu est activée.

```cpp
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la resizing du menu a été activée; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryismenuresizevertical"></a><a name="ismenuresizevertical"></a>CMFCRibbonGallery::IsMenuResizeVertical

```cpp
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryismenusidebar"></a><a name="ismenusidebar"></a>CMFCRibbonGallery::IsMenuSideBar

Précise si la barre latérale est activée ou désactivée.

```cpp
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si la barre latérale de style Office XP est dessinée sur le côté gauche du menu popup; autrement, FALSE.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryonafterchangerect"></a><a name="onafterchangerect"></a>CMFCRibbonGallery::OnAfterChangeRect

```cpp
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryondraw"></a><a name="ondraw"></a>CMFCRibbonGallery::OnDraw

```cpp
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Paramètres

[dans] *pDC (pDC)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryondrawpaletteicon"></a><a name="ondrawpaletteicon"></a>CMFCRibbonGallery::OnDrawPaletteIcon

Appelé par le cadre quand une icône de galerie est dessinée.

```cpp
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
[dans] Un pointeur sur le contexte de l’appareil qui est utilisé pour le dessin.

*rectIcon*<br/>
[dans] Spécifie le rectangle de délimitation de l’icône à dessiner.

*nIconIndex*<br/>
[dans] Spécifie l’index zéro dans la liste d’images des icônes de la galerie de l’icône à dessiner.

*Picon*<br/>
[dans] Un pointeur à l’icône étant tirée.

*clrText*<br/>
[dans] Spécifie la couleur du texte de l’élément à dessiner.

### <a name="remarks"></a>Notes

Vous pouvez remplacer cette méthode dans une classe dérivée pour personnaliser l’apparence d’une galerie de ruban.

## <a name="cmfcribbongalleryonenable"></a><a name="onenable"></a>CMFCRibbonGallery::OnEnable

```cpp
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>Paramètres

[dans] *bEnable*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryonrtlchanged"></a><a name="onrtlchanged"></a>CMFCRibbonGallery::OnRTLChanged

```cpp
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>Paramètres

[dans] *bIsRTL (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryredrawicons"></a><a name="redrawicons"></a>CMFCRibbonGallery::RedrawIcons

Redessiner la galerie.

```cpp
void RedrawIcons();
```

### <a name="remarks"></a>Notes

Appelez cette fonction pour redessiner la galerie. Vous devez appeler cette méthode si vous avez changé le contenu de la galerie à l’heure de l’exécution.

## <a name="cmfcribbongalleryremoveitemtooltips"></a><a name="removeitemtooltips"></a>CMFCRibbonGallery::RemoveItemToolTips

Supprime les outils de tous les articles de la galerie.

```cpp
void RemoveItemToolTips();
```

### <a name="remarks"></a>Notes

## <a name="cmfcribbongalleryselectitem"></a><a name="selectitem"></a>CMFCRibbonGallery::SelectItem

```cpp
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>Paramètres

[dans] *nItemIndex*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerysetaccdata"></a><a name="setaccdata"></a>CMFCRibbonGallery::SetACCData

Remplit l’objet `CAccessibilityData` spécifié avec des données d’accessibilité à partir de la galerie du ruban.

```cpp
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Paramètres

*pParent*<br/>
[dans] La fenêtre parente de la fenêtre de la galerie de ruban.

*data*<br/>
[out] Un `CAccessibilityData` objet qui reçoit les données d’accessibilité de la galerie de ruban.

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

VRAI si la méthode est réussie; autrement, FALSE.

## <a name="cmfcribbongallerysetbuttonmode"></a><a name="setbuttonmode"></a>CMFCRibbonGallery::SetButtonMode

Détermine s’il faut afficher la galerie de rubans comme un bouton de dépôt ou comme une palette directement sur le ruban.

```cpp
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] VRAI pour afficher la galerie de ruban comme un bouton de menu de décrochage; FALSE pour afficher le contenu de la galerie de ruban directement sur le ruban.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerysetgroupname"></a><a name="setgroupname"></a>CMFCRibbonGallery::SetGroupName

Définit le nom d’un groupe.

```cpp
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>Paramètres

*nGroupIndex (en anglais)*<br/>
[dans] Spécifie l’indice zéro pour le groupe pour lequel le nom est en cours de modification.

*lpszGroupName (en anglais)*<br/>
[dans] Spécifie le nouveau nom du groupe.

### <a name="remarks"></a>Notes

Le groupe dont le nom est changé doit avoir été ajouté à l’aide de la méthode [CMFCRibbonGallery::AddGroup](#addgroup) méthode.

## <a name="cmfcribbongalleryseticonsinrow"></a><a name="seticonsinrow"></a>CMFCRibbonGallery::SetIconsInRow

Spécifie le nombre d’objets par rangée dans la galerie.

```cpp
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>Paramètres

*nIconsInRow (en)*<br/>
[dans] Précise le nombre d’objets à apparaître dans chaque rangée de la galerie.

### <a name="remarks"></a>Notes

Utilisez cette méthode pour spécifier la largeur de la galerie de ruban.

## <a name="cmfcribbongallerysetitemtooltip"></a><a name="setitemtooltip"></a>CMFCRibbonGallery::SetItemToolTip

Définit le texte de la pointe d’outil pour un article dans la galerie.

```cpp
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>Paramètres

*nItemIndex*<br/>
[dans] L’index zéro de l’élément palette avec lequel associer le bout d’outil.

*lpszToolTip*<br/>
[dans] Le texte à apparaître sur le bout d’outil.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerysetpalette"></a><a name="setpalette"></a>CMFCRibbonGallery::SetPalette

Attache une palette à une galerie de rubans.

```cpp
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>Paramètres

*imagesPalette*<br/>
[dans] Spécifie la liste d’images qui contient les icônes à apparaître sur la galerie.

*uiImagesPaletteResID*<br/>
[dans] Spécifie l’ID de ressources de la liste d’images qui contient les icônes à apparaître sur la galerie.

*cxPaletteImage*<br/>
[dans] Spécifie la largeur, en pixels, d’une image sur la galerie.

### <a name="remarks"></a>Notes

## <a name="cmfcribbongallerysetpaletteid"></a><a name="setpaletteid"></a>CMFCRibbonGallery::SetPaletteID

Définit l’ID de commande qui est envoyé dans le message WM_COMMAND lorsqu’un utilisateur sélectionne un élément de galerie.

```cpp
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] Spécifie l’ID de commande qui est envoyé dans le WM_COMMAND message lorsqu’un utilisateur sélectionne un élément de galerie.

### <a name="remarks"></a>Notes

Pour déterminer l’élément spécifique qu’un utilisateur a choisi à partir de la galerie, appelez la [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) méthode statique.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCRibbonButton, classe](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFCRibbonGalleryMenuButton, classe](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
