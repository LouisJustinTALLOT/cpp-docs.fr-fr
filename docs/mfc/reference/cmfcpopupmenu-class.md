---
title: Classe de CMFCPopupMenu | Documents Microsoft
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
dev_langs: C++
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
caps.latest.revision: "40"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 36057304130150dbd12cf33f708d1d82cd52e0c4
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/24/2017
---
# <a name="cmfcpopupmenu-class"></a>Classe de CMFCPopupMenu
Implémente les fonctionnalités de menu contextuel Windows et les étend en ajoutant des fonctionnalités telles que des menus volants et des info-bulles.
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]    
  
## <a name="syntax"></a>Syntaxe  
  
```  
class CMFCPopupMenu : public CMiniFrameWnd  
```  
  
## <a name="members"></a>Membres  
  
### <a name="protected-constructors"></a>Constructeurs protégés  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|Construit un objet `CMFCPopupMenu`.|  
  
### <a name="public-methods"></a>M&#233;thodes publiques  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||  
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|Définit si un menu contextuel est activé pour afficher les entrées vides pour les outils définis par l’utilisateur.|  
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||  
|[CMFCPopupMenu::CheckArea](#checkarea)|Détermine l’emplacement d’un point par rapport à la liste déroulante.|  
|[CMFCPopupMenu::CloseMenu](#closemenu)||  
|[CMFCPopupMenu::Create](#create)|Crée un menu contextuel et l’attache à le `CMFCPopupMenu` objet.|  
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||  
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|Initialise le logo d’un menu contextuel.|  
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|Active le son de menu.|  
|[CMFCPopupMenu::EnableResize](#enableresize)||  
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||  
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||  
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||  
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|Retourne le menu actif.|  
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|Retourne la vitesse d’animation des menus contextuels.|  
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|Retourne le type actuel de l’animation de menu contextuel.|  
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||  
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|Indique si le focus est retourné au menu barre quand un menu contextuel s’affiche.|  
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||  
|[CMFCPopupMenu::GetHMenu](#gethmenu)|Retourne un handle vers la ressource de menu attaché.|  
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) incorporé dans le menu contextuel.|  
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|Retourne un pointeur vers l’élément de menu à l’index spécifié.|  
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|Retourne le nombre d’éléments dans un menu contextuel.|  
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|Retourne un pointeur vers la fenêtre dans laquelle le framework achemine les messages de menu contextuel.|  
|[CMFCPopupMenu::GetParentArea](#getparentarea)||  
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|Retourne un pointeur vers le bouton de barre d’outils parente.|  
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|Retourne un pointeur vers le menu contextuel parent.|  
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||  
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|Retourne un pointeur vers la barre d’outils parente.|  
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||  
|[CMFCPopupMenu::GetSelItem](#getselitem)|Retourne un pointeur vers la commande de menu actuellement sélectionné.|  
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||  
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|Indique si le menu contextuel peut masquer les commandes rarement utilisées.|  
|[CMFCPopupMenu::InCommand](#incommand)||  
|[CMFCPopupMenu::InsertItem](#insertitem)|Insère un nouvel élément dans le menu contextuel à l’emplacement spécifié.|  
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|Insère un séparateur dans le menu contextuel à l’emplacement spécifié.|  
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||  
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||  
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|Indique si le menu contextuel fonctionne comme un **QuickCustomizePane**.|  
|[CMFCPopupMenu::IsEscClose](#isescclose)||  
|[CMFCPopupMenu::IsIdle](#isidle)|Indique si un menu contextuel est actuellement inactif.|  
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||  
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|Détermine si le texte associé [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md) est en mode de QuickCustomize.|  
|[CMFCPopupMenu::IsResizeble](#isresizeble)||  
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|Indique si le menu est aligné à droite ou aligné à gauche.|  
|[CMFCPopupMenu::IsScrollable](#isscrollable)||  
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|Indique si le framework informe le frame parent lorsque l’utilisateur sélectionne une commande dans le menu contextuel.|  
|[CMFCPopupMenu::IsShown](#isshown)|Indique si le menu contextuel est actuellement visible.|  
|[CMFCPopupMenu::MoveTo](#moveto)||  
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(Substitue `CFrameWnd::OnCmdMsg`.)|  
|[CMFCPopupMenu::PostCommand](#postcommand)||  
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|(Substitue `CFrameWnd::PreTranslateMessage`.)|  
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|Appelé par le framework lorsque les barres de contrôles standard sont activées ou désactivées ou lorsque la fenêtre frame est redimensionnée. (Substitue [CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|  
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|Efface tous les éléments dans un menu déroulant.|  
|[CMFCPopupMenu::RemoveItem](#removeitem)|Supprime l’élément spécifié à partir d’un menu contextuel.|  
|[CMFCPopupMenu::SaveState](#savestate)||  
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|Définit la vitesse d’animation des menus contextuels.|  
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|Définit le type de l’animation pour le menu contextuel.|  
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||  
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|Définit la commande par défaut pour le menu contextuel.|  
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|Force le focus d’entrée pour revenir au menu de la barre quand un menu contextuel s’affiche.|  
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|Force l’infrastructure pour dessiner les ombres menu contextuels s’affichent en dehors du cadre principal.|  
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|Définissez la largeur maximale pour le menu contextuel.|  
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||  
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||  
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||  
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||  
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|Définit l’alignement de menu pour les menus contextuels.|  
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|Définit un indicateur qui détermine si le menu contextuel informe son frame parent lorsque l’utilisateur sélectionne une commande.|  
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|Force le menu contextuel pour afficher toutes les commandes.|  
|[CMFCPopupMenu::TriggerResize](#triggerresize)||  
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|Met à jour les ombres pour tous les menus contextuels ouverts.|  
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|Met à jour de l’ombre de la liste déroulante.|  
  
### <a name="protected-methods"></a>Méthodes protégées  
  
|Nom|Description|  
|----------|-----------------|  
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||  
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||  
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||  
  
### <a name="remarks"></a>Remarques  
 Normalement, MFC crée automatiquement des menus contextuels. Si vous souhaitez créer un `CMFCPopupMenu` objet manuellement, allouez au moins un sur le tas, puis appelez [CMFCPopupMenu::Create](#create).  
  
## <a name="example"></a>Exemple  
 L’exemple suivant montre comment configurer un objet de menu contextuel. L’exemple montre comment définir le logo et le son du menu contextuel, la vitesse d’animation et le type, dessiner des ombres de menu lorsque le menu contextuel s’affiche en dehors du cadre principal, définissez la largeur maximale et l’alignement de menu à droite du menu contextuel. Cet extrait de code fait partie de la [exemple des Pages personnalisées](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CFrameWnd](../../mfc/reference/cframewnd-class.md)  
  
 [CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)  
  
 `CMFCPopupMenu`  
  
## <a name="requirements"></a>Spécifications  
 **En-tête :** afxpopupmenu.h  
  
##  <a name="activatepopupmenu"></a>CMFCPopupMenu::ActivatePopupMenu  

  
```  
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,  
    CMFCPopupMenu* pPopupMenu);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pTopFrame`  
 [in] `pPopupMenu`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="alwaysshowemptytoolsentry"></a>CMFCPopupMenu::AlwaysShowEmptyToolsEntry  
 Définit si un menu contextuel est activé pour afficher les entrées vides pour les outils définis par l’utilisateur.  
  
```  
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bShow`  
 `TRUE`Si le menu contextuel peut afficher des entrées vides ; `FALSE` dans le cas contraire.  
  
##  <a name="areallcommandsshown"></a>CMFCPopupMenu::AreAllCommandsShown  

  
```  
BOOL AreAllCommandsShown() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="checkarea"></a>CMFCPopupMenu::CheckArea  
 Détermine l’emplacement d’un point par rapport à la liste déroulante.  
  
```  
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `ptScreen`  
 Un point, en coordonnées d’écran.  
  
### <a name="return-value"></a>Valeur de retour  
 Un paramètre MENUAREA_TYPE qui indique où le point est relatif à la liste déroulante.  
  
### <a name="remarks"></a>Remarques  
 Un paramètre MENUAREA_TYPE peut avoir l’une des valeurs suivantes.  
  
-   EXTÉRIEUR - `ptScreen` est en dehors de la liste déroulante.  
  
-   LOGO - `ptScreen` se trouve sur une zone de logo.  
  
-   TEAROFF_CAPTION - `ptScreen` sur la légende détachable.  
  
-   SHADOW_BOTTOM - `ptScreen` est sur l’ombre en bas du menu contextuel.  
  
-   SHADOW_RIGHT - `ptScreen` est sur l’ombre à droite du menu contextuel.  
  
-   MENU - `ptScreen` sur une commande.  
  
##  <a name="closemenu"></a>CMFCPopupMenu::CloseMenu  

  
```  
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bSetFocusToBar`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="cmfcpopupmenu"></a>CMFCPopupMenu::CMFCPopupMenu  
 Construit un [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) objet.  
  
```  
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,  
    LPCTSTR lpszTitle);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pCustPage`  
 Pointeur vers une page de personnalisation.  
  
 [in] `lpszTitle`  
 Chaîne qui contient la légende de menu.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode alloue les ressources pour un `CMFCPopupMenu`. Pour créer l’élément de menu contextuel, appelez [CMFCPopupMenu::Create](#create).  
  
##  <a name="create"></a>CMFCPopupMenu::Create  
 Crée un menu contextuel et l’attache à un [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) objet.  
  
```  
virtual BOOL Create(
    CWnd* pWndParent,  
    int x,  
    int y,  
    HMENU hMenu,  
    BOOL bLocked = FALSE,  
    BOOL bOwnMessage = FALSE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWndParent`  
 La fenêtre parente de la `CMFCPopupMenu`.  
  
 [in] `x`  
 Coordonnée d’écran horizontale pour l’emplacement du menu contextuel  
  
 [in] `y`  
 Coordonnée d’écran verticale de l’emplacement du menu contextuel.  
  
 [in] `hMenu`  
 Handle vers une ressource de menu.  
  
 [in] `bLocked`  
 Un paramètre booléen qui indique si le menu est personnalisable. `FALSE`Indique que le menu contextuel est personnalisable.  
  
 [in] `bOwnMessage`  
 Un paramètre booléen qui indique comment le framework achemine les messages de menu. Consultez la section Notes pour plus de détails.  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si la méthode a réussi ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Si `bOwnMessage` est `TRUE`, le framework achemine les messages de menu à `pWndParent`. `pWndParent`ne doit pas être `NULL` si `bOwnMessage` est `TRUE.` si `bOwnMessage` est `FALSE`, le framework achemine les messages de menu au menu contextuel parent.  
  
### <a name="example"></a>Exemple  
 L’exemple suivant montre comment utiliser le `Create` méthode de la `CMFCPopuMenu` classe. Cet extrait de code fait partie de la [exemple des Pages personnalisées](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]  
  
##  <a name="createtearoffbar"></a>CMFCPopupMenu::CreateTearOffBar  

  
```  
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,  
    UINT uiID,  
    LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pWndMain`  
 [in] `uiID`  
 [in] `lpszName`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="defaultmouseclickonclose"></a>CMFCPopupMenu::DefaultMouseClickOnClose  

  
```  
virtual BOOL DefaultMouseClickOnClose() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="enablemenulogo"></a>CMFCPopupMenu::EnableMenuLogo  
 Initialise le logo d’un menu contextuel.  
  
```  
void EnableMenuLogo(
    int iLogoSize,  
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iLogoSize`  
 La taille du logo, en pixels.  
  
 [in] `nLogoLocation`  
 Type de données énuméré qui indique l’emplacement du logo.  
  
### <a name="remarks"></a>Remarques  
 Pour afficher le logo, implémentez la méthode [CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) dans la fenêtre frame principale.  
  
 Les valeurs possibles pour `nLogoLocation` sont MENU_LOGO_LEFT, MENU_LOGO_RIGHT, MENU_LOGO_TOP et MENU_LOGO_BOTTOM.  
  
##  <a name="enablemenusound"></a>CMFCPopupMenu::EnableMenuSound  
 Active le son de menu.  
  
```  
static void EnableMenuSound(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bEnable`  
 `TRUE`Pour activer le son, `FALSE` dans le cas contraire.  
  
### <a name="remarks"></a>Remarques  
 Si vous activez le son, l’infrastructure appelle la [PlaySound](http://msdn.microsoft.com/library/windows/desktop/bb774426) méthode lorsqu’un utilisateur ouvre un menu contextuel ou sélectionne une commande de menu. Par défaut, cette fonctionnalité est activée.  
  
##  <a name="enableresize"></a>CMFCPopupMenu::EnableResize  

  
```  
void EnableResize(CSize sizeMinResize);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `sizeMinResize`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="enablescrolling"></a>CMFCPopupMenu::EnableScrolling  

  
```  
void EnableScrolling(BOOL = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `BOOL`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="enablevertresize"></a>CMFCPopupMenu::EnableVertResize  

  
```  
void EnableVertResize(int nMinResize);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `nMinResize`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="findsubitembycommand"></a>CMFCPopupMenu::FindSubItemByCommand  

  
```  
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `uiCmd`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="getactivemenu"></a>CMFCPopupMenu::GetActiveMenu  
 Retourne le menu actif.  
  
```  
static CMFCPopupMenu* GetActiveMenu();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers le menu contextuel actif, ou NULL si aucun menu contextuel n’est actuellement actif.  
  
### <a name="remarks"></a>Remarques  
 Chaque application peut avoir au plus un menu contextuel actif.  
  
##  <a name="getanimationspeed"></a>CMFCPopupMenu::GetAnimationSpeed  
 Retourne la vitesse d’animation des menus contextuels.  
  
```  
static UINT GetAnimationSpeed();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Entier qui indique la durée, en millisecondes, d’une animation de menu contextuel prend fin.  
  
### <a name="remarks"></a>Remarques  
 La vitesse d’animation est une valeur globale. Utilisez [CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed) pour modifier la vitesse d’animation des menus contextuels.  
  
##  <a name="getanimationtype"></a>CMFCPopupMenu::GetAnimationType  
 Retourne le type en cours d’animation contextuelle.  
  
```  
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bNoSystem`  
 Un paramètre booléen qui indique si cette méthode vérifie la valeur globale. FALSE si vous souhaitez que cette méthode retourne le style d’animation pour cette instance de la [CMFCPopupMenu classe](../../mfc/reference/cmfcpopupmenu-class.md).  
  
### <a name="return-value"></a>Valeur de retour  
 Valeur énumérée qui décrit le type de l’animation.  
  
### <a name="remarks"></a>Remarques  
 Le style d’animation des menus contextuels est global pour votre application. Utilisez [CMFCPopupMenu::SetAnimationType](#setanimationtype) pour définir le style d’animation.  
  
 Le tableau suivant répertorie les types possibles d’animation.  
  
 NO_ANIMATION  
 Le menu contextuel n’est pas animé et apparaît immédiatement.  
  
 DÉROULER  
 Le framework fait apparaître le menu contextuel à partir de l’angle supérieur gauche de l’angle inférieur droit.  
  
 FAITES GLISSER  
 Le menu contextuel déplace de haut en bas.  
  
 ATTÉNUATION  
 Le menu contextuel s’affiche d’abord transparent et solidification progressivement.  
  
##  <a name="getdropdirection"></a>CMFCPopupMenu::GetDropDirection  

  
```  
DROP_DIRECTION GetDropDirection() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="getforcemenufocus"></a>CMFCPopupMenu::GetForceMenuFocus  
 Indique si le focus est retourné au menu barre quand un menu contextuel s’affiche.  
  
```  
static BOOL GetForceMenuFocus();
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le focus d’entrée est renvoyé à la barre de menus quand un menu contextuel s’affiche. `FALSE` si le menu contextuel conserve le focus.  
  
### <a name="remarks"></a>Remarques  
 Par défaut, votre application ne retourne pas le focus à la barre de menus. Pour modifier ce paramètre, utilisez [CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus).  
  
##  <a name="getforceshadow"></a>CMFCPopupMenu::GetForceShadow  

  
```  
static BOOL __stdcall GetForceShadow();
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="gethmenu"></a>CMFCPopupMenu::GetHMenu  
 Retourne un handle vers la ressource de menu attaché.  
  
```  
HMENU GetHMenu();
```  
  
##  <a name="getmenubar"></a>CMFCPopupMenu::GetMenuBar  
 Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) incorporé dans le menu contextuel.  
  
```  
virtual CMFCPopupMenuBar* GetMenuBar();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers l’embedded `CMFCPopupMenuBar`.  
  
### <a name="remarks"></a>Remarques  
 Le menu contextuel a incorporé `CMFCPopupMenuBar` objet. Vous devez substituer cette méthode dans une classe dérivée si vous utilisez une autre classe incorporée.  
  
##  <a name="getmenuitem"></a>CMFCPopupMenu::GetMenuItem  
 Retourne un pointeur vers l’élément de menu à l’index spécifié.  
  
```  
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;  
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iIndex`  
 Index de base zéro d’un élément de menu.  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers un élément de menu. `NULL`Si l’index n’est pas valide.  
  
### <a name="remarks"></a>Remarques  
 Éléments de menu sont représentés par le [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md). Lorsque vous appelez cette méthode, il retourne un pointeur vers le `CMFCToolBarMenuButton`.  
  
##  <a name="getmenuitemcount"></a>CMFCPopupMenu::GetMenuItemCount  
 Retourne le nombre d’éléments dans un menu contextuel.  
  
```  
int GetMenuItemCount() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Le nombre d’éléments dans le menu.  
  
##  <a name="getmessagewnd"></a>CMFCPopupMenu::GetMessageWnd  
 Retourne un pointeur vers la fenêtre dans laquelle le framework achemine les messages de menu contextuel.  
  
```  
CWnd* GetMessageWnd() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers la fenêtre qui reçoit les messages de menu contextuel ; `NULL` s’il n’existe pas de fenêtre.  
  
### <a name="remarks"></a>Remarques  
 Lorsque vous utilisez la méthode [CMFCPopupMenu::Create](#create) pour créer un menu contextuel, vous spécifiez quelle fenêtre reçoit les messages de menu.  
  
##  <a name="getparentarea"></a>CMFCPopupMenu::GetParentArea  

  
```  
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `rectParentBtn`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="getparentbutton"></a>CMFCPopupMenu::GetParentButton  
 Retourne un pointeur vers le bouton de barre d’outils parente.  
  
```  
CMFCToolBarMenuButton* GetParentButton() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers le bouton de barre d’outils parente. `NULL`Si le menu contextuel n’a aucun bouton de barre d’outils parente.  
  
### <a name="remarks"></a>Remarques  
 Un `CMFCPopupMenu` peut être associé à un bouton dans le menu. Dans ce scénario, le menu contextuel s’affiche lorsqu’un utilisateur sélectionne le bouton de barre d’outils parente.  
  
 Si le menu contextuel est un menu contextuel, il n’aura aucun bouton de barre d’outils parente.  
  
##  <a name="getparentpopupmenu"></a>CMFCPopupMenu::GetParentPopupMenu  
 Retourne un pointeur vers le menu contextuel parent.  
  
```  
CMFCPopupMenu* GetParentPopupMenu() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers le parent `CMFCPopupMenu` de l’objet ; `NULL` si aucun menu contextuel parent.  
  
### <a name="remarks"></a>Remarques  
 Un menu contextuel a un parent `CMFCPopupMenu` uniquement l’objet s’il s’agit d’un sous-menu.  
  
##  <a name="getparentribbonelement"></a>CMFCPopupMenu::GetParentRibbonElement  

  
```  
CMFCRibbonBaseElement* GetParentRibbonElement() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="getparenttoolbar"></a>CMFCPopupMenu::GetParentToolBar  
 Retourne un pointeur vers la barre d’outils parente.  
  
```  
CMFCToolBar* GetParentToolBar() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 Pointeur vers la barre d’outils parente. `NULL`Si le menu contextuel n’a aucune barre d’outils parente.  
  
### <a name="remarks"></a>Remarques  
 Si le `CMFCPopupMenu` est un menu contextuel, il n’a aucune barre d’outils parente.  
  
##  <a name="getquickcustomizetype"></a>CMFCPopupMenu::GetQuickCustomizeType  

  
```  
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="getselitem"></a>CMFCPopupMenu::GetSelItem  
 Retourne un pointeur vers la commande de menu actuellement sélectionné.  
  
```  
CMFCToolBarMenuButton* GetSelItem();
```  
  
### <a name="return-value"></a>Valeur de retour  
 Un pointeur vers la commande de menu actuellement sélectionné ; `NULL` si aucun élément n’est sélectionné.  
  
### <a name="remarks"></a>Remarques  
 Les commandes de menu dans un menu contextuel sont représentées par le [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md), ou une classe dérivée de `CMFCToolBarMenuButton`.  
  
##  <a name="hasbeenresized"></a>CMFCPopupMenu::HasBeenResized  

  
```  
BOOL HasBeenResized() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="hiderarelyusedcommands"></a>CMFCPopupMenu::HideRarelyUsedCommands  
 Indique si le menu contextuel peut masquer les commandes rarement utilisées.  
  
```  
BOOL HideRarelyUsedCommands() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le menu contextuel peut masquer les commandes rarement utilisés ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode spécifie uniquement si un menu contextuel peut masquer rarement commandes les plus utilisées, pas si cette configuration est activée. Un menu contextuel peut masquer les commandes rarement utilisées si elle a un bouton de parent et la fenêtre parente est dérivée de la [CMFCMenuBar classe](../../mfc/reference/cmfcmenubar-class.md). Utilisez [CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus) pour activer cette fonctionnalité et [CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus) pour déterminer si cette fonctionnalité est actuellement activée. Vous devez appeler ces deux méthodes pour la fenêtre parente.  
  
##  <a name="incommand"></a>CMFCPopupMenu::InCommand  

  
```  
virtual BOOL InCommand();
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="insertitem"></a>CMFCPopupMenu::InsertItem  
 Insère un nouvel élément dans le menu contextuel à l’emplacement spécifié.  
  
```  
int InsertItem(
    const CMFCToolBarMenuButton& button,  
    int iInsertA = -1);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `button`  
 Une référence à l’élément de menu à ajouter.  
  
 [in] `iInsertAt`  
 Index de base zéro pour le nouvel élément. Si `iInsertAt` est -1, l’élément est ajouté à la fin du menu.  
  
### <a name="return-value"></a>Valeur de retour  
 Index de base zéro de la position où l’élément a été inséré. -1 si la méthode échoue.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode échoue si vous fournissez une valeur non valide pour `iInsertAt`, par exemple un entier supérieur au nombre d’éléments actuellement dans le menu contextuel.  
  
##  <a name="insertseparator"></a>CMFCPopupMenu::InsertSeparator  
 Insère un séparateur dans le menu contextuel à l’emplacement spécifié.  
  
```  
int InsertSeparator(int iInsertAt = -1);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iInsertAt`  
 Index de base zéro de la position où cette méthode insère le séparateur.  
  
### <a name="return-value"></a>Valeur de retour  
 Index de base zéro de la position où le séparateur a été inséré. -1 si cette méthode échoue.  
  
### <a name="remarks"></a>Remarques  
 La valeur -1 pour `iInsertAt` signifie que cette méthode ajoute le séparateur à la fin du menu contextuel.  
  
 Cette méthode échoue si `iInsertAt` est une valeur non valide.  
  
##  <a name="isalwaysclose"></a>CMFCPopupMenu::IsAlwaysClose  

  
```  
virtual BOOL IsAlwaysClose() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="isalwaysshowemptytoolsentry"></a>CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry  

  
```  
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="iscustomizepane"></a>CMFCPopupMenu::IsCustomizePane  
 Indique si le menu contextuel fonctionne comme un **QuickCustomizePane**.  
  
```  
BOOL IsCustomizePane();
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si la fenêtre contextuelle est un **QuckCustomizePane**; sinon `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Utilisez le **QuickCustomizePane** pour permettre à l’utilisateur directement personnaliser le menu contextuel. Le **QuickCustomizePane** est un `CMFCPopupMenu` qui s’affiche lorsque l’utilisateur clique sur un bouton de barre d’outils pour la modifier directement.  
  
 Votre application doit appeler cette méthode pendant [CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane).  
  
##  <a name="isescclose"></a>CMFCPopupMenu::IsEscClose  

  
```  
BOOL IsEscClose();
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="isidle"></a>CMFCPopupMenu::IsIdle  
 Indique si un menu contextuel est actuellement inactif.  
  
```  
virtual BOOL IsIdle() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le menu contextuel est en mode inactif ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Par défaut, un menu contextuel est en mode inactif si l’animation d’affichage est terminée et que l’utilisateur n’est pas le défilement du menu contextuel.  
  
##  <a name="ismenusound"></a>CMFCPopupMenu::IsMenuSound  

  
```  
static UINT __stdcall IsMenuSound();
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="isquickcustomize"></a>CMFCPopupMenu::IsQuickCustomize  
 Détermine si le texte associé [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md) est en mode de QuickCustomize.  
  
```  
BOOL IsQuickCustomize();
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le bouton de menu associé est en mode de QuickCustomize ; dans le cas contraire `FALSE`. Cette méthode retourne également `FALSE` si le menu contextuel n’est pas associé avec un `CMFCToolBarMenuButton`.  
  
### <a name="remarks"></a>Remarques  
 Dans QuickCustomize mode, l’utilisateur sélectionne un bouton sur une barre d’outils pour personnaliser le bouton directement.  
  
##  <a name="isresizeble"></a>CMFCPopupMenu::IsResizeble  

  
```  
BOOL IsResizeble() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="isrightalign"></a>CMFCPopupMenu::IsRightAlign  
 Indique si le menu est aligné à droite ou aligné à gauche.  
  
```  
BOOL IsRightAlign() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le menu est aligné à droite ; `FALSE` si le menu à gauche.  
  
### <a name="remarks"></a>Remarques  
 Vous pouvez utiliser [CMFCPopupMenu::SetRightAlign](#setrightalign) pour définir l’alignement du menu. Par défaut, les menus contextuels utilisent alignement à gauche.  
  
 Alignement du menu n’est pas un paramètre global et peut varier entre les menus contextuels.  
  
##  <a name="isscrollable"></a>CMFCPopupMenu::IsScrollable  

  
```  
BOOL IsScrollable() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="issendmenuselectmsg"></a>CMFCPopupMenu::IsSendMenuSelectMsg  
 Indique si le framework informe le frame parent lorsque l’utilisateur sélectionne une commande dans le menu contextuel.  
  
```  
static BOOL IsSendMenuSelectMsg();
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si le framework informe le frame parent ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Le framework informe le frame parent en l’envoyant le `WM_MENUSELECT` message lorsque utilisée sélectionne une commande de menu.  
  
##  <a name="isshown"></a>CMFCPopupMenu::IsShown  
 Indique si le menu contextuel est actuellement visible.  
  
```  
BOOL IsShown() const;  
```  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si un menu contextuel est visible ; dans le cas contraire `FALSE`.  
  
##  <a name="moveto"></a>CMFCPopupMenu::MoveTo  

  
```  
void MoveTo(const CPoint& pt);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pt`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="onchangehot"></a>CMFCPopupMenu::OnChangeHot  

  
```  
virtual void OnChangeHot(int nHot);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `nHot`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="onchooseitem"></a>CMFCPopupMenu::OnChooseItem  

  
```  
virtual void OnChooseItem(UINT uidCmdID);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `uidCmdID`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="oncmdmsg"></a>CMFCPopupMenu::OnCmdMsg  

  
```  
virtual BOOL OnCmdMsg(
    UINT nID,  
    int nCode,  
    void* pExtra,  
    AFX_CMDHANDLERINFO* pHandlerInfo);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `nID`  
 [in] `nCode`  
 [in] `pExtra`  
 [in] `pHandlerInfo`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="postcommand"></a>CMFCPopupMenu::PostCommand  

  
```  
BOOL PostCommand(UINT uiCommandID);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `uiCommandID`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="pretranslatemessage"></a>CMFCPopupMenu::PreTranslateMessage  

  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pMsg`  
  
### <a name="return-value"></a>Valeur de retour  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="recalclayout"></a>CMFCPopupMenu::RecalcLayout  

  
```  
virtual void RecalcLayout(BOOL bNotify = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bNotify`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="removeallitems"></a>CMFCPopupMenu::RemoveAllItems  
 Efface tous les éléments dans un menu déroulant.  
  
```  
void RemoveAllItems();
```  
  
##  <a name="removeitem"></a>CMFCPopupMenu::RemoveItem  
 Supprime l’élément spécifié dans le menu contextuel.  
  
```  
BOOL RemoveItem(int iIndex);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iIndex`  
 Index de base zéro de l’élément à supprimer.  
  
### <a name="return-value"></a>Valeur de retour  
 `TRUE`Si la méthode a réussi ; dans le cas contraire `FALSE`.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode organise automatiquement les séparateurs sont affectées par la suppression d’un élément. Pour plus d’informations sur la façon dont le framework réorganise les séparateurs, consultez [CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton).  
  
##  <a name="savestate"></a>CMFCPopupMenu::SaveState  

  
```  
virtual void SaveState();
```  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setanimationspeed"></a>CMFCPopupMenu::SetAnimationSpeed  
 Définit la vitesse d’animation des menus contextuels.  
  
```  
static void SetAnimationSpeed(UINT nElapse);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `nElapse`  
 La nouvelle animation vitesse, en millisecondes.  
  
### <a name="remarks"></a>Remarques  
 La vitesse d’animation est une valeur globale et affecte tous les menus contextuels dans l’application. Cette valeur spécifie la durée de l’animation d’un menu contextuel terminer.  
  
 Par défaut, ce paramètre est défini sur 30 millisecondes. La plage des valeurs valides pour `nElapse` est comprise entre 0 et 200.  
  
##  <a name="setanimationtype"></a>CMFCPopupMenu::SetAnimationType  
 Définit le type de l’animation de ce menu contextuel.  
  
```  
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `type`  
 Type de données énuméré qui spécifie le type d’animation.  
  
### <a name="remarks"></a>Remarques  
 Consultez [CMFCPopupMenu::GetAnimationType](#getanimationtype) pour obtenir la liste des valeurs valides pour `type`.  
  
##  <a name="setautodestroy"></a>CMFCPopupMenu::SetAutoDestroy  

  
```  
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bAutoDestroy`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setdefaultitem"></a>CMFCPopupMenu::SetDefaultItem  
 Définit la commande par défaut pour le menu contextuel.  
  
```  
void SetDefaultItem(UINT uiCmd);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `uiCmd`  
 L’ID de commande de menu de la nouvelle commande par défaut.  
  
### <a name="remarks"></a>Remarques  
 La commande par défaut dans le menu contextuel est la commande qui est sélectionnée lorsque le menu contextuel s’affiche.  
  
##  <a name="setforcemenufocus"></a>CMFCPopupMenu::SetForceMenuFocus  
 Force le focus d’entrée pour revenir au menu de la barre quand un menu contextuel s’affiche.  
  
```  
static void SetForceMenuFocus(BOOL bValue);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bValue`  
 `TRUE`Si vous souhaitez que l’infrastructure pour forcer le focus d’entrée à la barre de menus quand un menu contextuel s’affiche. `FALSE`Si vous souhaitez que le menu contextuel pour conserver le focus.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode définit un indicateur qui est global pour tous les menus contextuels dans l’application. Par défaut, cette fonctionnalité n’est pas activée.  
  
##  <a name="setforceshadow"></a>CMFCPopupMenu::SetForceShadow  
 Force l’infrastructure pour dessiner les ombres menu contextuels s’affichent en dehors du cadre principal.  
  
```  
static void SetForceShadow(BOOL bValue);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bValue`  
 `TRUE`Si vous souhaitez que l’infrastructure pour dessiner les ombres du menu, `FALSE` dans le cas contraire.  
  
### <a name="remarks"></a>Remarques  
 Lorsque vous appelez cette méthode, il définit un indicateur global dans votre application. Cet indicateur affecte tous les menus contextuels dans votre application.  
  
##  <a name="setmaxwidth"></a>CMFCPopupMenu::SetMaxWidth  
 Définissez la largeur maximale pour le menu contextuel.  
  
```  
void SetMaxWidth(int iMaxWidth);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `iMaxWidth`  
 La largeur maximale pour le menu contextuel, en pixels.  
  
### <a name="remarks"></a>Remarques  
 Si le texte associé à une commande de menu ne tient pas dans la largeur maximale, elle est tronquée et la partie qui ne tient pas est remplacée par trois points.  
  
##  <a name="setmessagewnd"></a>CMFCPopupMenu::SetMessageWnd  

  
```  
void SetMessageWnd(CWnd* pMsgWnd);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pMsgWnd`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setparentribbonelement"></a>CMFCPopupMenu::SetParentRibbonElement  

  
```  
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `pElem`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setquickcustomizetype"></a>CMFCPopupMenu::SetQuickCustomizeType  

  
```  
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `Type`  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setquickmode"></a>CMFCPopupMenu::SetQuickMode  

  
```  
void SetQuickMode();
```  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="setrightalign"></a>CMFCPopupMenu::SetRightAlign  
 Définit l’alignement de menu pour les menus contextuels.  
  
```  
void SetRightAlign(BOOL bRightAlign = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bRightAlign`  
 Valeur booléenne qui indique l’alignement de menu. `TRUE`Indique l’alignement à droite, `FALSE` indique l’alignement à gauche.  
  
### <a name="remarks"></a>Remarques  
 Par défaut, tous les menus déroulants sont alignés à gauche.  
  
##  <a name="setsendmenuselectmsg"></a>CMFCPopupMenu::SetSendMenuSelectMsg  
 Définit un indicateur qui détermine si le menu contextuel informe son frame parent lorsque l’utilisateur sélectionne une commande.  
  
```  
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `bSet`  
 `TRUE`Si le menu contextuel informe son frame parent, `FALSE` dans le cas contraire.  
  
### <a name="remarks"></a>Remarques  
 Il s’agit d’une option globale pour tous les menus contextuels dans une application. S’il est activé, les menus contextuels enverra un `WM_MENUSELECT` message vers le frame parent lorsque l’utilisateur sélectionne une commande.  
  
##  <a name="showallcommands"></a>CMFCPopupMenu::ShowAllCommands  
 Force le menu contextuel pour afficher toutes les commandes.  
  
```  
void ShowAllCommands();
```  
  
### <a name="remarks"></a>Remarques  
 Cela n’est pas un paramètre global et affecte uniquement le menu contextuel en cours.  
  
##  <a name="triggerresize"></a>CMFCPopupMenu::TriggerResize  

  
```  
void TriggerResize();
```  
  
### <a name="remarks"></a>Remarques  
  
##  <a name="updateallshadows"></a>CMFCPopupMenu::UpdateAllShadows  
 Met à jour les ombres pour tous les menus contextuels ouverts.  
  
```  
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `lprectScreen`  
 Un rectangle qui spécifie la région de mise à jour, en coordonnées d’écran.  
  
### <a name="remarks"></a>Remarques  
 Cette méthode est utile lorsque les menus contextuels sont affichés sur les contrôles animées ou d’autres fenêtres qui ont un contenu dynamique.  
  
##  <a name="updateshadow"></a>CMFCPopupMenu::UpdateShadow  
 Met à jour de l’ombre de la liste déroulante.  
  
```  
void UpdateShadow(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>Paramètres  
 [in] `lprectScreen`  
 Un rectangle, en coordonnées d’écran, qui spécifie les limites de la région de mise à jour.  
  
### <a name="remarks"></a>Remarques  
 Appelez cette méthode lorsqu’un menu contextuel qui a une ombre chevauche une image animée.  
  
## <a name="see-also"></a>Voir aussi  
 [Graphique hiérarchique](../../mfc/hierarchy-chart.md)   
 [Classes](../../mfc/reference/mfc-classes.md)   
 [CMFCPopupMenuBar, classe](../../mfc/reference/cmfcpopupmenubar-class.md)
