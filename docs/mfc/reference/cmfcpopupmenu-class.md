---
title: CMFCPopupMenu, classe
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: 74f161d68c3c58574d75ab64a1360fc7f571920d
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81751934"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu, classe

Implémente les fonctionnalités de menu contextuel Windows et les étend en ajoutant des fonctionnalités telles que des menus volants et des info-bulles.
Pour plus de détails, consultez le code source situé dans le dossier **VC\\\\atlmfc src\\mfc** de votre installation Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>Membres

### <a name="protected-constructors"></a>Constructeurs protégés

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|Construit un objet `CMFCPopupMenu`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|Définit si un menu pop-up est activé pour afficher des entrées vides pour les outils définis par l’utilisateur.|
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu::CheckArea](#checkarea)|Détermine l’emplacement d’un point par rapport au menu pop-up.|
|[CMFCPopupMenu::CloseMenu](#closemenu)||
|[CMFCPopupMenu::Créer](#create)|Crée un menu pop-up et `CMFCPopupMenu` le fixe à l’objet.|
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|Initialise le logo d’un menu pop-up.|
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|Permet le son du menu.|
|[CMFCPopupMenu::EnableResize](#enableresize)||
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|Retourne le menu actuellement actif.|
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|Retourne la vitesse d’animation pour les menus pop-up.|
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|Retourne le type actuel d’animation de menu pop-up.|
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|Indique si l’accent est retourné à la barre de menu lorsqu’un menu pop-up est affiché.|
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu::GetHMenu](#gethmenu)|Retourne une poignée à la ressource de menu ci-joint.|
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) intégré dans le menu pop-up.|
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|Retourne un pointeur à l’élément de menu à l’index spécifié.|
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|Retourne le nombre d’articles dans un menu popup.|
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|Retourne un pointeur à la fenêtre où le cadre achemine les messages du menu pop-up.|
|[CMFCPopupMenu::GetParentArea](#getparentarea)||
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|Retourne un pointeur sur le bouton de la barre d’outils parent.|
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|Retourne un pointeur au menu pop-up parent.|
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|Retourne un pointeur à la barre d’outils parent.|
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||
|[CMFCPopupMenu::GetSelItem](#getselitem)|Retourne un pointeur à la commande de menu actuellement sélectionnée.|
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|Indique si le menu pop-up peut cacher les commandes rarement utilisées.|
|[CMFCPopupMenu::InCommand](#incommand)||
|[CMFCPopupMenu::InsertItem](#insertitem)|Insère un nouvel élément dans le menu pop-up à l’emplacement spécifié.|
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|Insère un séparateur dans le menu pop-up à l’emplacement spécifié.|
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|Indique si le menu pop-up fonctionne comme un **QuickCustomizePane**.|
|[CMFCPopupMenu::IsEscClose](#isescclose)||
|[CMFCPopupMenu::IsIdle](#isidle)|Indique si un menu pop-up est actuellement inactif.|
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|Détermine si la [classe CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md) associée est en mode QuickCustomize.|
|[CMFCPopupMenu::IsResizeble](#isresizeble)||
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|Indique si le menu est aligné à droite ou aligné à gauche.|
|[CMFCPopupMenu::IsScrollable](#isscrollable)||
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|Indique si le cadre informe le cadre parent lorsque l’utilisateur sélectionne une commande dans le menu pop-up.|
|[CMFCPopupMenu::IsShown](#isshown)|Indique si le menu pop-up est actuellement visible.|
|[CMFCPopupMenu::MoveTo](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(Substitue `CFrameWnd::OnCmdMsg`.)|
|[CMFCPopupMenu::PostCommand](#postcommand)||
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|(Substitue `CFrameWnd::PreTranslateMessage`.)|
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|Appelé par le cadre lorsque les barres de contrôle standard sont basculent sur ou hors ou lorsque la fenêtre de cadre est resized. (Overrides [CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|Efface tous les éléments d’un menu pop-up.|
|[CMFCPopupMenu::RemoveItem](#removeitem)|Supprime l’élément spécifié d’un menu pop-up.|
|[CMFCPopupMenu::SaveState](#savestate)||
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|Définit la vitesse d’animation pour les menus pop-up.|
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|Définit le type d’animation pour le menu pop-up.|
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|Définit la commande par défaut pour le menu pop-up.|
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|Force l’accent sur l’entrée pour revenir à la barre de menu lorsqu’un menu pop-up est affiché.|
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|Force le cadre à dessiner des ombres de menu lorsque des menus contextuels apparaissent en dehors du cadre principal.|
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|Réglez la largeur maximale pour le menu pop-up.|
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|Définit l’alignement du menu pour les menus contextuels.|
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|Définit un drapeau qui contrôle si le menu pop-up informe son cadre parent lorsque l’utilisateur sélectionne une commande.|
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|Force le menu pop-up à afficher tous les ordres.|
|[CMFCPopupMenu::TriggerResize](#triggerresize)||
|[CMFCPopupMenu::Mise à jourAllShadows](#updateallshadows)|Mise à jour des ombres pour tous les menus pop-up ouverts.|
|[CMFCPopupMenu::Mise à jourShadow](#updateshadow)|Mise à jour de l’ombre pour le menu pop-up.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||

### <a name="remarks"></a>Notes

Normalement, MFC crée automatiquement des menus pop-up. Si vous souhaitez `CMFCPopupMenu` créer un objet manuellement, allouez-en un sur le tas, puis appelez [CMFCPopupMenu::Créer](#create).

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un objet de menu pop-up. L’exemple montre comment définir le logo et le son du menu pop-up, définir la vitesse et le type d’animation, dessiner des ombres de menu lorsque le menu pop-up apparaît en dehors du cadre principal, définir la largeur maximale, et définir l’alignement du menu pop-up droit. Cet extrait de code fait partie de [l’échantillon de pages personnalisées](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>Spécifications

**En-tête:** afxpopupmenu.h

## <a name="cmfcpopupmenuactivatepopupmenu"></a><a name="activatepopupmenu"></a>CMFCPopupMenu::ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>Paramètres

[dans] *pTopFrame (en)*<br/>
[dans] *pPopupMenu*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenualwaysshowemptytoolsentry"></a><a name="alwaysshowemptytoolsentry"></a>CMFCPopupMenu::AlwaysShowEmptyToolsEntry

Définit si un menu pop-up est activé pour afficher des entrées vides pour les outils définis par l’utilisateur.

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>Paramètres

*bShow (en)*<br/>
[dans] VRAI si le menu pop-up peut afficher des entrées vides; FALSE autrement.

## <a name="cmfcpopupmenuareallcommandsshown"></a><a name="areallcommandsshown"></a>CMFCPopupMenu::AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenucheckarea"></a><a name="checkarea"></a>CMFCPopupMenu::CheckArea

Détermine l’emplacement d’un point par rapport au menu pop-up.

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>Paramètres

*pt Écran*<br/>
[dans] Un point, dans les coordonnées de l’écran.

### <a name="return-value"></a>Valeur de retour

Un MENUAREA_TYPE paramètre qui indique où le point est par rapport au menu pop-up.

### <a name="remarks"></a>Notes

Un paramètre MENUAREA_TYPE peut avoir l’une des valeurs suivantes.

- OUTSIDE - *ptScreen* est en dehors du menu pop-up.

- LOGO - *ptScreen* est sur une zone de logo.

- TEAROFF_CAPTION - *ptScreen* est au-dessus de la légende déchirante.

- SHADOW_BOTTOM - *ptScreen* est sur l’ombre inférieure du menu pop-up.

- SHADOW_RIGHT - *ptScreen* est sur l’ombre droite du menu pop-up.

- MENU - *ptScreen* est au-dessus d’une commande.

## <a name="cmfcpopupmenuclosemenu"></a><a name="closemenu"></a>CMFCPopupMenu::CloseMenu

```cpp
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>Paramètres

[dans] *bSetFocusToBar*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenucmfcpopupmenu"></a><a name="cmfcpopupmenu"></a>CMFCPopupMenu::CMFCPopupMenu

Construit un objet [CMFCPopupMenu.](../../mfc/reference/cmfcpopupmenu-class.md)

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>Paramètres

*pCustPage (en)*<br/>
[dans] Un pointeur vers une page de personnalisation.

*lpszTitle (lpszTitle)*<br/>
[dans] Une chaîne qui contient la légende du menu.

### <a name="remarks"></a>Notes

Cette méthode alloue `CMFCPopupMenu`les ressources pour un . Pour créer l’élément de menu pop-up, appelez [CMFCPopupMenu::Créer](#create).

## <a name="cmfcpopupmenucreate"></a><a name="create"></a>CMFCPopupMenu::Créer

Crée un menu pop-up et le fixe à un objet [CMFCPopupMenu.](../../mfc/reference/cmfcpopupmenu-class.md)

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
[dans] La fenêtre parente pour le `CMFCPopupMenu`.

*x*<br/>
[dans] La coordonnées horizontale de l’écran pour l’emplacement du menu pop-up

*y*<br/>
[dans] La coordonnées de l’écran vertical pour l’emplacement du menu pop.

*hMenu*<br/>
[dans] Une poignée à une ressource de menu.

*Bloqué*<br/>
[dans] Un paramètre Boolean qui indique si le menu est personnalisable. FALSE indique que le menu pop-up est personnalisable.

*bOwnMessage (en)*<br/>
[dans] Un paramètre Boolean qui indique comment le cadre achemine les messages du menu. Pour plus d’informations, consultez la section Notes.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode est réussie; autrement FALSE.

### <a name="remarks"></a>Notes

Si *bOwnMessage* est VRAI, le cadre achemine tous les messages de menu à *pWndParent*. *pWndParent* ne doit pas être NULL si *bOwnMessage* est VRAI. Si *bOwnMessage* est FALSE, le cadre achemine les messages du menu vers le menu pop-up parent.

### <a name="example"></a>Exemple

L’exemple suivant montre comment `Create` utiliser `CMFCPopuMenu` la méthode de la classe. Cet extrait de code fait partie de [l’échantillon de pages personnalisées](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

## <a name="cmfcpopupmenucreatetearoffbar"></a><a name="createtearoffbar"></a>CMFCPopupMenu::CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>Paramètres

[dans] *pWndMain (en)*<br/>
[dans] *uiID*<br/>
[dans] *lpszName (en)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenudefaultmouseclickonclose"></a><a name="defaultmouseclickonclose"></a>CMFCPopupMenu::DefaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuenablemenulogo"></a><a name="enablemenulogo"></a>CMFCPopupMenu::EnableMenuLogo

Initialise le logo d’un menu pop-up.

```cpp
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>Paramètres

*iLogoSize*<br/>
[dans] La taille du logo, en pixels.

*nLogoLocation*<br/>
[dans] Un type de données énuméré qui indique l’emplacement du logo.

### <a name="remarks"></a>Notes

Pour afficher le logo, implémentez la méthode [CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) dans la fenêtre du cadre principal.

Les valeurs possibles pour *nLogoLocation* sont MENU_LOGO_LEFT, MENU_LOGO_RIGHT, MENU_LOGO_TOP et MENU_LOGO_BOTTOM.

## <a name="cmfcpopupmenuenablemenusound"></a><a name="enablemenusound"></a>CMFCPopupMenu::EnableMenuSound

Permet le son du menu.

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[dans] VRAI pour activer le son, FALSE autrement.

### <a name="remarks"></a>Notes

Si vous activez le son, le cadre appelle la méthode [PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound) lorsqu’un utilisateur ouvre un menu pop-up ou sélectionne une commande de menu. Par défaut, cette fonctionnalité est activée.

## <a name="cmfcpopupmenuenableresize"></a><a name="enableresize"></a>CMFCPopupMenu::EnableResize

```cpp
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>Paramètres

[dans] *tailleMinResize*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuenablescrolling"></a><a name="enablescrolling"></a>CMFCPopupMenu::EnableScrolling

```cpp
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>Paramètres

[dans] *BOOL (en anglais)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuenablevertresize"></a><a name="enablevertresize"></a>CMFCPopupMenu::EnableVertResize

```cpp
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>Paramètres

[dans] *nMinResize (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenufindsubitembycommand"></a><a name="findsubitembycommand"></a>CMFCPopupMenu::FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>Paramètres

[dans] *uiCmd uiCmd*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugetactivemenu"></a><a name="getactivemenu"></a>CMFCPopupMenu::GetActiveMenu

Retourne le menu actuellement actif.

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers le menu pop-up actif, ou NULL si aucun menu pop-up n’est actuellement actif.

### <a name="remarks"></a>Notes

Chaque application peut avoir tout au plus un menu pop-up actif.

## <a name="cmfcpopupmenugetanimationspeed"></a><a name="getanimationspeed"></a>CMFCPopupMenu::GetAnimationSpeed

Retourne la vitesse d’animation pour les menus pop-up.

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>Valeur de retour

Un integer qui indique l’heure, en millisecondes, qu’une animation de menu pop-up prend pour finir.

### <a name="remarks"></a>Notes

La vitesse d’animation est une valeur globale. Utilisez [CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed) pour changer la vitesse d’animation pour les menus pop-up.

## <a name="cmfcpopupmenugetanimationtype"></a><a name="getanimationtype"></a>CMFCPopupMenu::GetAnimationType

Retourne le type actuel d’animation pop-up.

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>Paramètres

*bNoSystem (en)*<br/>
[dans] Un paramètre Boolean qui indique si cette méthode vérifie la valeur globale. FALSE si vous voulez que cette méthode retourne le style d’animation pour cette instance de la [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md).

### <a name="return-value"></a>Valeur de retour

Une valeur énumérée qui décrit le type d’animation.

### <a name="remarks"></a>Notes

Le style d’animation pour les menus pop-up est mondial pour votre application. Utilisez [CMFCPopupMenu::SetAnimationType](#setanimationtype) pour définir le style d’animation.

Le tableau suivant répertorie les types d’animation possibles.

|||
|-|-|
|NO_ANIMATION|Le menu pop-up n’est pas animé et apparaît immédiatement.  |
|Déplier|Le cadre révèle le menu pop-up du coin supérieur gauche au coin inférieur droit.  |
|Glisser|Le menu pop-up se déplace de haut en bas.  |
|FADE FADE|Le menu pop-up apparaît d’abord transparent et se solidifie progressivement.  |

## <a name="cmfcpopupmenugetdropdirection"></a><a name="getdropdirection"></a>CMFCPopupMenu::GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugetforcemenufocus"></a><a name="getforcemenufocus"></a>CMFCPopupMenu::GetForceMenuFocus

Indique si l’accent est retourné à la barre de menu lorsqu’un menu pop-up est affiché.

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>Valeur de retour

VRAI si l’accent sur l’entrée est retourné à la barre de menu lorsqu’un menu pop-up est affiché; FALSE si le menu pop-up conserve l’accent.

### <a name="remarks"></a>Notes

Par défaut, votre application ne retourne pas la mise au point à la barre de menu. Pour modifier ce paramètre, utilisez [CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus).

## <a name="cmfcpopupmenugetforceshadow"></a><a name="getforceshadow"></a>CMFCPopupMenu::GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugethmenu"></a><a name="gethmenu"></a>CMFCPopupMenu::GetHMenu

Retourne une poignée à la ressource de menu ci-joint.

```
HMENU GetHMenu();
```

## <a name="cmfcpopupmenugetmenubar"></a><a name="getmenubar"></a>CMFCPopupMenu::GetMenuBar

Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) intégré dans le menu pop-up.

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur `CMFCPopupMenuBar`à la embarquée .

### <a name="remarks"></a>Notes

Le menu pop-up `CMFCPopupMenuBar` dispose d’un objet intégré. Vous devez passer outre à cette méthode dans une classe dérivée si vous utilisez une classe intégrée différente.

## <a name="cmfcpopupmenugetmenuitem"></a><a name="getmenuitem"></a>CMFCPopupMenu::GetMenuItem

Retourne un pointeur à l’élément de menu à l’index spécifié.

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>Paramètres

*iIndex (en)*<br/>
[dans] L’index zéro d’un élément de menu.

### <a name="return-value"></a>Valeur de retour

Un pointeur à un élément de menu. NULL si l’indice est invalide.

### <a name="remarks"></a>Notes

Les éléments du menu sont représentés par la [classe CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md). Lorsque vous appelez cette méthode, il `CMFCToolBarMenuButton`renvoie un pointeur à la appropriée .

## <a name="cmfcpopupmenugetmenuitemcount"></a><a name="getmenuitemcount"></a>CMFCPopupMenu::GetMenuItemCount

Retourne le nombre d’articles dans un menu pop-up.

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’articles dans le menu.

## <a name="cmfcpopupmenugetmessagewnd"></a><a name="getmessagewnd"></a>CMFCPopupMenu::GetMessageWnd

Retourne un pointeur à la fenêtre où le cadre achemine les messages du menu pop-up.

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers la fenêtre qui reçoit les messages du menu pop-up; NULL s’il n’y a pas de fenêtre.

### <a name="remarks"></a>Notes

Lorsque vous utilisez la méthode [CMFCPopupMenu: :Créer](#create) pour créer un menu pop-up, vous spécifiez quelle fenêtre reçoit les messages de menu.

## <a name="cmfcpopupmenugetparentarea"></a><a name="getparentarea"></a>CMFCPopupMenu::GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>Paramètres

[dans] *rectParentBtn*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugetparentbutton"></a><a name="getparentbutton"></a>CMFCPopupMenu::GetParentButton

Retourne un pointeur sur le bouton de la barre d’outils parent.

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur sur le bouton de barre d’outils parent. NULL si le menu pop-up n’a pas de bouton barre d’outils parent.

### <a name="remarks"></a>Notes

A `CMFCPopupMenu` peut être associé à un bouton sur le menu. Dans ce scénario, le menu pop-up apparaît lorsqu’un utilisateur sélectionne le bouton de la barre d’outils parent.

Si le menu pop-up est un menu raccourci, il n’aura pas de bouton de barre d’outils parent.

## <a name="cmfcpopupmenugetparentpopupmenu"></a><a name="getparentpopupmenu"></a>CMFCPopupMenu::GetParentPopupMenu

Retourne un pointeur au menu pop-up parent.

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur `CMFCPopupMenu` à l’objet parent; NULL s’il n’y a pas de menu pop-up parent.

### <a name="remarks"></a>Notes

Un menu pop-up `CMFCPopupMenu` n’a un objet parent que s’il s’agit d’un sous-mois.

## <a name="cmfcpopupmenugetparentribbonelement"></a><a name="getparentribbonelement"></a>CMFCPopupMenu::GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugetparenttoolbar"></a><a name="getparenttoolbar"></a>CMFCPopupMenu::GetParentToolBar

Retourne un pointeur à la barre d’outils parent.

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la barre d’outils parent. NULL si le menu pop-up n’a pas de barre d’outils parent.

### <a name="remarks"></a>Notes

Si `CMFCPopupMenu` le est un menu raccourci, alors il n’a pas de barre d’outils parent.

## <a name="cmfcpopupmenugetquickcustomizetype"></a><a name="getquickcustomizetype"></a>CMFCPopupMenu::GetQuickCustomizeType

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenugetselitem"></a><a name="getselitem"></a>CMFCPopupMenu::GetSelItem

Retourne un pointeur à la commande de menu actuellement sélectionnée.

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la commande de menu actuellement sélectionnée; NULL si aucun élément n’est sélectionné.

### <a name="remarks"></a>Notes

Les commandes de menu sur un menu pop-up sont représentés par la [classe CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md), ou une classe dérivée de `CMFCToolBarMenuButton`.

## <a name="cmfcpopupmenuhasbeenresized"></a><a name="hasbeenresized"></a>CMFCPopupMenu::HasBeenResized

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuhiderarelyusedcommands"></a><a name="hiderarelyusedcommands"></a>CMFCPopupMenu::HideRarelyUsedCommands

Indique si le menu pop-up peut cacher les commandes rarement utilisées.

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si le menu pop-up peut cacher les commandes rarement utilisées; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode ne précise que si un menu pop-up peut masquer les commandes rarement utilisées, pas si cette configuration est activée. Un menu pop-up peut cacher des commandes rarement utilisées s’il a un bouton parent et la fenêtre parente est dérivée de la [classe CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md). Utilisez [CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus) pour activer cette fonctionnalité et [CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus) pour déterminer si cette fonctionnalité est actuellement activée. Vous devez appeler ces deux méthodes pour la fenêtre parente.

## <a name="cmfcpopupmenuincommand"></a><a name="incommand"></a>CMFCPopupMenu::InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuinsertitem"></a><a name="insertitem"></a>CMFCPopupMenu::InsertItem

Insère un nouvel élément dans le menu pop-up à l’emplacement spécifié.

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>Paramètres

*Bouton*<br/>
[dans] Une référence à l’élément de menu à ajouter.

*iInsertAt*<br/>
[dans] L’indice zéro pour le nouvel élément. Si *iInsertAt* est de -1, l’article est ajouté à la fin du menu.

### <a name="return-value"></a>Valeur de retour

L’indice zéro de la position où l’élément a été inséré. -1 si la méthode échoue.

### <a name="remarks"></a>Notes

Cette méthode échouera si vous fournissez une valeur invalide pour *iInsertAt*, comme un intégriste plus grand que le nombre d’articles actuellement sur le menu pop-up.

## <a name="cmfcpopupmenuinsertseparator"></a><a name="insertseparator"></a>CMFCPopupMenu::InsertSeparator

Insère un séparateur dans le menu pop-up à l’emplacement spécifié.

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>Paramètres

*iInsertAt*<br/>
[dans] L’index à base nulle de la position où cette méthode insérera le séparateur.

### <a name="return-value"></a>Valeur de retour

L’indice zéro de la position où le séparateur a été inséré. -1 si cette méthode échoue.

### <a name="remarks"></a>Notes

Une valeur de -1 pour *iInsertAt* signifie que cette méthode ajoutera le séparateur à la fin du menu pop-up.

Cette méthode échoue si *iInsertAt* est une valeur invalide.

## <a name="cmfcpopupmenuisalwaysclose"></a><a name="isalwaysclose"></a>CMFCPopupMenu::IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuisalwaysshowemptytoolsentry"></a><a name="isalwaysshowemptytoolsentry"></a>CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuiscustomizepane"></a><a name="iscustomizepane"></a>CMFCPopupMenu::IsCustomizePane

Indique si le menu pop-up fonctionne comme un **QuickCustomizePane**.

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>Valeur de retour

VRAI si le pop-up est un **QuckCustomizePane;** autrement FALSE.

### <a name="remarks"></a>Notes

Utilisez le **QuickCustomizePane** pour permettre à l’utilisateur de personnaliser directement le menu pop-up. Le **QuickCustomizePane** `CMFCPopupMenu` est un qui apparaît lorsque l’utilisateur clique sur un bouton de barre d’outils pour le modifier directement.

Votre application devrait appeler cette méthode au cours [de CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane).

## <a name="cmfcpopupmenuisescclose"></a><a name="isescclose"></a>CMFCPopupMenu::IsEscClose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuisidle"></a><a name="isidle"></a>CMFCPopupMenu::IsIdle

Indique si un menu pop-up est actuellement inactif.

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si le menu pop-up est en mode inactif; autrement FALSE.

### <a name="remarks"></a>Notes

Par défaut, un menu pop-up est en mode inactif si l’animation d’affichage est terminée et que l’utilisateur ne fait pas défiler le menu pop-up.

## <a name="cmfcpopupmenuismenusound"></a><a name="ismenusound"></a>CMFCPopupMenu::IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuisquickcustomize"></a><a name="isquickcustomize"></a>CMFCPopupMenu::IsQuickCustomize

Détermine si la [classe CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md) associée est en mode QuickCustomize.

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>Valeur de retour

VRAI si le bouton de menu associé est en mode QuickCustomize; autrement FALSE. Cette méthode sera également retour FALSE si le menu `CMFCToolBarMenuButton`pop-up n’est pas associé à un .

### <a name="remarks"></a>Notes

En mode QuickCustomize, l’utilisateur sélectionne un bouton sur une barre d’outils pour personnaliser le bouton directement.

## <a name="cmfcpopupmenuisresizeble"></a><a name="isresizeble"></a>CMFCPopupMenu::IsResizeble

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuisrightalign"></a><a name="isrightalign"></a>CMFCPopupMenu::IsRightAlign

Indique si le menu est aligné à droite ou aligné à gauche.

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si le menu est aligné à droite; FALSE si le menu est aligné à gauche.

### <a name="remarks"></a>Notes

Vous pouvez utiliser [CMFCPopupMenu::SetRightAlign](#setrightalign) pour définir l’alignement du menu. Par défaut, les menus pop-up utilisent l’alignement gauche.

L’alignement du menu n’est pas un cadre global et peut varier d’un menu à l’autre.

## <a name="cmfcpopupmenuisscrollable"></a><a name="isscrollable"></a>CMFCPopupMenu::IsScrollable

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuissendmenuselectmsg"></a><a name="issendmenuselectmsg"></a>CMFCPopupMenu::IsSendMenuSelectMsg

Indique si le cadre informe le cadre parent lorsque l’utilisateur sélectionne une commande dans le menu pop-up.

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>Valeur de retour

VRAI si le cadre avertit le cadre parent; autrement FALSE.

### <a name="remarks"></a>Notes

Le cadre informe le cadre parent en lui envoyant le message WM_MENUSELECT lorsqu’un utilisé sélectionne une commande de menu.

## <a name="cmfcpopupmenuisshown"></a><a name="isshown"></a>CMFCPopupMenu::IsShown

Indique si le menu pop-up est actuellement visible.

```
BOOL IsShown() const;
```

### <a name="return-value"></a>Valeur de retour

VRAI si un menu pop-up est visible; autrement FALSE.

## <a name="cmfcpopupmenumoveto"></a><a name="moveto"></a>CMFCPopupMenu::MoveTo

```cpp
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>Paramètres

[dans] *pt*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuonchangehot"></a><a name="onchangehot"></a>CMFCPopupMenu::OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>Paramètres

[dans] *nHot (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuonchooseitem"></a><a name="onchooseitem"></a>CMFCPopupMenu::OnChooseItem

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>Paramètres

[dans] *uidCmdID (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuoncmdmsg"></a><a name="oncmdmsg"></a>CMFCPopupMenu::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>Paramètres

[dans] *nID (en)*<br/>
[dans] *nCode (en)*<br/>
[dans] *pExtra*<br/>
[dans] *pHandlerInfo (en anglais)*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenupostcommand"></a><a name="postcommand"></a>CMFCPopupMenu::PostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>Paramètres

[dans] *uiCommandID*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenupretranslatemessage"></a><a name="pretranslatemessage"></a>CMFCPopupMenu::PreTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Paramètres

[dans] *pMsg*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenurecalclayout"></a><a name="recalclayout"></a>CMFCPopupMenu::RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>Paramètres

[dans] *bNotifier*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuremoveallitems"></a><a name="removeallitems"></a>CMFCPopupMenu::RemoveAllItems

Efface tous les éléments d’un menu pop-up.

```cpp
void RemoveAllItems();
```

## <a name="cmfcpopupmenuremoveitem"></a><a name="removeitem"></a>CMFCPopupMenu::RemoveItem

Supprime l’élément spécifié du menu pop-up.

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>Paramètres

*iIndex (en)*<br/>
[dans] L’index zéro de l’élément à supprimer.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode est réussie; autrement FALSE.

### <a name="remarks"></a>Notes

Cette méthode organise automatiquement tous les séparateurs qui sont affectés par la suppression d’un élément. Pour plus d’informations sur la façon dont le cadre réorganise les séparateurs, voir [CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton).

## <a name="cmfcpopupmenusavestate"></a><a name="savestate"></a>CMFCPopupMenu::SaveState

```
virtual void SaveState();
```

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetanimationspeed"></a><a name="setanimationspeed"></a>CMFCPopupMenu::SetAnimationSpeed

Définit la vitesse d’animation pour les menus pop-up.

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>Paramètres

*nElapse*<br/>
[dans] La nouvelle vitesse d’animation, en millisecondes.

### <a name="remarks"></a>Notes

La vitesse d’animation est une valeur globale et affecte tous les menus pop-up de l’application. Cette valeur précise combien de temps il faut pour l’animation pour une carte pop-up pour finir.

Par défaut, ce paramètre est réglé à 30 millisecondes. La gamme de valeurs valides pour *nElapse* est de 0 à 200.

## <a name="cmfcpopupmenusetanimationtype"></a><a name="setanimationtype"></a>CMFCPopupMenu::SetAnimationType

Définit le type d’animation pour ce menu pop-up.

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>Paramètres

*type*<br/>
[dans] Un type de données énuméré qui spécifie le type d’animation.

### <a name="remarks"></a>Notes

Voir [CMFCPopupMenu::GetAnimationType](#getanimationtype) pour une liste de valeurs valides pour *le type*.

## <a name="cmfcpopupmenusetautodestroy"></a><a name="setautodestroy"></a>CMFCPopupMenu::SetAutoDestroy

```cpp
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>Paramètres

[dans] *bAutoDestroy*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetdefaultitem"></a><a name="setdefaultitem"></a>CMFCPopupMenu::SetDefaultItem

Définit la commande par défaut pour le menu pop-up.

```cpp
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd uiCmd*<br/>
[dans] L’ID de commande de menu de la nouvelle commande par défaut.

### <a name="remarks"></a>Notes

La commande par défaut dans le menu pop-up est la commande qui est sélectionnée lorsque le menu pop-up apparaît.

## <a name="cmfcpopupmenusetforcemenufocus"></a><a name="setforcemenufocus"></a>CMFCPopupMenu::SetForceMenuFocus

Force l’accent sur l’entrée pour revenir à la barre de menu lorsqu’un menu pop-up est affiché.

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue (en)*<br/>
[dans] VRAI si vous voulez que le cadre force l’entrée à se concentrer sur la barre de menu lorsqu’un menu pop-up est affiché. FALSE si vous voulez que le menu pop-up conserve l’accent.

### <a name="remarks"></a>Notes

Cette méthode fixe un drapeau qui est mondial pour tous les menus pop-up dans l’application. Par défaut, cette fonctionnalité n’est pas activée.

## <a name="cmfcpopupmenusetforceshadow"></a><a name="setforceshadow"></a>CMFCPopupMenu::SetForceShadow

Force le cadre à dessiner des ombres de menu lorsque des menus contextuels apparaissent en dehors du cadre principal.

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue (en)*<br/>
[dans] VRAI si vous voulez que le cadre dessine des ombres de menu, FALSE autrement.

### <a name="remarks"></a>Notes

Lorsque vous appelez cette méthode, elle définit un drapeau global dans votre application. Ce drapeau affecte tous les menus pop-up dans votre application.

## <a name="cmfcpopupmenusetmaxwidth"></a><a name="setmaxwidth"></a>CMFCPopupMenu::SetMaxWidth

Réglez la largeur maximale pour le menu pop-up.

```cpp
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>Paramètres

*iMaxWidth (en)*<br/>
[dans] La largeur maximale pour le menu pop-up, en pixels.

### <a name="remarks"></a>Notes

Si le texte associé à une commande de menu ne s’inscrit pas dans la largeur maximale, il est tronqué et la partie qui ne s’adapte pas est remplacée par trois points.

## <a name="cmfcpopupmenusetmessagewnd"></a><a name="setmessagewnd"></a>CMFCPopupMenu::SetMessageWnd

```cpp
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>Paramètres

[dans] *pMsgWnd*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetparentribbonelement"></a><a name="setparentribbonelement"></a>CMFCPopupMenu::SetParentRibbonElement

```cpp
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>Paramètres

[dans] *pElem (en)*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetquickcustomizetype"></a><a name="setquickcustomizetype"></a>CMFCPopupMenu::SetQuickCustomizeType

```cpp
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>Paramètres

[dans] *Type*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetquickmode"></a><a name="setquickmode"></a>CMFCPopupMenu::SetQuickMode

```cpp
void SetQuickMode();
```

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenusetrightalign"></a><a name="setrightalign"></a>CMFCPopupMenu::SetRightAlign

Définit l’alignement du menu pour les menus contextuels.

```cpp
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>Paramètres

*bRightAlign (en)*<br/>
[dans] Un Boolean qui indique l’alignement du menu. TRUE indique l’alignement droit, FALSE indique l’alignement gauche.

### <a name="remarks"></a>Notes

Par défaut, tous les menus pop-up sont alignés à gauche.

## <a name="cmfcpopupmenusetsendmenuselectmsg"></a><a name="setsendmenuselectmsg"></a>CMFCPopupMenu::SetSendMenuSelectMsg

Définit un drapeau qui contrôle si le menu pop-up informe son cadre parent lorsque l’utilisateur sélectionne une commande.

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet (en anglais)*<br/>
[dans] VRAI si le menu pop-up informe son cadre parent, FALSE autrement.

### <a name="remarks"></a>Notes

Il s’agit d’une option globale pour tous les menus pop-up dans une application. Si elle est activée, les menus contextuels envoient un message WM_MENUSELECT au cadre parent lorsque l’utilisateur sélectionne une commande.

## <a name="cmfcpopupmenushowallcommands"></a><a name="showallcommands"></a>CMFCPopupMenu::ShowAllCommands

Force le menu pop-up à afficher tous les ordres.

```cpp
void ShowAllCommands();
```

### <a name="remarks"></a>Notes

Ce n’est pas un cadre global et affecte seulement le menu pop-up actuel.

## <a name="cmfcpopupmenutriggerresize"></a><a name="triggerresize"></a>CMFCPopupMenu::TriggerResize

```cpp
void TriggerResize();
```

### <a name="remarks"></a>Notes

## <a name="cmfcpopupmenuupdateallshadows"></a><a name="updateallshadows"></a>CMFCPopupMenu::Mise à jourAllShadows

Mise à jour des ombres pour tous les menus pop-up ouverts.

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>Paramètres

*lprectScreen (en)*<br/>
[dans] Un rectangle qui spécifie la région à mettre à jour, dans les coordonnées de l’écran.

### <a name="remarks"></a>Notes

Cette méthode est utile lorsque les menus pop-up sont affichés sur les commandes animées ou d’autres fenêtres qui ont un contenu dynamique.

## <a name="cmfcpopupmenuupdateshadow"></a><a name="updateshadow"></a>CMFCPopupMenu::Mise à jourShadow

Mise à jour de l’ombre pour le menu pop-up.

```cpp
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>Paramètres

*lprectScreen (en)*<br/>
[dans] Un rectangle, dans les coordonnées de l’écran, qui spécifie les limites de la région à mettre à jour.

### <a name="remarks"></a>Notes

Appelez cette méthode lorsqu’un menu pop-up qui a une ombre chevauche une image animée.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)
