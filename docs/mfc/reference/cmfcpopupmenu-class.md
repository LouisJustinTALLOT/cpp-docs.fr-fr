---
title: Cmfcpopupmenu, classe
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: b45ac09ff87c191e55e403951fdff18cae33256d
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/04/2019
ms.locfileid: "57292274"
---
# <a name="cmfcpopupmenu-class"></a>Cmfcpopupmenu, classe

Implémente les fonctionnalités de menu contextuel Windows et les étend en ajoutant des fonctionnalités telles que des menus volants et des info-bulles.
Pour plus d’informations, consultez le code source situé dans le **VC\\atlmfc\\src\\mfc** dossier de votre installation de Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>Membres

### <a name="protected-constructors"></a>Constructeurs protégés

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|Construit un objet `CMFCPopupMenu`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|Définit si un menu contextuel est activé pour afficher des entrées vides pour les outils définis par l’utilisateur.|
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu::CheckArea](#checkarea)|Détermine l’emplacement d’un point par rapport à la liste déroulante.|
|[CMFCPopupMenu::CloseMenu](#closemenu)||
|[CMFCPopupMenu::Create](#create)|Crée un menu contextuel et l’attache à la `CMFCPopupMenu` objet.|
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|Initialise le logo d’un menu contextuel.|
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|Permet les son menu.|
|[CMFCPopupMenu::EnableResize](#enableresize)||
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|Retourne le menu actif.|
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|Retourne la vitesse d’animation des menus contextuels.|
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|Retourne le type en cours d’animation de menu contextuel.|
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|Indique si le focus est retourné au menu barre quand un menu contextuel s’affiche.|
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu::GetHMenu](#gethmenu)|Retourne un handle vers la ressource de menu attaché.|
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) incorporé dans le menu contextuel.|
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|Retourne un pointeur vers l’élément de menu à l’index spécifié.|
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|Retourne le nombre d’éléments dans un menu contextuel.|
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|Retourne un pointeur vers la fenêtre où l’infrastructure achemine les messages de menu contextuel.|
|[CMFCPopupMenu::GetParentArea](#getparentarea)||
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|Retourne un pointeur vers le bouton de barre d’outils parent.|
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|Retourne un pointeur vers le menu contextuel parent.|
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|Retourne un pointeur vers la barre d’outils parent.|
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||
|[CMFCPopupMenu::GetSelItem](#getselitem)|Retourne un pointeur vers la commande de menu actuellement sélectionné.|
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|Indique si le menu contextuel peut masquer les commandes rarement utilisés.|
|[CMFCPopupMenu::InCommand](#incommand)||
|[CMFCPopupMenu::InsertItem](#insertitem)|Insère un nouvel élément dans le menu contextuel à l’emplacement spécifié.|
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|Insère un séparateur dans le menu contextuel à l’emplacement spécifié.|
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|Indique si le menu contextuel fonctionne comme un **QuickCustomizePane**.|
|[CMFCPopupMenu::IsEscClose](#isescclose)||
|[CMFCPopupMenu::IsIdle](#isidle)|Indique si un menu contextuel est actuellement inactif.|
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|Détermine si le texte associé [cmfctoolbarmenubutton, classe](../../mfc/reference/cmfctoolbarmenubutton-class.md) est en mode de QuickCustomize.|
|[CMFCPopupMenu::IsResizeble](#isresizeble)||
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|Indique si le menu est aligné à droite ou aligné à gauche.|
|[CMFCPopupMenu::IsScrollable](#isscrollable)||
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|Indique si le framework informe le frame parent lorsque l’utilisateur sélectionne une commande dans le menu contextuel.|
|[CMFCPopupMenu::IsShown](#isshown)|Indique si le menu contextuel est actuellement visible.|
|[CMFCPopupMenu::MoveTo](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(Substitue `CFrameWnd::OnCmdMsg`.)|
|[CMFCPopupMenu::PostCommand](#postcommand)||
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|(Substitue `CFrameWnd::PreTranslateMessage`.)|
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|Appelé par l’infrastructure lorsque les barres de contrôle standard sont activées ou désactivées ou lorsque la fenêtre frame est redimensionnée. (Substitue [CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|Efface tous les éléments à partir d’un menu contextuel.|
|[CMFCPopupMenu::RemoveItem](#removeitem)|Supprime l’élément spécifié à partir d’un menu contextuel.|
|[CMFCPopupMenu::SaveState](#savestate)||
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|Définit la vitesse d’animation des menus contextuels.|
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|Définit le type d’animation pour le menu contextuel.|
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|Définit la commande par défaut pour le menu contextuel.|
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|Force le focus d’entrée pour revenir au menu de barre quand un menu contextuel s’affiche.|
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|Force l’infrastructure pour dessiner les ombres de menu lorsque les menus contextuels s’affichent en dehors du cadre principal.|
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|Définissez la largeur maximale pour le menu contextuel.|
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|Définit l’alignement du menu des menus contextuels.|
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|Définit un indicateur qui détermine si le menu contextuel informe son frame parent lorsque l’utilisateur sélectionne une commande.|
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|Force le menu contextuel pour afficher toutes les commandes.|
|[CMFCPopupMenu::TriggerResize](#triggerresize)||
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|Met à jour les ombres pour tous les menus contextuels ouverts.|
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|Met à jour de l’ombre pour le menu contextuel.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||

### <a name="remarks"></a>Notes

Normalement, MFC crée automatiquement des menus contextuels. Si vous souhaitez créer un `CMFCPopupMenu` objet manuellement, alloue un sur le tas, puis appelez [CMFCPopupMenu::Create](#create).

## <a name="example"></a>Exemple

L’exemple suivant montre comment configurer un objet de menu contextuel. L’exemple montre comment définir le logo et le son du menu contextuel, définir la vitesse d’animation et le type, dessiner les ombres de menu lorsque le menu contextuel s’affiche en dehors du cadre principal, définissez la largeur maximale et définir l’alignement du menu de droite du menu contextuel. Cet extrait de code fait partie de la [exemple des Pages personnalisées](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>Spécifications

**En-tête :** afxpopupmenu.h

##  <a name="activatepopupmenu"></a>  CMFCPopupMenu::ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>Paramètres

[in] *pTopFrame*<br/>
[in] *pPopupMenu*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="alwaysshowemptytoolsentry"></a>  CMFCPopupMenu::AlwaysShowEmptyToolsEntry

Définit si un menu contextuel est activé pour afficher des entrées vides pour les outils définis par l’utilisateur.

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>Paramètres

*bShow*<br/>
[in] TRUE si le menu contextuel peut afficher des entrées vides ; FALSE sinon.

##  <a name="areallcommandsshown"></a>  CMFCPopupMenu::AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="checkarea"></a>  CMFCPopupMenu::CheckArea

Détermine l’emplacement d’un point par rapport à la liste déroulante.

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>Paramètres

*ptScreen*<br/>
[in] Un point, en coordonnées d’écran.

### <a name="return-value"></a>Valeur de retour

Un paramètre MENUAREA_TYPE qui indique où le point est relatif à la liste déroulante.

### <a name="remarks"></a>Notes

Un paramètre MENUAREA_TYPE peut avoir l’une des valeurs suivantes.

- EXTERNE - *ptScreen* est en dehors de la liste déroulante.

- LOGO - *ptScreen* est sur une zone de logo.

- TEAROFF_CAPTION - *ptScreen* est positionnée sur la légende détachable.

- SHADOW_BOTTOM - *ptScreen* est au fil de l’ombre en bas du menu contextuel.

- SHADOW_RIGHT - *ptScreen* est positionnée sur le cliché instantané droit du menu contextuel.

- MENU - *ptScreen* est sur une commande.

##  <a name="closemenu"></a>  CMFCPopupMenu::CloseMenu

```
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>Paramètres

[in] *bSetFocusToBar*<br/>

### <a name="remarks"></a>Notes

##  <a name="cmfcpopupmenu"></a>  CMFCPopupMenu::CMFCPopupMenu

Construit un [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) objet.

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>Paramètres

*pCustPage*<br/>
[in] Pointeur vers une page de personnalisation.

*lpszTitle*<br/>
[in] Chaîne qui contient la légende de menu.

### <a name="remarks"></a>Notes

Cette méthode alloue les ressources pour un `CMFCPopupMenu`. Pour créer l’élément de menu contextuel, appelez [CMFCPopupMenu::Create](#create).

##  <a name="create"></a>  CMFCPopupMenu::Create

Crée un menu contextuel et l’attache à un [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) objet.

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>Paramètres

*pWndParent*<br/>
[in] La fenêtre parente pour le `CMFCPopupMenu`.

*x*<br/>
[in] Coordonnée d’écran horizontale pour l’emplacement du menu contextuel

*y*<br/>
[in] Coordonnée d’écran verticale pour l’emplacement du point de présence-menu.

*hMenu*<br/>
[in] Handle vers une ressource de menu.

*bLocked*<br/>
[in] Un paramètre booléen qui indique si le menu est personnalisable. FALSE indique que le menu contextuel est personnalisable.

*bOwnMessage*<br/>
[in] Un paramètre booléen qui indique la façon dont le framework achemine les messages de menu. Consultez la section Notes pour plus d’informations.

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode a réussi ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Si *bOwnMessage* a la valeur TRUE, l’infrastructure achemine les messages de menu à *pWndParent*. *pWndParent* ne doit pas être NULL si *bOwnMessage* a la valeur TRUE. Si *bOwnMessage* est FALSE, l’infrastructure achemine les messages de menu au menu contextuel parent.

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser le `Create` méthode de la `CMFCPopuMenu` classe. Cet extrait de code fait partie de la [exemple des Pages personnalisées](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

##  <a name="createtearoffbar"></a>  CMFCPopupMenu::CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>Paramètres

[in] *pWndMain*<br/>
[in] *uiID*<br/>
[in] *lpszName*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="defaultmouseclickonclose"></a>  CMFCPopupMenu::DefaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="enablemenulogo"></a>  CMFCPopupMenu::EnableMenuLogo

Initialise le logo d’un menu contextuel.

```
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>Paramètres

*iLogoSize*<br/>
[in] La taille du logo, en pixels.

*nLogoLocation*<br/>
[in] Type de données énuméré qui indique l’emplacement du logo.

### <a name="remarks"></a>Notes

Pour afficher le logo, implémentez la méthode [CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) dans la fenêtre frame principale.

Les valeurs possibles pour *nLogoLocation* sont MENU_LOGO_LEFT, MENU_LOGO_RIGHT, MENU_LOGO_TOP et MENU_LOGO_BOTTOM.

##  <a name="enablemenusound"></a>  CMFCPopupMenu::EnableMenuSound

Permet les son menu.

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
[in] TRUE pour activer le son, FALSE sinon.

### <a name="remarks"></a>Notes

Si vous activez le son, l’infrastructure appelle la [PlaySound](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound) méthode lorsqu’un utilisateur ouvre un menu contextuel ou sélectionne une commande de menu. Par défaut, cette fonctionnalité est activée.

##  <a name="enableresize"></a>  CMFCPopupMenu::EnableResize

```
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>Paramètres

[in] *sizeMinResize*<br/>

### <a name="remarks"></a>Notes

##  <a name="enablescrolling"></a>  CMFCPopupMenu::EnableScrolling

```
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>Paramètres

[in] *BOOL*<br/>

### <a name="remarks"></a>Notes

##  <a name="enablevertresize"></a>  CMFCPopupMenu::EnableVertResize

```
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>Paramètres

[in] *nMinResize*<br/>

### <a name="remarks"></a>Notes

##  <a name="findsubitembycommand"></a>  CMFCPopupMenu::FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>Paramètres

[in] *uiCmd*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getactivemenu"></a>  CMFCPopupMenu::GetActiveMenu

Retourne le menu actif.

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers le menu contextuel actif, ou NULL si aucun menu contextuel n’est actuellement actif.

### <a name="remarks"></a>Notes

Chaque application peut avoir au plus un menu contextuel actif.

##  <a name="getanimationspeed"></a>  CMFCPopupMenu::GetAnimationSpeed

Retourne la vitesse d’animation des menus contextuels.

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>Valeur de retour

Entier qui indique la durée, en millisecondes, une animation de menu contextuel à la fin.

### <a name="remarks"></a>Notes

La vitesse d’animation est une valeur globale. Utilisez [CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed) pour modifier la vitesse d’animation des menus contextuels.

##  <a name="getanimationtype"></a>  CMFCPopupMenu::GetAnimationType

Retourne le type en cours d’animation contextuelle.

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>Paramètres

*bNoSystem*<br/>
[in] Un paramètre booléen qui indique si cette méthode vérifie la valeur globale. FALSE si vous souhaitez que cette méthode retourne le style d’animation pour cette instance de la [cmfcpopupmenu, classe](../../mfc/reference/cmfcpopupmenu-class.md).

### <a name="return-value"></a>Valeur de retour

Valeur énumérée qui décrit le type d’animation.

### <a name="remarks"></a>Notes

Le style d’animation des menus contextuels est global pour votre application. Utilisez [CMFCPopupMenu::SetAnimationType](#setanimationtype) pour définir le style d’animation.

Le tableau suivant répertorie les types possibles d’animation.

|||
|-|-|
|NO_ANIMATION|Le menu contextuel n’est pas animé et apparaît immédiatement.  |
|DÉROULER|Le framework fait apparaître le menu contextuel dans l’angle supérieur gauche à l’angle inférieur droit.  |
|DIAPOSITIVE|Le menu contextuel déplace de haut en bas.  |
|FONDU|Le menu contextuel s’affiche d’abord transparent et solidification progressivement.  |

##  <a name="getdropdirection"></a>  CMFCPopupMenu::GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getforcemenufocus"></a>  CMFCPopupMenu::GetForceMenuFocus

Indique si le focus est retourné au menu barre quand un menu contextuel s’affiche.

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>Valeur de retour

TRUE si le focus d’entrée est renvoyé à la barre de menus quand un menu contextuel s’affiche ; FALSE si le menu contextuel conserve le focus.

### <a name="remarks"></a>Notes

Par défaut, votre application ne retourne pas le focus à la barre de menus. Pour modifier ce paramètre, utilisez [CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus).

##  <a name="getforceshadow"></a>  CMFCPopupMenu::GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="gethmenu"></a>  CMFCPopupMenu::GetHMenu

Retourne un handle vers la ressource de menu attaché.

```
HMENU GetHMenu();
```

##  <a name="getmenubar"></a>  CMFCPopupMenu::GetMenuBar

Retourne le [CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) incorporé dans le menu contextuel.

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers l’embedded `CMFCPopupMenuBar`.

### <a name="remarks"></a>Notes

Le menu contextuel a incorporé `CMFCPopupMenuBar` objet. Vous devez substituer cette méthode dans une classe dérivée si vous utilisez une autre classe incorporée.

##  <a name="getmenuitem"></a>  CMFCPopupMenu::GetMenuItem

Retourne un pointeur vers l’élément de menu à l’index spécifié.

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>Paramètres

*iIndex*<br/>
[in] Index de base zéro d’un élément de menu.

### <a name="return-value"></a>Valeur de retour

Pointeur vers un élément de menu. NULL si l’index n’est pas valide.

### <a name="remarks"></a>Notes

Éléments de menu sont représentés par le [cmfctoolbarmenubutton, classe](../../mfc/reference/cmfctoolbarmenubutton-class.md). Lorsque vous appelez cette méthode, il retourne un pointeur vers le texte approprié `CMFCToolBarMenuButton`.

##  <a name="getmenuitemcount"></a>  CMFCPopupMenu::GetMenuItemCount

Retourne le nombre d’éléments dans un menu contextuel.

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre d’éléments dans le menu.

##  <a name="getmessagewnd"></a>  CMFCPopupMenu::GetMessageWnd

Retourne un pointeur vers la fenêtre où l’infrastructure achemine les messages de menu contextuel.

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers la fenêtre qui reçoit les messages de menu contextuel ; NULL s’il n’existe aucune fenêtre.

### <a name="remarks"></a>Notes

Lorsque vous utilisez la méthode [CMFCPopupMenu::Create](#create) pour créer un menu contextuel, vous spécifiez quelle fenêtre reçoit les messages de menu.

##  <a name="getparentarea"></a>  CMFCPopupMenu::GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>Paramètres

[in] *rectParentBtn*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getparentbutton"></a>  CMFCPopupMenu::GetParentButton

Retourne un pointeur vers le bouton de barre d’outils parent.

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers le bouton de barre d’outils parent. NULL si le menu contextuel n’a aucun bouton de barre d’outils parent.

### <a name="remarks"></a>Notes

Un `CMFCPopupMenu` peut être associé à un bouton dans le menu. Dans ce scénario, le menu contextuel s’affiche lorsqu’un utilisateur sélectionne le bouton de barre d’outils parent.

Si le menu contextuel est un menu contextuel, il n’aura aucun bouton de barre d’outils parent.

##  <a name="getparentpopupmenu"></a>  CMFCPopupMenu::GetParentPopupMenu

Retourne un pointeur vers le menu contextuel parent.

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers le parent `CMFCPopupMenu` de l’objet ; NULL s’il n’existe aucun menu contextuel parent.

### <a name="remarks"></a>Notes

Un menu contextuel a un parent `CMFCPopupMenu` uniquement l’objet s’il s’agit d’un sous-menu.

##  <a name="getparentribbonelement"></a>  CMFCPopupMenu::GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getparenttoolbar"></a>  CMFCPopupMenu::GetParentToolBar

Retourne un pointeur vers la barre d’outils parent.

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la barre d’outils parent. NULL si le menu contextuel n’a aucune barre d’outils parent.

### <a name="remarks"></a>Notes

Si le `CMFCPopupMenu` est un menu contextuel, il n’a aucune barre d’outils parent.

##  <a name="getquickcustomizetype"></a>  CMFCPopupMenu::GetQuickCustomizeType

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="getselitem"></a>  CMFCPopupMenu::GetSelItem

Retourne un pointeur vers la commande de menu actuellement sélectionné.

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers la commande de menu actuellement sélectionné ; NULL si aucun élément n’est sélectionné.

### <a name="remarks"></a>Notes

Les commandes de menu dans un menu contextuel sont représentées par le [cmfctoolbarmenubutton, classe](../../mfc/reference/cmfctoolbarmenubutton-class.md), ou une classe dérivée de `CMFCToolBarMenuButton`.

##  <a name="hasbeenresized"></a>  CMFCPopupMenu::HasBeenResized

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="hiderarelyusedcommands"></a>  CMFCPopupMenu::HideRarelyUsedCommands

Indique si le menu contextuel peut masquer les commandes rarement utilisés.

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le menu contextuel peut masquer les commandes rarement utilisés ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Cette méthode spécifie uniquement si un menu contextuel peut masquer rarement les commandes utilisées, pas si cette configuration est activée. Un menu contextuel peut masquer les commandes rarement utilisées s’il a un bouton parent et de la fenêtre parente est dérivée le [cmfcmenubar, classe](../../mfc/reference/cmfcmenubar-class.md). Utilisez [CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus) pour activer cette fonctionnalité et [CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus) pour déterminer si cette fonctionnalité est actuellement activée. Vous devez appeler ces deux méthodes pour la fenêtre parente.

##  <a name="incommand"></a>  CMFCPopupMenu::InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="insertitem"></a>  CMFCPopupMenu::InsertItem

Insère un nouvel élément dans le menu contextuel à l’emplacement spécifié.

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>Paramètres

*button*<br/>
[in] Une référence à l’élément de menu à ajouter.

*iInsertAt*<br/>
[in] Index de base zéro du nouvel élément. Si *iInsertAt* est -1, l’élément est ajouté à la fin du menu.

### <a name="return-value"></a>Valeur de retour

Index de base zéro de la position où l’élément a été inséré. -1 si la méthode échoue.

### <a name="remarks"></a>Notes

Cette méthode échoue si vous fournissez une valeur non valide pour *iInsertAt*, comme un entier supérieur au nombre d’éléments actuellement dans le menu contextuel.

##  <a name="insertseparator"></a>  CMFCPopupMenu::InsertSeparator

Insère un séparateur dans le menu contextuel à l’emplacement spécifié.

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>Paramètres

*iInsertAt*<br/>
[in] Index de base zéro de la position où cette méthode insère le séparateur.

### <a name="return-value"></a>Valeur de retour

Index de base zéro de la position où le séparateur a été inséré. -1 si cette méthode échoue.

### <a name="remarks"></a>Notes

La valeur -1 pour *iInsertAt* signifie que cette méthode ajoutera le séparateur à la fin du menu contextuel.

Cette méthode échoue si *iInsertAt* est une valeur non valide.

##  <a name="isalwaysclose"></a>  CMFCPopupMenu::IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isalwaysshowemptytoolsentry"></a>  CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="iscustomizepane"></a>  CMFCPopupMenu::IsCustomizePane

Indique si le menu contextuel fonctionne comme un **QuickCustomizePane**.

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>Valeur de retour

TRUE si la fenêtre contextuelle est un **QuckCustomizePane**; sinon, FALSE.

### <a name="remarks"></a>Notes

Utilisez le **QuickCustomizePane** pour permettre aux utilisateurs de personnaliser directement le menu contextuel. Le **QuickCustomizePane** est un `CMFCPopupMenu` qui s’affiche lorsque l’utilisateur clique sur un bouton de barre d’outils pour la modifier directement.

Votre application doit appeler cette méthode pendant [CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane).

##  <a name="isescclose"></a>  CMFCPopupMenu::IsEscClose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isidle"></a>  CMFCPopupMenu::IsIdle

Indique si un menu contextuel est actuellement inactif.

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le menu contextuel est en mode inactif ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Par défaut, un menu contextuel est en mode inactif si l’animation de l’affichage est terminée et que l’utilisateur ne fait pas défiler le menu contextuel.

##  <a name="ismenusound"></a>  CMFCPopupMenu::IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isquickcustomize"></a>  CMFCPopupMenu::IsQuickCustomize

Détermine si le texte associé [cmfctoolbarmenubutton, classe](../../mfc/reference/cmfctoolbarmenubutton-class.md) est en mode de QuickCustomize.

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>Valeur de retour

TRUE si le bouton de menu associé est en mode de QuickCustomize ; Sinon, FALSE. Cette méthode retourne également FALSE si le menu contextuel n’est pas associé à un `CMFCToolBarMenuButton`.

### <a name="remarks"></a>Notes

Dans QuickCustomize mode, l’utilisateur sélectionne un bouton sur une barre d’outils pour personnaliser le bouton directement.

##  <a name="isresizeble"></a>  CMFCPopupMenu::IsResizeble

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="isrightalign"></a>  CMFCPopupMenu::IsRightAlign

Indique si le menu est aligné à droite ou aligné à gauche.

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si le menu est aligné à droite ; FALSE si le menu à gauche.

### <a name="remarks"></a>Notes

Vous pouvez utiliser [CMFCPopupMenu::SetRightAlign](#setrightalign) pour définir l’alignement du menu. Par défaut, les menus contextuels utilisent alignement à gauche.

Alignement du menu n’est pas un paramètre global et peut varier entre les menus contextuels.

##  <a name="isscrollable"></a>  CMFCPopupMenu::IsScrollable

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="issendmenuselectmsg"></a>  CMFCPopupMenu::IsSendMenuSelectMsg

Indique si le framework informe le frame parent lorsque l’utilisateur sélectionne une commande dans le menu contextuel.

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>Valeur de retour

TRUE si l’infrastructure notifie le frame parent ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Le framework informe le frame parent en lui envoyant le message WM_MENUSELECT lorsque utilisée sélectionne une commande de menu.

##  <a name="isshown"></a>  CMFCPopupMenu::IsShown

Indique si le menu contextuel est actuellement visible.

```
BOOL IsShown() const;
```

### <a name="return-value"></a>Valeur de retour

TRUE si un menu contextuel est visible ; Sinon, FALSE.

##  <a name="moveto"></a>  CMFCPopupMenu::MoveTo

```
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>Paramètres

[in] *pt*<br/>

### <a name="remarks"></a>Notes

##  <a name="onchangehot"></a>  CMFCPopupMenu::OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>Paramètres

[in] *nHot*<br/>

### <a name="remarks"></a>Notes

##  <a name="onchooseitem"></a>  CMFCPopupMenu::OnChooseItem

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>Paramètres

[in] *uidCmdID*<br/>

### <a name="remarks"></a>Notes

##  <a name="oncmdmsg"></a>  CMFCPopupMenu::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>Paramètres

[in] *nID*<br/>
[in] *nCode*<br/>
[in] *pExtra*<br/>
[in] *pHandlerInfo*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="postcommand"></a>  CMFCPopupMenu::PostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>Paramètres

[in] *uiCommandID*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="pretranslatemessage"></a>  CMFCPopupMenu::PreTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Paramètres

[in] *pMsg*<br/>

### <a name="return-value"></a>Valeur de retour

### <a name="remarks"></a>Notes

##  <a name="recalclayout"></a>  CMFCPopupMenu::RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>Paramètres

[in] *bNotify*<br/>

### <a name="remarks"></a>Notes

##  <a name="removeallitems"></a>  CMFCPopupMenu::RemoveAllItems

Efface tous les éléments à partir d’un menu contextuel.

```
void RemoveAllItems();
```

##  <a name="removeitem"></a>  CMFCPopupMenu::RemoveItem

Supprime l’élément spécifié dans le menu contextuel.

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>Paramètres

*iIndex*<br/>
[in] Index de base zéro de l’élément à supprimer.

### <a name="return-value"></a>Valeur de retour

TRUE si la méthode a réussi ; Sinon, FALSE.

### <a name="remarks"></a>Notes

Cette méthode organise automatiquement les séparateurs sont affectés par la suppression d’un élément. Pour plus d’informations sur la façon dont le framework réorganise les séparateurs, consultez [CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton).

##  <a name="savestate"></a>  CMFCPopupMenu::SaveState

```
virtual void SaveState();
```

### <a name="remarks"></a>Notes

##  <a name="setanimationspeed"></a>  CMFCPopupMenu::SetAnimationSpeed

Définit la vitesse d’animation des menus contextuels.

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>Paramètres

*nElapse*<br/>
[in] La nouvelle animation vitesse, en millisecondes.

### <a name="remarks"></a>Notes

La vitesse d’animation est une valeur globale et affecte tous les menus contextuels dans l’application. Cette valeur spécifie la durée de l’animation d’un menu contextuel terminer.

Par défaut, ce paramètre est défini sur 30 millisecondes. La plage des valeurs valides pour *nElapse* est comprise entre 0 et 200.

##  <a name="setanimationtype"></a>  CMFCPopupMenu::SetAnimationType

Définit le type d’animation pour ce menu contextuel.

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>Paramètres

*type*<br/>
[in] Type de données énuméré qui spécifie le type d’animation.

### <a name="remarks"></a>Notes

Consultez [CMFCPopupMenu::GetAnimationType](#getanimationtype) pour obtenir la liste des valeurs valides pour *type*.

##  <a name="setautodestroy"></a>  CMFCPopupMenu::SetAutoDestroy

```
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>Paramètres

[in] *bAutoDestroy*<br/>

### <a name="remarks"></a>Notes

##  <a name="setdefaultitem"></a>  CMFCPopupMenu::SetDefaultItem

Définit la commande par défaut pour le menu contextuel.

```
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>Paramètres

*uiCmd*<br/>
[in] L’ID de commande de menu de la nouvelle commande par défaut.

### <a name="remarks"></a>Notes

La commande par défaut dans le menu contextuel est la commande qui est sélectionnée lorsque le menu contextuel s’affiche.

##  <a name="setforcemenufocus"></a>  CMFCPopupMenu::SetForceMenuFocus

Force le focus d’entrée pour revenir au menu de barre quand un menu contextuel s’affiche.

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue*<br/>
[in] TRUE si vous souhaitez que l’infrastructure pour forcer le focus d’entrée vers la barre de menus quand un menu contextuel s’affiche. FALSE si vous souhaitez que le menu contextuel pour conserver le focus.

### <a name="remarks"></a>Notes

Cette méthode définit un indicateur qui est global pour tous les menus contextuels dans l’application. Par défaut, cette fonctionnalité n’est pas activée.

##  <a name="setforceshadow"></a>  CMFCPopupMenu::SetForceShadow

Force l’infrastructure pour dessiner les ombres de menu lorsque les menus contextuels s’affichent en dehors du cadre principal.

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

*bValue*<br/>
[in] TRUE si vous souhaitez que l’infrastructure pour dessiner les ombres de menu, FALSE sinon.

### <a name="remarks"></a>Notes

Lorsque vous appelez cette méthode, il définit un indicateur global dans votre application. Cet indicateur affecte tous les menus contextuels dans votre application.

##  <a name="setmaxwidth"></a>  CMFCPopupMenu::SetMaxWidth

Définissez la largeur maximale pour le menu contextuel.

```
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>Paramètres

*iMaxWidth*<br/>
[in] La largeur maximale pour le menu contextuel, en pixels.

### <a name="remarks"></a>Notes

Si le texte associé à une commande de menu ne tient pas dans la largeur maximale, il est tronqué et la partie qui ne tient pas est remplacée par trois points.

##  <a name="setmessagewnd"></a>  CMFCPopupMenu::SetMessageWnd

```
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>Paramètres

[in] *pMsgWnd*<br/>

### <a name="remarks"></a>Notes

##  <a name="setparentribbonelement"></a>  CMFCPopupMenu::SetParentRibbonElement

```
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>Paramètres

[in] *pElem*<br/>

### <a name="remarks"></a>Notes

##  <a name="setquickcustomizetype"></a>  CMFCPopupMenu::SetQuickCustomizeType

```
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>Paramètres

[in] *Type*<br/>

### <a name="remarks"></a>Notes

##  <a name="setquickmode"></a>  CMFCPopupMenu::SetQuickMode

```
void SetQuickMode();
```

### <a name="remarks"></a>Notes

##  <a name="setrightalign"></a>  CMFCPopupMenu::SetRightAlign

Définit l’alignement du menu des menus contextuels.

```
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>Paramètres

*bRightAlign*<br/>
[in] Valeur booléenne qui indique l’alignement du menu. TRUE indique l’alignement à droite, la valeur FALSE indique l’alignement à gauche.

### <a name="remarks"></a>Notes

Par défaut, tous les menus contextuels sont alignés à gauche.

##  <a name="setsendmenuselectmsg"></a>  CMFCPopupMenu::SetSendMenuSelectMsg

Définit un indicateur qui détermine si le menu contextuel informe son frame parent lorsque l’utilisateur sélectionne une commande.

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>Paramètres

*bSet*<br/>
[in] TRUE si le menu contextuel informe son frame parent.

### <a name="remarks"></a>Notes

Il s’agit d’une option globale pour tous les menus contextuels dans une application. Si elle est activée, les menus contextuels enverra un message WM_MENUSELECT vers le frame parent lorsque l’utilisateur sélectionne une commande.

##  <a name="showallcommands"></a>  CMFCPopupMenu::ShowAllCommands

Force le menu contextuel pour afficher toutes les commandes.

```
void ShowAllCommands();
```

### <a name="remarks"></a>Notes

Cela n’est pas un paramètre global et affecte uniquement le menu contextuel actuel.

##  <a name="triggerresize"></a>  CMFCPopupMenu::TriggerResize

```
void TriggerResize();
```

### <a name="remarks"></a>Notes

##  <a name="updateallshadows"></a>  CMFCPopupMenu::UpdateAllShadows

Met à jour les ombres pour tous les menus contextuels ouverts.

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>Paramètres

*lprectScreen*<br/>
[in] Un rectangle qui spécifie la région à mettre à jour, en coordonnées d’écran.

### <a name="remarks"></a>Notes

Cette méthode est utile lorsque les menus contextuels sont affichés sur les contrôles animées ou autres fenêtres qui ont un contenu dynamique.

##  <a name="updateshadow"></a>  CMFCPopupMenu::UpdateShadow

Met à jour de l’ombre pour le menu contextuel.

```
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>Paramètres

*lprectScreen*<br/>
[in] Un rectangle, en coordonnées d’écran, qui spécifie les limites de la zone à mettre à jour.

### <a name="remarks"></a>Notes

Appelez cette méthode lorsqu’un menu contextuel qui possède une ombre chevauche une image animée.

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar, classe](../../mfc/reference/cmfcpopupmenubar-class.md)
