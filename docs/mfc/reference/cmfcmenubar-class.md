---
description: 'En savoir plus sur : classe CMFCMenuBar'
title: CMFCMenuBar, classe
ms.date: 10/18/2018
f1_keywords:
- CMFCMenuBar
- AFXMENUBAR/CMFCMenuBar
- AFXMENUBAR/CMFCMenuBar::AdjustLocations
- AFXMENUBAR/CMFCMenuBar::AllowChangeTextLabels
- AFXMENUBAR/CMFCMenuBar::AllowShowOnPaneMenu
- AFXMENUBAR/CMFCMenuBar::CalcFixedLayout
- AFXMENUBAR/CMFCMenuBar::CalcLayout
- AFXMENUBAR/CMFCMenuBar::CalcMaxButtonHeight
- AFXMENUBAR/CMFCMenuBar::CanBeClosed
- AFXMENUBAR/CMFCMenuBar::CanBeRestored
- AFXMENUBAR/CMFCMenuBar::Create
- AFXMENUBAR/CMFCMenuBar::CreateEx
- AFXMENUBAR/CMFCMenuBar::CreateFromMenu
- AFXMENUBAR/CMFCMenuBar::EnableHelpCombobox
- AFXMENUBAR/CMFCMenuBar::EnableMenuShadows
- AFXMENUBAR/CMFCMenuBar::GetAvailableExpandSize
- AFXMENUBAR/CMFCMenuBar::GetColumnWidth
- AFXMENUBAR/CMFCMenuBar::GetDefaultMenu
- AFXMENUBAR/CMFCMenuBar::GetDefaultMenuResId
- AFXMENUBAR/CMFCMenuBar::GetFloatPopupDirection
- AFXMENUBAR/CMFCMenuBar::GetForceDownArrows
- AFXMENUBAR/CMFCMenuBar::GetHelpCombobox
- AFXMENUBAR/CMFCMenuBar::GetHMenu
- AFXMENUBAR/CMFCMenuBar::GetMenuFont
- AFXMENUBAR/CMFCMenuBar::GetMenuItem
- AFXMENUBAR/CMFCMenuBar::GetRowHeight
- AFXMENUBAR/CMFCMenuBar::GetSystemButton
- AFXMENUBAR/CMFCMenuBar::GetSystemButtonsCount
- AFXMENUBAR/CMFCMenuBar::GetSystemMenu
- AFXMENUBAR/CMFCMenuBar::HighlightDisabledItems
- AFXMENUBAR/CMFCMenuBar::IsButtonExtraSizeAvailable
- AFXMENUBAR/CMFCMenuBar::IsHighlightDisabledItems
- AFXMENUBAR/CMFCMenuBar::IsMenuShadows
- AFXMENUBAR/CMFCMenuBar::IsRecentlyUsedMenus
- AFXMENUBAR/CMFCMenuBar::IsShowAllCommands
- AFXMENUBAR/CMFCMenuBar::IsShowAllCommandsDelay
- AFXMENUBAR/CMFCMenuBar::LoadState
- AFXMENUBAR/CMFCMenuBar::OnChangeHot
- AFXMENUBAR/CMFCMenuBar::OnDefaultMenuLoaded
- AFXMENUBAR/CMFCMenuBar::OnSendCommand
- AFXMENUBAR/CMFCMenuBar::OnSetDefaultButtonText
- AFXMENUBAR/CMFCMenuBar::OnToolHitTest
- AFXMENUBAR/CMFCMenuBar::PreTranslateMessage
- AFXMENUBAR/CMFCMenuBar::RestoreOriginalstate
- AFXMENUBAR/CMFCMenuBar::SaveState
- AFXMENUBAR/CMFCMenuBar::SetDefaultMenuResId
- AFXMENUBAR/CMFCMenuBar::SetForceDownArrows
- AFXMENUBAR/CMFCMenuBar::SetMaximizeMode
- AFXMENUBAR/CMFCMenuBar::SetMenuButtonRTC
- AFXMENUBAR/CMFCMenuBar::SetMenuFont
- AFXMENUBAR/CMFCMenuBar::SetRecentlyUsedMenus
- AFXMENUBAR/CMFCMenuBar::SetShowAllCommands
helpviewer_keywords:
- CMFCMenuBar [MFC], AdjustLocations
- CMFCMenuBar [MFC], AllowChangeTextLabels
- CMFCMenuBar [MFC], AllowShowOnPaneMenu
- CMFCMenuBar [MFC], CalcFixedLayout
- CMFCMenuBar [MFC], CalcLayout
- CMFCMenuBar [MFC], CalcMaxButtonHeight
- CMFCMenuBar [MFC], CanBeClosed
- CMFCMenuBar [MFC], CanBeRestored
- CMFCMenuBar [MFC], Create
- CMFCMenuBar [MFC], CreateEx
- CMFCMenuBar [MFC], CreateFromMenu
- CMFCMenuBar [MFC], EnableHelpCombobox
- CMFCMenuBar [MFC], EnableMenuShadows
- CMFCMenuBar [MFC], GetAvailableExpandSize
- CMFCMenuBar [MFC], GetColumnWidth
- CMFCMenuBar [MFC], GetDefaultMenu
- CMFCMenuBar [MFC], GetDefaultMenuResId
- CMFCMenuBar [MFC], GetFloatPopupDirection
- CMFCMenuBar [MFC], GetForceDownArrows
- CMFCMenuBar [MFC], GetHelpCombobox
- CMFCMenuBar [MFC], GetHMenu
- CMFCMenuBar [MFC], GetMenuFont
- CMFCMenuBar [MFC], GetMenuItem
- CMFCMenuBar [MFC], GetRowHeight
- CMFCMenuBar [MFC], GetSystemButton
- CMFCMenuBar [MFC], GetSystemButtonsCount
- CMFCMenuBar [MFC], GetSystemMenu
- CMFCMenuBar [MFC], HighlightDisabledItems
- CMFCMenuBar [MFC], IsButtonExtraSizeAvailable
- CMFCMenuBar [MFC], IsHighlightDisabledItems
- CMFCMenuBar [MFC], IsMenuShadows
- CMFCMenuBar [MFC], IsRecentlyUsedMenus
- CMFCMenuBar [MFC], IsShowAllCommands
- CMFCMenuBar [MFC], IsShowAllCommandsDelay
- CMFCMenuBar [MFC], LoadState
- CMFCMenuBar [MFC], OnChangeHot
- CMFCMenuBar [MFC], OnDefaultMenuLoaded
- CMFCMenuBar [MFC], OnSendCommand
- CMFCMenuBar [MFC], OnSetDefaultButtonText
- CMFCMenuBar [MFC], OnToolHitTest
- CMFCMenuBar [MFC], PreTranslateMessage
- CMFCMenuBar [MFC], RestoreOriginalstate
- CMFCMenuBar [MFC], SaveState
- CMFCMenuBar [MFC], SetDefaultMenuResId
- CMFCMenuBar [MFC], SetForceDownArrows
- CMFCMenuBar [MFC], SetMaximizeMode
- CMFCMenuBar [MFC], SetMenuButtonRTC
- CMFCMenuBar [MFC], SetMenuFont
- CMFCMenuBar [MFC], SetRecentlyUsedMenus
- CMFCMenuBar [MFC], SetShowAllCommands
ms.assetid: 8a3ce4c7-b012-4dc0-b4f8-53c10b4b86b8
ms.openlocfilehash: 025e1cdfa54226ed1a0ea5e79f9b8c8ea948cccf
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97265140"
---
# <a name="cmfcmenubar-class"></a>CMFCMenuBar, classe

Barre de menus qui implémente l'ancrage.
Pour plus d’informations, consultez le code source situé dans le dossier **VC \\ ATLMFC \\ src \\ MFC** de votre installation de Visual Studio.

## <a name="syntax"></a>Syntaxe

```
class CMFCMenuBar : public CMFCToolbar
```

## <a name="members"></a>Membres

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CMFCMenuBar::AdjustLocations](#adjustlocations)|(Substitue `CMFCToolBar::AdjustLocations`.)|
|[CMFCMenuBar::AllowChangeTextLabels](#allowchangetextlabels)|Spécifie si les étiquettes de texte peuvent être affichées sous images sur les boutons de la barre d’outils. (Substitue [CMFCToolBar :: AllowChangeTextLabels](../../mfc/reference/cmfctoolbar-class.md#allowchangetextlabels).)|
|[CMFCMenuBar::AllowShowOnPaneMenu](#allowshowonpanemenu)|(Substitue `CPane::AllowShowOnPaneMenu`.)|
|[CMFCMenuBar::CalcFixedLayout](#calcfixedlayout)|Calcule la taille horizontale de la barre d’outils. (Substitue [CMFCToolBar :: CalcFixedLayout](../../mfc/reference/cmfctoolbar-class.md#calcfixedlayout).)|
|[CMFCMenuBar::CalcLayout](#calclayout)|(Substitue `CMFCToolBar::CalcLayout`.)|
|[CMFCMenuBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|Calcule la hauteur maximale des boutons dans la barre d’outils. (Substitue [CMFCToolBar :: CalcMaxButtonHeight](../../mfc/reference/cmfctoolbar-class.md#calcmaxbuttonheight).)|
|[CMFCMenuBar::CanBeClosed](#canbeclosed)|Spécifie si un utilisateur peut fermer la barre d’outils. (Substitue [CMFCToolBar :: CanBeClosed](../../mfc/reference/cmfctoolbar-class.md#canbeclosed).)|
|[CMFCMenuBar::CanBeRestored](#canberestored)|Détermine si le système peut restaurer une barre d’outils à son état d’origine après la personnalisation. (Substitue [CMFCToolBar :: CanBeRestored](../../mfc/reference/cmfctoolbar-class.md#canberestored).)|
|[CMFCMenuBar :: Create](#create)|Crée un contrôle de menu et l’attache à un `CMFCMenuBar` objet.|
|[CMFCMenuBar :: CreateEx](#createex)|Crée un `CMFCMenuBar` objet avec des options de style supplémentaires.|
|[CMFCMenuBar::CreateFromMenu](#createfrommenu)|Initialise un objet `CMFCMenuBar`. Accepte un paramètre HMENU qui agit comme un modèle pour un rempli `CMFCMenuBar` .|
|[CMFCMenuBar::EnableHelpCombobox](#enablehelpcombobox)|Active une zone de liste modifiable **d’aide** située sur le côté droit de la barre de menus.|
|[CMFCMenuBar::EnableMenuShadows](#enablemenushadows)|Spécifie s’il faut afficher les ombres pour les menus contextuels.|
|[CMFCMenuBar::GetAvailableExpandSize](#getavailableexpandsize)|(Substitue [CPane :: GetAvailableExpandSize](../../mfc/reference/cpane-class.md#getavailableexpandsize).)|
|[CMFCMenuBar::GetColumnWidth](#getcolumnwidth)|Retourne la largeur des boutons de la barre d’outils. (Substitue [CMFCToolBar :: GetColumnWidth](../../mfc/reference/cmfctoolbar-class.md#getcolumnwidth).)|
|[CMFCMenuBar::GetDefaultMenu](#getdefaultmenu)|Retourne un handle au menu d’origine dans le fichier de ressources.|
|[CMFCMenuBar::GetDefaultMenuResId](#getdefaultmenuresid)|Retourne l’identificateur de ressource pour le menu d’origine dans le fichier de ressources.|
|[CMFCMenuBar::GetFloatPopupDirection](#getfloatpopupdirection)||
|[CMFCMenuBar::GetForceDownArrows](#getforcedownarrows)||
|[CMFCMenuBar::GetHelpCombobox](#gethelpcombobox)|Retourne un pointeur vers la zone de liste déroulante **d’aide** .|
|[CMFCMenuBar::GetHMenu](#gethmenu)|Retourne le handle du menu attaché à l' `CMFCMenuBar` objet.|
|[CMFCMenuBar::GetMenuFont](#getmenufont)|Retourne la police globale actuelle pour les objets de menu.|
|[CMFCMenuBar::GetMenuItem](#getmenuitem)|Retourne le bouton de barre d’outils associé à l’index d’élément fourni.|
|[CMFCMenuBar::GetRowHeight](#getrowheight)|Retourne la hauteur des boutons de la barre d’outils. (Substitue [CMFCToolBar :: GetRowHeight](../../mfc/reference/cmfctoolbar-class.md#getrowheight).)|
|[CMFCMenuBar::GetSystemButton](#getsystembutton)||
|[CMFCMenuBar::GetSystemButtonsCount](#getsystembuttonscount)||
|[CMFCMenuBar::GetSystemMenu](#getsystemmenu)||
|[CMFCMenuBar::HighlightDisabledItems](#highlightdisableditems)|Indique si les éléments de menu désactivés sont mis en surbrillance.|
|[CMFCMenuBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|Détermine si la barre d’outils peut afficher des boutons avec des bordures étendues. (Substitue [CMFCToolBar :: IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable).)|
|[CMFCMenuBar::IsHighlightDisabledItems](#ishighlightdisableditems)|Indique si les éléments désactivés sont mis en surbrillance.|
|[CMFCMenuBar::IsMenuShadows](#ismenushadows)|Indique si les ombres sont dessinées pour les menus contextuels.|
|[CMFCMenuBar::IsRecentlyUsedMenus](#isrecentlyusedmenus)|Indique si les commandes de menu récemment utilisées sont affichées dans la barre de menus.|
|[CMFCMenuBar::IsShowAllCommands](#isshowallcommands)|Indique si les menus contextuels affichent toutes les commandes.|
|[CMFCMenuBar::IsShowAllCommandsDelay](#isshowallcommandsdelay)|Indique si les menus affichent toutes les commandes après un bref délai.|
|[CMFCMenuBar :: LoadState](#loadstate)|Charge l’état de l' `CMFCMenuBar` objet à partir du Registre.|
|[CMFCMenuBar::OnChangeHot](#onchangehot)|Appelé par le Framework quand un utilisateur sélectionne un bouton dans la barre d’outils. (Substitue [CMFCToolBar :: OnChangeHot](../../mfc/reference/cmfctoolbar-class.md#onchangehot).)|
|[CMFCMenuBar::OnDefaultMenuLoaded](#ondefaultmenuloaded)|Appelé par le Framework lorsqu’une fenêtre frame charge le menu par défaut à partir du fichier de ressources.|
|[CMFCMenuBar::OnSendCommand](#onsendcommand)|(Substitue `CMFCToolBar::OnSendCommand`.)|
|[CMFCMenuBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|Appelé par le Framework lorsqu’un menu est en mode de personnalisation et que l’utilisateur modifie le texte d’un élément de menu.|
|[CMFCMenuBar::OnToolHitTest](#ontoolhittest)|(Substitue `CMFCToolBar::OnToolHitTest`.)|
|[CMFCMenuBar ::P reTranslateMessage](#pretranslatemessage)|(Substitue `CMFCToolBar::PreTranslateMessage`.)|
|[CMFCMenuBar :: RestoreOriginalstate](#restoreoriginalstate)|Appelé par le Framework lorsqu’un menu est en mode de personnalisation et que l’utilisateur sélectionne **Réinitialiser** pour une barre de menus.|
|[CMFCMenuBar :: saveste](#savestate)|Enregistre l’état de l' `CMFCMenuBar` objet dans le registre.|
|[CMFCMenuBar::SetDefaultMenuResId](#setdefaultmenuresid)|Définit le menu d’origine dans le fichier de ressources.|
|[CMFCMenuBar::SetForceDownArrows](#setforcedownarrows)||
|[CMFCMenuBar::SetMaximizeMode](#setmaximizemode)|Appelé par le Framework lorsqu’une fenêtre enfant MDI change de mode d’affichage. Si la fenêtre enfant MDI est récemment agrandie ou n’est plus agrandie, cette méthode met à jour la barre de menus.|
|[CMFCMenuBar::SetMenuButtonRTC](#setmenubuttonrtc)|Définit les informations de classe d’exécution générées lorsque l’utilisateur crée dynamiquement des boutons de menu.|
|[CMFCMenuBar::SetMenuFont](#setmenufont)|Définit la police pour tous les menus de l’application.|
|[CMFCMenuBar::SetRecentlyUsedMenus](#setrecentlyusedmenus)|Spécifie si une barre de menus affiche les commandes de menu récemment utilisées.|
|[CMFCMenuBar::SetShowAllCommands](#setshowallcommands)|Spécifie si la barre de menus affiche toutes les commandes.|

## <a name="remarks"></a>Notes

La `CMFCMenuBar` classe est une barre de menus qui implémente la fonctionnalité d’ancrage. Elle ressemble à une barre d’outils, bien qu’elle ne puisse pas être fermée. elle est toujours affichée.

`CMFCMenuBar` prend en charge l’option d’affichage des objets d’élément de menu récemment utilisés. Si cette option est activée, le n' `CMFCMenuBar` affiche qu’un sous-ensemble des commandes disponibles lors de la première consultation. Par la suite, les commandes récemment utilisées sont affichées avec le sous-ensemble d’origine des commandes. En outre, l’utilisateur peut toujours développer le menu pour afficher toutes les commandes disponibles. Par conséquent, chaque commande disponible est configurée pour s’afficher en permanence ou pour s’afficher uniquement si elle a été sélectionnée récemment.

Pour utiliser un `CMFCMenuBar` objet, incorporez-le dans l’objet frame de la fenêtre principale. Lors du traitement du `WM_CREATE` message, appelez `CMFCMenuBar::Create` ou `CMFCMenuBar::CreateEx` . Quelle que soit la fonction de création que vous utilisez, transmettez un pointeur vers la fenêtre frame principale. Activez ensuite l’ancrage en appelant [CFrameWndEx :: EnableDocking](../../mfc/reference/cframewndex-class.md#enabledocking). Ancrez ce menu en appelant [CFrameWndEx ::D ockpane](../../mfc/reference/cframewndex-class.md#dockpane).

## <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser différentes méthodes de la classe `CMFCMenuBar` . L’exemple montre comment définir le style du volet, activer le bouton Personnaliser, activer une zone d’aide, activer les ombres pour les menus contextuels et mettre à jour la barre de menus. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#1](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#3](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)

`CMFCMenuBar`

## <a name="requirements"></a>Spécifications

**En-tête :** afxmenubar. h

## <a name="cmfcmenubaradjustlocations"></a><a name="adjustlocations"></a> CMFCMenuBar::AdjustLocations

Ajuste la position des éléments de menu dans la barre de menus.

```
virtual void AdjustLocations();
```

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarallowchangetextlabels"></a><a name="allowchangetextlabels"></a> CMFCMenuBar::AllowChangeTextLabels

Détermine si les étiquettes de texte sont autorisées sous les images dans la barre de menus.

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>Valeur renvoyée

Retourne la valeur TRUE si l’utilisateur peut choisir d’afficher les étiquettes de texte sous les images.

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarallowshowonpanemenu"></a><a name="allowshowonpanemenu"></a> CMFCMenuBar::AllowShowOnPaneMenu

```
virtual BOOL AllowShowOnPaneMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcalcfixedlayout"></a><a name="calcfixedlayout"></a> CMFCMenuBar::CalcFixedLayout

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>Paramètres

dans *bStretch*<br/>

dans *bHorz*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcalclayout"></a><a name="calclayout"></a> CMFCMenuBar::CalcLayout

```
virtual CSize CalcLayout(
    DWORD dwMode,
    int nLength = -1);
```

### <a name="parameters"></a>Paramètres

dans *dwMode*<br/>

dans *nLength*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a> CMFCMenuBar::CalcMaxButtonHeight

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcanbeclosed"></a><a name="canbeclosed"></a> CMFCMenuBar::CanBeClosed

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcanberestored"></a><a name="canberestored"></a> CMFCMenuBar::CanBeRestored

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarcreate"></a><a name="create"></a> CMFCMenuBar :: Create

Crée un contrôle Menu et l’attache à un objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) .

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle = AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID = AFX_IDW_MENUBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
dans Pointeur vers la fenêtre parente du nouvel `CMFCMenuBar` objet.

*dwStyle*<br/>
dans Style de la nouvelle barre de menus.

*nID*<br/>
dans ID de la fenêtre enfant de la barre de menus.

### <a name="return-value"></a>Valeur renvoyée

TRUE en cas de réussite, sinon FALSE.

### <a name="remarks"></a>Notes

Après avoir construit un `CMFCMenuBar` objet, vous devez appeler `Create` . Cette méthode crée le `CMFCMenuBar` contrôle et l’attache à l' `CMFCMenuBar` objet.

Pour plus d’informations sur les styles de barre d’outils, consultez [CBasePane :: SetPaneStyle](../../mfc/reference/cbasepane-class.md#setpanestyle).

## <a name="cmfcmenubarcreateex"></a><a name="createex"></a> CMFCMenuBar :: CreateEx

Crée un objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) avec les styles étendus spécifiés.

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle = TBSTYLE_FLAT,
    DWORD dwStyle = AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders = CRect(1,
    1,
    1,
    1),
    UINT nID =AFX_IDW_MENUBAR);
```

### <a name="parameters"></a>Paramètres

*pParentWnd*<br/>
dans Pointeur vers la fenêtre parente du nouvel `CMFCMenuBar` objet.

*dwCtrlStyle*<br/>
dans Styles supplémentaires pour la nouvelle barre de menus.

*dwStyle*<br/>
dans Style principal de la nouvelle barre de menus.

*rcBorders*<br/>
dans `CRect` Paramètre qui spécifie les tailles des bordures de l' `CMFCMenuBar` objet.

*nID*<br/>
dans ID de la fenêtre enfant de la barre de menus.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la méthode réussit ; Sinon, 0.

### <a name="remarks"></a>Notes

Vous devez utiliser cette fonction à la place de [CMFCMenuBar :: Create](#create) lorsque vous souhaitez spécifier des styles en plus du style de barre d’outils. Certains styles supplémentaires fréquemment utilisés sont TBSTYLE_TRANSPARENT et CBRS_TOP.

Pour obtenir la liste des styles supplémentaires, consultez [styles de contrôle et de bouton de barre d’outils](/windows/win32/Controls/toolbar-control-and-button-styles), [styles de contrôles communs](/windows/win32/Controls/common-control-styles)et [styles de fenêtres courants](/windows/win32/winmsg/window-styles).

### <a name="example"></a>Exemple

L’exemple suivant montre comment utiliser la `CreateEx` méthode de la `CMFCMenuBar` classe. Cet extrait de code fait partie de l' [exemple de démonstration IE](../../overview/visual-cpp-samples.md).

[!code-cpp[NVC_MFC_IEDemo#1](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#2](../../mfc/reference/codesnippet/cpp/cmfcmenubar-class_3.cpp)]

## <a name="cmfcmenubarcreatefrommenu"></a><a name="createfrommenu"></a> CMFCMenuBar::CreateFromMenu

Initialise un objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) . Cette méthode modélise l' `CMFCMenuBar` objet après un paramètre HMENU.

```
virtual void CreateFromMenu(
    HMENU hMenu,
    BOOL bDefaultMenu = FALSE,
    BOOL bForceUpdate = FALSE);
```

### <a name="parameters"></a>Paramètres

*hMenu*<br/>
dans Handle d’une ressource de menu. `CreateFromMenu` utilise cette ressource comme modèle pour le `CMFCMenuBar` .

*bDefaultMenu*<br/>
dans Valeur booléenne qui indique si le nouveau menu est le menu par défaut.

*bForceUpdate*<br/>
dans Valeur booléenne qui indique si cette méthode force une mise à jour de menu.

### <a name="remarks"></a>Notes

Utilisez cette méthode si vous souhaitez qu’un contrôle de menu ait les mêmes éléments de menu qu’une ressource de menu. Vous appelez cette méthode après avoir appelé [CMFCMenuBar :: Create](#create) ou [CMFCMenuBar :: CreateEx](#createex).

## <a name="cmfcmenubarenablehelpcombobox"></a><a name="enablehelpcombobox"></a> CMFCMenuBar::EnableHelpCombobox

Active une zone de liste modifiable **d’aide** située sur le côté droit de la barre de menus.

```cpp
void EnableHelpCombobox(
    UINT uiID,
    LPCTSTR lpszPrompt = NULL,
    int nComboBoxWidth = 150);
```

### <a name="parameters"></a>Paramètres

*uiID*<br/>
dans ID de commande pour le bouton de la zone de liste déroulante d' **aide** .

*lpszPrompt*<br/>
dans Chaîne qui contient le texte que l’infrastructure affiche dans la zone de liste déroulante si elle est vide et qu’elle n’est pas active. Par exemple, « entrez ici le texte ».

*nComboBoxWidth*<br/>
dans Largeur, en pixels, du bouton de la zone de liste déroulante.

### <a name="remarks"></a>Notes

La zone de liste déroulante d' **aide** ressemble à la zone de liste déroulante d' **aide** dans la barre de menus de Microsoft Word.

Quand vous appelez cette méthode avec *uiID* défini sur 0, cette méthode masque la zone de liste déroulante. Sinon, cette méthode affiche automatiquement la zone de liste déroulante sur le côté droit de la barre de menus. Après avoir appelé cette méthode, appelez [CMFCMenuBar :: GetHelpCombobox](#gethelpcombobox) pour obtenir un pointeur vers l’objet [CMFCToolBarComboBoxButton](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md) inséré.

## <a name="cmfcmenubarenablemenushadows"></a><a name="enablemenushadows"></a> CMFCMenuBar::EnableMenuShadows

Active les ombres pour les menus contextuels.

```
static void EnableMenuShadows(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
dans Paramètre booléen qui indique si les ombres doivent être activées pour les menus contextuels.

### <a name="remarks"></a>Notes

L’algorithme utilisé par cette méthode est complexe et peut diminuer les performances de votre application sur des systèmes plus lents.

## <a name="cmfcmenubargetavailableexpandsize"></a><a name="getavailableexpandsize"></a> CMFCMenuBar::GetAvailableExpandSize

```
virtual int GetAvailableExpandSize() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetcolumnwidth"></a><a name="getcolumnwidth"></a> CMFCMenuBar::GetColumnWidth

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetdefaultmenu"></a><a name="getdefaultmenu"></a> CMFCMenuBar::GetDefaultMenu

Récupère un handle vers le menu d’origine. Le Framework charge le menu d’origine à partir du fichier de ressources.

```
HMENU GetDefaultMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

Handle d’une ressource de menu.

### <a name="remarks"></a>Notes

Si votre application personnalise un menu, vous pouvez utiliser cette méthode pour récupérer un handle du menu d’origine.

## <a name="cmfcmenubargetdefaultmenuresid"></a><a name="getdefaultmenuresid"></a> CMFCMenuBar::GetDefaultMenuResId

Récupère l’identificateur de ressource pour le menu par défaut.

```
UINT GetDefaultMenuResId() const;
```

### <a name="return-value"></a>Valeur renvoyée

Identificateur de ressource de menu.

### <a name="remarks"></a>Notes

L’infrastructure charge le menu par défaut de l' `CMFCMenuBar` objet à partir du fichier de ressources.

## <a name="cmfcmenubargetfloatpopupdirection"></a><a name="getfloatpopupdirection"></a> CMFCMenuBar::GetFloatPopupDirection

```
int GetFloatPopupDirection(CMFCToolBarMenuButton* pButton);
```

### <a name="parameters"></a>Paramètres

dans *pButton*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetforcedownarrows"></a><a name="getforcedownarrows"></a> CMFCMenuBar::GetForceDownArrows

```
BOOL GetForceDownArrows();
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargethelpcombobox"></a><a name="gethelpcombobox"></a> CMFCMenuBar::GetHelpCombobox

Retourne un pointeur vers la zone de liste déroulante **d’aide** .

```
CMFCToolBarComboBoxButton* GetHelpCombobox();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers la zone de liste déroulante **d’aide** . NULL si la zone de liste déroulante **d’aide** est masquée ou désactivée.

### <a name="remarks"></a>Notes

La zone de liste déroulante **aide** se trouve sur le côté droit de la barre de menus. Appelez la méthode [CMFCMenuBar :: EnableHelpCombobox](#enablehelpcombobox) pour activer cette zone de liste déroulante.

## <a name="cmfcmenubargethmenu"></a><a name="gethmenu"></a> CMFCMenuBar::GetHMenu

Récupère le handle du menu attaché à l’objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) .

```
HMENU GetHMenu() const;
```

## <a name="cmfcmenubargetmenufont"></a><a name="getmenufont"></a> CMFCMenuBar::GetMenuFont

Récupère la police de menu actuelle.

```
static const CFont& GetMenuFont(BOOL bHorz = TRUE);
```

### <a name="parameters"></a>Paramètres

*bHorz*<br/>
dans Paramètre booléen qui spécifie s’il faut retourner la police horizontale ou verticale. TRUE indique la police horizontale.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un paramètre [CFont](../../mfc/reference/cfont-class.md) qui contient la police de la barre de menus actuelle.

### <a name="remarks"></a>Notes

La police retournée est un paramètre global pour l’application. Deux polices globales sont conservées pour tous les `CMFCMenuBar` objets. Ces polices distinctes sont utilisées pour les barres de menus horizontales et verticales.

## <a name="cmfcmenubargetmenuitem"></a><a name="getmenuitem"></a> CMFCMenuBar::GetMenuItem

Récupère un objet [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) sur une barre de menus en fonction de l’index de l’élément.

```
CMFCToolBarButton* GetMenuItem(int iItem) const;
```

### <a name="parameters"></a>Paramètres

*iItem*<br/>
dans Index de l’élément de menu à retourner.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l' `CMFCToolBarButton` objet qui correspond à l’index spécifié par *iItem*. NULL si l’index n’est pas valide.

## <a name="cmfcmenubargetrowheight"></a><a name="getrowheight"></a> CMFCMenuBar::GetRowHeight

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetsystembutton"></a><a name="getsystembutton"></a> CMFCMenuBar::GetSystemButton

```
CMFCToolBarMenuButtonsButton* GetSystemButton(
    UINT uiBtn,
    BOOL bByCommand = TRUE) const;
```

### <a name="parameters"></a>Paramètres

dans *uiBtn*<br/>

dans *bByCommand*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetsystembuttonscount"></a><a name="getsystembuttonscount"></a> CMFCMenuBar::GetSystemButtonsCount

```
int GetSystemButtonsCount() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubargetsystemmenu"></a><a name="getsystemmenu"></a> CMFCMenuBar::GetSystemMenu

```
CMFCToolBarSystemMenuButton* GetSystemMenu() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarhighlightdisableditems"></a><a name="highlightdisableditems"></a> CMFCMenuBar::HighlightDisabledItems

Contrôle si le Framework met en surbrillance les éléments de menu désactivés.

```
static void HighlightDisabledItems(BOOL bHighlight = TRUE);
```

### <a name="parameters"></a>Paramètres

*bHighlight*<br/>
dans Paramètre booléen qui indique si le Framework met en surbrillance les éléments de menu non disponibles.

### <a name="remarks"></a>Notes

Par défaut, l’infrastructure ne met pas en surbrillance les éléments de menu non disponibles lorsque l’utilisateur place le pointeur de la souris dessus.

## <a name="cmfcmenubarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a> CMFCMenuBar::IsButtonExtraSizeAvailable

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarishighlightdisableditems"></a><a name="ishighlightdisableditems"></a> CMFCMenuBar::IsHighlightDisabledItems

Indique si le Framework met en surbrillance les éléments de menu non disponibles.

```
static BOOL IsHighlightDisabledItems();
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si les éléments de menu non disponibles sont mis en surbrillance ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Par défaut, l’infrastructure ne met pas en surbrillance les éléments de menu non disponibles lorsque l’utilisateur place le pointeur de la souris dessus. Utilisez la méthode [CMFCMenuBar :: HighlightDisabledItems](#highlightdisableditems) pour activer cette fonctionnalité.

## <a name="cmfcmenubarismenushadows"></a><a name="ismenushadows"></a> CMFCMenuBar::IsMenuShadows

Indique si le Framework dessine des ombres pour les menus contextuels.

```
static BOOL IsMenuShadows();
```

### <a name="return-value"></a>Valeur renvoyée

TRUE si le Framework dessine des ombres de menu ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Utilisez la méthode [CMFCMenuBar :: EnableMenuShadows](#enablemenushadows) pour activer ou désactiver cette fonctionnalité.

## <a name="cmfcmenubarisrecentlyusedmenus"></a><a name="isrecentlyusedmenus"></a> CMFCMenuBar::IsRecentlyUsedMenus

Indique si les commandes de menu récemment utilisées sont affichées dans la barre de menus.

```
static BOOL IsRecentlyUsedMenus();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si l' `CMFCMenuBar` objet affiche les commandes de menu récemment utilisées ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez la fonction [CMFCMenuBar :: SetRecentlyUsedMenus](#setrecentlyusedmenus) pour contrôler si la barre de menus affiche les commandes de menu récemment utilisées.

## <a name="cmfcmenubarisshowallcommands"></a><a name="isshowallcommands"></a> CMFCMenuBar::IsShowAllCommands

Indique si les menus affichent toutes les commandes.

```
static BOOL IsShowAllCommands();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si `CMFCMenuBar` affiche toutes les commandes ; sinon, 0.

### <a name="remarks"></a>Notes

Un `CMFCMenuBar` objet peut être configuré pour afficher toutes les commandes ou afficher uniquement un sous-ensemble de commandes. Pour plus d’informations sur cette fonctionnalité, consultez [CMFCMenuBar, classe](../../mfc/reference/cmfcmenubar-class.md).

`IsShowAllCommands` indique comment cette fonctionnalité est configurée pour l' `CMFCMenuBar` objet. Pour contrôler les commandes de menu qui s’affichent, utilisez les méthodes [CMFCMenuBar :: SetShowAllCommands](#setshowallcommands) et [CMFCMenuBar :: SetRecentlyUsedMenus](#setrecentlyusedmenus).

## <a name="cmfcmenubarisshowallcommandsdelay"></a><a name="isshowallcommandsdelay"></a> CMFCMenuBar::IsShowAllCommandsDelay

Indique si l’objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) affiche toutes les commandes après un bref délai.

```
static BOOL IsShowAllCommandsDelay();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la barre de menus affiche des menus entiers après un bref délai ; Sinon, 0.

### <a name="remarks"></a>Notes

Quand vous configurez une barre de menus pour afficher les éléments utilisés récemment, la barre de menus affiche le menu complet de l’une des deux manières suivantes :

- Affichez le menu complet après un délai programmé lorsque l’utilisateur place le curseur sur la flèche en bas du menu.

- Affichez le menu complet après que l’utilisateur a cliqué sur la flèche en bas du menu.

Par défaut, tous les `CMFCMenuBar` objets utilisent l’option pour afficher le menu complet après un bref délai. Cette option ne peut pas être modifiée par programmation dans la `CMFCMenuBar` classe. Toutefois, un utilisateur peut modifier le comportement lors de la personnalisation de la barre d’outils à l’aide de la boîte de dialogue **personnaliser** .

## <a name="cmfcmenubarloadstate"></a><a name="loadstate"></a> CMFCMenuBar :: LoadState

Charge l’état de la barre de menus à partir du Registre Windows.

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Chaîne qui contient le chemin d’accès à une clé de Registre Windows.

*nIndex*<br/>
dans ID de contrôle de la barre de menus.

*uiID*<br/>
dans Valeur réservée.

### <a name="return-value"></a>Valeur renvoyée

TRUE si la méthode a réussi ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Utilisez la méthode [CMFCMenuBar :: Savestest](#savestate) pour enregistrer l’état de la barre de menus dans le registre. Les informations enregistrées incluent les éléments de menu, l’état d’ancrage et la position de la barre de menus.

Dans la plupart des cas, votre application n’appelle pas `LoadState` . Le Framework appelle cette méthode lorsqu’il initialise l’espace de travail.

## <a name="cmfcmenubaronchangehot"></a><a name="onchangehot"></a> CMFCMenuBar::OnChangeHot

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>Paramètres

dans *iHot*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarondefaultmenuloaded"></a><a name="ondefaultmenuloaded"></a> CMFCMenuBar::OnDefaultMenuLoaded

L’infrastructure appelle cette méthode lorsqu’elle charge la ressource de menu à partir du fichier de ressources.

```
virtual void OnDefaultMenuLoaded(HMENU hMenu);
```

### <a name="parameters"></a>Paramètres

*hMenu*<br/>
dans Handle pour le menu attaché à l' `CMFCMenuBar` objet.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette fonction est sans effet. Substituez cette fonction pour exécuter du code personnalisé une fois que le Framework a chargé une ressource de menu à partir du fichier de ressources.

## <a name="cmfcmenubaronsendcommand"></a><a name="onsendcommand"></a> CMFCMenuBar::OnSendCommand

```
virtual BOOL OnSendCommand(const CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

dans *pButton*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a> CMFCMenuBar::OnSetDefaultButtonText

L’infrastructure appelle cette méthode lorsque l’utilisateur modifie le texte d’un élément dans la barre de menus.

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>Paramètres

*pButton*<br/>
dans Pointeur vers l’objet [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) que l’utilisateur souhaite personnaliser.

### <a name="return-value"></a>Valeur renvoyée

TRUE si l’infrastructure applique les modifications de l’utilisateur à la barre de menus ; Sinon, FALSe.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette méthode remplace le texte du bouton par le texte fourni par l’utilisateur.

## <a name="cmfcmenubarontoolhittest"></a><a name="ontoolhittest"></a> CMFCMenuBar::OnToolHitTest

```
virtual INT_PTR OnToolHitTest(
    CPoint point,
    TOOLINFO* pTI) const;
```

### <a name="parameters"></a>Paramètres

dans *point*<br/>

dans *pTI*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarpretranslatemessage"></a><a name="pretranslatemessage"></a> CMFCMenuBar ::P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Paramètres

dans *PMSG*<br/>

### <a name="return-value"></a>Valeur renvoyée

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a> CMFCMenuBar :: RestoreOriginalstate

Appelée par l’infrastructure quand l’utilisateur sélectionne **Réinitialiser** dans la boîte de dialogue **personnaliser** .

```
virtual BOOL RestoreOriginalstate();
```

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si la méthode réussit ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode est appelée lorsque l’utilisateur sélectionne **Réinitialiser** dans le menu de personnalisation. Vous pouvez également appeler manuellement cette méthode pour réinitialiser par programme l’état de la barre de menus. Cette méthode charge l’état d’origine à partir du fichier de ressources.

Substituez cette méthode si vous souhaitez effectuer un traitement lorsque l’utilisateur sélectionne l’option de **réinitialisation** .

## <a name="cmfcmenubarsavestate"></a><a name="savestate"></a> CMFCMenuBar :: saveste

Enregistre l’état de l’objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) dans le Registre Windows.

```
virtual BOOL SaveState (
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT)-1);
```

### <a name="parameters"></a>Paramètres

*lpszProfileName*<br/>
dans Chaîne qui contient le chemin d’accès à une clé de Registre Windows.

*nIndex*<br/>
dans ID de contrôle de la barre de menus.

*uiID*<br/>
dans Valeur réservée.

### <a name="return-value"></a>Valeur renvoyée

TRUE en cas de réussite ; Sinon, FALSe.

### <a name="remarks"></a>Notes

En règle générale, votre application n’appelle pas `SaveState` . L’infrastructure appelle cette méthode lorsque l’espace de travail est sérialisé. Pour plus d’informations, consultez [CWinAppEx :: saveste](../../mfc/reference/cwinappex-class.md#savestate).

Les informations enregistrées incluent les éléments de menu, l’état d’ancrage et la position de la barre de menus.

## <a name="cmfcmenubarsetdefaultmenuresid"></a><a name="setdefaultmenuresid"></a> CMFCMenuBar::SetDefaultMenuResId

Définit le menu par défaut d’un objet [CMFCMenuBar](../../mfc/reference/cmfcmenubar-class.md) en fonction de l’ID de ressource.

```cpp
void SetDefaultMenuResId(UINT uiResId);
```

### <a name="parameters"></a>Paramètres

*uiResId*<br/>
dans ID de ressource pour le nouveau menu par défaut.

### <a name="remarks"></a>Notes

La méthode [CMFCMenuBar :: RestoreOriginalstate](#restoreoriginalstate) restaure le menu par défaut à partir du fichier de ressources.

Utilisez la méthode [CMFCMenuBar :: GetDefaultMenuResId](#getdefaultmenuresid) pour récupérer le menu par défaut sans le restaurer.

## <a name="cmfcmenubarsetforcedownarrows"></a><a name="setforcedownarrows"></a> CMFCMenuBar::SetForceDownArrows

```cpp
void SetForceDownArrows(BOOL bValue);
```

### <a name="parameters"></a>Paramètres

dans *bValue*<br/>

### <a name="remarks"></a>Notes

## <a name="cmfcmenubarsetmaximizemode"></a><a name="setmaximizemode"></a> CMFCMenuBar::SetMaximizeMode

L’infrastructure appelle cette méthode lorsqu’un MDI modifie son mode d’affichage et que la barre de menus doit être mise à jour.

```cpp
void SetMaximizeMode(
    BOOL bMax,
    CWnd* pWnd = NULL,
    BOOL bRecalcLayout = TRUE);
```

### <a name="parameters"></a>Paramètres

*bMax*<br/>
dans Valeur booléenne qui spécifie le mode. Pour plus d'informations, consultez la section Notes.

*pWnd*<br/>
dans Pointeur vers la fenêtre enfant MDI qui change.

*bRecalcLayout*<br/>
dans Valeur booléenne qui spécifie si la disposition de la barre de menus doit être recalculée immédiatement.

### <a name="remarks"></a>Notes

Quand une fenêtre enfant MDI est agrandie, une barre de menus attachée à la fenêtre frame principale MDI affiche le menu système et les boutons **réduire**, **agrandir** et **Fermer** . Si *Bmax* a la valeur true et que *pwnd* n’a pas la valeur null, la fenêtre enfant MDI est agrandie et la barre de menus doit incorporer les contrôles supplémentaires. Dans le cas contraire, la barre de menus retourne à son état normal.

## <a name="cmfcmenubarsetmenubuttonrtc"></a><a name="setmenubuttonrtc"></a> CMFCMenuBar::SetMenuButtonRTC

Définit les informations de classe d’exécution que l’infrastructure utilise lorsque l’utilisateur crée des boutons de menu.

```cpp
void SetMenuButtonRTC(CRuntimeClass* pMenuButtonRTC);
```

### <a name="parameters"></a>Paramètres

*pMenuButtonRTC*<br/>
dans Informations [CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md) pour une classe dérivée de la [classe CMFCMenuButton,](../../mfc/reference/cmfcmenubutton-class.md).

### <a name="remarks"></a>Notes

Quand un utilisateur ajoute de nouveaux boutons à la barre de menus, l’infrastructure crée les boutons de manière dynamique. Par défaut, il crée des `CMFCMenuButton` objets. Substituez cette méthode pour modifier le type des objets bouton que le Framework crée.

## <a name="cmfcmenubarsetmenufont"></a><a name="setmenufont"></a> CMFCMenuBar::SetMenuFont

Définit la police pour toutes les barres de menus de votre application.

```
static BOOL SetMenuFont(
    LPLOGFONT lpLogFont,
    BOOL bHorz = TRUE);
```

### <a name="parameters"></a>Paramètres

*lpLogFont*<br/>
dans Pointeur vers une structure [LOGFONT](/windows/win32/api/dimm/ns-dimm-logfonta) qui définit la police à définir.

*bHorz*<br/>
dans TRUE si vous souhaitez que le paramètre *lpLogFont* soit utilisé pour la police verticale, false si vous souhaitez qu’il soit utilisé pour la police horizontale.

### <a name="return-value"></a>Valeur renvoyée

TRUE si la méthode a réussi ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Deux polices sont utilisées pour tous les `CMFCMenuBar` objets. Ces polices distinctes sont utilisées pour les barres de menus horizontales et verticales.

Les paramètres de police sont des variables globales et affectent tous les `CMFCMenuBar` objets.

## <a name="cmfcmenubarsetrecentlyusedmenus"></a><a name="setrecentlyusedmenus"></a> CMFCMenuBar::SetRecentlyUsedMenus

Contrôle si une barre de menus affiche les commandes de menu récemment utilisées.

```
static void SetRecentlyUsedMenus (BOOL bOn = TRUE);
```

### <a name="parameters"></a>Paramètres

*Ble*<br/>
dans Valeur booléenne qui contrôle si les commandes de menu récemment utilisées sont affichées.

## <a name="cmfcmenubarsetshowallcommands"></a><a name="setshowallcommands"></a> CMFCMenuBar::SetShowAllCommands

Contrôle si un menu affiche toutes les commandes disponibles.

```
static void SetShowAllCommands(BOOL bShowAllCommands = TRUE);
```

### <a name="parameters"></a>Paramètres

*bShowAllCommands*<br/>
dans Paramètre booléen qui spécifie si le menu contextuel affiche toutes les commandes de menu.

### <a name="remarks"></a>Notes

Si un menu n’affiche pas toutes les commandes de menu, il masque les commandes qui sont rarement utilisées. Pour plus d’informations sur l’affichage des commandes de menu, consultez [CMFCMenuBar, classe](../../mfc/reference/cmfcmenubar-class.md).

## <a name="see-also"></a>Voir aussi

[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar, classe](../../mfc/reference/cmfctoolbar-class.md)
