---
description: 'En savoir plus sur : CToolBarCtrl, classe'
title: CToolBarCtrl (classe)
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 769403be6e4015df1de04d41fcb0a1b2721ee434
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97318557"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl (classe)

Fournit les fonctionnalités du contrôle commun de barre d'outils Windows.

## <a name="syntax"></a>Syntaxe

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CToolBarCtrl :: CToolBarCtrl](#ctoolbarctrl)|Construit un objet `CToolBarCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CToolBarCtrl :: AddBitmap](#addbitmap)|Ajoute une ou plusieurs images de bouton bitmap à la liste des images de bouton disponibles pour un contrôle de barre d’outils.|
|[CToolBarCtrl :: AddButtons](#addbuttons)|Ajoute un ou plusieurs boutons à un contrôle ToolBar.|
|[CToolBarCtrl :: AddString](#addstring)|Ajoute une nouvelle chaîne, passée comme ID de ressource, à la liste interne des chaînes de la barre d’outils.|
|[CToolBarCtrl :: AddStrings](#addstrings)|Ajoute une ou des chaînes, passées en tant que pointeur vers une mémoire tampon de chaînes séparées par des valeurs NULL, à la liste interne des chaînes de la barre d’outils.|
|[CToolBarCtrl :: AutoSize](#autosize)|Redimensionne un contrôle de barre d’outils.|
|[CToolBarCtrl :: ChangeBitmap](#changebitmap)|Modifie l’image bitmap d’un bouton dans le contrôle de barre d’outils actuel.|
|[CToolBarCtrl :: CheckButton](#checkbutton)|Vérifie ou efface un bouton donné dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: CommandToIndex](#commandtoindex)|Récupère l’index de base zéro pour le bouton associé à l’identificateur de commande spécifié.|
|[CToolBarCtrl :: Create](#create)|Crée un contrôle ToolBar et l’attache à un `CToolBarCtrl` objet.|
|[CToolBarCtrl :: CreateEx](#createex)|Crée un contrôle de barre d’outils avec les styles étendus Windows spécifiés et l’attache à un `CToolBarCtrl` objet.|
|[CToolBarCtrl :: Customize](#customize)|Affiche la boîte de dialogue Personnaliser la barre d’outils.|
|[CToolBarCtrl ::D eleteButton](#deletebutton)|Supprime un bouton du contrôle ToolBar.|
|[CToolBarCtrl :: EnableButton](#enablebutton)|Active ou désactive le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: GetAnchorHighlight](#getanchorhighlight)|Récupère le paramètre de surbrillance d’ancrage d’une barre d’outils.|
|[CToolBarCtrl :: GetBitmap](#getbitmap)|Récupère l’index de l’image bitmap associée à un bouton dans une barre d’outils.|
|[CToolBarCtrl :: GetBitmapFlags](#getbitmapflags)|Obtient les indicateurs associés à l’image bitmap de la barre d’outils.|
|[CToolBarCtrl :: GetButton](#getbutton)|Récupère des informations sur le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: GetButtonCount](#getbuttoncount)|Récupère le nombre de boutons actuellement dans le contrôle ToolBar.|
|[CToolBarCtrl :: GetButtonInfo](#getbuttoninfo)|Récupère les informations d’un bouton dans une barre d’outils.|
|[CToolBarCtrl :: GetButtonSize](#getbuttonsize)|Récupère la largeur et la hauteur actuelles des boutons de la barre d’outils, en pixels.|
|[CToolBarCtrl :: GetColorScheme](#getcolorscheme)|Récupère le modèle de couleurs du contrôle de barre d’outils actuel.|
|[CToolBarCtrl :: GetDisabledImageList](#getdisabledimagelist)|Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons désactivés.|
|[CToolBarCtrl :: GetDropTarget](#getdroptarget)|Récupère l’interface [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) pour un contrôle ToolBar.|
|[CToolBarCtrl :: GetExtendedStyle](#getextendedstyle)|Récupère les styles étendus pour un contrôle ToolBar.|
|[CToolBarCtrl :: GetHotImageList](#gethotimagelist)|Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons « actifs ». Un bouton actif apparaît en surbrillance lorsque le pointeur de la souris se trouve au-dessus de lui.|
|[CToolBarCtrl :: GetHotItem](#gethotitem)|Récupère l’index de l’élément réactif dans une barre d’outils.|
|[CToolBarCtrl :: GetImageList](#getimagelist)|Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons dans leur état par défaut.|
|[CToolBarCtrl :: GetInsertMark](#getinsertmark)|Récupère la marque d’insertion actuelle pour la barre d’outils.|
|[CToolBarCtrl :: GetInsertMarkColor](#getinsertmarkcolor)|Récupère la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.|
|[CToolBarCtrl :: GetItemRect](#getitemrect)|Récupère le rectangle englobant d’un bouton dans un contrôle ToolBar.|
|[CToolBarCtrl :: GetMaxSize](#getmaxsize)|Récupère la taille totale de tous les boutons et séparateurs visibles dans la barre d’outils.|
|[CToolBarCtrl :: GetMaxTextRows](#getmaxtextrows)|Récupère le nombre maximal de lignes de texte affichées sur un bouton de barre d’outils.|
|[CToolBarCtrl :: GetMetrics](#getmetrics)|Récupère les métriques d’un contrôle ToolBar.|
|[CToolBarCtrl :: GetPadding](#getpadding)|Récupère le remplissage horizontal et vertical du contrôle de barre d’outils actuel.|
|[CToolBarCtrl :: GetPressedImageList](#getpressedimagelist)|Récupère la liste d’images que le contrôle de barre d’outils actuelle utilise pour représenter les boutons dans un état appuyé.|
|[CToolBarCtrl :: GetRect](#getrect)|Récupère le rectangle englobant d’un bouton de barre d’outils spécifié.|
|[CToolBarCtrl :: GetRows](#getrows)|Récupère le nombre de lignes de boutons actuellement affichées dans la barre d’outils.|
|[CToolBarCtrl :: GetState](#getstate)|Récupère des informations sur l’état du bouton spécifié dans un contrôle ToolBar, par exemple s’il est activé, appuyé ou activé.|
|[CToolBarCtrl :: GetString](#getstring)|Récupère une chaîne de barre d’outils.|
|[CToolBarCtrl :: GetStyle](#getstyle)|Récupère les styles en cours d’utilisation pour un contrôle ToolBar.|
|[CToolBarCtrl :: GetToolTips](#gettooltips)|Récupère le handle du contrôle d’info-bulle, le cas échéant, associé au contrôle de barre d’outils.|
|[CToolBarCtrl :: HideButton](#hidebutton)|Masque ou affiche le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: HitTest](#hittest)|Détermine où un point se trouve dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: Indeterminate](#indeterminate)|Définit ou efface l’état indéterminé (gris) du bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: InsertButton](#insertbutton)|Insère un bouton dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: InsertMarkHitTest](#insertmarkhittest)|Récupère les informations sur les marques d’insertion pour un point dans une barre d’outils.|
|[CToolBarCtrl :: IsButtonChecked](#isbuttonchecked)|Indique si le bouton spécifié dans un contrôle de barre d’outils est activé.|
|[CToolBarCtrl :: IsButtonEnabled](#isbuttonenabled)|Indique si le bouton spécifié dans un contrôle de barre d’outils est activé.|
|[CToolBarCtrl :: IsButtonHidden](#isbuttonhidden)|Indique si le bouton spécifié dans un contrôle ToolBar est masqué.|
|[CToolBarCtrl :: IsButtonHighlighted](#isbuttonhighlighted)|Vérifie l’état de mise en surbrillance du bouton de la barre d’outils.|
|[CToolBarCtrl :: IsButtonIndeterminate](#isbuttonindeterminate)|Indique si l’état du bouton spécifié dans un contrôle de barre d’outils est indéterminé (gris).|
|[CToolBarCtrl :: IsButtonPressed](#isbuttonpressed)|Indique si le bouton spécifié dans un contrôle de barre d’outils est enfoncé.|
|[CToolBarCtrl :: LoadImages](#loadimages)|Charge des bitmaps dans la liste d’images d’un contrôle ToolBar.|
|[CToolBarCtrl :: MapAccelerator](#mapaccelerator)|Mappe un caractère d’accélérateur à un bouton de barre d’outils.|
|[CToolBarCtrl :: MarkButton](#markbutton)|Définit l’état de surbrillance d’un bouton donné dans un contrôle ToolBar.|
|[CToolBarCtrl :: MoveButton](#movebutton)|Déplace un bouton d’un index vers un autre.|
|[CToolBarCtrl ::P ressButton](#pressbutton)|Appuie sur le bouton spécifié ou le relâche dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: ReplaceBitmap](#replacebitmap)|Remplace la bitmap existante dans le contrôle de barre d’outils actuel par une nouvelle image bitmap.|
|[CToolBarCtrl :: RestoreState](#restorestate)|Restaure l’état du contrôle de barre d’outils.|
|[CToolBarCtrl :: saveste](#savestate)|Enregistre l’état du contrôle de barre d’outils.|
|[CToolBarCtrl :: SetAnchorHighlight](#setanchorhighlight)|Définit le paramètre de surbrillance d’ancrage pour une barre d’outils.|
|[CToolBarCtrl :: SetBitmapSize](#setbitmapsize)|Définit la taille des images bitmap à ajouter à un contrôle ToolBar.|
|[CToolBarCtrl :: SetButtonInfo](#setbuttoninfo)|Définit les informations d’un bouton existant dans une barre d’outils.|
|[CToolBarCtrl :: SetButtonSize](#setbuttonsize)|Définit la taille des boutons à ajouter à un contrôle ToolBar.|
|[CToolBarCtrl :: SetButtonStructSize](#setbuttonstructsize)|Spécifie la taille de la `TBBUTTON` structure.|
|[CToolBarCtrl :: SetButtonWidth](#setbuttonwidth)|Définit les largeurs minimale et maximale des boutons dans le contrôle ToolBar.|
|[CToolBarCtrl :: SetCmdID](#setcmdid)|Définit l’identificateur de commande à envoyer à la fenêtre propriétaire lorsque le bouton spécifié est enfoncé.|
|[CToolBarCtrl :: SetColorScheme](#setcolorscheme)|Définit le modèle de couleurs du contrôle de barre d’outils actuel.|
|[CToolBarCtrl :: SetDisabledImageList](#setdisabledimagelist)|Définit la liste d’images que le contrôle ToolBar utilisera pour afficher les boutons désactivés.|
|[CToolBarCtrl :: SetDrawTextFlags](#setdrawtextflags)|Définit les indicateurs dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui est utilisé pour dessiner le texte dans le rectangle spécifié, mis en forme en fonction de la façon dont les indicateurs sont définis.|
|[CToolBarCtrl :: SetExtendedStyle](#setextendedstyle)|Définit les styles étendus pour un contrôle de barre d’outils.|
|[CToolBarCtrl :: SetHotImageList](#sethotimagelist)|Définit la liste d’images que le contrôle de barre d’outils utilisera pour afficher les boutons « actifs ».|
|[CToolBarCtrl :: SetHotItem](#sethotitem)|Définit l’élément réactif dans une barre d’outils.|
|[CToolBarCtrl :: SetImageList](#setimagelist)|Définit la liste d’images que la barre d’outils utilisera pour afficher les boutons dont l’État par défaut est.|
|[CToolBarCtrl :: SetIndent](#setindent)|Définit la mise en retrait du premier bouton dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: SetInsertMark](#setinsertmark)|Définit la marque d’insertion actuelle pour la barre d’outils.|
|[CToolBarCtrl :: SetInsertMarkColor](#setinsertmarkcolor)|Définit la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.|
|[CToolBarCtrl :: SetMaxTextRows](#setmaxtextrows)|Définit le nombre maximal de lignes de texte affichées sur un bouton de barre d’outils.|
|[CToolBarCtrl :: SetMetrics](#setmetrics)|Définit les métriques d’un contrôle ToolBar.|
|[CToolBarCtrl :: SetOwner](#setowner)|Définit la fenêtre pour recevoir des messages de notification à partir du contrôle ToolBar.|
|[CToolBarCtrl :: SetPadding](#setpadding)|Définit le remplissage horizontal et vertical du contrôle de barre d’outils actuel.|
|[CToolBarCtrl :: SetPressedImageList](#setpressedimagelist)|Définit la liste d’images que le contrôle de barre d’outils actuelle utilise pour représenter les boutons dans un état appuyé.|
|[CToolBarCtrl :: SetRows](#setrows)|Définit le nombre de lignes de boutons affichées dans la barre d’outils.|
|[CToolBarCtrl :: SetState](#setstate)|Définit l’état du bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl :: SetStyle](#setstyle)|Définit les styles pour un contrôle de barre d’outils.|
|[CToolBarCtrl :: SetToolTips](#settooltips)|Associe un contrôle d’info-bulle au contrôle ToolBar.|
|[CToolBarCtrl :: SetWindowTheme](#setwindowtheme)|Définit le style visuel d’un contrôle de barre d’outils.|

## <a name="remarks"></a>Notes

Ce contrôle (et par conséquent la `CToolBarCtrl` classe) est uniquement disponible pour les programmes qui s’exécutent sous windows 95/98 et Windows NT version 3,51 et versions ultérieures.

Un contrôle commun de barre d’outils Windows est une fenêtre enfant rectangulaire qui contient un ou plusieurs boutons. Ces boutons peuvent afficher une image bitmap, une chaîne, ou les deux. Quand l’utilisateur choisit un bouton, il envoie un message de commande à la fenêtre propriétaire de la barre d’outils. En règle générale, les boutons d’une barre d’outils correspondent aux éléments du menu de l’application ; ils offrent un moyen plus direct pour l’utilisateur d’accéder aux commandes d’une application.

`CToolBarCtrl` les objets contiennent plusieurs structures de données internes importantes : une liste de bitmaps d’image de bouton ou une liste d’images, une liste de chaînes de noms de bouton et une liste de `TBBUTTON` structures qui associent une image et/ou une chaîne à la position, le style, l’État et l’ID de commande du bouton. Chacun des éléments de ces structures de données est référencé par un index de base zéro. Avant de pouvoir utiliser un `CToolBarCtrl` objet, vous devez configurer ces structures de données. La liste de chaînes peut uniquement être utilisée pour les étiquettes de bouton ; vous ne pouvez pas récupérer des chaînes à partir de la barre d’outils.

Pour utiliser un `CToolBarCtrl` objet, vous devez généralement suivre les étapes suivantes :

1. Construisez l' `CToolBarCtrl` objet.

1. Appelez [Create](#create) pour créer le contrôle commun de barre d’outils Windows et l’attacher à l' `CToolBarCtrl` objet. Indiquez le style de la barre d’outils à l’aide de styles, tels que TBSTYLE_TRANSPARENT pour une barre d’outils transparente ou TBSTYLE_DROPDOWN pour une barre d’outils qui prend en charge les boutons de style déroulant.

1. Identifiez la façon dont vous souhaitez que les boutons de la barre d’outils s’affichent :

   - Pour utiliser des images bitmap pour les boutons, ajoutez les bitmaps de bouton à la barre d’outils en appelant [AddBitmap](#addbitmap).

   - Pour utiliser des images affichées à partir d’une liste d’images pour les boutons, spécifiez la liste d’images en appelant [SetImageList](#setimagelist), [SetHotImageList](#sethotimagelist)ou [SetDisabledImageList](#setdisabledimagelist).

   - Pour utiliser des étiquettes de chaîne pour les boutons, ajoutez les chaînes à la barre d’outils en appelant [AddString](#addstring) et/ou [AddStrings](#addstrings).

1. Ajoutez des structures de bouton à la barre d’outils en appelant [AddButtons](#addbuttons).

1. Si vous souhaitez des info-bulles pour un bouton de barre d’outils dans une fenêtre propriétaire qui n’est pas un `CFrameWnd` , vous devez gérer les messages TTN_NEEDTEXT dans la fenêtre propriétaire de la barre d’outils, comme décrit dans [gestion des notifications d’info-bulle](../../mfc/handling-tool-tip-notifications.md). Si la fenêtre parente de la barre d’outils est dérivée de `CFrameWnd` , des info-bulles s’affichent sans aucun effort supplémentaire de votre part, car `CFrameWnd` fournit un gestionnaire par défaut.

1. Si vous souhaitez que votre utilisateur puisse personnaliser la barre d’outils, gérez les messages de notification de personnalisation dans la fenêtre propriétaire comme décrit dans [gestion des notifications de personnalisation](../../mfc/handling-customization-notifications.md).

Vous pouvez utiliser [saveste](#savestate) pour enregistrer l’état actuel d’un contrôle ToolBar dans le registre et [RestoreState](#restorestate) pour restaurer l’État en fonction des informations précédemment stockées dans le registre. En plus d’enregistrer l’état de la barre d’outils entre les utilisations de l’application, les applications stockent généralement l’état avant que l’utilisateur ne commence à personnaliser la barre d’outils au cas où l’utilisateur souhaiterait restaurer l’état d’origine de la barre d’outils.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Prise en charge d’Internet Explorer version 4,0 et versions ultérieures

Pour prendre en charge les fonctionnalités introduites dans Internet Explorer, version 4,0 et versions ultérieures, MFC fournit la prise en charge de la liste d’images et des styles transparents et plats pour les contrôles ToolBar.

Une barre d’outils transparente permet au client dans la barre d’outils de s’afficher. Pour créer une barre d’outils transparente, utilisez à la fois les styles TBSTYLE_FLAT et TBSTYLE_TRANSPARENT. Les barres d’outils transparentes sont suivies à chaud ; autrement dit, lorsque le pointeur de la souris se déplace au-dessus d’un bouton actif sur la barre d’outils, l’apparence du bouton change. Les barres d’outils créées uniquement avec le style TBSTYLE_FLAT contiennent des boutons qui ne sont pas transparents.

La prise en charge de la liste d’images permet de contrôler une plus grande flexibilité pour le comportement par défaut, les images à chaud et les images désactivées. Utilisez [GetImageList](#getimagelist), [GetHotImageList](#gethotimagelist)et [GetDisabledImageList](#getdisabledimagelist) avec la barre d’outils transparente pour manipuler l’image en fonction de son état :

Pour plus d’informations sur l’utilisation de `CToolBarCtrl` , consultez [contrôles](../../mfc/controls-mfc.md) et [utilisation de CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a> CToolBarCtrl :: AddBitmap

Ajoute une ou plusieurs images de bouton à la liste des images de bouton stockées dans le contrôle de barre d’outils.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Paramètres

*nNumButtons*<br/>
Nombre d’images de bouton dans l’image bitmap.

*nBitmapID*<br/>
Identificateur de ressource de la bitmap qui contient l’image ou les images du bouton à ajouter.

*pBitmap*<br/>
Pointeur vers l' `CBitmap` objet qui contient l’image ou les images du bouton à ajouter.

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro de la première nouvelle image en cas de réussite ; sinon-1.

### <a name="remarks"></a>Notes

Vous pouvez utiliser l’API Windows [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap) pour mapper les couleurs avant d’ajouter l’image bitmap à la barre d’outils. Si vous transmettez un pointeur vers un `CBitMap` objet, vous devez vous assurer que l’image bitmap n’est pas détruite tant que la barre d’outils n’a pas été détruite.

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a> CToolBarCtrl :: AddButtons

Ajoute un ou plusieurs boutons à un contrôle ToolBar.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Paramètres

*nNumButtons*<br/>
Nombre de boutons à ajouter.

*lpButtons*<br/>
Adresse d’un tableau de `TBBUTTON` structures qui contient des informations sur les boutons à ajouter. Le tableau doit contenir le même nombre d’éléments que les boutons spécifiés par *nNumButtons*.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Le pointeur *lpButtons* pointe vers un tableau de `TBBUTTON` structures. Chaque `TBBUTTON` structure associe le bouton ajouté avec le style du bouton, l’image et/ou la chaîne, l’ID de commande, l’État et les données définies par l’utilisateur :

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

Les membres sont les suivants :

- `iBitmap`

   Index de base zéro de l’image du bouton,-1 si aucune image n’est pour ce bouton.

- `idCommand`

   Identificateur de commande associé au bouton. Cet identificateur est envoyé dans un message de WM_COMMAND lorsque le bouton est sélectionné. Si le `fsStyle` membre a la valeur TBSTYLE_SEP, ce membre doit être égal à zéro.

- `fsState`

   Indicateurs d’État du bouton. Il peut s’agir d’une combinaison des valeurs listées ci-dessous :

  - TBSTATE_CHECKED le bouton a le style TBSTYLE_CHECKED et est enfoncé.

  - TBSTATE_ENABLED le bouton accepte l’entrée d’utilisateur. Un bouton qui n’a pas cet État n’accepte pas les entrées d’utilisateur et est grisé.

  - TBSTATE_HIDDEN le bouton n’est pas visible et ne peut pas recevoir d’entrée d’utilisateur.

  - TBSTATE_INDETERMINATE le bouton est grisé.

  - TBSTATE_PRESSED le bouton est enfoncé.

  - TBSTATE_WRAP un saut de ligne suit le bouton. Le bouton doit également avoir l’État TBSTATE_ENABLED.

- `fsStyle`

   Style du bouton. Il peut s’agir d’une combinaison des valeurs listées ci-dessous :

  - TBSTYLE_BUTTON crée un bouton de commande standard.

  - TBSTYLE_CHECK crée un bouton qui bascule entre les États enfoncé et inpresse chaque fois que l’utilisateur clique dessus. Le bouton a une couleur d’arrière-plan différente lorsqu’il est dans un état appuyé.

  - TBSTYLE_CHECKGROUP crée un bouton de vérification qui reste enfoncé jusqu’à ce qu’un autre bouton du groupe soit enfoncé.

  - TBSTYLE_GROUP crée un bouton qui reste enfoncé jusqu’à ce qu’un autre bouton du groupe soit enfoncé.

  - TBSTYLE_SEP crée un séparateur en fournissant un petit intervalle entre les groupes de boutons. Un bouton qui a ce style ne reçoit pas d’entrée d’utilisateur.

- `dwData`

   Données définies par l’utilisateur.

- `iString`

   Index de base zéro de la chaîne à utiliser comme étiquette du bouton,-1 s’il n’y a aucune chaîne pour ce bouton.

L’image et/ou la chaîne dont vous indiquez l’index doit avoir été ajoutée précédemment à la liste du contrôle ToolBar à l’aide de [AddBitmap](#addbitmap), [AddString](#addstring)et/ou [AddStrings](#addstrings).

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a> CToolBarCtrl :: AddString

Ajoute une nouvelle chaîne, passée comme ID de ressource, à la liste interne des chaînes de la barre d’outils.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Paramètres

*nStringID*<br/>
Identificateur de ressource de la ressource de type chaîne à ajouter à la liste de chaînes du contrôle ToolBar.

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro de la première nouvelle chaîne ajoutée en cas de réussite ; sinon-1.

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a> CToolBarCtrl :: AddStrings

Ajoute une ou des chaînes à la liste de chaînes disponibles pour un contrôle ToolBar.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Paramètres

*lpszStrings*<br/>
Adresse d’une mémoire tampon qui contient une ou plusieurs chaînes se terminant par un caractère null à ajouter à la liste de chaînes de la barre d’outils. La dernière chaîne doit se terminer par deux caractères null.

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro de la première nouvelle chaîne ajoutée en cas de réussite ; sinon-1.

### <a name="remarks"></a>Notes

Les chaînes contenues dans la mémoire tampon doivent être séparées par un caractère null. Vous devez vous assurer que la dernière chaîne a deux marques de fin null. Pour mettre correctement en forme une chaîne constante, vous pouvez l’écrire comme suit :

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

ou :

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

Vous ne devez pas passer un `CString` objet à cette fonction, car il n’est pas possible d’avoir plus d’un caractère NULL dans un `CString` .

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a> CToolBarCtrl :: AutoSize

Redimensionne le contrôle de barre d’outils dans son intégralité.

```cpp
void AutoSize();
```

### <a name="remarks"></a>Notes

Vous devez appeler cette fonction lorsque la taille de la fenêtre parente change ou lorsque la taille de la barre d’outils change (par exemple, lorsque vous définissez la taille du bouton ou de la bitmap, ou ajoutez des chaînes).

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a> CToolBarCtrl :: ChangeBitmap

Modifie l’image bitmap d’un bouton dans le contrôle de barre d’outils actuel.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Paramètres

*idButton*\
dans Identificateur de commande du bouton qui doit recevoir une nouvelle image bitmap.

*iBitmap*\
dans Index de base zéro d’une image dans la liste d’images du contrôle de barre d’outils actuel.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Si cette méthode réussit, le système affiche l’image spécifiée dans le bouton spécifié.

Cette méthode envoie le message [TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant modifie l’image bitmap du bouton **Enregistrer du fichier** en bitmap pour le bouton **à propos** de.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a> CToolBarCtrl :: CheckButton

Vérifie ou efface un bouton donné dans un contrôle de barre d’outils.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton à activer ou à désactiver.

*bCheck*<br/>
TRUE pour activer le bouton, FALSe pour l’effacer.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Lorsqu’un bouton a été activé, il semble avoir été enfoncé. Si vous souhaitez modifier plusieurs États de bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a> CToolBarCtrl :: CommandToIndex

Récupère l’index de base zéro pour le bouton associé à l’identificateur de commande spécifié.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
ID de commande dont vous souhaitez Rechercher l’index de bouton.

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro pour le bouton associé à l’ID de commande.

### <a name="remarks"></a>Notes

## <a name="ctoolbarctrlcreate"></a><a name="create"></a> CToolBarCtrl :: Create

Crée un contrôle ToolBar et l’attache à un `CToolBarCtrl` objet.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle*<br/>
Spécifie le style du contrôle ToolBar. Les barres d’outils doivent toujours avoir le style WS_CHILD. En outre, vous pouvez spécifier n’importe quelle combinaison de styles de barres d’outils et de styles de fenêtre, comme décrit dans la **section Notes**.

*rectangulaire*<br/>
Spécifie éventuellement la taille et la position du contrôle ToolBar. Il peut s’agir d’un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou d’une structure [Rect](/windows/win32/api/windef/ns-windef-rect) .

*pParentWnd*<br/>
Spécifie la fenêtre parente du contrôle ToolBar. Il ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle ToolBar.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Vous construisez un `CToolBarCtrl` en deux étapes. Tout d’abord, appelez le constructeur, puis appelez `Create` , qui crée le contrôle ToolBar et l’attache à l' `CToolBarCtrl` objet. Appliquez les styles de fenêtre suivants à un contrôle ToolBar.

- WS_CHILD toujours

- WS_VISIBLE généralement

- WS_DISABLED rarement

Consultez [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le SDK Windows pour obtenir une description des styles de fenêtre.

Si vous le souhaitez, appliquez une combinaison de [styles de contrôles communs](/windows/win32/Controls/common-control-styles), comme décrit dans la SDK Windows.

Appliquez une combinaison de styles de barre d’outils au contrôle ou aux boutons eux-mêmes. Les styles sont décrits dans la rubrique [contrôle de barre d’outils et styles de bouton](/windows/win32/Controls/toolbar-control-and-button-styles) dans la SDK Windows.

Pour utiliser les styles de barre d’outils étendus, appelez [SetExtendedStyle](#setextendedstyle) après avoir appelé `Create` . Pour créer une barre d’outils avec des styles de fenêtre étendus, appelez [CToolBarCtrl :: CreateEx](#createex) au lieu de `Create` .

Le contrôle ToolBar définit automatiquement la taille et la position de la fenêtre de la barre d’outils. La hauteur est basée sur la hauteur des boutons dans la barre d’outils. La largeur est identique à la largeur de la zone cliente de la fenêtre parente. Les styles CCS_TOP et CCS_BOTTOM déterminent si la barre d’outils est positionnée le long du bord supérieur ou inférieur de la zone cliente. Par défaut, une barre d’outils a le style CCS_TOP.

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a> CToolBarCtrl :: CreateEx

Crée un contrôle (une fenêtre enfant) et l’associe à l' `CToolBarCtrl` objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour obtenir la liste des styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le SDK Windows.

*dwStyle*<br/>
Spécifie le style du contrôle ToolBar. Les barres d’outils doivent toujours avoir le style WS_CHILD. En outre, vous pouvez spécifier n’importe quelle combinaison de styles de barre d’outils et de styles de fenêtre, comme décrit dans la section **Notes** de [Create](#create).

*rectangulaire*<br/>
Référence à une structure [Rect](/windows/win32/api/windef/ns-windef-rect) décrivant la taille et la position de la fenêtre à créer, en coordonnées clientes de *pParentWnd*.

*pParentWnd*<br/>
Pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
ID de la fenêtre enfant du contrôle.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au lieu de [Create](#create) pour appliquer des styles Windows étendus, spécifiés par la préversion de style étendu Windows **WS_EX_**. `CreateEx` crée le contrôle avec les styles Windows étendus spécifiés par *dwExStyle*. Définir des styles étendus spécifiques à un contrôle à l’aide de [SetExtendedStyle](#setextendedstyle). Par exemple, utilisez `CreateEx` pour définir des styles de ce type comme WS_EX_CONTEXTHELP, mais utilisez `SetExtendedStyle` pour définir des styles de ce type comme TBSTYLE_EX_DRAWDDARROWS. Pour plus d’informations, consultez les styles décrits dans [barre d’outils styles étendus](/windows/win32/Controls/toolbar-extended-styles) dans la SDK Windows.

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a> CToolBarCtrl :: CToolBarCtrl

Construit un objet `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Notes

Vous devez appeler [Create](#create) pour rendre la barre d’outils utilisable.

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a> CToolBarCtrl :: Customize

Affiche la boîte de dialogue Personnaliser la barre d’outils.

```cpp
void Customize();
```

### <a name="remarks"></a>Notes

Cette boîte de dialogue permet à l’utilisateur de personnaliser la barre d’outils en ajoutant et en supprimant des boutons. Pour prendre en charge la personnalisation, la fenêtre parente de votre barre d’outils doit gérer les messages de notification de personnalisation comme décrit dans [gestion des notifications de personnalisation](../../mfc/handling-customization-notifications.md). Votre barre d’outils doit également avoir été créée avec le style CCS_ADJUSTABLE, comme décrit dans [CToolBarCtrl :: Create](#create).

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a> CToolBarCtrl ::D eleteButton

Supprime un bouton du contrôle ToolBar.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro du bouton à supprimer.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a> CToolBarCtrl :: EnableButton

Active ou désactive le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton à activer ou à désactiver.

*bEnable*<br/>
TRUE pour activer le bouton. FALSe pour désactiver le bouton.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Lorsqu’un bouton a été activé, il peut être appuyé et activé. Si vous souhaitez modifier plusieurs États de bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a> CToolBarCtrl :: GetAnchorHighlight

Récupère le paramètre de surbrillance d’ancrage d’une barre d’outils.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Valeur renvoyée

Si la valeur est différente de zéro, la mise en surbrillance de l’ancre est activée. Si la valeur est zéro, la mise en surbrillance d’ancrage est désactivée.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a> CToolBarCtrl :: GetBitmap

Récupère l’index de l’image bitmap associée à un bouton dans une barre d’outils.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dont l’index bitmap doit être récupéré.

### <a name="return-value"></a>Valeur renvoyée

Retourne l’index de l’image bitmap en cas de réussite, ou zéro dans le cas contraire.

### <a name="remarks"></a>Notes

Implémente les fonctionnalités de [TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap) dans le SDK Windows.

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a> CToolBarCtrl :: GetBitmapFlags

Récupère les indicateurs de bitmap de la barre d’outils.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Valeur renvoyée

UINT qui a l’indicateur TBBF_LARGE défini si l’affichage peut prendre en charge des bitmaps de barre d’outils volumineuses, désactivez-le dans le cas contraire.

### <a name="remarks"></a>Notes

Vous devez l’appeler après avoir créé la barre d’outils, mais avant d’ajouter des bitmaps à la barre d’outils. La valeur de retour indique si l’affichage prend en charge des bitmaps de grande taille. Si l’affichage prend en charge les bitmaps de grande taille et si vous choisissez de les utiliser, appelez [SetBitmapSize](#setbitmapsize) et [SetButtonSize](#setbuttonsize) avant d’ajouter votre bitmap de grande taille à l’aide de [AddBitmap](#addbitmap).

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a> CToolBarCtrl :: GetButton

Récupère des informations sur le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro du bouton pour lequel des informations doivent être récupérées.

*lpButton*<br/>
Adresse de la `TBBUTTON` structure qui doit recevoir une copie des informations sur le bouton. Pour plus d’informations sur la structure, consultez [CToolBarCtrl :: AddButtons](#addbuttons) `TBBUTTON` .

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a> CToolBarCtrl :: GetButtonCount

Récupère le nombre de boutons actuellement dans le contrôle ToolBar.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre de boutons.

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a> CToolBarCtrl :: GetButtonInfo

Récupère les informations d’un bouton dans une barre d’outils.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur du bouton.

*ptbbi*<br/>
Pointeur vers une structure [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) qui reçoit les informations sur le bouton.

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro du bouton, en cas de réussite ; sinon-1.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a> CToolBarCtrl :: GetButtonSize

Obtient la taille d’un bouton de barre d’outils.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD qui contient les valeurs de largeur et de hauteur dans LOWORD et HIWORD, respectivement.

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a> CToolBarCtrl :: GetButtonText

Récupère le texte affiché d’un bouton spécifié sur le contrôle de barre d’outils actuel.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Paramètres

*idButton*\
dans Identificateur du bouton dont le texte affiché est récupéré.

### <a name="return-value"></a>Valeur renvoyée

[CString](../../atl-mfc-shared/using-cstring.md) qui contient le texte d’affichage du bouton spécifié.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext) , qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a> CToolBarCtrl :: GetColorScheme

Récupère le modèle de couleurs du contrôle de barre d’outils actuel.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Paramètres

*lpColorScheme*\
à Pointeur vers une structure [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) qui reçoit les informations de modèle de couleurs. Lorsque cette méthode est retournée, la structure décrit la couleur de surbrillance et la couleur de l’ombre du contrôle ToolBar.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme) , qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a> CToolBarCtrl :: GetDisabledImageList

Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons désactivés.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) , ou null si aucune liste d’images désactivées n’est définie.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)de message Win32, comme décrit dans le SDK Windows. L’implémentation MFC de `GetDisabledImageList` utilise un `CImageList` objet contenant les images de bouton du contrôle ToolBar, plutôt qu’un handle vers une liste d’images.

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a> CToolBarCtrl :: GetDropTarget

Récupère l’interface [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) pour un contrôle ToolBar.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Paramètres

*ppDropTarget*<br/>
Pointeur vers un pointeur d’interface [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) . Si une erreur se produit, un pointeur NULL est placé dans cette adresse.

### <a name="return-value"></a>Valeur renvoyée

Retourne une valeur HRESULT indiquant la réussite ou l’échec de l’opération.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETOBJECT](/windows/win32/Controls/tb-getobject)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a> CToolBarCtrl :: GetExtendedStyle

Récupère les styles étendus pour un contrôle ToolBar.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD qui représente les styles étendus en cours d’utilisation pour le contrôle ToolBar. Pour obtenir la liste des styles, consultez [styles étendus de la barre d’outils](/windows/win32/Controls/toolbar-extended-styles), dans la SDK Windows.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a> CToolBarCtrl :: GetHotImageList

Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons « actifs ». Un bouton actif apparaît en surbrillance lorsque le pointeur de la souris se trouve au-dessus de lui.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) , ou null si aucune liste d’images désactivées n’est définie.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)de message Win32, comme décrit dans le SDK Windows. Un bouton actif apparaît en surbrillance lorsque le pointeur de la souris se trouve au-dessus de lui.

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a> CToolBarCtrl :: GetHotItem

Récupère l’index de l’élément réactif dans une barre d’outils.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Valeur renvoyée

Index de base zéro de l’élément réactif dans une barre d’outils.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a> CToolBarCtrl :: GetImageList

Récupère la liste d’images utilisée par un contrôle de barre d’outils pour afficher les boutons dans leur état par défaut.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) , ou null si aucune liste d’images n’est définie.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a> CToolBarCtrl :: GetInsertMark

Récupère la marque d’insertion actuelle pour la barre d’outils.

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Paramètres

*ptbim*<br/>
Pointeur vers une structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui reçoit la marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a> CToolBarCtrl :: GetInsertMarkColor

Récupère la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui contient la couleur de la marque d’insertion actuelle.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a> CToolBarCtrl :: GetItemRect

Récupère le rectangle englobant d’un bouton dans un contrôle ToolBar.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro du bouton pour lequel des informations doivent être récupérées.

*lpRect*<br/>
Adresse d’une structure [Rect](/windows/win32/api/windef/ns-windef-rect) ou d’un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) qui reçoit les coordonnées du rectangle englobant.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction ne récupère pas le rectangle englobant pour les boutons dont l’État est défini sur TBSTATE_HIDDEN.

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a> CToolBarCtrl :: GetMaxSize

Récupère la taille totale de tous les boutons et séparateurs visibles dans la barre d’outils.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Paramètres

*pSize*<br/>
Pointeur vers une structure de [taille](/windows/win32/api/windef/ns-windef-size) qui reçoit la taille des éléments.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a> CToolBarCtrl :: GetMaxTextRows

Récupère le nombre maximal de lignes de texte affichées sur un bouton de barre d’outils.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre maximal de lignes de texte affichées sur un bouton de barre d’outils.

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a> CToolBarCtrl :: GetMetrics

Récupère les métriques de l' `CToolBarCtrl` objet.

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Paramètres

*ptbm*<br/>
Pointeur vers la structure [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) de l' `CToolBarCtrl` objet.

### <a name="remarks"></a>Notes

Cette fonction membre émule les fonctionnalités du message [TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics) , comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a> CToolBarCtrl :: GetPadding

Récupère le remplissage horizontal et vertical du contrôle de barre d’outils actuel.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Paramètres

*pnHorzPadding*\
à Entier qui reçoit le remplissage horizontal du contrôle ToolBar, en pixels.

*pnVertPadding*\
à Entier qui reçoit le remplissage vertical du contrôle de barre d’outils, en pixels.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_GETPADDING](/windows/win32/Controls/tb-getpadding) , qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a> CToolBarCtrl :: GetPressedImageList

Récupère la liste d’images que le contrôle de barre d’outils actuelle utilise pour représenter les boutons dans un état appuyé.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un [CImageList](../../mfc/reference/cimagelist-class.md) qui contient la liste d’images pour le contrôle actuel, ou null si aucune liste d’images de ce type n’est définie.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist) , qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a> CToolBarCtrl :: GetRect

Récupère le rectangle englobant d’un bouton de barre d’outils spécifié.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur du bouton.

*lpRect*<br/>
Pointeur vers une structure [Rect](/windows/win32/api/windef/ns-windef-rect) pour recevoir les informations de rectangle englobant.

### <a name="return-value"></a>Valeur renvoyée

TRUE en cas de réussite, sinon FALSE.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETRECT](/windows/win32/Controls/tb-getrect)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a> CToolBarCtrl :: GetRows

Récupère le nombre de lignes de boutons actuellement affichées par le contrôle ToolBar.

```
int GetRows() const;
```

### <a name="return-value"></a>Valeur renvoyée

Nombre de lignes de boutons actuellement affichées dans la barre d’outils.

### <a name="remarks"></a>Notes

Notez que le nombre de lignes sera toujours un, sauf si la barre d’outils a été créée avec le style TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a> CToolBarCtrl :: GetState

Récupère des informations sur l’état du bouton spécifié dans un contrôle ToolBar, par exemple s’il est activé, appuyé ou activé.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton pour lequel des informations doivent être récupérées.

### <a name="return-value"></a>Valeur renvoyée

Informations d’État du bouton en cas de réussite ou-1 dans le cas contraire. Les informations d’État du bouton peuvent être une combinaison des valeurs listées dans [CToolBarCtrl :: AddButtons](#addbuttons).

### <a name="remarks"></a>Notes

Cette fonction est particulièrement pratique si vous souhaitez récupérer plus d’un état de bouton. Pour récupérer un seul État, utilisez l’une des fonctions membres suivantes : [IsButtonEnabled](#isbuttonenabled), [IsButtonChecked](#isbuttonchecked), [IsButtonPressed](#isbuttonpressed), [IsButtonHidden](#isbuttonhidden)ou [IsButtonIndeterminate](#isbuttonindeterminate). Toutefois, la `GetState` fonction membre est la seule façon de détecter l’état du bouton de TBSTATE_WRAP.

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a> CToolBarCtrl :: GetString

Récupère une chaîne de barre d’outils.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Paramètres

*nString*<br/>
Index de la chaîne.

*lpstrString*<br/>
Pointeur vers une mémoire tampon utilisée pour retourner la chaîne.

*cchMaxLen*<br/>
Longueur de la mémoire tampon en octets.

*str*<br/>
Chaîne.

### <a name="return-value"></a>Valeur renvoyée

Longueur de la chaîne en cas de réussite,-1 dans le cas contraire.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_GETSTRING](/windows/win32/Controls/tb-getstring)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a> CToolBarCtrl :: GetStyle

Obtient les styles actuellement appliqués à un contrôle de barre d’outils.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD contenant une combinaison de [styles de contrôle de barre d’outils](/windows/win32/Controls/toolbar-control-and-button-styles), comme décrit dans la SDK Windows.

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a> CToolBarCtrl :: GetToolTips

Récupère le handle du contrôle d’info-bulle, le cas échéant, associé au contrôle de barre d’outils.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers l’objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) associé à cette barre d’outils ou null si la barre d’outils n’a pas de contrôle d’info-bulle associé.

### <a name="remarks"></a>Notes

Étant donné que le contrôle ToolBar crée et gère normalement son propre contrôle d’info-bulle, la plupart des programmes n’ont pas besoin d’appeler cette fonction.

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a> CToolBarCtrl :: HitTest

Détermine où un point se trouve dans un contrôle de barre d’outils.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Paramètres

*formations*<br/>
Pointeur vers une structure de [points](/windows/win32/api/windef/ns-windef-point) qui contient la coordonnée x du test de positionnement dans le `x` membre et la coordonnée y du test de positionnement dans le `y` membre. Les coordonnées sont relatives à la zone cliente de la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Valeur entière indiquant l’emplacement d’un point sur une barre d’outils. Si la valeur est zéro ou une valeur positive, cette valeur de retour est l’index de base zéro de l’élément de non-séparateur dans lequel se trouve le point.

Si la valeur de retour est négative, le point ne se situe pas dans un bouton. La valeur absolue de la valeur de retour est l’index d’un élément de séparateur ou de l’élément de non-séparateur le plus proche.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_HITTEST](/windows/win32/Controls/tb-hittest)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a> CToolBarCtrl :: HideButton

Masque ou affiche le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton à masquer ou afficher.

*bHide*<br/>
TRUE pour masquer le bouton, FALSe pour l’afficher.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Si vous souhaitez modifier plusieurs États de bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a> CToolBarCtrl :: Indeterminate

Définit ou efface l’état indéterminé du bouton spécifié dans un contrôle ToolBar.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dont l’état indéterminé doit être défini ou effacé.

*bIndeterminate*<br/>
TRUE pour définir l’état indéterminé du bouton spécifié, FALSe pour l’effacer.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Les boutons indéterminés sont affichés en grisé, tels que la façon dont le bouton gras sur la barre d’outils d’un traitement de texte doit se présenter lorsque le texte sélectionné contient à la fois des caractères gras et normal. Si vous souhaitez modifier plusieurs États de bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a> CToolBarCtrl :: InsertButton

Insère un bouton dans un contrôle de barre d’outils.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro d’un bouton. Cette fonction insère le bouton nouveau à gauche de ce bouton.

*lpButton*<br/>
Adresse d’une `TBBUTTON` structure contenant des informations sur le bouton à insérer. Consultez [CToolBarCtrl :: AddButtons](#addbuttons) pour obtenir une description de la `TBBUTTON` structure.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

L’image et/ou la chaîne dont vous indiquez l’index doit avoir été ajoutée précédemment à la liste du contrôle ToolBar à l’aide de [AddBitmap](#addbitmap), [AddString](#addstring)et/ou [AddStrings](#addstrings).

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a> CToolBarCtrl :: InsertMarkHitTest

Récupère les informations sur les marques d’insertion pour un point dans une barre d’outils.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Paramètres

*formations*<br/>
Pointeur vers une structure de [points](/windows/win32/api/windef/ns-windef-point) qui contient les coordonnées de test de positionnement par rapport à la zone cliente de la barre d’outils.

*ptbim*<br/>
Pointeur vers une structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui reçoit les informations sur les marques d’insertion.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a> CToolBarCtrl :: IsButtonChecked

Détermine si le bouton spécifié dans un contrôle de barre d’outils est activé.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le bouton est activé ; Sinon, zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous souhaitez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a> CToolBarCtrl :: IsButtonEnabled

Détermine si le bouton spécifié dans un contrôle de barre d’outils est activé.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le bouton est activé ; Sinon, zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous souhaitez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a> CToolBarCtrl :: IsButtonHidden

Détermine si le bouton spécifié dans un contrôle de barre d’outils est masqué.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le bouton est masqué ; Sinon, zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous souhaitez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a> CToolBarCtrl :: IsButtonHighlighted

Vérifie l’état de mise en surbrillance d’un bouton de barre d’outils.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
dans ID de commande pour le bouton de barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Entier positif si le bouton est mis en surbrillance, 0 si le bouton n’est pas mis en surbrillance ou-1 si une erreur se produit.

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a> CToolBarCtrl :: IsButtonIndeterminate

Détermine si le bouton spécifié dans un contrôle de barre d’outils est indéterminé.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
dans Identificateur de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Entier positif si le bouton est indéterminé, zéro si le bouton n’est pas indéterminé, ou-1 si une erreur se produit.

### <a name="remarks"></a>Notes

Les boutons indéterminés sont affichés estompés, tels que la façon dont le bouton gras sur la barre d’outils d’un traitement de texte s’affiche lorsque le texte sélectionné contient à la fois des caractères gras et des caractères normaux. Envisagez d’appeler [GetState](#getstate) si vous souhaitez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a> CToolBarCtrl :: IsButtonPressed

Détermine si le bouton spécifié dans un contrôle de barre d’outils est enfoncé.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Différent de zéro si le bouton est enfoncé ; sinon, zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous souhaitez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a> CToolBarCtrl :: LoadImages

Charge des bitmaps dans la liste d’images d’un contrôle ToolBar.

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Paramètres

*iBitmapID*<br/>
ID d’une image bitmap qui contient les images à charger. Pour spécifier votre propre ressource bitmap, définissez ce paramètre sur l’ID d’une ressource bitmap et affectez à *HINST* la valeur null. Votre ressource bitmap sera ajoutée à la liste d’images sous la forme d’une image unique. Vous pouvez ajouter des bitmaps standard définies par le système en affectant à *HINST* la valeur HINST_COMMCTRL et en définissant ce paramètre sur l’un des ID suivants :

|ID bitmap|Description|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Bitmaps de l’Explorateur en grande taille|
|IDB_HIST_SMALL_COLOR|Bitmaps de l’Explorateur de petite taille|
|IDB_STD_LARGE_COLOR|Images bitmap standard en grande taille|
|IDB_STD_SMALL_COLOR|Images bitmap standard de petite taille|
|IDB_VIEW_LARGE_COLOR|Afficher les bitmaps dans une grande taille|
|IDB_VIEW_SMALL_COLOR|Afficher les bitmaps dans une petite taille|

*hinst*<br/>
Handle d’instance de programme pour l’application appelante. Ce paramètre peut être HINST_COMMCTRL pour charger une liste d’images standard.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a> CToolBarCtrl :: MapAccelerator

Mappe un caractère d’accélérateur à un bouton de barre d’outils.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Paramètres

*chAccel*<br/>
Caractère d’accélérateur à mapper. Ce caractère est le même que celui qui est souligné dans le texte du bouton.

*pIDBtn*<br/>
Pointeur vers un UINT qui reçoit l’identificateur de commande du bouton qui correspond à l’accélérateur spécifié dans *chAccel*.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a> CToolBarCtrl :: MarkButton

Définit l’état de surbrillance d’un bouton donné dans un contrôle ToolBar.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur du bouton.

*fHighlight*<br/>
Spécifie l’état de mise en surbrillance à définir. Par défaut, TRUE. Si la valeur est FALSe, le bouton est défini sur son état par défaut.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a> CToolBarCtrl :: MoveButton

Déplace un bouton d’un index vers un autre.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Paramètres

*nOldPos*<br/>
Index de base zéro du bouton à déplacer.

*nNewPos*<br/>
Index de base zéro de la destination du bouton.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a> CToolBarCtrl ::P ressButton

Appuie sur le bouton spécifié ou le relâche dans un contrôle de barre d’outils.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
dans Identificateur de commande du bouton à appuyer ou à libérer.

*bPress*<br/>
dans TRUE pour appuyer sur le bouton spécifié ; FALSe pour libérer le bouton spécifié. La valeur par défaut est TRUE.

### <a name="return-value"></a>Valeur renvoyée

TRUE si la méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Si vous souhaitez modifier plusieurs États de bouton, envisagez d’appeler [SetState](#setstate) à la place.

Cette méthode envoie le message [TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton) , qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a> CToolBarCtrl :: ReplaceBitmap

Remplace la bitmap existante dans le contrôle de barre d’outils actuel par une nouvelle image bitmap.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Paramètres

*pReplaceBitmap*\
dans Pointeur vers une structure [TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap) qui décrit l’image bitmap à remplacer et la nouvelle bitmap.

### <a name="return-value"></a>Valeur renvoyée

TRUE si cette méthode réussit ; Sinon, FALSe.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant remplace l’image bitmap de la barre d’outils standard par une autre bitmap.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a> CToolBarCtrl :: RestoreState

Restaure l’état du contrôle de barre d’outils à partir de l’emplacement spécifié par les paramètres dans le registre.

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Paramètres

*hKeyRoot*<br/>
Identifie une clé actuellement ouverte dans le registre ou l’une des valeurs de handle réservées prédéfinies suivantes :

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Pointe vers une chaîne se terminant par un caractère null qui contient le nom de la sous-clé à laquelle une valeur est associée. Ce paramètre peut avoir la valeur null ou être un pointeur vers une chaîne vide. Si le paramètre a la valeur NULL, la valeur est ajoutée à la clé identifiée par le paramètre *hKeyRoot* .

*lpszValueName*<br/>
Pointe vers une chaîne contenant le nom de la valeur à récupérer. Si une valeur portant ce nom n’est pas déjà présente dans la clé, la fonction l’ajoute à la clé.

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a> CToolBarCtrl :: saveste

Enregistre l’état du contrôle de barre d’outils à l’emplacement spécifié par les paramètres dans le registre.

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Paramètres

*hKeyRoot*<br/>
Identifie une clé actuellement ouverte dans le registre ou l’une des valeurs de handle réservées prédéfinies suivantes :

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Pointe vers une chaîne se terminant par un caractère null qui contient le nom de la sous-clé à laquelle une valeur est associée. Ce paramètre peut avoir la valeur null ou être un pointeur vers une chaîne vide. Si le paramètre a la valeur NULL, la valeur est ajoutée à la clé identifiée par le paramètre *hKeyRoot* .

*lpszValueName*<br/>
Pointe vers une chaîne contenant le nom de la valeur à définir. Si une valeur portant ce nom n’est pas déjà présente dans la clé, la fonction l’ajoute à la clé.

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a> CToolBarCtrl :: SetAnchorHighlight

Définit le paramètre de surbrillance d’ancrage pour une barre d’outils.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Paramètres

*fAnchor*<br/>
dans Spécifie si la mise en surbrillance de l’ancre est activée ou désactivée. Si cette valeur est différente de zéro, la mise en surbrillance de l’ancre est activée. Si cette valeur est égale à zéro, la mise en surbrillance de l’ancre est désactivée

### <a name="return-value"></a>Valeur renvoyée

Paramètre d’ancrage précédent. Si la mise en surbrillance a été activée, cette valeur est différente de zéro. Si la mise en surbrillance n’a pas été activée, cette valeur est égale à zéro.

### <a name="remarks"></a>Notes

Cette méthode implémente le comportement de la [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a> CToolBarCtrl :: SetBitmapSize

Définit la taille des images bitmap réelles à ajouter à un contrôle ToolBar.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Paramètres

*size*<br/>
Largeur et hauteur, en pixels, des images bitmap.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction doit être appelée uniquement avant l’ajout de bitmaps à la barre d’outils. Si l’application ne définit pas explicitement la taille de la bitmap, sa valeur par défaut est 16 par 15 pixels.

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a> CToolBarCtrl :: SetButtonInfo

Définit les informations d’un bouton existant dans une barre d’outils.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur du bouton.

*ptbbi*<br/>
Pointeur vers une structure [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) qui reçoit les informations sur le bouton.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction membre implémente le comportement de la [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a> CToolBarCtrl :: SetButtonSize

Définit la taille des boutons dans le contrôle ToolBar.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Paramètres

*size*<br/>
Largeur et hauteur, en pixels, des boutons.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

La taille du bouton doit toujours être au moins aussi grande que la taille de la bitmap qu’il englobe. Cette fonction doit être appelée uniquement avant l’ajout de bitmaps à la barre d’outils. Si l’application ne définit pas explicitement la taille du bouton, sa valeur par défaut est 24 par 22 pixels.

### <a name="example"></a>Exemple

  Consultez l’exemple de [CToolBar :: GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a> CToolBarCtrl :: SetButtonStructSize

Spécifie la taille de la `TBBUTTON` structure.

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Paramètres

*nSize*<br/>
Taille, en octets, de la `TBBUTTON` structure.

### <a name="remarks"></a>Notes

Si vous souhaitez stocker des données supplémentaires dans la `TBBUTTON` structure, vous pouvez soit dériver une nouvelle structure de `TBBUTTON` , ajouter les membres nécessaires, soit créer une nouvelle structure qui contient une `TBBUTTON` structure en tant que premier membre. Vous appelez ensuite cette fonction pour indiquer à la barre d’outils de contrôler la taille de la nouvelle structure.

Pour plus d’informations sur la structure, consultez [CToolBarCtrl :: AddButtons](#addbuttons) `TBBUTTON` .

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a> CToolBarCtrl :: SetButtonWidth

Définit les largeurs minimale et maximale des boutons dans le contrôle ToolBar.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Paramètres

*cxMin*<br/>
Largeur minimale du bouton, en pixels. Les boutons de la barre d’outils ne seront jamais plus étroits que cette valeur.

*cxMax*<br/>
Largeur maximale du bouton, en pixels. Si le texte du bouton est trop grand, le contrôle l’affiche avec des points de suspension.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a> CToolBarCtrl :: SetCmdID

Définit l’identificateur de commande qui sera envoyé à la fenêtre propriétaire lorsque le bouton spécifié est enfoncé.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro du bouton dont l’ID de commande doit être défini.

*nID*<br/>
ID de commande auquel définir le bouton sélectionné.

### <a name="return-value"></a>Valeur renvoyée

Retourne une valeur différente de zéro en cas de réussite ; Sinon, zéro.

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a> CToolBarCtrl :: SetColorScheme

Définit le modèle de couleurs du contrôle de barre d’outils actuel.

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Paramètres

*lpColorScheme*\
dans Pointeur vers une structure [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) qui décrit la couleur de surbrillance et la couleur de l’ombre du contrôle ToolBar.

### <a name="remarks"></a>Notes

Cette méthode n’a aucun effet si un thème visuel Windows Vista est défini.

Cette méthode envoie le message [TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit le modèle de couleurs pour le contrôle de barre d’outils actuel. L’exemple de code fait en sorte que les bords gauche et supérieur de chaque bouton d’outil soient rouges et les bords inférieur et droit bleus. Quand l’utilisateur appuie sur le bouton, les bords rouges du bouton deviennent bleus et leurs bords bleus deviennent rouges.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a> CToolBarCtrl :: SetDisabledImageList

Définit la liste d’images que le contrôle ToolBar utilisera pour afficher les boutons désactivés.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList*<br/>
Pointeur vers un `CImageList` objet contenant les images à utiliser par le contrôle de barre d’outils pour afficher les images de bouton désactivées.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) précédemment utilisé par le contrôle ToolBar pour afficher des images de bouton désactivées.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)de message Win32, comme décrit dans le SDK Windows. L’implémentation MFC de `SetDisabledImageList` utilise un `CImageList` objet contenant les images de bouton désactivées du contrôle ToolBar, plutôt qu’un handle vers une liste d’images.

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a> CToolBarCtrl :: SetDrawTextFlags

Définit les indicateurs dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui est utilisé pour dessiner le texte dans le rectangle spécifié, mis en forme en fonction de la façon dont les indicateurs sont définis.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Paramètres

*dwMask*<br/>
Combinaison d’un ou plusieurs des indicateurs de DT_, spécifiés dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui indique quels bits de *dwDTFlags* seront utilisés lors du dessin du texte.

*dwDTFlags*<br/>
Combinaison d’un ou plusieurs DT_ indicateurs, spécifiés dans la fonction Win32 `DrawText` , qui indiquent comment le texte du bouton sera dessiné. Cette valeur est passée à `DrawText` lorsque le texte du bouton est dessiné.

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD contenant les indicateurs de dessin de texte précédents.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)de message Win32, comme décrit dans le SDK Windows. Cette fonction membre définit les indicateurs dans la fonction Win32 `DrawText` , qui dessine le texte dans le rectangle spécifié, mis en forme en fonction de la façon dont les indicateurs sont définis.

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a> CToolBarCtrl :: SetExtendedStyle

Définit les styles étendus pour un contrôle de barre d’outils.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Paramètres

*dwExStyle*<br/>
Valeur qui spécifie les nouveaux styles étendus. Ce paramètre peut être une combinaison des styles étendus de la barre d’outils.

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD qui représente les styles étendus précédents. Pour obtenir la liste des styles, consultez [styles étendus de la barre d’outils](/windows/win32/Controls/toolbar-extended-styles), dans la SDK Windows.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a> CToolBarCtrl :: SetHotImageList

Définit la liste d’images que le contrôle de barre d’outils utilisera pour afficher les boutons « actifs ».

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList*<br/>
Pointeur vers un `CImageList` objet contenant les images à utiliser par le contrôle de barre d’outils pour afficher les images de bouton actif.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) précédemment utilisé par le contrôle ToolBar pour afficher des images de bouton actif.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)de message Win32, comme décrit dans le SDK Windows.

L’implémentation MFC de `SetHotImageList` utilise un `CImageList` objet contenant les images de bouton actif du contrôle ToolBar, plutôt qu’un handle vers une liste d’images. Un bouton actif apparaît en surbrillance lorsque le pointeur se trouve au-dessus de lui.

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a> CToolBarCtrl :: SetHotItem

Définit l’élément réactif dans une barre d’outils.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Paramètres

*nHot*<br/>
Numéro d’index de base zéro de l’élément qui sera rendu chaud. Si cette valeur est-1, aucun des éléments n’est chaud.

### <a name="return-value"></a>Valeur renvoyée

Index de l’élément réactif précédent, ou-1 s’il n’y a pas d’élément réactif.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a> CToolBarCtrl :: SetImageList

Définit la liste d’images que la barre d’outils utilisera pour afficher les boutons dont l’État par défaut est.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList*<br/>
Pointeur vers un `CImageList` objet contenant les images à utiliser par le contrôle de barre d’outils pour afficher les images de bouton dans leur état par défaut.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) précédemment utilisé par le contrôle ToolBar pour afficher les images de bouton dans leur état par défaut.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)de message Win32, comme décrit dans le SDK Windows.

L’implémentation MFC de `SetImageList` utilise un `CImageList` objet contenant les images de bouton du contrôle ToolBar, plutôt qu’un handle vers une liste d’images.

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a> CToolBarCtrl :: SetIndent

Définit la mise en retrait du premier bouton dans un contrôle de barre d’outils.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Paramètres

*iIndent*<br/>
Valeur qui spécifie la mise en retrait, en pixels.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a> CToolBarCtrl :: SetInsertMark

Définit la marque d’insertion actuelle pour la barre d’outils.

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Paramètres

*ptbim*<br/>
Pointeur vers la structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui contient la marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a> CToolBarCtrl :: SetInsertMarkColor

Définit la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
Valeur COLORREF qui contient la nouvelle couleur de la marque d’insertion.

### <a name="return-value"></a>Valeur renvoyée

Valeur COLORREF qui contient la couleur de la marque d’insertion précédente.

### <a name="remarks"></a>Notes

Cette fonction membre implémente le comportement de la [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)de message Win32, comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a> CToolBarCtrl :: SetMaxTextRows

Définit le nombre maximal de lignes de texte affichées sur un bouton de barre d’outils.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Paramètres

*iMaxRows*<br/>
Nombre maximal de lignes à définir.

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a> CToolBarCtrl :: SetMetrics

Définit les métriques de l' `CToolBarCtrl` objet.

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Paramètres

*ptbm*<br/>
Pointeur vers la structure [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) de l' `CToolBarCtrl` objet.

### <a name="remarks"></a>Notes

Cette fonction membre émule les fonctionnalités du message [TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics) , comme décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a> CToolBarCtrl :: SetOwner

Définit la fenêtre propriétaire du contrôle ToolBar.

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*pWnd*<br/>
Pointeur vers l' `CWnd` `CWnd` objet dérivé de ou qui sera la nouvelle fenêtre propriétaire du contrôle ToolBar.

### <a name="remarks"></a>Notes

La fenêtre propriétaire est la fenêtre qui reçoit les notifications de la barre d’outils.

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a> CToolBarCtrl :: SetPadding

Définit le remplissage horizontal et vertical du contrôle de barre d’outils actuel.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Paramètres

*nHorzPadding*\
dans Spécifie la marge intérieure horizontale du contrôle ToolBar, en pixels.

*nVertPadding*\
dans Spécifie la marge intérieure verticale du contrôle ToolBar, en pixels.

### <a name="return-value"></a>Valeur renvoyée

Valeur DWORD dont le mot de poids faible contient la valeur de remplissage horizontal précédente et dont le mot de poids fort contient la valeur de marge intérieure verticale précédente. Les valeurs de remplissage sont exprimées en pixels.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_SETPADDING](/windows/win32/Controls/tb-setpadding) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit la marge intérieure horizontale et verticale du contrôle de barre d’outils actuel sur 20 pixels.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a> CToolBarCtrl :: SetPressedImageList

Définit la liste d’images que le contrôle de barre d’outils actuelle utilise pour représenter les boutons dans un état appuyé.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*iImageID*\
dans Index de base zéro de la liste d’images. Définissez ce paramètre sur zéro si vous utilisez une seule liste d’images.

*pImageList*\
dans Pointeur vers un [CImageList](../../mfc/reference/cimagelist-class.md) qui contient la nouvelle liste d’images.

### <a name="return-value"></a>Valeur renvoyée

Pointeur vers un [CImageList](../../mfc/reference/cimagelist-class.md) qui contient la liste d’images précédente pour le contrôle actuel, ou null si aucune liste d’images n’a été définie.

### <a name="remarks"></a>Notes

Cette méthode envoie le message [TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist) , qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit la liste d’images enfoncée pour qu’elle soit identique à la liste d’images par défaut.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a> CToolBarCtrl :: SetRows

Demande au contrôle Toolbar de se redimensionner sur le nombre de lignes demandé.

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*nRows*<br/>
Nombre de lignes demandé.

*bLarger*<br/>
Indique s’il faut utiliser davantage de lignes ou moins de lignes si la barre d’outils ne peut pas être redimensionnée sur le nombre de lignes demandé.

*lpRect*<br/>
Pointe vers l’objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou la structure [Rect](/windows/win32/api/windef/ns-windef-rect) qui recevra le nouveau rectangle englobant de la barre d’outils.

### <a name="remarks"></a>Notes

Si la barre d’outils ne peut pas se redimensionner sur le nombre ou les lignes demandées, elle se redimensionne en la taille valide la plus grande ou la plus petite suivante, selon la valeur de *bLarger*. Si *bLarger* a la valeur true, le nouveau nombre de lignes est supérieur au nombre demandé. Si *bLarger* a la valeur false, le nouveau nombre de lignes est inférieur au nombre demandé.

Un nombre donné de lignes est valide pour la barre d’outils si les boutons peuvent être disposés de telle sorte que toutes les lignes ont le même nombre de boutons (sauf éventuellement la dernière ligne). Par exemple, une barre d’outils qui contient quatre boutons ne peut pas être dimensionnée à trois lignes, car les deux dernières lignes devraient être plus courtes. Si vous avez essayé de la dimensionner sur trois lignes, vous obtiendriez quatre lignes si *bLarger* était true et deux lignes si *bLarger* était false.

Si la barre d’outils contient des séparateurs, les règles relatives à la validité d’un nombre donné de lignes sont plus compliquées. La disposition est calculée de telle sorte que les groupes de boutons (boutons avec un séparateur avant le premier et le dernier bouton dans le groupe) ne soient jamais répartis sur plusieurs lignes, sauf si le groupe ne peut pas tenir sur une ligne.

Si un groupe ne tient pas sur une ligne, le groupe suivant commence à la ligne suivante même s’il s’ajuste à la ligne où le groupe volumineux s’est terminé. L’objectif de cette règle est de rendre la séparation entre les grands groupes plus perceptible. Les séparateurs verticaux résultants sont comptés comme des lignes.

Notez également que la `SetRows` fonction membre choisit toujours la disposition qui donne la plus petite taille de barre d’outils. La création d’une barre d’outils avec le style TBSTYLE_WRAPABLE, puis le redimensionnement du contrôle, appliquent simplement la méthode décrite ci-dessus en fonction de la largeur du contrôle.

Cette fonction ne peut être appelée que pour les barres d’outils qui ont été créées avec le style TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a> CToolBarCtrl :: SetState

Définit l’état du bouton spécifié dans un contrôle de barre d’outils.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identificateur de commande du bouton.

*nState*<br/>
Indicateurs d’État. Il peut s’agir d’une combinaison des valeurs indiquées pour les États de bouton dans [CToolBarCtrl :: AddButtons](#addbuttons).

### <a name="return-value"></a>Valeur renvoyée

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction est particulièrement pratique si vous souhaitez définir plusieurs États de bouton. Pour définir simplement un État, utilisez l’une des fonctions membres suivantes : [EnableButton](#enablebutton), [CheckButton](#checkbutton), [HideButton](#hidebutton), [Indeterminate](#indeterminate)ou [PressButton](#pressbutton).

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a> CToolBarCtrl :: SetStyle

Définit les styles pour un contrôle de barre d’outils.

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Paramètres

*dwStyle*<br/>
Valeur DWORD contenant une combinaison de [styles de contrôle de barre d’outils](/windows/win32/Controls/toolbar-control-and-button-styles), comme décrit dans la SDK Windows.

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a> CToolBarCtrl :: SetToolTips

Associe un contrôle d’info-bulle à un contrôle de barre d’outils.

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Paramètres

*pTip*<br/>
Pointeur vers l’objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) .

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a> CToolBarCtrl :: SetWindowTheme

Définit le style visuel de l' `CToolBarCtrl` objet.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Paramètres

*pszSubAppName*<br/>
Pointeur vers une chaîne Unicode qui contient le style visuel de la barre d’outils à définir.

### <a name="return-value"></a>Valeur renvoyée

La valeur de retour n’est pas utilisée.

### <a name="remarks"></a>Notes

Cette fonction membre émule les fonctionnalités du message [TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme) , comme décrit dans le SDK Windows.

## <a name="see-also"></a>Voir aussi

[Exemple MFC CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC, exemple MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CToolBar (classe)](../../mfc/reference/ctoolbar-class.md)
