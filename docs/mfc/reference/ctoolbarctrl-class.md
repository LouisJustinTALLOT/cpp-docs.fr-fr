---
title: CToolBarCtrl, classe
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 50d3174d4569392be72efdad338eeaac3154ec56
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752221"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl, classe

Fournit les fonctionnalités du contrôle commun de barre d'outils Windows.

## <a name="syntax"></a>Syntaxe

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|Construit un objet `CToolBarCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CToolBarCtrl::AddBitmap](#addbitmap)|Ajoute une ou plusieurs images de boutons bitmap à la liste des images de boutons disponibles pour un contrôle de barre d’outils.|
|[CToolBarCtrl::AddButtons](#addbuttons)|Ajoute un ou plusieurs boutons à un contrôle de barre d’outils.|
|[CToolBarCtrl::AddString](#addstring)|Ajoute une nouvelle chaîne, passée comme une pièce d’identité de ressource, à la liste interne des chaînes de la barre d’outils.|
|[CToolBarCtrl::AddStrings](#addstrings)|Ajoute une nouvelle chaîne ou des cordes, passé comme un pointeur à un tampon de cordes non séparées, à la liste interne de la barre d’outils de cordes.|
|[CToolBarCtrl::AutoSize](#autosize)|Resizes un contrôle de barre d’outils.|
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|Change la bitmap pour un bouton dans le contrôle actuel de la barre d’outils.|
|[CToolBarCtrl::CheckButton](#checkbutton)|Vérifie ou efface un bouton donné dans un contrôle de barre d’outils.|
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|Récupère l’index zéro pour le bouton associé à l’identifiant de commande spécifié.|
|[CToolBarCtrl::Créer](#create)|Crée un contrôle de barre d’outils et le fixe à un `CToolBarCtrl` objet.|
|[CToolBarCtrl::CreateEx](#createex)|Crée un contrôle de barre d’outils avec les `CToolBarCtrl` styles Windows étendus spécifiés et le fixe à un objet.|
|[CToolBarCtrl::Customize](#customize)|Affiche la boîte de dialogue Customize Toolbar.|
|[CToolBarCtrl::DeleteButton](#deletebutton)|Supprime un bouton du contrôle de la barre d’outils.|
|[CToolBarCtrl::EnableButton](#enablebutton)|Permet ou désactive le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|Récupère le réglage de mise en évidence de l’ancre pour une barre d’outils.|
|[CToolBarCtrl::GetBitmap](#getbitmap)|Récupère l’index de la bitmap associé à un bouton dans une barre d’outils.|
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|Obtient des drapeaux associés à la bitmap de la barre d’outils.|
|[CToolBarCtrl::GetButton](#getbutton)|Récupère des informations sur le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|Récupère un compte des boutons actuellement dans le contrôle de la barre d’outils.|
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|Récupère les informations pour un bouton dans une barre d’outils.|
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|Récupère la largeur et la hauteur actuelles des boutons de barre d’outils, en pixels.|
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|Récupère le schéma de couleur du contrôle actuel de la barre d’outils.|
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher les boutons désactivés.|
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|Récupère l’interface [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) pour un contrôle de barre d’outils.|
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|Récupère les styles étendus pour un contrôle de barre d’outils.|
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher des boutons « chauds ». Un bouton chaud apparaît surligné lorsque le pointeur de la souris est au-dessus.|
|[CToolBarCtrl::GetHotItem](#gethotitem)|Récupère l’index de l’élément chaud dans une barre d’outils.|
|[CToolBarCtrl::GetImageList](#getimagelist)|Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher les boutons dans leur état par défaut.|
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|Récupère la marque d’insertion actuelle pour la barre d’outils.|
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Récupère la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.|
|[CToolBarCtrl::GetItemRect](#getitemrect)|Récupère le rectangle de délimitation d’un bouton dans un contrôle de barre d’outils.|
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|Récupère la taille totale de tous les boutons et séparateurs visibles dans la barre d’outils.|
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|Récupère le nombre maximum de lignes de texte affichées sur un bouton de barre d’outils.|
|[CToolBarCtrl::GetMetrics](#getmetrics)|Récupère les mesures d’un contrôle de barre d’outils.|
|[CToolBarCtrl::GetPadding](#getpadding)|Récupère le rembourrage horizontal et vertical du contrôle actuel de la barre d’outils.|
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|Récupère la liste d’images que le contrôle actuel de la barre d’outils utilise pour représenter les boutons dans l’état pressé.|
|[CToolBarCtrl::GetRect](#getrect)|Récupère le rectangle de délimitation pour un bouton de barre d’outils spécifié.|
|[CToolBarCtrl::GetRows](#getrows)|Récupère le nombre de lignes de boutons actuellement affichées dans la barre d’outils.|
|[CToolBarCtrl::GetState](#getstate)|Récupère des informations sur l’état du bouton spécifié dans un contrôle de barre d’outils, par exemple s’il est activé, pressé ou vérifié.|
|[CToolBarCtrl::GetString](#getstring)|Récupère une chaîne de barre d’outils.|
|[CToolBarCtrl::GetStyle](#getstyle)|Récupère les styles actuellement utilisés pour un contrôle de barre d’outils.|
|[CToolBarCtrl::GetToolTips](#gettooltips)|Récupère la poignée du contrôle de pointe de l’outil, le cas échéant, associé au contrôle de la barre d’outils.|
|[CToolBarCtrl::HideButton](#hidebutton)|Cache ou affiche le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::HitTest](#hittest)|Détermine où se trouve un point dans un contrôle de barre d’outils.|
|[CToolBarCtrl::Indéterminé](#indeterminate)|Définit ou efface l’état indéterminé (gris) du bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::InsertButton](#insertbutton)|Insère un bouton dans un contrôle de barre d’outils.|
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|Récupère les informations de marque d’insertion pour un point dans une barre d’outils.|
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|Indique si le bouton spécifié dans un contrôle de barre d’outils est vérifié.|
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|Indique si le bouton spécifié dans un contrôle de barre d’outils est activé.|
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|Indique si le bouton spécifié dans un contrôle de barre d’outils est caché.|
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|Vérifie l’état de surbrillance du bouton de la barre d’outils.|
|[CToolBarCtrl::IsButtonIndéterminer](#isbuttonindeterminate)|Indique si l’état du bouton spécifié dans un contrôle de barre d’outils est indéterminé (gris).|
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|Indique si le bouton spécifié dans un contrôle de barre d’outils est pressé.|
|[CToolBarCtrl::LoadImages](#loadimages)|Charge les bitmaps dans la liste d’images d’une barre d’outils.|
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|Cartographiez un personnage d’accélérateur sur un bouton de barre d’outils.|
|[CToolBarCtrl::MarkButton](#markbutton)|Définit l’état de surbrillance d’un bouton donné dans un contrôle de barre d’outils.|
|[CToolBarCtrl::MoveButton](#movebutton)|Déplace un bouton d’un index à l’autre.|
|[CToolBarCtrl::PressButton](#pressbutton)|Presse ou libère le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|Remplace la bitmap existante dans le contrôle actuel de la barre d’outils par une nouvelle bitmap.|
|[CToolBarCtrl::RestoreState](#restorestate)|Restaure l’état du contrôle de la barre d’outils.|
|[CToolBarCtrl::SaveState](#savestate)|Enregistre l’état du contrôle de la barre d’outils.|
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|Définit le réglage de mise en évidence d’ancre pour une barre d’outils.|
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|Définit la taille des images bitmapped à ajouter à un contrôle de barre d’outils.|
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|Définit les informations pour un bouton existant dans une barre d’outils.|
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|Définit la taille des boutons à ajouter à un contrôle de barre d’outils.|
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|Précise la taille de `TBBUTTON` la structure.|
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|Définit les largeurs minimales et maximales du bouton dans le contrôle de la barre d’outils.|
|[CToolBarCtrl::SetCmdID](#setcmdid)|Définit l’identifiant de commande à envoyer à la fenêtre du propriétaire lorsque le bouton spécifié est appuyé.|
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|Définit le schéma de couleur du contrôle actuel de la barre d’outils.|
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|Définit la liste d’images que le contrôle de la barre d’outils utilisera pour afficher les boutons désactivés.|
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Définit les drapeaux dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui est utilisé pour dessiner le texte dans le rectangle spécifié, formaté en fonction de la façon dont les drapeaux sont définis.|
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|Définit les styles étendus pour un contrôle de barre d’outils.|
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|Définit la liste d’images que le contrôle de la barre d’outils utilisera pour afficher des boutons « chauds ».|
|[CToolBarCtrl::SetHotItem](#sethotitem)|Définit l’article chaud dans une barre d’outils.|
|[CToolBarCtrl::SetImageList](#setimagelist)|Définit la liste d’images que la barre d’outils utilisera pour afficher les boutons qui sont dans leur état par défaut.|
|[CToolBarCtrl::SetIndent](#setindent)|Définit l’indentation pour le premier bouton dans un contrôle de barre d’outils.|
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|Définit la marque d’insertion actuelle pour la barre d’outils.|
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Définit la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.|
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|Définit le nombre maximum de lignes de texte affichées sur un bouton de barre d’outils.|
|[CToolBarCtrl::SetMetrics](#setmetrics)|Définit les mesures d’un contrôle de barre d’outils.|
|[CToolBarCtrl::SetOwner](#setowner)|Définit la fenêtre pour recevoir des messages de notification du contrôle de la barre d’outils.|
|[CToolBarCtrl::SetPadding](#setpadding)|Définit le rembourrage horizontal et vertical du contrôle actuel de la barre d’outils.|
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|Définit la liste d’images que le contrôle actuel de la barre d’outils utilise pour représenter les boutons dans l’état pressé.|
|[CToolBarCtrl::SetRows](#setrows)|Définit le nombre de rangées de boutons affichés dans la barre d’outils.|
|[CToolBarCtrl::SetState](#setstate)|Définit l’état pour le bouton spécifié dans un contrôle de barre d’outils.|
|[CToolBarCtrl::SetStyle](#setstyle)|Définit les styles pour un contrôle de barre d’outils.|
|[CToolBarCtrl::SetToolTips](#settooltips)|Associe un contrôle de pointe d’outil avec le contrôle de la barre d’outils.|
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|Définit le style visuel d’un contrôle de barre d’outils.|

## <a name="remarks"></a>Notes

Ce contrôle (et `CToolBarCtrl` donc la classe) n’est disponible que pour les programmes fonctionnant sous Windows 95/98 et Windows NT version 3.51 et plus tard.

Un contrôle commun de barre d’outils Windows est une fenêtre d’enfant rectangulaire qui contient un ou plusieurs boutons. Ces boutons peuvent afficher une image bitmap, une chaîne, ou les deux. Lorsque l’utilisateur choisit un bouton, il envoie un message de commande à la fenêtre propriétaire de la barre d’outils. En règle générale, les boutons d’une barre d’outils correspondent à des éléments du menu de l’application; ils fournissent un moyen plus direct pour l’utilisateur d’accéder aux commandes d’une application.

`CToolBarCtrl`les objets contiennent plusieurs structures de données internes importantes : une liste de bitmaps d’image `TBBUTTON` de bouton ou une liste d’images, une liste de chaînes d’étiquettes de bouton, et une liste de structures qui associent une image et/ou une chaîne à la position, au style, à l’état et à l’identification de commande du bouton. Chacun des éléments de ces structures de données est mentionné par un indice zéro. Avant de pouvoir `CToolBarCtrl` utiliser un objet, vous devez configurer ces structures de données. La liste des cordes ne peut être utilisée que pour les étiquettes de boutons; vous ne pouvez pas récupérer les chaînes de la barre d’outils.

Pour utiliser `CToolBarCtrl` un objet, vous suivrez généralement ces étapes :

1. Construisez `CToolBarCtrl` l’objet.

1. Appelez [Créer](#create) pour créer le contrôle commun de `CToolBarCtrl` la barre d’outils Windows et l’attacher à l’objet. Indiquez le style de la barre d’outils en utilisant des styles, tels que TBSTYLE_TRANSPARENT pour une barre d’outils transparente ou TBSTYLE_DROPDOWN pour une barre d’outils qui prend en charge les boutons de style drop-down.

1. Identifiez comment vous voulez que les boutons sur la barre d’outils s’affichent :

   - Pour utiliser des images de bitmap pour les boutons, ajoutez les bitmaps bouton à la barre d’outils en appelant [AddBitmap](#addbitmap).

   - Pour utiliser les images affichées à partir d’une liste d’images pour les boutons, spécifiez la liste d’images en appelant [SetImageList](#setimagelist), [SetHotImageList](#sethotimagelist), ou [SetDisabledImageList](#setdisabledimagelist).

   - Pour utiliser des étiquettes de chaîne pour les boutons, ajoutez les cordes à la barre d’outils en appelant [AddString](#addstring) et/ou [AddStrings](#addstrings).

1. Ajoutez des structures de bouton à la barre d’outils en appelant [AddButtons](#addbuttons).

1. Si vous voulez des conseils d’outil pour un `CFrameWnd`bouton de barre d’outils dans une fenêtre propriétaire qui n’est pas un , vous devez gérer les messages TTN_NEEDTEXT dans la fenêtre propriétaire de la barre d’outils comme décrit dans [les notifications de conseils d’outil](../../mfc/handling-tool-tip-notifications.md)de manipulation . Si la fenêtre parente de `CFrameWnd`la barre d’outils est dérivée, les conseils d’outil sont affichés sans aucun effort supplémentaire de votre part parce qu’il `CFrameWnd` fournit un gestionnaire par défaut.

1. Si vous voulez que votre utilisateur soit en mesure de personnaliser la barre d’outils, gérez les messages de notification de personnalisation dans la fenêtre du propriétaire tel que décrit dans [handling Customization Notifications](../../mfc/handling-customization-notifications.md).

Vous pouvez utiliser [SaveState](#savestate) pour enregistrer l’état actuel d’un contrôle de barre d’outils dans le registre et [RestoreState](#restorestate) pour restaurer l’état en fonction des informations précédemment stockées dans le registre. En plus d’enregistrer l’état de la barre d’outils entre les utilisations de l’application, les applications stockent généralement l’état avant que l’utilisateur commence à personnaliser la barre d’outils au cas où l’utilisateur veut plus tard restaurer la barre d’outils à son état d’origine.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Prise en charge de la version 4.0 et plus tard d’Internet Explorer

Pour prendre en charge les fonctionnalités introduites dans Internet Explorer, version 4.0 et plus tard, MFC fournit un support de liste d’images et des styles transparents et plats pour les contrôles des barres d’outils.

Une barre d’outils transparente permet au client sous la barre d’outils de se montrer à travers. Pour créer une barre d’outils transparente, utilisez à la fois des styles TBSTYLE_FLAT et TBSTYLE_TRANSPARENT. Les barres d’outils transparentes sont fonctions d’un suivi à chaud; c’est-à-dire, lorsque le pointeur de la souris se déplace sur un bouton chaud sur la barre d’outils, l’apparence du bouton change. Les barres d’outils créées avec seulement le style TBSTYLE_FLAT contiendra des boutons qui ne sont pas transparents.

Le support de liste d’images permet un contrôle plus de flexibilité pour le comportement par défaut, les images chaudes, et les images désactivées. Utilisez [GetImageList](#getimagelist), [GetHotImageList](#gethotimagelist), et [GetDisabledImageList](#getdisabledimagelist) avec la barre d’outils transparente pour manipuler l’image en fonction de son état:

Pour plus d’informations sur l’utilisation `CToolBarCtrl`, voir [Contrôles](../../mfc/controls-mfc.md) et Utilisation de [CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a>CToolBarCtrl::AddBitmap

Ajoute une ou plusieurs images bouton à la liste des images bouton stockées dans le contrôle de la barre d’outils.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Paramètres

*nNumButtons (en)*<br/>
Nombre d’images bouton dans la bitmap.

*nBitmapID (en)*<br/>
Identifiant de ressource de la bitmap qui contient l’image de bouton ou des images à ajouter.

*pBitmap (en)*<br/>
Pointeur `CBitmap` vers l’objet qui contient l’image du bouton ou des images à ajouter.

### <a name="return-value"></a>Valeur de retour

Indice zéro de la première nouvelle image en cas de succès; autrement - 1.

### <a name="remarks"></a>Notes

Vous pouvez utiliser le Windows API [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap) pour cartographier les couleurs avant d’ajouter le bitmap à la barre d’outils. Si vous passez un `CBitMap` pointeur à un objet, vous devez vous assurer que la bitmap n’est pas détruite jusqu’à ce que la barre d’outils est détruite.

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a>CToolBarCtrl::AddButtons

Ajoute un ou plusieurs boutons à un contrôle de barre d’outils.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Paramètres

*nNumButtons (en)*<br/>
Nombre de boutons à ajouter.

*lpButtons*<br/>
Adresse d’un `TBBUTTON` tableau de structures qui contient des informations sur les boutons à ajouter. Il doit y avoir le même nombre d’éléments dans le tableau que les boutons spécifiés par *nNumButtons*.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Le pointeur *lpButtons* pointe `TBBUTTON` vers un tableau de structures. Chaque `TBBUTTON` structure associe le bouton ajouté au style, à l’image et/ou à la chaîne, à l’ID de commande, à l’état et aux données définies par l’utilisateur :

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

Les membres sont les suivants :

- `iBitmap`

   Index à base zéro de l’image bouton, -1 si aucune image pour ce bouton.

- `idCommand`

   Identifiant de commande associé au bouton. Cet identifiant est envoyé dans un message WM_COMMAND lorsque le bouton est choisi. Si `fsStyle` le membre a la valeur TBSTYLE_SEP, ce membre doit être nul.

- `fsState`

   Drapeaux d’état de bouton. Il peut s’agir d’une combinaison des valeurs énumérées ci-dessous :

  - TBSTATE_CHECKED Le bouton a le style TBSTYLE_CHECKED et est pressé.

  - TBSTATE_ENABLED Le bouton accepte l’entrée de l’utilisateur. Un bouton qui n’a pas cet état n’accepte pas l’entrée de l’utilisateur et est grisé.

  - TBSTATE_HIDDEN Le bouton n’est pas visible et ne peut pas recevoir d’entrée utilisateur.

  - TBSTATE_INDETERMINATE Le bouton est grisé.

  - TBSTATE_PRESSED Le bouton est pressé.

  - TBSTATE_WRAP Une rupture de ligne suit le bouton. Le bouton doit également avoir l’état TBSTATE_ENABLED.

- `fsStyle`

   Style bouton. Il peut s’agir d’une combinaison des valeurs énumérées ci-dessous :

  - TBSTYLE_BUTTON crée un bouton poussoir standard.

  - TBSTYLE_CHECK crée un bouton qui bascule entre les états pressés et non pressés chaque fois que l’utilisateur clique dessus. Le bouton a une couleur de fond différente quand il est dans l’état pressé.

  - TBSTYLE_CHECKGROUP crée un bouton de contrôle qui reste pressé jusqu’à ce qu’un autre bouton dans le groupe soit pressé.

  - TBSTYLE_GROUP crée un bouton qui reste pressé jusqu’à ce qu’un autre bouton dans le groupe soit pressé.

  - TBSTYLE_SEP crée un séparateur, fournissant un petit espace entre les groupes de boutons. Un bouton qui a ce style ne reçoit pas l’entrée de l’utilisateur.

- `dwData`

   Données définies par l’utilisateur.

- `iString`

   Index à base zéro de la chaîne à utiliser comme étiquette du bouton, -1 s’il n’y a pas de chaîne pour ce bouton.

L’image et/ou la chaîne dont vous fournissez l’index doit avoir déjà été ajoutée à la liste du contrôle de la barre d’outils à l’aide [d’AddBitmap,](#addbitmap) [AddString](#addstring)et/ou [AddStrings](#addstrings).

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a>CToolBarCtrl::AddString

Ajoute une nouvelle chaîne, passée comme une pièce d’identité de ressource, à la liste interne des chaînes de la barre d’outils.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Paramètres

*nStringID (en)*<br/>
Identifiant de ressource de la ressource de chaîne à ajouter à la liste de chaîne du contrôle de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

L’indice zéro de la première nouvelle chaîne ajouté en cas de succès; sinon -1.

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a>CToolBarCtrl::AddStrings

Ajoute une nouvelle chaîne ou des chaînes à la liste des chaînes disponibles pour un contrôle de barre d’outils.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Paramètres

*lpszStrings (lpszStrings)*<br/>
Adresse d’un tampon qui contient une ou plusieurs chaînes non terminées à ajouter à la liste des chaînes de la barre d’outils. La dernière corde doit être terminée avec deux caractères nuls.

### <a name="return-value"></a>Valeur de retour

L’indice zéro de la première nouvelle chaîne ajouté en cas de succès; sinon -1.

### <a name="remarks"></a>Notes

Les cordes dans le tampon doivent être séparées par un caractère nul. Vous devez vous assurer que la dernière chaîne a deux terminateurs nuls. Pour bien formater une chaîne constante, vous pouvez l’écrire comme:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

ou :

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

Vous ne devez `CString` pas passer un objet à cette fonction car il `CString`n’est pas possible d’avoir plus d’un caractère nul dans un .

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a>CToolBarCtrl::AutoSize

Resizes l’ensemble du contrôle de la barre d’outils.

```cpp
void AutoSize();
```

### <a name="remarks"></a>Notes

Vous devez appeler cette fonction lorsque la taille de la fenêtre parente change ou lorsque la taille de la barre d’outils change (par exemple lorsque vous réglez le bouton ou la taille de la bitmap, ou ajoutez des cordes).

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a>CToolBarCtrl::ChangeBitmap

Change la bitmap pour un bouton dans le contrôle actuel de la barre d’outils.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*idButton*|[dans] Identifiant de commande du bouton qui doit recevoir une nouvelle bitmap.|
|*iBitmap (en)*|[dans] Index basé sur zéro d’une image dans la liste d’images du contrôle actuel de la barre d’outils.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Si cette méthode est efficace, le système affiche l’image spécifiée dans le bouton spécifié.

Cette méthode envoie le [message TB_CHANGEBITMAP,](/windows/win32/Controls/tb-changebitmap) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant modifie la bitmap pour le bouton **Enregistrement de fichier** sur le bitmap pour le bouton **About.**

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a>CToolBarCtrl::CheckButton

Vérifie ou efface un bouton donné dans un contrôle de barre d’outils.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton pour vérifier ou effacer.

*bCheck (en)*<br/>
VRAI pour vérifier le bouton, FALSE pour l’effacer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Lorsqu’un bouton a été vérifié, il semble avoir été pressé. Si vous souhaitez modifier plus d’un bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a>CToolBarCtrl::CommandToIndex

Récupère l’index zéro pour le bouton associé à l’identifiant de commande spécifié.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Id de commande dont l’index de bouton que vous voulez trouver.

### <a name="return-value"></a>Valeur de retour

L’index zéro pour le bouton associé à l’ID de commande.

### <a name="remarks"></a>Notes

## <a name="ctoolbarctrlcreate"></a><a name="create"></a>CToolBarCtrl::Créer

Crée un contrôle de barre d’outils et le fixe à un `CToolBarCtrl` objet.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle (en)*<br/>
Spécifie le style du contrôle de la barre d’outils. Les barres d’outils doivent toujours avoir le style WS_CHILD. En outre, vous pouvez spécifier n’importe quelle combinaison de styles de barre d’outils et de styles de fenêtre comme décrit sous **Remarques**.

*Rect*<br/>
Spécifie optionnellement la taille et la position du contrôle de la barre d’outils. Il peut s’agir soit d’un objet [CRect,](../../atl-mfc-shared/reference/crect-class.md) soit d’une structure [RECT.](/windows/win32/api/windef/ns-windef-rect)

*pParentWnd*<br/>
Spécifie la fenêtre parente du contrôle de la barre d’outils. Ce ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Vous construisez un `CToolBarCtrl` en deux étapes. Tout d’abord, appelez le `Create`constructeur, puis appelez , ce qui `CToolBarCtrl` crée le contrôle de la barre d’outils et le fixe à l’objet. Appliquer les styles de fenêtre suivants à un contrôle de barre d’outils.

- WS_CHILD toujours

- WS_VISIBLE Habituellement

- WS_DISABLED Rarement

Voir [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le Windows SDK pour une description des styles de fenêtre.

Optionnellement, appliquez une combinaison de styles de [contrôle communs,](/windows/win32/Controls/common-control-styles)comme décrit dans le SDK Windows.

Appliquer une combinaison de styles de barres d’outils pour le contrôle ou les boutons eux-mêmes. Les styles sont décrits dans le sujet [Toolbar Control et Button Styles](/windows/win32/Controls/toolbar-control-and-button-styles) dans le SDK Windows.

Pour utiliser des styles de barres d’outils `Create`étendus, appelez [SetExtendedStyle](#setextendedstyle) après votre appel . Pour créer une barre d’outils avec des styles de fenêtre étendus, appelez [CToolBarCtrl::CreateEx](#createex) au lieu de `Create`.

Le contrôle de la barre d’outils définit automatiquement la taille et la position de la fenêtre de la barre d’outils. La hauteur est basée sur la hauteur des boutons dans la barre d’outils. La largeur est la même que la largeur de la zone cliente de la fenêtre mère. Les styles CCS_TOP et CCS_BOTTOM déterminent si la barre d’outils est positionnée le long du haut ou du bas de la zone client. Par défaut, une barre d’outils a le style CCS_TOP.

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a>CToolBarCtrl::CreateEx

Crée un contrôle (une fenêtre enfant) `CToolBarCtrl` et l’associe à l’objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle (en anglais)*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour une liste de styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le Windows SDK.

*dwStyle (en)*<br/>
Spécifie le style du contrôle de la barre d’outils. Les barres d’outils doivent toujours avoir le style WS_CHILD. En outre, vous pouvez spécifier n’importe quelle combinaison de styles de barre d’outils et de styles de fenêtre comme décrit dans la section **Remarques** de [Créer](#create).

*Rect*<br/>
Une référence à une structure [RECT](/windows/win32/api/windef/ns-windef-rect) décrivant la taille et la position de la fenêtre à créer, dans les coordonnées des clients de *pParentWnd*.

*pParentWnd*<br/>
Un pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
L’id de fenêtre pour enfants du contrôle.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au lieu de [créer](#create) pour appliquer des styles Windows étendus, spécifiés par la préface de style étendu Windows **WS_EX_**. `CreateEx`crée le contrôle avec les styles Windows étendus spécifiés par *dwExStyle*. Définissez des styles étendus spécifiques à un contrôle à l’aide [de SetExtendedStyle](#setextendedstyle). Par exemple, `CreateEx` utilisez-le pour définir des styles `SetExtendedStyle` tels que WS_EX_CONTEXTHELP, mais utilisez pour définir des styles tels que TBSTYLE_EX_DRAWDDARROWS. Pour plus d’informations, voir les styles décrits dans [Toolbar Extended Styles](/windows/win32/Controls/toolbar-extended-styles) dans le Windows SDK.

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a>CToolBarCtrl::CToolBarCtrl

Construit un objet `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Notes

Vous devez appeler [Create](#create) pour rendre la barre d’outils utilisable.

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a>CToolBarCtrl::Customize

Affiche la boîte de dialogue Customize Toolbar.

```cpp
void Customize();
```

### <a name="remarks"></a>Notes

Cette boîte de dialogue permet à l’utilisateur de personnaliser la barre d’outils en ajoutant et en supprimant les boutons. Pour prendre en charge la personnalisation, la fenêtre parente de votre barre d’outils doit gérer les messages de notification de personnalisation tels que décrits dans [handling Customization Notifications](../../mfc/handling-customization-notifications.md). Votre barre d’outils doit également avoir été créé avec le style CCS_ADJUSTABLE, comme décrit dans [CToolBarCtrl::Créer](#create).

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a>CToolBarCtrl::DeleteButton

Supprime un bouton du contrôle de la barre d’outils.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index zéro du bouton à supprimer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a>CToolBarCtrl::EnableButton

Permet ou désactive le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton pour activer ou désactiver.

*bEnable*<br/>
VRAI pour activer le bouton; FALSE pour désactiver le bouton.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Lorsqu’un bouton a été activé, il peut être pressé et vérifié. Si vous souhaitez modifier plus d’un bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a>CToolBarCtrl::GetAnchorHighlight

Récupère le réglage de mise en évidence de l’ancre pour une barre d’outils.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Valeur de retour

Si non zéro, la mise en évidence de l’ancre est activée. Si zéro, la mise en évidence de l’ancre est désactivée.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a>CToolBarCtrl::GetBitmap

Récupère l’index de la bitmap associé à un bouton dans une barre d’outils.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dont l’index de bitmap doit être récupéré.

### <a name="return-value"></a>Valeur de retour

Retourne l’index de la bitmap en cas de succès, ou zéro autrement.

### <a name="remarks"></a>Notes

Implémente la fonctionnalité de [TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap) dans le SDK Windows.

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a>CToolBarCtrl::GetBitmapFlags

Récupère les drapeaux de la bitmap de la barre d’outils.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Valeur de retour

Un UINT qui a le TBBF_LARGE drapeau réglé si l’affichage peut prendre en charge les gros bitmaps barre d’outils, clair autrement.

### <a name="remarks"></a>Notes

Vous devriez l’appeler après la création de la barre d’outils, mais avant d’ajouter des bitmaps à la barre d’outils. La valeur de retour indique si l’affichage prend en charge de grandes bitmaps ou non. Si l’écran prend en charge les gros bitmaps et si vous choisissez de les utiliser, appelez [SetBitmapSize](#setbitmapsize) et [SetButtonSize](#setbuttonsize) avant d’ajouter votre gros bitmap à l’aide [d’AddBitmap](#addbitmap).

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a>CToolBarCtrl::GetButton

Récupère des informations sur le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index zéro du bouton pour lequel récupérer des informations.

*lpButton*<br/>
Adresse de `TBBUTTON` la structure qui doit recevoir une copie des informations sur le bouton. Voir [CToolBarCtrl:AddButtons](#addbuttons) pour plus `TBBUTTON` d’informations sur la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a>CToolBarCtrl::GetButtonCount

Récupère un compte des boutons actuellement dans le contrôle de la barre d’outils.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le compte des boutons.

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a>CToolBarCtrl::GetButtonInfo

Récupère les informations pour un bouton dans une barre d’outils.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
L’identifiant du bouton.

*ptbbi (en)*<br/>
Un pointeur vers une structure [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) qui reçoit les informations du bouton.

### <a name="return-value"></a>Valeur de retour

L’index zéro du bouton, en cas de succès; sinon -1.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a>CToolBarCtrl::GetButtonSize

Obtient la taille d’un bouton de barre d’outils.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur DWORD qui contient les valeurs de largeur et de hauteur dans le LOWORD et HIWORD, respectivement.

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a>CToolBarCtrl::GetButtonText

Récupère le texte d’affichage d’un bouton spécifié sur le contrôle actuel de la barre d’outils.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*idButton*|[dans] L’identifiant pour le bouton dont le texte d’affichage est récupéré.|

### <a name="return-value"></a>Valeur de retour

Un [CString](../../atl-mfc-shared/using-cstring.md) qui contient le texte d’affichage du bouton spécifié.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_GETBUTTONTEXT,](/windows/win32/Controls/tb-getbuttontext) qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a>CToolBarCtrl::GetColorScheme

Récupère le schéma de couleur du contrôle actuel de la barre d’outils.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*lpColorScheme*|[out] Pointeur vers une structure [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) qui reçoit les informations de schéma de couleur. Lorsque cette méthode revient, la structure décrit la couleur de mise en évidence et la couleur de l’ombre du contrôle de la barre d’outils.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_GETCOLORSCHEME,](/windows/win32/Controls/tb-getcolorscheme) qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a>CToolBarCtrl::GetDisabledImageList

Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher les boutons désactivés.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList,](../../mfc/reference/cimagelist-class.md) ou NULL si aucune liste d’images désactivée n’est définie.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist), tel que décrit dans le SDK Windows. La mise en `GetDisabledImageList` œuvre MFC utilise un `CImageList` objet contenant les images bouton du contrôle de la barre d’outils, plutôt qu’une poignée à une liste d’images.

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a>CToolBarCtrl::GetDropTarget

Récupère l’interface [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) pour un contrôle de barre d’outils.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Paramètres

*ppDropTarget*<br/>
Un pointeur à un pointeur d’interface [IDropTarget.](/windows/win32/api/oleidl/nn-oleidl-idroptarget) En cas d’erreur, un pointeur NULL est placé dans cette adresse.

### <a name="return-value"></a>Valeur de retour

Retourne une valeur HRESULT indiquant le succès ou l’échec de l’opération.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETOBJECT](/windows/win32/Controls/tb-getobject), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a>CToolBarCtrl::GetExtendedStyle

Récupère les styles étendus pour un contrôle de barre d’outils.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valeur de retour

Un DWORD qui représente les styles étendus actuellement utilisés pour le contrôle de la barre d’outils. Pour une liste de styles, voir [Toolbar Extended Styles](/windows/win32/Controls/toolbar-extended-styles), dans le Windows SDK.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a>CToolBarCtrl::GetHotImageList

Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher des boutons « chauds ». Un bouton chaud apparaît surligné lorsque le pointeur de la souris est au-dessus.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList,](../../mfc/reference/cimagelist-class.md) ou NULL si aucune liste d’images désactivée n’est définie.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist), tel que décrit dans le SDK Windows. Un bouton chaud apparaît surligné lorsque le pointeur de la souris est au-dessus.

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a>CToolBarCtrl::GetHotItem

Récupère l’index de l’élément chaud dans une barre d’outils.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Valeur de retour

L’index à base nulle de l’élément chaud dans une barre d’outils.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a>CToolBarCtrl::GetImageList

Récupère la liste d’images qu’un contrôle de barre d’outils utilise pour afficher les boutons dans leur état par défaut.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList,](../../mfc/reference/cimagelist-class.md) ou NULL si aucune liste d’images n’est définie.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a>CToolBarCtrl::GetInsertMark

Récupère la marque d’insertion actuelle pour la barre d’outils.

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Paramètres

*ptbim ptbim*<br/>
Un pointeur vers une structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui reçoit la marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CToolBarCtrl::GetInsertMarkColor

Récupère la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui contient la couleur actuelle de marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a>CToolBarCtrl::GetItemRect

Récupère le rectangle de délimitation d’un bouton dans un contrôle de barre d’outils.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index zéro du bouton pour lequel récupérer des informations.

*lpRect*<br/>
Adresse d’une structure [RECT](/windows/win32/api/windef/ns-windef-rect) ou [d’un objet CRect](../../atl-mfc-shared/reference/crect-class.md) qui reçoit les coordonnées du rectangle de délimitation.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction ne récupère pas le rectangle de délimitation pour les boutons dont l’état est réglé pour TBSTATE_HIDDEN.

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a>CToolBarCtrl::GetMaxSize

Récupère la taille totale de tous les boutons et séparateurs visibles dans la barre d’outils.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Paramètres

*Psize*<br/>
Un pointeur vers une structure [SIZE](/windows/win32/api/windef/ns-windef-size) qui reçoit la taille des articles.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a>CToolBarCtrl::GetMaxTextRows

Récupère le nombre maximum de lignes de texte affichées sur un bouton de barre d’outils.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre maximum de lignes de texte affichées sur un bouton de barre d’outils.

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a>CToolBarCtrl::GetMetrics

Récupère les mesures de `CToolBarCtrl` l’objet.

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Paramètres

*ptbm ptbm*<br/>
Un pointeur sur la structure `CToolBarCtrl` [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) de l’objet.

### <a name="remarks"></a>Notes

Cette fonction de membre imite la fonctionnalité du message [TB_GETMETRICS,](/windows/win32/Controls/tb-getmetrics) tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a>CToolBarCtrl::GetPadding

Récupère le rembourrage horizontal et vertical du contrôle actuel de la barre d’outils.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*pnHorzPadding (en)*|[out] Un intégrant qui reçoit le rembourrage horizontal du contrôle de la barre d’outils, en pixels.|
|*pnVertPadding (en)*|[out] Un intégrant qui reçoit le rembourrage vertical du contrôle de la barre d’outils, en pixels.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_GETPADDING,](/windows/win32/Controls/tb-getpadding) qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a>CToolBarCtrl::GetPressedImageList

Récupère la liste d’images que le contrôle actuel de la barre d’outils utilise pour représenter les boutons dans l’état pressé.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers une [liste CImage Qui](../../mfc/reference/cimagelist-class.md) contient la liste d’images pour le contrôle actuel, ou NULL si aucune liste d’images de ce type n’est définie.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_GETPRESSEDIMAGELIST,](/windows/win32/Controls/tb-getpressedimagelist) qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a>CToolBarCtrl::GetRect

Récupère le rectangle de délimitation pour un bouton de barre d’outils spécifié.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
L’identifiant du bouton.

*lpRect*<br/>
Un pointeur vers une structure [RECT](/windows/win32/api/windef/ns-windef-rect) pour recevoir les informations de rectangle de délimitation.

### <a name="return-value"></a>Valeur de retour

TRUE en cas de réussite, sinon FALSE.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETRECT](/windows/win32/Controls/tb-getrect), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a>CToolBarCtrl::GetRows

Récupère le nombre de lignes de boutons actuellement affichées par le contrôle de la barre d’outils.

```
int GetRows() const;
```

### <a name="return-value"></a>Valeur de retour

Nombre de lignes de boutons actuellement affichées sur la barre d’outils.

### <a name="remarks"></a>Notes

Notez que le nombre de lignes sera toujours un sauf si la barre d’outils a été créé avec le style TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a>CToolBarCtrl::GetState

Récupère des informations sur l’état du bouton spécifié dans un contrôle de barre d’outils, par exemple s’il est activé, pressé ou vérifié.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton pour lequel récupérer des informations.

### <a name="return-value"></a>Valeur de retour

Les informations d’état de bouton en cas de succès ou - 1 autrement. Les informations d’état de bouton peuvent être une combinaison des valeurs énumérées dans [CToolBarCtrl:AddButtons](#addbuttons).

### <a name="remarks"></a>Notes

Cette fonction est particulièrement pratique si vous voulez récupérer plus d’un des états de bouton. Pour simplement récupérer un état, utilisez l’une des fonctions suivantes membre: [IsButtonEnabled](#isbuttonenabled), [IsButtonChecked](#isbuttonchecked), [IsButtonPressed](#isbuttonpressed), [IsButtonHidden](#isbuttonhidden), ou [IsButtonIndeterminate](#isbuttonindeterminate). Cependant, `GetState` la fonction de membre est la seule façon de détecter l’état TBSTATE_WRAP bouton.

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a>CToolBarCtrl::GetString

Récupère une chaîne de barre d’outils.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Paramètres

*nString*<br/>
Index de la chaîne.

*lpstrString (lpstrString)*<br/>
Pointeur vers un tampon utilisé pour retourner la chaîne.

*cchMaxLen (en)*<br/>
Longueur du tampon dans les octets.

*Str*<br/>
Chaîne.

### <a name="return-value"></a>Valeur de retour

La longueur de la chaîne en cas de succès, -1 sinon.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_GETSTRING](/windows/win32/Controls/tb-getstring), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a>CToolBarCtrl::GetStyle

Obtient les styles actuellement appliqués à un contrôle de barre d’outils.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Valeur de retour

Un DWORD contenant une combinaison de styles de contrôle de [barre d’outils,](/windows/win32/Controls/toolbar-control-and-button-styles)tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a>CToolBarCtrl::GetToolTips

Récupère la poignée du contrôle de pointe de l’outil, le cas échéant, associé au contrôle de la barre d’outils.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à l’objet [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) associé à cette barre d’outils ou NULL si la barre d’outils n’a pas de contrôle de pointe d’outil associé.

### <a name="remarks"></a>Notes

Étant donné que le contrôle de la barre d’outils crée et maintient normalement son propre contrôle de pointe d’outil, la plupart des programmes n’ont pas besoin d’appeler cette fonction.

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a>CToolBarCtrl::HitTest

Détermine où se trouve un point dans un contrôle de barre d’outils.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Paramètres

*Ppt*<br/>
Un pointeur vers une structure [POINT](/windows/win32/api/windef/ns-windef-point) qui contient la `x` x-coordonnées du test de frappe `y` dans le membre et la y-coordinate du test de frappe dans le membre. Les coordonnées sont relatives à la zone client de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Une valeur d’intégrant indiquant l’emplacement d’un point sur une barre d’outils. Si la valeur est nulle ou une valeur positive, cette valeur de rendement est l’indice à base nulle de l’élément non-parateur dans lequel se trouve le point.

Si la valeur de retour est négative, le point ne se trouve pas dans un bouton. La valeur absolue de la valeur de rendement est l’index d’un élément séparateur ou de l’élément non-parateur le plus proche.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_HITTEST](/windows/win32/Controls/tb-hittest), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a>CToolBarCtrl::HideButton

Cache ou affiche le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Commandez l’identifiant du bouton pour se cacher ou montrer.

*bHide (en)*<br/>
VRAI pour cacher le bouton, FALSE pour le montrer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Si vous souhaitez modifier plus d’un bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a>CToolBarCtrl::Indéterminé

Définit ou efface l’état indéterminé du bouton spécifié dans un contrôle de barre d’outils.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dont l’état d’une durée indéterminée doit être défini ou effacé.

*bDéterminez*<br/>
VRAI pour définir l’état d’une durée indéterminée pour le bouton spécifié, FALSE pour l’effacer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Les boutons pour une durée indéterminée sont affichés grisés, comme la façon dont le bouton audacieux sur la barre d’outils d’un traitement de texte regarderait lorsque le texte sélectionné contient des caractères audacieux et réguliers. Si vous souhaitez modifier plus d’un bouton, envisagez d’appeler [SetState](#setstate) à la place.

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a>CToolBarCtrl::InsertButton

Insère un bouton dans un contrôle de barre d’outils.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index zéro d’un bouton. Cette fonction insère le nouveau bouton à gauche de ce bouton.

*lpButton*<br/>
Adresse d’une `TBBUTTON` structure contenant des informations sur le bouton à insérer. Voir [CToolBarCtrl:AddButtons](#addbuttons) pour une `TBBUTTON` description de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

L’image et/ou la chaîne dont vous fournissez l’index doit avoir déjà été ajoutée à la liste du contrôle de la barre d’outils à l’aide [d’AddBitmap,](#addbitmap) [AddString](#addstring)et/ou [AddStrings](#addstrings).

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a>CToolBarCtrl::InsertMarkHitTest

Récupère les informations de marque d’insertion pour un point dans une barre d’outils.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Paramètres

*Ppt*<br/>
Un pointeur vers une structure [POINT](/windows/win32/api/windef/ns-windef-point) qui contient les coordonnées de test à succès, par rapport à la zone client de la barre d’outils.

*ptbim ptbim*<br/>
Un pointeur vers une structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui reçoit les informations de marque d’insertion.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a>CToolBarCtrl::IsButtonChecked

Détermine si le bouton spécifié dans un contrôle de barre d’outils est vérifié.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nonzero si le bouton est vérifié; autrement zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous voulez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a>CToolBarCtrl::IsButtonEnabled

Détermine si le bouton spécifié dans un contrôle de barre d’outils est activé.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nonzero si le bouton est activé; autrement zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous voulez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a>CToolBarCtrl::IsButtonHidden

Détermine si le bouton spécifié dans un contrôle de barre d’outils est caché.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nonzero si le bouton est caché; autrement zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous voulez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CToolBarCtrl::IsButtonHighlighted

Vérifie l’état de surbrillance d’un bouton de barre d’outils.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] L’ID de commande pour le bouton de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Integer positif si le bouton est mis en surbrillance, 0 si le bouton n’est pas mis en surbrillance, ou -1 si une erreur se produit.

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a>CToolBarCtrl::IsButtonIndéterminer

Détermine si le bouton spécifié dans un contrôle de barre d’outils est indéterminé.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] Identifiant de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Integer positif si le bouton est indéterminé, zéro si le bouton n’est pas indéterminé, ou -1 si une erreur se produit.

### <a name="remarks"></a>Notes

Les boutons pour une durée indéterminée sont affichés tamisés, comme la façon dont le bouton audacieux sur la barre d’outils d’un traitement de texte ressemble lorsque le texte sélectionné contient des caractères audacieux et réguliers. Envisagez d’appeler [GetState](#getstate) si vous voulez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a>CToolBarCtrl::IsButtonPressed

Détermine si le bouton spécifié dans un contrôle de barre d’outils est pressé.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton dans la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Nonzero si le bouton est appuyé, sinon zéro.

### <a name="remarks"></a>Notes

Envisagez d’appeler [GetState](#getstate) si vous voulez récupérer plus d’un état de bouton.

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a>CToolBarCtrl::LoadImages

Charge les bitmaps dans la liste d’images d’une barre d’outils.

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Paramètres

*iBitmapID*<br/>
ID d’une bitmap qui contient les images à charger. Pour spécifier votre propre ressource de bitmap, définissez ce paramètre à l’ID d’une ressource bitmap et *définissez hInst* à NULL. Votre ressource bitmap sera ajoutée à la liste d’images en une seule image. Vous pouvez ajouter des bitmaps standard et définis par le système en définissant *hinst* à HINST_COMMCTRL et en définissant ce paramètre à l’une des DIM suivantes :

|Bitmap ID|Description|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Les bitmaps d’explorateur dans la grande taille|
|IDB_HIST_SMALL_COLOR|Les bitmaps d’explorateur dans la petite taille|
|IDB_STD_LARGE_COLOR|Bitmaps standard en grande taille|
|IDB_STD_SMALL_COLOR|Bitmaps standard en petite taille|
|IDB_VIEW_LARGE_COLOR|Afficher les bitmaps en grande taille|
|IDB_VIEW_SMALL_COLOR|Afficher les bitmaps en petite taille|

*hinst*<br/>
L’instance du programme s’occupe de la demande d’appel. Ce paramètre peut être HINST_COMMCTRL pour charger une liste d’images standard.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a>CToolBarCtrl::MapAccelerator

Cartographiez un personnage d’accélérateur sur un bouton de barre d’outils.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Paramètres

*chAccel (en)*<br/>
Caractère d’accélérateur à cartographier. Ce personnage est le même personnage qui est souligné dans le texte du bouton.

*pIDBtn (en)*<br/>
Un pointeur à un UINT qui reçoit l’identifiant de commande du bouton qui correspond à l’accélérateur spécifié dans *chAccel*.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a>CToolBarCtrl::MarkButton

Définit l’état de surbrillance d’un bouton donné dans un contrôle de barre d’outils.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
L’identifiant du bouton.

*fHighlight*<br/>
Spécifie l’état de point culminant à définir. Par défaut, TRUE. Si défini à FALSE, le bouton est réglé à son état par défaut.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a>CToolBarCtrl::MoveButton

Déplace un bouton d’un index à l’autre.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Paramètres

*nOldPos (en)*<br/>
L’index zéro du bouton à déplacer.

*nNewPos (en)*<br/>
L’index zéro de la destination du bouton.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a>CToolBarCtrl::PressButton

Presse ou libère le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
[dans] Identifiant de commande du bouton pour appuyer ou libérer.

*bPress (en)*<br/>
[dans] VRAI pour appuyer sur le bouton spécifié; FALSE pour libérer le bouton spécifié. La valeur par défaut est TRUE.

### <a name="return-value"></a>Valeur de retour

VRAI si la méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Si vous souhaitez modifier plus d’un bouton, envisagez d’appeler [SetState](#setstate) à la place.

Cette méthode envoie le [message TB_PRESSBUTTON,](/windows/win32/Controls/tb-pressbutton) qui est décrit dans le SDK Windows.

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a>CToolBarCtrl::ReplaceBitmap

Remplace la bitmap existante dans le contrôle actuel de la barre d’outils par une nouvelle bitmap.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*pReplaceBitmap (en)*|[dans] Pointeur vers une structure [TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap) qui décrit la bitmap à remplacer et la nouvelle bitmap.|

### <a name="return-value"></a>Valeur de retour

VRAI si cette méthode est réussie; autrement, FALSE.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_REPLACEBITMAP,](/windows/win32/Controls/tb-replacebitmap) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant remplace la bitmap pour la barre d’outils standard par une bitmap différente.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a>CToolBarCtrl::RestoreState

Restaure l’état du contrôle de la barre d’outils à partir de l’emplacement du registre spécifié par les paramètres.

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Paramètres

*hKeyRoot (en)*<br/>
Identifie une clé actuellement ouverte dans le registre ou l’une des valeurs de poignée réservée prédéfinie suivantes :

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Indique une chaîne non terminée contenant le nom du sous-clé auquel une valeur est associée. Ce paramètre peut être nul ou un pointeur à une chaîne vide. Si le paramètre est NULL, la valeur sera ajoutée à la clé identifiée par le paramètre *hKeyRoot.*

*lpszValueName*<br/>
Points à une chaîne contenant le nom de la valeur à récupérer. Si une valeur avec ce nom n’est pas déjà présente dans la clé, la fonction l’ajoute à la clé.

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a>CToolBarCtrl::SaveState

Enregistre l’état du contrôle de la barre d’outils dans l’emplacement du registre spécifié par les paramètres.

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Paramètres

*hKeyRoot (en)*<br/>
Identifie une clé actuellement ouverte dans le registre ou l’une des valeurs de poignée réservée prédéfinie suivantes :

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Indique une chaîne non terminée contenant le nom du sous-clé auquel une valeur est associée. Ce paramètre peut être nul ou un pointeur à une chaîne vide. Si le paramètre est NULL, la valeur sera ajoutée à la clé identifiée par le paramètre *hKeyRoot.*

*lpszValueName*<br/>
Points à une chaîne contenant le nom de la valeur à définir. Si une valeur avec ce nom n’est pas déjà présente dans la clé, la fonction l’ajoute à la clé.

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a>CToolBarCtrl::SetAnchorHighlight

Définit le réglage de mise en évidence d’ancre pour une barre d’outils.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Paramètres

*fAnchor*<br/>
[dans] Précise si la mise en surbrillance de l’ancre est activée ou désactivée. Si cette valeur n’est pas zéro, la mise en évidence de l’ancre sera activée. Si cette valeur est nulle, la mise en évidence de l’ancre sera désactivée

### <a name="return-value"></a>Valeur de retour

Le réglage d’ancrage précédent. Si la mise en surbrillance a été activée, cette valeur n’est pas zéro. Si la mise en évidence n’a pas été activée, cette valeur est nulle.

### <a name="remarks"></a>Notes

Cette méthode met en œuvre le comportement du message Win32 [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a>CToolBarCtrl::SetBitmapSize

Définit la taille des images bitmapped réelles à ajouter à un contrôle de barre d’outils.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Paramètres

*size*<br/>
Largeur et hauteur, en pixels, des images mordues.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction ne doit être appelée qu’avant d’ajouter des bitmaps à la barre d’outils. Si l’application ne fixe pas explicitement la taille de la bitmap, elle est par défaut à 16 par 15 pixels.

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a>CToolBarCtrl::SetButtonInfo

Définit les informations pour un bouton existant dans une barre d’outils.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
L’identifiant du bouton.

*ptbbi (en)*<br/>
Un pointeur vers une structure [TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow) qui reçoit les informations du bouton.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction membre implémente le comportement du message Win32 [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a>CToolBarCtrl::SetButtonSize

Définit la taille des boutons dans le contrôle de la barre d’outils.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Paramètres

*size*<br/>
Largeur et hauteur, en pixels, des boutons.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

La taille du bouton doit toujours être au moins aussi grande que la taille de bitmap qu’il s’enferme. Cette fonction ne doit être appelée qu’avant d’ajouter des bitmaps à la barre d’outils. Si l’application ne fixe pas explicitement la taille du bouton, elle est par défaut à 24 par 22 pixels.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CToolBar:GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a>CToolBarCtrl::SetButtonStructSize

Précise la taille de `TBBUTTON` la structure.

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Paramètres

*nSize (en)*<br/>
Taille, dans les octets, de la `TBBUTTON` structure.

### <a name="remarks"></a>Notes

Si vous vouliez stocker des `TBBUTTON` données supplémentaires dans la structure, vous pourriez soit tirer une nouvelle structure de `TBBUTTON`, en ajoutant les membres dont vous aviez besoin, ou créer une nouvelle structure qui contient une `TBBUTTON` structure comme son premier membre. Vous appelez alors cette fonction pour indiquer à la barre d’outils de contrôler la taille de la nouvelle structure.

Voir [CToolBarCtrl:AddButtons](#addbuttons) pour plus `TBBUTTON` d’informations sur la structure.

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a>CToolBarCtrl::SetButtonWidth

Définit les largeurs minimales et maximales du bouton dans le contrôle de la barre d’outils.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Paramètres

*cxMin (en)*<br/>
Largeur minimale du bouton, en pixels. Les boutons de barre d’outils ne seront jamais plus étroits que cette valeur.

*cxMax (en)*<br/>
Largeur maximale du bouton, en pixels. Si le texte du bouton est trop large, le contrôle l’affiche avec des points d’élipsis.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a>CToolBarCtrl::SetCmdID

Définit l’identifiant de commande qui sera envoyé à la fenêtre du propriétaire lorsque le bouton spécifié est appuyé.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
L’index zéro du bouton dont l’ID de commande doit être défini.

*nID*<br/>
L’ID de commande pour régler le bouton sélectionné.

### <a name="return-value"></a>Valeur de retour

Retourne nonzero en cas de succès; autrement zéro.

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a>CToolBarCtrl::SetColorScheme

Définit le schéma de couleur du contrôle actuel de la barre d’outils.

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*lpColorScheme*|[dans] Pointeur vers une structure [COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme) qui décrit la couleur de mise en évidence et la couleur d’ombre du contrôle de la barre d’outils.|

### <a name="remarks"></a>Notes

Cette méthode n’a aucun effet si un thème visuel Windows Vista est défini.

Cette méthode envoie le [message TB_SETCOLORSCHEME,](/windows/win32/Controls/tb-setcolorscheme) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit le schéma de couleur pour le contrôle actuel de la barre d’outils. L’exemple de code rend les bords gauche et supérieur de chaque bouton d’outil rouge et les bords droits et inférieurs bleus. Lorsque l’utilisateur appuie sur le bouton, les bords rouges du bouton deviennent bleus et ses bords bleus deviennent rouges.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a>CToolBarCtrl::SetDisabledImageList

Définit la liste d’images que le contrôle de la barre d’outils utilisera pour afficher les boutons désactivés.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList (en)*<br/>
Un pointeur `CImageList` vers un objet contenant les images à utiliser par le contrôle de la barre d’outils pour afficher des images de bouton désactivées.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) qui a été précédemment utilisé par le contrôle de la barre d’outils pour afficher des images de bouton désactivées.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist), tel que décrit dans le SDK Windows. La mise en `SetDisabledImageList` œuvre MFC utilise un `CImageList` objet contenant les images de bouton désactivées du contrôle de la barre d’outils, plutôt qu’une poignée à une liste d’images.

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a>CToolBarCtrl::SetDrawTextFlags

Définit les drapeaux dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui est utilisé pour dessiner le texte dans le rectangle spécifié, formaté en fonction de la façon dont les drapeaux sont définis.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Paramètres

*dwMask*<br/>
Une combinaison d’un ou plusieurs des drapeaux DT_, spécifié dans la fonction Win32 [DrawText](/windows/win32/api/winuser/nf-winuser-drawtext), qui indique quels bits dans *dwDTFlags* seront utilisés lors du dessin du texte.

*dwDTFlags dwDTFlags*<br/>
Une combinaison d’un ou plusieurs des DT_ drapeaux, spécifié `DrawText`dans la fonction Win32 , qui indiquent comment le texte du bouton sera tiré. Cette valeur est `DrawText` transmise au moment où le texte du bouton est dessiné.

### <a name="return-value"></a>Valeur de retour

Un DWORD contenant le texte précédent dessinant des drapeaux.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags), tel que décrit dans le SDK Windows. Cette fonction membre définit les drapeaux `DrawText`dans la fonction Win32 , qui tire du texte dans le rectangle spécifié, formaté en fonction de la façon dont les drapeaux sont définis.

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a>CToolBarCtrl::SetExtendedStyle

Définit les styles étendus pour un contrôle de barre d’outils.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Paramètres

*dwExStyle (en anglais)*<br/>
Une valeur spécifiant les nouveaux styles étendus. Ce paramètre peut être une combinaison des styles étendus de la barre d’outils.

### <a name="return-value"></a>Valeur de retour

Un DWORD qui représente les styles étendus précédents. Pour une liste de styles, voir [Toolbar Extended Styles](/windows/win32/Controls/toolbar-extended-styles), dans le Windows SDK.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a>CToolBarCtrl::SetHotImageList

Définit la liste d’images que le contrôle de la barre d’outils utilisera pour afficher des boutons « chauds ».

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList (en)*<br/>
Un pointeur `CImageList` d’un objet contenant les images à utiliser par le contrôle de la barre d’outils pour afficher des images bouton chaud.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) qui a été précédemment utilisé par le contrôle de la barre d’outils pour afficher des images bouton chaud.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist), tel que décrit dans le SDK Windows.

La mise en `SetHotImageList` œuvre MFC utilise un `CImageList` objet contenant les images bouton chaud du contrôle de la barre d’outils, plutôt qu’une poignée à une liste d’images. Un bouton chaud apparaît surligné lorsque le pointeur est au-dessus.

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a>CToolBarCtrl::SetHotItem

Définit l’article chaud dans une barre d’outils.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Paramètres

*nHot (en)*<br/>
Le numéro d’index à base nulle de l’élément qui sera rendu chaud. Si cette valeur est de -1, aucun des éléments ne sera chaud.

### <a name="return-value"></a>Valeur de retour

L’index de l’article chaud précédent, ou -1 s’il n’y avait pas d’article chaud.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a>CToolBarCtrl::SetImageList

Définit la liste d’images que la barre d’outils utilisera pour afficher les boutons qui sont dans leur état par défaut.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

*pImageList (en)*<br/>
Un pointeur `CImageList` vers un objet contenant les images à utiliser par le contrôle de la barre d’outils pour afficher des images de bouton dans leur état par défaut.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [CImageList](../../mfc/reference/cimagelist-class.md) qui a été précédemment utilisé par le contrôle de la barre d’outils pour afficher des images bouton dans leur état par défaut.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist), tel que décrit dans le SDK Windows.

La mise en `SetImageList` œuvre MFC utilise un `CImageList` objet contenant les images bouton du contrôle de la barre d’outils, plutôt qu’une poignée à une liste d’images.

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a>CToolBarCtrl::SetIndent

Définit l’indentation pour le premier bouton dans un contrôle de barre d’outils.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Paramètres

*iIndent (en)*<br/>
La valeur spécifiant l’indentation, en pixels.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a>CToolBarCtrl::SetInsertMark

Définit la marque d’insertion actuelle pour la barre d’outils.

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Paramètres

*ptbim ptbim*<br/>
Un pointeur à la structure [TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark) qui contient la marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CToolBarCtrl::SetInsertMarkColor

Définit la couleur utilisée pour dessiner la marque d’insertion pour la barre d’outils.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Paramètres

*clrNew*<br/>
Une valeur COLORREF qui contient la nouvelle couleur de marque d’insertion.

### <a name="return-value"></a>Valeur de retour

Une valeur COLORREF qui contient la couleur précédente de marque d’insertion.

### <a name="remarks"></a>Notes

Cette fonction de membre implémente le comportement du message Win32 [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor), tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a>CToolBarCtrl::SetMaxTextRows

Définit le nombre maximum de lignes de texte affichées sur un bouton de barre d’outils.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Paramètres

*iMaxRows (en)*<br/>
Nombre maximum de lignes à régler.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a>CToolBarCtrl::SetMetrics

Définit les mesures `CToolBarCtrl` de l’objet.

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Paramètres

*ptbm ptbm*<br/>
Un pointeur sur la structure `CToolBarCtrl` [TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics) de l’objet.

### <a name="remarks"></a>Notes

Cette fonction de membre imite la fonctionnalité du [message TB_SETMETRICS,](/windows/win32/Controls/tb-setmetrics) tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a>CToolBarCtrl::SetOwner

Définit la fenêtre du propriétaire pour le contrôle de la barre d’outils.

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Paramètres

*Pwnd*<br/>
Pointeur `CWnd` vers `CWnd`l’objet ou dérivé qui sera la nouvelle fenêtre propriétaire pour le contrôle de la barre d’outils.

### <a name="remarks"></a>Notes

La fenêtre du propriétaire est la fenêtre qui reçoit des notifications de la barre d’outils.

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a>CToolBarCtrl::SetPadding

Définit le rembourrage horizontal et vertical du contrôle actuel de la barre d’outils.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*nHorzPadding (en)*|[dans] Spécifie le rembourrage horizontal du contrôle de la barre d’outils, en pixels.|
|*nVertPadding (en)*|[dans] Spécifie le rembourrage vertical du contrôle de la barre d’outils, en pixels.|

### <a name="return-value"></a>Valeur de retour

Un DWORD dont le mot faible contient la valeur horizontale précédente de rembourrage, et dont le mot élevé contient la valeur verticale précédente de rembourrage. Les valeurs de rembourrage sont mesurées en pixels.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_SETPADDING,](/windows/win32/Controls/tb-setpadding) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit le rembourrage horizontal et vertical du contrôle actuel de la barre d’outils à 20 pixels.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a>CToolBarCtrl::SetPressedImageList

Définit la liste d’images que le contrôle actuel de la barre d’outils utilise pour représenter les boutons dans l’état pressé.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Paramètres

|Paramètre|Description|
|---------------|-----------------|
|*iImageID (en)*|[dans] L’index zéro de la liste d’images. Définissez ce paramètre à zéro si vous n’utilisez qu’une seule liste d’images.|
|*pImageList (en)*|[dans] Pointeur vers un [CImageList](../../mfc/reference/cimagelist-class.md) qui contient la nouvelle liste d’images.|

### <a name="return-value"></a>Valeur de retour

Pointeur vers une [liste D’images CImage qui](../../mfc/reference/cimagelist-class.md) contient la liste d’images précédente pour le contrôle actuel, ou NULL si aucune liste d’images de ce genre n’a été définie.

### <a name="remarks"></a>Notes

Cette méthode envoie le [message TB_SETPRESSEDIMAGELIST,](/windows/win32/Controls/tb-setpressedimagelist) qui est décrit dans le SDK Windows.

### <a name="example"></a>Exemple

L’exemple de code suivant définit la liste d’images pressée comme étant la même que la liste d’images par défaut.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a>CToolBarCtrl::SetRows

Demande au contrôle de la barre d’outils de se resize au nombre demandé de lignes.

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*nRows*<br/>
Nombre demandé de lignes.

*bLarger (en)*<br/>
Indique s’il faut utiliser plus de rangées ou moins de lignes si la barre d’outils ne peut pas être resized au nombre demandé de lignes.

*lpRect*<br/>
Points à l’objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou structure [RECT](/windows/win32/api/windef/ns-windef-rect) qui recevra le nouveau rectangle de délimitation de la barre d’outils.

### <a name="remarks"></a>Notes

Si la barre d’outils ne peut pas se resize au nombre demandé ou des lignes, elle se resize à la taille valide plus grande ou suivante plus petite, selon la valeur de *bLarger*. Si *bLarger* est VRAI, le nouveau nombre de lignes sera plus grand que le nombre demandé. Si *bLarger* est FALSE, le nouveau nombre de lignes sera plus petit que le nombre demandé.

Un certain nombre de lignes est valable pour la barre d’outils si les boutons peuvent être disposés de telle sorte que toutes les lignes ont le même nombre de boutons (sauf peut-être la dernière rangée). Par exemple, une barre d’outils contenant quatre boutons ne pouvait pas être dimensionnée à trois rangées parce que les deux dernières rangées devraient être plus courtes. Si vous avez essayé de le tailler à trois rangées, vous obtiendrez quatre rangées si *bLarger* était VRAI et deux rangées si *bLarger* était FALSE.

S’il y a des séparateurs dans la barre d’outils, les règles pour quand un nombre donné de lignes est valide sont plus compliquées. La mise en page est calculée de telle sorte que les groupes de boutons (boutons avec un séparateur avant le premier et le dernier bouton du groupe) ne sont jamais décomposés sur plusieurs lignes à moins que le groupe ne ne puisse pas s’adapter sur une ligne.

Si un groupe ne s’inscrit pas sur une rangée, le groupe suivant commencera sur la rangée suivante, même s’il s’inscrirait sur la rangée où le grand groupe s’est terminé. Le but de cette règle est de rendre la séparation entre les grands groupes plus perceptible. Les séparateurs verticaux qui en résultent sont comptés comme des rangées.

Notez également `SetRows` que la fonction membre choisira toujours la disposition qui se traduit par la plus petite taille de barre d’outils. La création d’une barre d’outils avec le style TBSTYLE_WRAPABLE, puis la resizing du contrôle sera tout simplement appliquer la méthode décrite ci-dessus compte tenu de la largeur du contrôle.

Cette fonction ne peut être appelée que pour les barres d’outils qui ont été créées avec le style TBSTYLE_WRAPABLE.

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a>CToolBarCtrl::SetState

Définit l’état pour le bouton spécifié dans un contrôle de barre d’outils.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Paramètres

*nID*<br/>
Identifiant de commande du bouton.

*nState (États-Unis)*<br/>
Drapeaux d’État. Il peut être une combinaison des valeurs énumérées pour les états de bouton dans [CToolBarCtrl:AddButtons](#addbuttons).

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; sinon, zéro.

### <a name="remarks"></a>Notes

Cette fonction est particulièrement pratique si vous voulez définir plus d’un des états de bouton. Pour juste définir un état, utilisez l’une des fonctions suivantes du membre: [EnableButton](#enablebutton), [CheckButton](#checkbutton), [HideButton](#hidebutton), [Indéterminé](#indeterminate), ou [PressButton](#pressbutton).

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a>CToolBarCtrl::SetStyle

Définit les styles pour un contrôle de barre d’outils.

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Paramètres

*dwStyle (en)*<br/>
Un DWORD contenant une combinaison de styles de contrôle de [barre d’outils,](/windows/win32/Controls/toolbar-control-and-button-styles)tel que décrit dans le SDK Windows.

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a>CToolBarCtrl::SetToolTips

Associe un contrôle de pointe d’outil avec un contrôle de barre d’outils.

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Paramètres

*pTip pTip*<br/>
Pointeur vers l’objet [CToolTipCtrl.](../../mfc/reference/ctooltipctrl-class.md)

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a>CToolBarCtrl::SetWindowTheme

Définit le style `CToolBarCtrl` visuel de l’objet.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Paramètres

*pszSubAppName*<br/>
Un pointeur à une chaîne Unicode qui contient le style visuel de la barre d’outils à définir.

### <a name="return-value"></a>Valeur de retour

La valeur de retour n’est pas utilisée.

### <a name="remarks"></a>Notes

Cette fonction de membre imite la fonctionnalité du [message TB_SETWINDOWTHEME,](/windows/win32/Controls/tb-setwindowtheme) tel que décrit dans le SDK Windows.

## <a name="see-also"></a>Voir aussi

[Échantillon MFC CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC, exemple MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CToolBar, classe](../../mfc/reference/ctoolbar-class.md)
