---
title: Classe COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: c880b1fb724b533bb049666460948c6df661a03c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376284"
---
# <a name="coleclientitem-class"></a>Classe COleClientItem

Définit l'interface du conteneur pour les éléments OLE.

## <a name="syntax"></a>Syntaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Construit un objet `COleClientItem`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[COleClientItem::Activer](#activate)|Ouvre l’élément OLE pour une opération, puis exécute le verbe spécifié.|
|[COleClientItem::ActivateAs](#activateas)|Active l’élément comme un autre type.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Accéde aux données de l’objet OLE.|
|[COleClientItem::CanCreateDeData](#cancreatefromdata)|Indique si une application de conteneur peut créer un objet intégré.|
|[COleClientItem::CanCreateLinkDeData](#cancreatelinkfromdata)|Indique si une application de conteneur peut créer un objet lié.|
|[COleClientItem::CanPaste](#canpaste)|Indique si le Clipboard contient un élément OLE intégré ou statique.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indique si le Clipboard contient un élément OLE liant.|
|[COleClientItem::Fermer](#close)|Ferme un lien vers un serveur mais ne détruit pas l’élément OLE.|
|[COleClientItem::ConvertTo](#convertto)|Convertit l’article en un autre type.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copie de l’article OLE au Clipboard.|
|[COleClientItem::CreateCloneDe](#createclonefrom)|Crée un double d’un élément existant.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crée un article intégré à partir du Clipboard.|
|[COleClientItem::CreateFromData](#createfromdata)|Crée un élément intégré à partir d’un objet de données.|
|[COleClientItem::CreateDeFile](#createfromfile)|Crée un élément intégré à partir d’un fichier.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crée un article lié à partir du Clipboard.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crée un élément lié à partir d’un objet de données.|
|[COleClientItem::CreateLinkDeFile](#createlinkfromfile)|Crée un élément lié à partir d’un fichier.|
|[COleClientItem::CreateNewItem](#createnewitem)|Crée un nouvel élément intégré en lançant l’application serveur.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crée un article statique à partir du Clipboard.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crée un élément statique à partir d’un objet de données.|
|[COleClientItem::Deactivate](#deactivate)|Désactive l’article.|
|[COleClientItem::DeactivateUI](#deactivateui)|Restaure l’interface utilisateur de l’application de conteneur à son état d’origine.|
|[COleClientItem::Delete](#delete)|Supprime ou ferme l’élément OLE s’il s’agit d’un élément lié.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Effectue une opération de drag-and-drop.|
|[COleClientItem::DoVerb](#doverb)|Exécute le verbe spécifié.|
|[COleClientItem::Draw](#draw)|Dessine l’article OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Obtient la vue sur laquelle l’élément est activé en place.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Retourne les limites du rectangle de l’élément OLE.|
|[COleClientItem::GetClassID](#getclassid)|Obtient l’ID de classe de l’article actuel.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtient les données qui seraient placées sur `CopyToClipboard` le Clipboard en appelant la fonction membre.|
|[COleClientItem::GetDocument](#getdocument)|Retourne `COleDocument` l’objet qui contient l’élément actuel.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtient la vue actuelle de l’élément pour le rendu.|
|[COleClientItem::GetExtent](#getextent)|Retourne les limites du rectangle de l’élément OLE.|
|[COleClientItem::GetIconDeregistry](#geticonfromregistry)|Récupère une poignée sur une icône associée au serveur d’un CLSID particulier.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtient le metafile utilisé pour dessiner l’icône de l’élément.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Retourne un pointeur à la fenêtre de montage en place de l’élément.|
|[COleClientItem::GetItemState](#getitemstate)|Obtient l’état actuel de l’article.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Retourne l’état de la dernière opération OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Retourne le mode de mise à jour d’un élément lié (fonctionnalité avancée).|
|[COleClientItem::GetType](#gettype)|Renvoie le type (intégré, lié ou statique) de l’article OLE.|
|[COleClientItem::GetUserType](#getusertype)|Obtient une chaîne décrivant le type de l’élément.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Retourne VRAI si l’article est actif sur place.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Retourne VRAI si un élément lié est à jour avec son document source.|
|[COleClientItem::IsModified](#ismodified)|Retourne VRAI si l’élément a été modifié depuis sa dernière économie.|
|[COleClientItem::IsOpen](#isopen)|Retourne TRUE si l’élément est actuellement ouvert dans l’application serveur.|
|[COleClientItem::IsRunning](#isrunning)|Retourne VRAI si l’application serveur de l’élément est en cours d’exécution.|
|[COleClientItem::OnActivate](#onactivate)|Appelé par le cadre pour informer l’élément qu’il est activé.|
|[COleClientItem::OnActivateUI](#onactivateui)|Appelé par le cadre pour informer l’élément qu’il est activé et doit afficher son interface utilisateur.|
|[COleClientItem::OnChange](#onchange)|Appelé lorsque le serveur modifie l’élément OLE. Mise en œuvre requise.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Appelé par le cadre lorsqu’un élément est désactivé.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Appelé par le cadre lorsque le serveur a supprimé son interface utilisateur en place.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Appelé par le cadre pour obtenir les données à copier au Clipboard.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Appelé par le cadre pour créer un menu composite.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Appelé par le cadre pour supprimer les menus du conteneur d’un menu composite.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Appelé par le cadre pour installer et supprimer un menu composite.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Appelé par le cadre pour montrer et cacher les barres de contrôle.|
|[COleClientItem::OnUpdateFrametitle](#onupdateframetitle)|Appelé par le cadre pour mettre à jour la barre de titre de la fenêtre de cadre.|
|[COleClientItem::RéactivateAndUndo](#reactivateandundo)|Réactive l’article et annule la dernière opération d’édition sur place.|
|[COleClientItem::Libération](#release)|Communiqués de connexion à un élément lié à l’OLE et le ferme s’il était ouvert. Ne détruit pas l’article du client.|
|[COleClientItem::Reload](#reload)|Recharger l’article après `ActivateAs`un appel à .|
|[COleClientItem::Run](#run)|Exécute l’application associée à l’élément.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Définit la vue actuelle de l’élément pour le rendu.|
|[COleClientItem::SetExtent](#setextent)|Définit le rectangle de délimitation de l’élément OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Définit les noms que le serveur affiche lors de l’édition de l’élément OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Cache le metafile utilisé pour dessiner l’icône de l’objet.|
|[COleClientItem::SetItemRects](#setitemrects)|Définit le rectangle de délimitation de l’élément.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Définit le mode de mise à jour d’un élément lié (fonctionnalité avancée).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Définit l’appareil d’impression cible pour cet article client.|
|[COleClientItem::UpdateLink](#updatelink)|Mise à jour du cache de présentation d’un élément.|

### <a name="protected-methods"></a>Méthodes protégées

|Nom|Description|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Appelé par le cadre pour déterminer si l’activation sur place est autorisée.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Appelé par le cadre lorsque la position d’un élément change.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Appelé par le cadre à annuler après l’activation.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Appelé par le cadre pour jeter les informations de l’état annuler de l’article.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Appelé par le cadre pour obtenir les coordonnées de l’élément clipping-rectangle.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Appelé par le cadre pour obtenir la position de l’élément par rapport à la vue.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Appelé par le cadre lorsqu’un élément est activé en place.|
|[COleClientItem::OnScrollBy](#onscrollby)|Appelé par le cadre pour faire défiler l’élément en vue.|
|[COleClientItem::OnShowItem](#onshowitem)|Appelé par le cadre pour afficher l’élément OLE.|

## <a name="remarks"></a>Notes

Un élément OLE représente les données, créées et maintenues par une application serveur, qui peuvent être incorporées « de manière transparente » dans un document de sorte qu’il semble à l’utilisateur qu’il s’agit d’un seul document. Le résultat est un « document composé » composé de l’élément OLE et d’un document contenant.

Un élément OLE peut être intégré ou lié. S’il est intégré, ses données sont stockées dans le cadre du document composé. S’il est lié, ses données sont stockées dans le cadre d’un fichier séparé créé par l’application serveur, et seul un lien vers ce fichier est stocké dans le document composé. Tous les éléments OLE contiennent des informations spécifiant l’application serveur qui doit être appelée pour les modifier.

`COleClientItem`définit plusieurs fonctions primordiales qui sont appelées en réponse aux demandes de l’application serveur; ces dépassements agissent généralement comme notifications. Cela permet à l’application serveur d’informer le conteneur des modifications apportées par l’utilisateur lors de l’édition de l’élément OLE, ou de récupérer les informations nécessaires lors de l’édition.

`COleClientItem`peut être utilisé avec la classe [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), ou [COleServerDoc.](../../mfc/reference/coleserverdoc-class.md) Pour `COleClientItem`utiliser , en tirer une classe et implémenter la fonction membre [OnChange,](#onchange) qui définit la façon dont le conteneur réagit aux modifications apportées à l’article. Pour soutenir l’activation sur place, remplacez la fonction membre [OnGetItemPosition.](#ongetitemposition) Cette fonction fournit des informations sur la position affichée de l’élément OLE.

Pour plus d’informations sur l’utilisation de l’interface conteneur, voir les articles [Conteneurs: Mise en œuvre d’un conteneur](../../mfc/containers-implementing-a-container.md) et [l’activation](../../mfc/activation-cpp.md).

> [!NOTE]
> Le SDK Windows désigne les éléments embarqués et liés comme des « objets » et désigne les types d’éléments comme des « classes ». Cette référence utilise le terme « élément » pour distinguer l’entité OLE de l’objet CMD correspondant et le terme « type » pour distinguer la catégorie OLE de la catégorie C.

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Spécifications

**En-tête:** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClientItem::Activer

Appelez cette fonction pour exécuter le verbe spécifié au lieu de [DoVerb](#doverb) afin que vous puissiez faire votre propre traitement quand une exception est lancée.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb (en)*<br/>
Spécifie le verbe à exécuter. Les valeurs possibles sont les suivantes :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|- 0|Primary (verbe)|OLEIVERB_PRIMARY|
|- 1|Verbe secondaire|(aucune)|
|- 1|Afficher l’élément pour l’édition|OLEIVERB_SHOW|
|- 2|Modifier l’élément dans une fenêtre séparée|OLEIVERB_OPEN|
|- 3|Masquer l’article|OLEIVERB_HIDE|

La valeur -1 est généralement un alias pour un autre verbe. Si l’édition ouverte n’est pas prise en charge, -2 a le même effet que -1. Pour plus de valeurs, voir [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

*pView (en)*<br/>
Pointeur vers la fenêtre de vue du conteneur qui contient l’élément OLE; ceci est utilisé par l’application serveur pour l’activation sur place. Ce paramètre doit être NULL si le conteneur ne prend pas en charge l’activation sur place.

*lpMsg*<br/>
Pointeur vers le message qui a causé l’activation de l’élément.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la Microsoft `COleServerItem` Foundation Class Library, cette fonction provoque l’exécution de la fonction membre [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) de l’objet correspondant.

Si le verbe principal est Edit et zéro est spécifié dans le paramètre *nVerb,* l’application serveur est lancée pour permettre la modification de l’élément OLE. Si l’application de conteneur prend en charge l’activation sur place, l’édition peut être effectuée en place. Si le conteneur ne prend pas en charge l’activation sur place (ou si le verbe Open est spécifié), le serveur est lancé dans une fenêtre séparée et l’édition peut être faite là-bas. Typiquement, lorsque l’utilisateur de l’application de conteneur double-clics l’élément OLE, la valeur pour le verbe principal dans le paramètre *nVerb* détermine quelle action l’utilisateur peut prendre. Toutefois, si le serveur ne prend en charge qu’une seule action, il prend cette mesure, quelle que soit la valeur spécifiée dans le paramètre *nVerb.*

Pour plus d’informations, voir [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClientItem::ActivateAs

Utilise les installations de conversion d’objets d’OLE pour activer l’article comme s’il s’agissait d’un élément du type spécifié par *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Paramètres

*lpszUserType*<br/>
Pointeur vers une chaîne représentant le type d’utilisateur cible, comme « Document de mot ».

*clsidOld*<br/>
Une référence à l’ID de classe actuel de l’élément. L’ID de classe doit représenter le type de l’objet réel, tel qu’il est stocké, à moins qu’il ne s’agit d’un lien. Dans ce cas, il devrait s’agir du CLSID de l’élément auquel le lien se réfère. Le [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fournit automatiquement l’ID de classe correct pour l’article.

*clsidNew*<br/>
Une référence à l’ID de classe cible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Ceci est appelé automatiquement par [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Il n’est généralement pas appelé directement.

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClientItem::AttachDataObject

Appelez cette fonction pour initialiser un [COleDataObject](../../mfc/reference/coledataobject-class.md) pour accéder aux données de l’élément OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Paramètres

*rDataObject*<br/>
Référence à `COleDataObject` un objet qui sera paradé pour permettre l’accès aux données dans l’élément OLE.

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClientItem::CanActivate

Appelé par le cadre lorsque l’utilisateur demande l’activation sur place de l’élément OLE; la valeur de retour de cette fonction détermine si l’activation sur place est autorisée.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’activation sur place est autorisée; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut permet l’activation sur place si le conteneur dispose d’une fenêtre valide. Remplacer cette fonction pour implémenter une logique particulière pour accepter ou refuser la demande d’activation. Par exemple, une demande d’activation peut être refusée si l’article OLE est trop petit ou n’est pas actuellement visible.

Pour plus d’informations, voir [IOleInPlaceSite:CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) in the Windows SDK.

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClientItem::CanCreateDeData

Vérifie si une application de conteneur peut `COleDataObject` créer un objet intégré à partir de l’objet donné.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

### <a name="return-value"></a>Valeur de retour

Nonzero si le conteneur peut créer `COleDataObject` un objet intégré à partir de l’objet; sinon 0.

### <a name="remarks"></a>Notes

La `COleDataObject` classe est utilisée dans les transferts de données pour la récupération de données dans divers formats à partir du Clipboard, par la traînée et la baisse, ou à partir d’un élément OLE intégré.

Les conteneurs peuvent utiliser cette fonction pour décider d’activer ou de désactiver leurs commandes spéciales Edit Paste et Edit Paste.

Pour plus d’informations, consultez l’article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClientItem::CanCreateLinkDeData

Vérifie si une application de conteneur peut `COleDataObject` créer un objet lié à partir de l’objet donné.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

### <a name="return-value"></a>Valeur de retour

Nonzero si le conteneur peut créer `COleDataObject` un objet lié à partir de l’objet.

### <a name="remarks"></a>Notes

La `COleDataObject` classe est utilisée dans les transferts de données pour la récupération de données dans divers formats à partir du Clipboard, par la traînée et la baisse, ou à partir d’un élément OLE intégré.

Les conteneurs peuvent utiliser cette fonction pour décider d’activer ou de désactiver leurs commandes Edit Paste Special et Edit Paste Link.

Pour plus d’informations, consultez l’article [Data Objects and Data Sources (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClientItem::CanPaste

Appelez cette fonction pour voir si un élément OLE intégré peut être collé à partir du Clipboard.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si un élément OLE intégré peut être collé à partir du Clipboard; sinon 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) et [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) dans le Windows SDK.

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClientItem::CanPasteLink

Appelez cette fonction pour voir si un élément OLE lié peut être collé à partir du Clipboard.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si un élément OLE lié peut être collé à partir du Clipboard; sinon 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) et [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) dans le Windows SDK.

## <a name="coleclientitemclose"></a><a name="close"></a>COleClientItem::Fermer

Appelez cette fonction pour changer l’état d’un élément OLE de l’état de fonctionnement à l’état chargé, c’est-à-dire, chargé avec son gestionnaire dans la mémoire, mais avec le serveur ne fonctionne pas.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Paramètres

*dwCloseOption*<br/>
Indicateur spécifiant dans quelles circonstances l’élément OLE est enregistré lorsqu’il retourne à l’état chargé. Elle peut avoir l’une des valeurs suivantes :

- OLECLOSE_SAVEIFDIRTY Enregistrer l’article OLE.

- OLECLOSE_NOSAVE Ne pas enregistrer l’article OLE.

- OLECLOSE_PROMPTSAVE invitez l’utilisateur à enregistrer ou non l’élément OLE.

### <a name="remarks"></a>Notes

Cette fonction n’a aucun effet lorsque l’élément OLE n’est pas en cours d’exécution.

Pour plus d’informations, voir [IOleObject:Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) in the Windows SDK.

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClientItem::COleClientItem

Construit un `COleClientItem` objet et l’ajoute à la collection d’éléments de document du document du document, qui ne construit que l’objet CMD et n’effectue aucune initialisation OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Paramètres

*pContainerDoc*<br/>
Pointeur vers le document de conteneur qui contiendra cet article. Il peut s’agir de n’importe quel dérivé [COleDocument.](../../mfc/reference/coledocument-class.md)

### <a name="remarks"></a>Notes

Si vous passez un pointeur NULL, aucun ajout n’est fait au document de conteneur. Vous devez appeler explicitement [COleDocument:AddItem](../../mfc/reference/coledocument-class.md#additem).

Vous devez appeler l’une des fonctions suivantes des membres de la création avant d’utiliser l’élément OLE :

- [CréerDeClipboard](#createfromclipboard)

- [CreateDeData](#createfromdata)

- [CréerDeFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkDeClipboard](#createlinkfromclipboard)

- [CréerLinkFromData](#createlinkfromdata)

- [CréerLinkDeFile](#createlinkfromfile)

- [CréerNewItem](#createnewitem)

- [CreateCloneDe](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClientItem::ConvertTo

Appelez cette fonction de membre pour convertir l’élément au type spécifié par *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Paramètres

*clsidNew*<br/>
L’ID de classe du type cible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Ceci est appelé automatiquement par [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Il n’est pas nécessaire de l’appeler directement.

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClientItem::CopyToClipboard

Appelez cette fonction pour copier l’article OLE au Clipboard.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Paramètres

*bIncludeLink*<br/>
VRAI si les informations de lien doivent être copiées au Clipboard, permettant à un élément lié d’être collé; autrement FALSE.

### <a name="remarks"></a>Notes

En règle générale, vous appelez cette fonction lors de l’écriture de gestionnaires de messages pour les commandes Copy ou Cut à partir du menu Modifier. Vous devez implémenter la sélection d’éléments dans votre application de conteneur si vous souhaitez implémenter les commandes Copy ou Cut.

Pour plus d’informations, voir [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) dans le Windows SDK.

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClientItem::CreateCloneDe

Appelez cette fonction pour créer une copie de l’élément OLE spécifié.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Paramètres

*pSrcItem (en)*<br/>
Pointeur vers l’élément OLE à dupliquer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La copie est identique à l’élément source. Vous pouvez utiliser cette fonction pour prendre en charge les opérations de défaire.

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClientItem::CreateFromClipboard

Appelez cette fonction pour créer un élément intégré à partir du contenu du Clipboard.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Vous appelez généralement cette fonction à partir du gestionnaire de message pour la commande Pâte sur le menu Edit. (La commande de pâte est activée par le cadre si la fonction membre [de CanPaste](#canpaste) renvoie nonzero.)

Pour plus d’informations, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClientItem::CreateFromData

Appelez cette fonction pour créer `COleDataObject` un élément intégré à partir d’un objet.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Les opérations de transfert de données, telles que le coller `COleDataObject` à partir des opérations Clipboard ou drag-and-drop, fournissent des objets contenant les informations offertes par une application serveur. Il est généralement utilisé dans votre remplacement de [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Pour plus d’informations, voir [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClientItem::CreateDeFile

Appelez cette fonction pour créer un élément OLE intégré à partir d’un fichier.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*lpszFileName*<br/>
Pointeur sur le nom du fichier à partir duquel l’élément OLE doit être créé.

*clsid*<br/>
Réservé pour un usage futur.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette fonction de [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si l’utilisateur choisit OK à partir de la boîte de dialogue Insert Object lorsque le bouton Créer à partir du bouton Fichier est sélectionné.

Pour plus d’informations, voir [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClientItem::CreateLinkFromClipboard

Appelez cette fonction pour créer un élément lié à partir du contenu du Clipboard.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Vous appelez généralement cette fonction à partir du gestionnaire de message pour la commande Paste Link sur le menu Edit. (La commande Paste Link est activée dans la mise en œuvre par défaut de [COleDocument](../../mfc/reference/coledocument-class.md) si le Clipboard contient un élément OLE qui peut être lié à.)

Pour plus d’informations, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClientItem::CreateLinkFromData

Appelez cette fonction pour créer `COleDataObject` un élément lié à partir d’un objet.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez ceci pendant une opération de chute lorsque l’utilisateur indique qu’un lien doit être créé. Il peut également être utilisé pour gérer la commande Edit Paste. Il est appelé par `COleClientItem::CreateLinkFromClipboard` le cadre dans et dans [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) lorsque l’option Link a été sélectionnée.

Pour plus d’informations, voir [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClientItem::CreateLinkDeFile

Appelez cette fonction pour créer un élément OLE lié à partir d’un fichier.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*lpszFileName*<br/>
Pointeur sur le nom du fichier à partir duquel l’élément OLE doit être créé.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette fonction si l’utilisateur choisit OK à partir de la boîte de dialogue Insert Object lorsque le bouton Créer à partir du bouton Fichier est sélectionné et que la case à cocher Link est cochée. Il est appelé de [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Pour plus d’informations, voir [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClientItem::CreateNewItem

Appelez cette fonction pour créer un élément intégré; cette fonction lance l’application serveur qui permet à l’utilisateur de créer l’élément OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*clsid*<br/>
ID qui identifie uniquement le type d’élément OLE à créer.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Le cadre appelle cette fonction si l’utilisateur choisit OK à partir de la boîte de dialogue Insert Object lorsque le bouton Créer un nouveau bouton est sélectionné.

Pour plus d’informations, voir [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClientItem::CreateStaticFromClipboard

Appelez cette fonction pour créer un élément statique à partir du contenu du Clipboard.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Un élément statique contient les données de présentation, mais pas les données natives; par conséquent, il ne peut pas être modifié. Vous appelez généralement cette fonction si la fonction membre [CreateFromClipboard](#createfromclipboard) échoue.

Pour plus d’informations, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClientItem::CreateStaticFromData

Appelez cette fonction pour créer `COleDataObject` un élément statique à partir d’un objet.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*Rendre*<br/>
Indicateur spécifiant comment le serveur rendra l’élément OLE. Pour les valeurs possibles, voir [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données Clipboard à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *le rendu* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournir une valeur pour ce paramètre que si vous souhaitez spécifier des informations de format supplémentaires au-delà du format Clipboard spécifié par *cfFormat*. Si vous ometez ce paramètre, les valeurs `FORMATETC` par défaut sont utilisées pour les autres champs de la structure.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Un élément statique contient les données de présentation, mais pas les données natives; par conséquent, il ne peut pas être modifié. C’est essentiellement le même que [CreateStaticFromClipboard,](#createstaticfromclipboard) sauf qu’un élément statique peut être créé à partir d’un arbitraire `COleDataObject`, pas seulement à partir du Clipboard.

Utilisé dans [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) lorsque Static est sélectionné.

Pour plus d’informations, voir [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender), et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClientItem::Deactivate

Appelez cette fonction pour désactiver l’article OLE et libérer toutes les ressources associées.

```
void Deactivate();
```

### <a name="remarks"></a>Notes

Vous désactivez généralement un élément OLE actif sur place lorsque l’utilisateur clique sur la souris sur la zone client en dehors des limites de l’élément. Notez que la désactivation de l’article OLE jettera son état de défaire, ce qui rend impossible d’appeler la fonction membre [ReactivateAndUndo.](#reactivateandundo)

Si votre demande prend en `Deactivate`charge l’annulation, n’appelez pas ; au lieu de cela, appelez [DeactivateUI](#deactivateui).

Pour plus d’informations, voir [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) in the Windows SDK.

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClientItem::DeactivateUI

Appelez cette fonction lorsque l’utilisateur désactive un élément activé en place.

```
void DeactivateUI();
```

### <a name="remarks"></a>Notes

Cette fonction restaure l’interface utilisateur de l’application de conteneur à son état d’origine, cachant tous les menus et autres contrôles qui ont été créés pour l’activation en place.

Cette fonction ne chasse pas les informations d’état annuler pour l’article. Ces informations sont conservées de sorte que [ReactivateAndUndo](#reactivateandundo) peut plus tard être utilisé pour exécuter une commande annuler dans l’application du serveur, au cas où la commande de défaire du conteneur est choisie immédiatement après avoir désactivé l’élément.

Pour plus d’informations, voir [IOleInPlaceObject::InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) in the Windows SDK.

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClientItem::Delete

Appelez cette fonction pour supprimer l’élément OLE du document de conteneur.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Paramètres

*bAutoDelete*<br/>
Précise si l’élément doit être retiré du document.

### <a name="remarks"></a>Notes

Cette fonction appelle la fonction membre [De libération,](#release) qui supprime à son tour l’objet C POUR l’élément, en supprimant définitivement l’élément OLE du document. Si l’élément OLE est intégré, les données natives de l’élément sont supprimées. Il ferme toujours un serveur en cours d’exécution; par conséquent, si l’élément est un lien ouvert, cette fonction le ferme.

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClientItem::DoDragDrop

Appelez `DoDragDrop` la fonction membre pour effectuer une opération de drag-and-drop.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Paramètres

*lpItemRect*<br/>
Rectangle de l’élément à l’écran dans les coordonnées des clients (pixels).

*ptOffset (en anglais)*<br/>
Le décalage de *lpItemRect* où la position de la souris était au moment de la traînée.

*bIncludeLink*<br/>
Définissez ceci à TRUE si les données de lien doivent être copiées sur le Clipboard. Définissez-le à FALSE si votre application serveur ne prend pas en charge les liens.

*dwEffects dwEffects*<br/>
Détermine les effets que la source de traînée permettra dans le fonctionnement de la traînée.

*lpRectStartDrag*<br/>
Pointeur vers le rectangle qui définit où la traînée commence réellement. Pour plus d'informations, consultez la section Notes qui suit.

### <a name="return-value"></a>Valeur de retour

Une valeur DROPEFFECT. S’il est DROPEFFECT_MOVE, les données d’origine doivent être supprimées.

### <a name="remarks"></a>Notes

L’opération de drag-and-drop ne démarre pas immédiatement. Il attend que le curseur de souris quitte le rectangle spécifié par *lpRectStartDrag* ou jusqu’à ce qu’un nombre spécifié de millisecondes soient passés. Si *lpRectStartDrag* est NULL, la taille du rectangle est d’un pixel.

Le délai est spécifié par un paramètre de clé de registre. Vous pouvez modifier le délai en appelant [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) ou [CWinApp:WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Si vous ne spécifiez pas le délai, une valeur par défaut de 200 millisecondes est utilisée. Le temps de retard de traînée est stocké comme suit :

- Windows NT Drag delay time est stocké dans HKEY_LOCAL_MACHINE-SOFTWARE-Microsoft-Windows-NT-CurrentVersion-IniFileMapping.win.ini-Windows-DragDelay.

- Windows 3.x Le délai de drag est stocké dans le WIN. Fichier INI, sous la section [Windows».

- Windows 95/98 Le délai de drag est stocké dans une version mise en cache de WIN. Ini.

Pour plus d’informations sur la façon dont les informations sur les retards de traînée sont stockées dans le registre ou le . Fichier INI, voir [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) in the Windows SDK.

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClientItem::DoVerb

Appelez `DoVerb` pour exécuter le verbe spécifié.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb (en)*<br/>
Spécifie le verbe à exécuter. Il peut inclure l’un des éléments suivants :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|- 0|Primary (verbe)|OLEIVERB_PRIMARY|
|- 1|Verbe secondaire|(aucune)|
|- 1|Afficher l’élément pour l’édition|OLEIVERB_SHOW|
|- 2|Modifier l’élément dans une fenêtre séparée|OLEIVERB_OPEN|
|- 3|Masquer l’article|OLEIVERB_HIDE|

La valeur -1 est généralement un alias pour un autre verbe. Si l’édition ouverte n’est pas prise en charge, -2 a le même effet que -1. Pour plus de valeurs, voir [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

*pView (en)*<br/>
Pointeur vers la fenêtre de vue; ceci est utilisé par le serveur pour l’activation sur place. Ce paramètre doit être NULL si l’application de conteneur ne permet pas l’activation sur place.

*lpMsg*<br/>
Pointeur vers le message qui a causé l’activation de l’élément.

### <a name="return-value"></a>Valeur de retour

Nonzero si le verbe a été exécuté avec succès; sinon 0.

### <a name="remarks"></a>Notes

Cette fonction appelle la fonction [active du](#activate) membre pour exécuter le verbe. Il saisit également les exceptions et affiche une boîte de message à l’utilisateur si l’on est jeté.

Si le verbe principal est Edit et zéro est spécifié dans le paramètre *nVerb,* l’application serveur est lancée pour permettre la modification de l’élément OLE. Si l’application de conteneur prend en charge l’activation sur place, l’édition peut être effectuée en place. Si le conteneur ne prend pas en charge l’activation sur place (ou si le verbe Open est spécifié), le serveur est lancé dans une fenêtre séparée et l’édition peut être faite là-bas. Typiquement, lorsque l’utilisateur de l’application de conteneur double-clics l’élément OLE, la valeur pour le verbe principal dans le paramètre *nVerb* détermine quelle action l’utilisateur peut prendre. Toutefois, si le serveur ne prend en charge qu’une seule action, il prend cette mesure, quelle que soit la valeur spécifiée dans le paramètre *nVerb.*

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClientItem::Draw

Appelez cette fonction pour dessiner l’élément OL DANS le rectangle de délimitation spécifié à l’aide du contexte spécifié de l’appareil.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers un objet [CDC](../../mfc/reference/cdc-class.md) utilisé pour dessiner l’élément OLE.

*lpBounds (lpBounds)*<br/>
Pointeur vers un objet `RECT` ou une structure [CRect](../../atl-mfc-shared/reference/crect-class.md) qui définit le rectangle de délimitation dans lequel dessiner l’élément OLE (dans les unités logiques déterminées par le contexte de l’appareil).

*nDrawAspect (en anglais seulement)*<br/>
Spécifie l’aspect de l’article OLE, c’est-à-dire comment il doit être affiché. Si *nDrawAspect* est de -1, le dernier aspect défini par l’utilisation [de SetDrawAspect](#setdrawaspect) est utilisé. Pour plus d’informations sur les valeurs possibles pour ce drapeau, voir [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction peut utiliser la représentation métaafile de l’élément OLE créé par la fonction membre [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) de `COleServerItem`.

Typiquement, `Draw` vous utilisez pour l’affichage de l’écran, en passant le contexte de l’appareil d’écran comme *pDC*. Dans ce cas, vous n’avez besoin que de spécifier les deux premiers paramètres.

Le *paramètre lpBounds* identifie le rectangle dans le contexte de l’appareil cible (par rapport à son mode de cartographie actuel). Le rendu peut impliquer la mise à l’échelle de l’image et peut être utilisé par les applications de conteneurs pour imposer une vue qui s’balance entre la vue affichée et l’image imprimée finale.

Pour plus d’informations, voir [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) dans le SDK Windows.

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClientItem::GetActiveView

Retourne la vue sur laquelle l’élément est activé sur place.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur à la vue; autrement NULL si l’élément n’est pas activé sur place.

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClientItem::GetCachedExtent

Appelez cette fonction pour récupérer la taille de l’élément OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Paramètres

*lpSize*<br/>
Pointeur `SIZE` vers une structure ou un objet [CSize](../../atl-mfc-shared/reference/csize-class.md) qui recevra les informations de taille.

*nDrawAspect (en anglais seulement)*<br/>
Spécifie l’aspect de l’article OLE dont les limites doivent être récupérées. Pour les valeurs possibles, voir [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; 0 si l’article OLE est vide.

### <a name="remarks"></a>Notes

Cette fonction fournit les mêmes informations que [GetExtent](#getextent). Cependant, vous `GetCachedExtent` pouvez appeler pour obtenir des informations d’étendue pendant le traitement d’autres gestionnaires OLE, tels que [OnChange](#onchange). Les dimensions sont dans MM_HIMETRIC unités.

Cela est `GetCachedExtent` possible parce que utilise l’interface [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) plutôt que d’utiliser l’interface [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) pour obtenir l’étendue de cet élément. L’objet `IViewObject2` COM cache l’étendue des informations utilisées dans l’appel précédent à [IViewObject::Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Pour plus d’informations, voir [IViewObject2:GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) in the Windows SDK.

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClientItem::GetClassID

Retourne l’ID de classe de l’élément dans la mémoire pointée par *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Paramètres

*pClassID (en)*<br/>
Pointeur vers un identifiant de type [CLSID](/windows/win32/com/clsid-key-hklm) pour récupérer l’ID de classe. Pour plus d’informations sur CLSID, consultez windows SDK.

### <a name="remarks"></a>Notes

L’ID de classe est un numéro de 128 bits qui identifie uniquement l’application qui modifie l’élément.

Pour plus d’informations, voir [IPersist:GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) dans le SDK Windows.

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClientItem::GetClipboardData

Appelez cette fonction `COleDataSource` pour obtenir un objet contenant toutes les données qui seraient placées sur le Clipboard par un appel à la fonction membre [CopyToClipboard.](#copytoclipboard)

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataSource (en)*<br/>
Pointeur vers un objet [COleDataSource](../../mfc/reference/coledatasource-class.md) qui recevra les données contenues dans l’élément OLE.

*bIncludeLink*<br/>
VRAI si les données de lien doivent être incluses; autrement FALSE.

*lpOffset (en anglais)*<br/>
Le décalage du curseur de souris de l’origine de l’objet en pixels.

*lpSize*<br/>
La taille de l’objet en pixels.

### <a name="remarks"></a>Notes

`GetClipboardData`est appelé comme la mise en œuvre par défaut de [OnGetClipboardData](#ongetclipboarddata). Remplacer `OnGetClipboardData` uniquement si vous souhaitez offrir des formats `CopyToClipboard`de données en plus de ceux offerts par . Placez `COleDataSource` ces formats dans l’objet avant ou après l’appel, `CopyToClipboard`puis passez l’objet `COleDataSource` à la [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) fonction. Par exemple, si vous voulez que la position de l’élément OLE dans son document de conteneurs l’accompagne `COleDataSource` sur `CopyToClipboard`le Clipboard, vous définiriez votre propre format pour transmettre cette information et la placeriez dans l’appel avant d’appeler.

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClientItem::GetDocument

Appelez cette fonction pour obtenir un pointeur sur le document qui contient l’élément OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valeur de retour

Un pointeur sur le document qui contient l’élément OLE. NULL si l’élément ne fait pas partie d’un document.

### <a name="remarks"></a>Notes

Ce pointeur permet `COleDocument` l’accès à l’objet que vous avez passé comme argument au `COleClientItem` constructeur.

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClientItem::GetDrawAspect

Appelez `GetDrawAspect` la fonction du membre pour déterminer l’aspect actuel ou la vue de l’élément.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur de l’énumération DVASPECT, dont les valeurs sont énumérées dans la référence pour [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Notes

L’aspect précise comment l’élément doit être rendu.

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClientItem::GetExtent

Appelez cette fonction pour récupérer la taille de l’élément OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Paramètres

*lpSize*<br/>
Pointeur `SIZE` vers une `CSize` structure ou un objet qui recevra les informations de taille.

*nDrawAspect (en anglais seulement)*<br/>
Spécifie l’aspect de l’article OLE dont les limites doivent être récupérées. Pour les valeurs possibles, voir [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; 0 si l’article OLE est vide.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la Microsoft `COleServerItem` Foundation Class Library, cette fonction provoque l’appel de la fonction membre [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) de l’objet correspondant. Notez que la taille récupérée peut différer de la taille dernière définie par la fonction [membre SetExtent;](#setextent) la taille `SetExtent` spécifiée par est traitée comme une suggestion. Les dimensions sont dans MM_HIMETRIC unités.

> [!NOTE]
> N’appelez `GetExtent` pas pendant le traitement d’un gestionnaire OLE, tel que [OnChange](#onchange). Appelez [GetCachedExtent à](#getcachedextent) la place.

Pour plus d’informations, voir [IOleObject:GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) in the Windows SDK.

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClientItem::GetIconDeregistry

Appelez cette fonction de membre pour récupérer une poignée à une ressource d’icône associée au serveur d’un CLSID particulier.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Paramètres

*clsid*<br/>
Une référence au CLSID pour le serveur associé à l’icône.

### <a name="return-value"></a>Valeur de retour

Une poignée valide à la ressource d’icône, ou NULL si l’icône du serveur, ou une icône par défaut, ne peut pas être trouvée.

### <a name="remarks"></a>Notes

Cette fonction de membre ne démarre pas le serveur ou n’obtiendra pas une icône dynamiquement, même si le serveur est déjà en cours d’exécution. Au lieu de cela, cette fonction membre ouvre l’image exécutable du serveur et récupère l’icône statique associée au serveur au fur et à mesure qu’elle était enregistrée.

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClientItem::GetIconicMetafile

Récupère le metafile utilisé pour dessiner l’icône de l’élément.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valeur de retour

Une poignée au metafile en cas de succès; autrement NULL.

### <a name="remarks"></a>Notes

S’il n’y a pas d’icône actuelle, une icône par défaut est retournée. Ceci est appelé automatiquement par les dialogues MFC/OLE et n’est généralement pas appelé directement.

Cette fonction appelle également [SetIconicMetafile](#seticonicmetafile) pour mettre en cache le metafile pour une utilisation ultérieure.

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClientItem::GetInPlaceWindow

Appelez `GetInPlaceWindow` la fonction membre pour obtenir un pointeur à la fenêtre dans laquelle l’élément a été ouvert pour l’édition en place.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valeur de retour

Un pointeur de la fenêtre de montage en place de l’élément; NULL si l’élément n’est pas actif ou si son serveur n’est pas disponible.

### <a name="remarks"></a>Notes

Cette fonction ne doit être appelée que pour les articles qui sont actifs sur place.

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClientItem::GetItemState

Appelez cette fonction pour obtenir l’état actuel de l’élément OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valeur de retour

Une `COleClientItem::ItemState` valeur énumérée, qui peut être `emptyState`l’une des suivantes: `loadedState`, , `openState`, `activeState`, `activeUIState`. Pour plus d’informations sur ces états, voir l’article [Containers: Client-Item States](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Notes

Pour être informé lorsque l’état de l’élément OLE change, utilisez la fonction membre [OnChange.](#onchange)

Pour plus d’informations, voir l’article [Containers: Client-Item States](../../mfc/containers-client-item-states.md).

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClientItem::GetLastStatus

Retourne le code d’état de la dernière opération OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valeur de retour

Une valeur SCODE.

### <a name="remarks"></a>Notes

Pour les fonctions membres qui retournent une valeur BOOL de `GetLastStatus` FALSE, ou d’autres fonctions membres qui retournent NULL, renvoie des informations plus détaillées sur l’échec. Soyez conscient que la plupart des fonctions des membres OLE jettent des exceptions pour des erreurs plus graves. Les informations spécifiques sur l’interprétation du SCODE dépendent de l’appel sous-jacent OLE qui a retourné pour la dernière fois une valeur SCODE.

Pour plus d’informations sur SCODE, voir [Structure of COM Error Codes](/windows/win32/com/structure-of-com-error-codes) dans la documentation Windows SDK.

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClientItem::GetLinkUpdateOptions

Appelez cette fonction pour obtenir la valeur actuelle de l’option de mise à jour de lien pour l’élément OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valeur de retour

L’une des valeurs suivantes :

- OLEUPDATE_ALWAYS Mettre à jour l’élément lié dans la mesure du possible. Cette option prend en charge le bouton radio automatique de mise à jour de lien dans la boîte de dialogue Links.

- OLEUPDATE_ONCALL Mettre à jour l’élément lié uniquement sur demande de l’application de conteneur (lorsque la fonction de membre [UpdateLink](#updatelink) est appelée). Cette option prend en charge le bouton radio de mise à jour manuelle du lien dans la boîte de dialogue Links.

### <a name="remarks"></a>Notes

C’est une opéra tion avancée.

Cette fonction est appelée automatiquement par la classe [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Pour plus d’informations, voir [IOleLink:GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) in the Windows SDK.

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClientItem::GetType

Appelez cette fonction pour déterminer si l’élément OL est intégré ou lié, ou statique.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valeur de retour

Un insignable avec l’une des valeurs suivantes :

- OT_LINK L’article OLE est un lien.

- OT_EMBEDDED L’article OLE est intégré.

- OT_STATIC L’élément OLE est statique, c’est-à-dire qu’il ne contient que des données de présentation, et non des données natives, et ne peut donc pas être modifié.

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClientItem::GetUserType

Appelez cette fonction pour obtenir la chaîne visible de l’utilisateur décrivant le type de l’élément OLE, tel que « document de mot ».

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Paramètres

*nUserClassType*<br/>
Une valeur indiquant la variante désirée de la chaîne décrivant le type de l’élément OLE. Cela peut avoir l’une des valeurs suivantes :

- USERCLASSTYPE_FULL Le nom de type complet affiché à l’utilisateur.

- USERCLASSTYPE_SHORT Un nom court (15 caractères maximum) pour une utilisation dans les menus pop-up et la boîte de dialogue Edit Links.

- USERCLASSTYPE_APPNAME Nom de l’application desservant la classe.

*rString (en)*<br/>
Une référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) auquel la chaîne décrivant le type de l’élément OLE doit être retournée.

### <a name="remarks"></a>Notes

C’est souvent l’entrée dans la base de données d’enregistrement du système.

Si le nom de type complet est demandé mais non disponible, le nom court est utilisé à la place. Si aucune entrée pour le type d’élément OL n’est trouvée dans la base de données d’enregistrement, ou s’il n’y a pas de type d’utilisateur enregistré pour le type d’article OLE, alors le type d’utilisateur actuellement stocké dans l’article OLE est utilisé. Si ce nom de type utilisateur est une chaîne vide, "Objet inconnu" est utilisé.

Pour plus d’informations, voir [IOleObject:GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) dans le Windows SDK.

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClientItem::IsInPlaceActive

Appelez cette fonction pour voir si l’élément OLE est actif sur place.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’article OLE est actif en place; sinon 0.

### <a name="remarks"></a>Notes

Il est courant d’exécuter une logique différente selon que l’élément est en cours d’élaboration. La fonction vérifie si l’état actuel `activeState` de `activeUIState`l’élément est égal à l’ou le .

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClientItem::IsLinkUpToDate

Appelez cette fonction pour voir si l’élément OLE est à jour.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’article OLE est à jour; sinon 0.

### <a name="remarks"></a>Notes

Un élément lié peut être périmé si son document source a été mis à jour. Un élément intégré qui contient des liens à son intérieur peut également devenir obsolète. La fonction effectue une vérification récursive de l’article OLE. Notez que déterminer si un article OLE est obsolète peut être aussi coûteux que d’effectuer réellement une mise à jour.

Ceci est appelé automatiquement par la mise en œuvre [COleLinksDialog.](../../mfc/reference/colelinksdialog-class.md)

Pour plus d’informations, voir [IOleObject:IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) dans le SDK Windows.

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClientItem::IsModified

Appelez cette fonction pour voir si l’article OLE est sale (modifié depuis qu’il a été enregistré pour la dernière fois).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’article OLE est sale; sinon 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [IPersistStorage::IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) in the Windows SDK.

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClientItem::IsOpen

Appelez cette fonction pour voir si l’article OLE est ouvert; c’est-à-dire ouvert dans un cas de l’application serveur en cours d’exécution dans une fenêtre séparée.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’article OLE est ouvert; sinon 0.

### <a name="remarks"></a>Notes

Il est utilisé pour déterminer quand dessiner l’objet avec un modèle d’éclosion. Un objet ouvert doit avoir un motif d’écoutille dessiné sur le dessus de l’objet. Vous pouvez utiliser un objet [CRectTracker](../../mfc/reference/crecttracker-class.md) pour y parvenir.

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClientItem::IsRunning

Appelez cette fonction pour voir si l’élément OLE est en cours d’exécution; c’est-à-dire si l’élément est chargé et en cours d’exécution dans l’application serveur.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’article OLE est en cours d’exécution; sinon 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) dans le SDK Windows.

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClientItem::OnActivate

Appelé par le cadre pour informer l’élément qu’il vient d’être activé en place.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Notes

Notez que cette fonction est appelée pour indiquer que le serveur est en marche, pour ne pas indiquer que son interface utilisateur a été installé dans l’application de conteneur. À ce stade, l’objet n’a pas `activeUIState`d’interface utilisateur active (n’est pas ). Il n’a pas installé ses menus ou sa barre d’outils. La fonction membre [OnActivateUI](#onactivateui) est appelée lorsque cela se produit.

La implémentation par défaut appelle la fonction membre [OnChange](#onchange) avec OLE_CHANGEDSTATE comme paramètre. Remplacer cette fonction pour effectuer un traitement personnalisé lorsqu’un élément devient actif.

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClientItem::OnActivateUI

Le cadre `OnActivateUI` appelle lorsque l’objet est entré dans l’état actif de l’interface utilisateur.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Notes

L’objet a maintenant installé sa barre d’outils et ses menus.

L’implémentation par défaut rappelle HWND du serveur pour les appels ultérieurs. `GetServerWindow`

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClientItem::OnChange

Appelé par le cadre lorsque l’utilisateur modifie, enregistre ou ferme l’élément OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Paramètres

*nCode (en)*<br/>
La raison pour laquelle le serveur a changé cet élément. Elle peut avoir l’une des valeurs suivantes :

- OLE_CHANGED L’apparence de l’article OLE a changé.

- OLE_SAVED L’article OLE a été enregistré.

- OLE_CLOSED L’article OLE a été fermé.

- OLE_CHANGED_STATE L’article OLE a changé d’un état à l’autre.

*dwParam dwParam*<br/>
Si *le nCode* est OLE_SAVED ou OLE_CLOSED, ce paramètre n’est pas utilisé. Si *le nCode* est OLE_CHANGED, ce paramètre spécifie l’aspect de l’élément OLE qui a changé. Pour les valeurs possibles, voir le paramètre *dwParam* de [COleClientItem::Draw](#draw). Si *le nCode* est OLE_CHANGED_STATE, ce `COleClientItem::ItemState` paramètre est une valeur énumérée et décrit l’état entré. Il peut avoir l’une `emptyState` `loadedState`des `openState` `activeState`valeurs `activeUIState`suivantes: , , , , ou .

### <a name="remarks"></a>Notes

(Si l’application serveur est écrite à l’aide de la `Notify` Microsoft Foundation `COleServerDoc` `COleServerItem`Class Library, cette fonction est appelée en réponse aux fonctions des membres de ou .) La mise en œuvre par défaut indique que le document de conteneur est modifié si *le code ncode* est OLE_CHANGED ou OLE_SAVED.

Pour OLE_CHANGED_STATE, l’état actuel de retour de [GetItemState](#getitemstate) sera toujours l’ancien État, ce qui signifie que l’État qui était à jour avant ce changement d’État.

Remplacer cette fonction pour répondre aux changements dans l’état de l’élément OLE. En règle générale, vous mettez à jour l’apparence de l’élément en invalidant la zone dans laquelle l’élément est affiché. Appelez la mise en œuvre de la classe de base au début de votre remplacement.

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClientItem::OnChangeItemPosition

Appelé par le cadre pour informer le conteneur que l’étendue de l’élément OLE a changé lors de l’activation sur place.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Paramètres

*rectPos rectPos*<br/>
Indique la position de l’élément par rapport à la zone client de l’application de conteneurs.

### <a name="return-value"></a>Valeur de retour

Nonzero si la position de l’élément est modifiée avec succès; sinon 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut détermine le nouveau rectangle visible de l’élément OLE et appelle [SetItemRects](#setitemrects) avec les nouvelles valeurs. L’implémentation par défaut calcule le rectangle visible pour l’élément et transmet ces informations au serveur.

Remplacer cette fonction pour appliquer des règles spéciales à l’opération de resize/move. Si l’application est écrite dans MFC, cet appel résulte parce que le serveur appelé [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClientItem::OnDeactivate

Appelé par le cadre lorsque l’élément OLE passe `activeState`de l’état actif sur place () à l’état chargé, ce qui signifie qu’il est désactivé après une activation sur place.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Notes

Notez que cette fonction est appelée pour indiquer que l’élément OLE est fermé, et non pas que son interface utilisateur a été supprimée de l’application conteneur. Lorsque cela se produit, la fonction membre [OnDeactivateUI](#ondeactivateui) est appelée.

La implémentation par défaut appelle la fonction membre [OnChange](#onchange) avec OLE_CHANGEDSTATE comme paramètre. Remplacer cette fonction pour effectuer un traitement personnalisé lorsqu’un élément actif sur place est désactivé. Par exemple, si vous soutenez la commande annuler dans votre application de conteneur, vous pouvez remplacer cette fonction pour jeter l’état annuler, ce qui indique que la dernière opération effectuée sur l’élément OLE ne peut pas être annulée une fois que l’élément est désactivé.

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClientItem::OnDeactivateAndUndo

Appelé par le cadre lorsque l’utilisateur invoque la commande annuler après l’activation de l’élément OLE en place.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle [DeactivateUI](#deactivateui) pour désactiver l’interface utilisateur du serveur. Remplacez cette fonction si vous implémentez la commande annuler votre application de conteneur. Dans votre remplacement, appelez la version de classe de base de la fonction, puis défaire la dernière commande exécutée dans votre application.

Pour plus d’informations, voir [IOleInPlaceSite::DeactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) dans le SDK Windows.

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClientItem::OnDeactivateUI

Appelé lorsque l’utilisateur désactive un élément qui a été activé en place.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Paramètres

*bUndoable*<br/>
Précise si les modifications d’édition sont indobles.

### <a name="remarks"></a>Notes

Cette fonction restaure l’interface utilisateur de l’application de conteneur à son état d’origine, cachant tous les menus et autres contrôles qui ont été créés pour l’activation en place.

Si *bUndoable* est FALSE, le conteneur doit désactiver la commande annulere, rejetant en fait l’état d’annulation du conteneur, car il indique que la dernière opération effectuée par le serveur n’est pas indoable.

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClientItem::OnDiscardUndoState

Appelé par le cadre lorsque l’utilisateur effectue une action qui rejette l’état annuler lors de l’édition de l’élément OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération. Remplacez cette fonction si vous implémentez la commande annuler votre application de conteneur. Dans votre remplacement, jetez l’état de défaire de l’application de conteneur.

Si le serveur a été écrit avec la Microsoft Foundation Class Library, le serveur peut provoquer l’appel de cette fonction en appelant [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Pour plus d’informations, voir [IOleInPlaceSite::DiscardUndoState](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) dans le SDK Windows.

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClientItem::OnGetClipboardData

Appelé par le cadre `COleDataSource` pour obtenir un objet contenant toutes les données qui seraient placées sur le Clipboard par un appel soit au [CopyToClipboard](#copytoclipboard) ou à la fonction membre [DoDragDrop.](#dodragdrop)

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Paramètres

*bIncludeLink*<br/>
Définissez ceci à TRUE si les données de lien doivent être copiées sur le Clipboard. Définissez ceci à FALSE si votre application serveur ne prend pas en charge les liens.

*lpOffset (en anglais)*<br/>
Pointeur sur le décalage du curseur de souris de l’origine de l’objet en pixels.

*lpSize*<br/>
Pointeur sur la taille de l’objet en pixels.

### <a name="return-value"></a>Valeur de retour

Un pointeur vers un objet [COleDataSource](../../mfc/reference/coledatasource-class.md) contenant les données Clipboard.

### <a name="remarks"></a>Notes

La mise en œuvre par défaut de cette fonction appelle [GetClipboardData](#getclipboarddata).

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClientItem::OnGetClipRect

Le cadre `OnGetClipRect` appelle la fonction du membre pour obtenir les coordonnées de la tonte-rectangle de l’élément qui est en cours de modification en place.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Paramètres

*rClipRect (en)*<br/>
Pointeur vers un objet de classe [CRect](../../atl-mfc-shared/reference/crect-class.md) qui tiendra les coordonnées de la tonte-rectangle de l’élément.

### <a name="remarks"></a>Notes

Les coordonnées sont en pixels par rapport à la zone client de la fenêtre d’application du conteneur.

La implémentation par défaut renvoie simplement le rectangle client de la vue sur laquelle l’élément est actif.

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClientItem::OnGetItemPosition

Le cadre `OnGetItemPosition` appelle la fonction membre pour obtenir les coordonnées de l’élément qui est en cours de modification en place.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Paramètres

*rPosition*<br/>
Référence à l’objet [CRect](../../atl-mfc-shared/reference/crect-class.md) qui contiendra les coordonnées de position de l’élément.

### <a name="remarks"></a>Notes

Les coordonnées sont en pixels par rapport à la zone client de la fenêtre d’application du conteneur.

L’implémentation par défaut de cette fonction est sans effet. Les applications qui prennent en charge l’édition sur place nécessitent sa mise en œuvre.

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClientItem::OnGetWindowContext

Appelé par le cadre lorsqu’un élément est activé en place.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Paramètres

*ppMainFrame*<br/>
Pointeur vers un pointeur vers la fenêtre du cadre principal.

*ppDocFrame*<br/>
Pointeur vers un pointeur vers la fenêtre du cadre de document.

*lpFrameInfo*<br/>
Pointeur vers une structure [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) qui recevra des informations de fenêtre de cadre.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction est utilisée pour récupérer des informations sur la fenêtre parente de l’élément OLE.

Si le conteneur est une application MDI, la mise en œuvre par défaut renvoie un pointeur à [l’objet CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) dans *ppMainFrame* et un pointeur à l’objet [actif CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) dans *ppDocFrame*. Si le conteneur est une application SDI, la mise en œuvre par défaut renvoie un pointeur à [l’objet CFrameWnd](../../mfc/reference/cframewnd-class.md) dans *ppMainFrame* et retourne NULL dans *ppDocFrame*. La mise en œuvre par défaut remplit également les membres de *lpFrameInfo*.

Remplacer cette fonction uniquement si l’implémentation par défaut ne convient pas à votre application; par exemple, si votre application a un paradigme d’interface utilisateur qui diffère de SDI ou MDI. C’est un avancé primordial.

Pour plus d’informations, voir [IOleInPlaceSite:GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) et la structure [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) dans le SDK Windows.

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClientItem::OnInsertMenus

Appelé par le cadre lors de l’activation sur place pour insérer les menus de l’application de conteneur dans un menu vide.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Points à un menu vide.

*lpMenuWidths*<br/>
Points à une gamme de six valeurs LONG indiquant combien de menus sont dans chacun des groupes de menu suivants: Fichier, Modifier, Conteneur, Objet, Fenêtre, Aide. L’application de conteneurs est responsable des groupes de menu de fichiers, de conteneurs et de fenêtres, correspondant aux éléments 0, 2 et 4 de ce tableau.

### <a name="remarks"></a>Notes

Ce menu est ensuite transmis au serveur, qui insère ses propres menus, créant un menu composite. Cette fonction peut être appelée à plusieurs reprises pour construire plusieurs menus composites.

La mise en œuvre par défaut s’insère dans *pMenuShared* les menus de conteneurs sur place; c’est-à-dire les groupes de menu de fichiers, de conteneurs et de fenêtres. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) est utilisé pour définir cette ressource de menu. La mise en œuvre par défaut attribue également les valeurs appropriées aux éléments 0, 2 et 4 dans *lpMenuWidths*, selon la ressource du menu. Remplacer cette fonction si la mise en œuvre par défaut n’est pas appropriée pour votre application; par exemple, si votre application n’utilise pas de modèles de documents pour associer des ressources avec des types de documents. Si vous remplacez cette fonction, vous devez également remplacer [OnSetMenu](#onsetmenu) et [OnRemoveMenus](#onremovemenus). C’est un avancé primordial.

Pour plus d’informations, voir [IOleInPlaceFrame::InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) in the Windows SDK.

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClientItem::OnRemoveMenus

Appelé par le cadre pour supprimer les menus du conteneur du menu composite spécifié à la fin de l’activation sur place.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Points au menu composite construit par des appels à la fonction membre [OnInsertMenus.](#oninsertmenus)

### <a name="remarks"></a>Notes

La mise en œuvre par défaut supprime de *pMenuShared* les menus de conteneurs sur place, c’est-à-dire les groupes de menu De fichiers, de conteneurs et de fenêtres. Remplacer cette fonction si la mise en œuvre par défaut n’est pas appropriée pour votre application; par exemple, si votre application n’utilise pas de modèles de documents pour associer des ressources avec des types de documents. Si vous remplacez cette fonction, vous devriez probablement remplacer [OnInsertMenus](#oninsertmenus) et [OnSetMenu](#onsetmenu) ainsi. C’est un avancé primordial.

Le sous-genre sur *pMenuShared* peut être partagé par plus d’un menu composite si le serveur a appelé `OnInsertMenus`à plusieurs reprises . Par conséquent, vous ne devez pas supprimer `OnRemoveMenus`tout sous-genre dans votre remplacement de ; vous ne devriez les détacher.

Pour plus d’informations, voir [IOleInPlaceFrame::RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) in the Windows SDK.

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClientItem::OnScrollBy

Appelé par le cadre pour faire défiler l’élément OLE en réponse aux demandes du serveur.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Paramètres

*tailleExtent*<br/>
Spécifie les distances, en pixels, pour faire défiler dans les directions x et y.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’élément a été défilé; 0 si l’élément ne pouvait pas être défilé.

### <a name="remarks"></a>Notes

Par exemple, si l’élément OLE est partiellement visible et que l’utilisateur se déplace à l’extérieur de la région visible lors de l’édition sur place, cette fonction est appelée à garder le curseur visible. L'implémentation par défaut n'exécute aucune opération. Remplacer cette fonction pour faire défiler l’élément par la quantité spécifiée. Notez qu’à la suite du défilement, la partie visible de l’élément OL peut changer. Appelez [SetItemRects](#setitemrects) pour mettre à jour le rectangle visible de l’élément.

Pour plus d’informations, voir [IOleInPlaceSite::Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) in the Windows SDK.

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClientItem::OnSetMenu

Appelé par le cadre deux fois lorsque l’activation sur place commence et se termine; la première fois pour installer le menu composite et la deuxième fois (avec *holemenu* égal à NULL) pour l’enlever.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Pointeur sur le menu composite construit par des appels `InsertMenu` à la fonction membre [OnInsertMenus](#oninsertmenus) et la fonction.

*holemenu*<br/>
Manipuler le descripteur de `OleCreateMenuDescriptor` menu retourné par la fonction, ou NULL si le code d’expédition doit être supprimé.

*hwndActiveObject*<br/>
Gérer la fenêtre d’édition pour l’élément OLE. C’est la fenêtre qui recevra des commandes d’édition de l’OLE.

### <a name="remarks"></a>Notes

L’implémentation par défaut installe ou supprime le menu composite, puis appelle la fonction [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) pour installer ou supprimer le code d’expédition. Remplacer cette fonction si l’implémentation par défaut n’est pas appropriée pour votre application. Si vous remplacez cette fonction, vous devriez probablement remplacer [OnInsertMenus](#oninsertmenus) et [OnRemoveMenus](#onremovemenus) ainsi. C’est un avancé primordial.

Pour plus d’informations, voir [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor), et [IOleInPlaceFrame::SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) dans le Windows SDK.

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClientItem::OnShowControlBars

Appelé par le cadre pour montrer et cacher les barres de contrôle de l’application de conteneurs.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*pFrameWnd*<br/>
Pointeur vers la fenêtre de cadre de l’application de conteneur. Il peut s’agir soit d’une fenêtre de cadre principale, soit d’une fenêtre pour enfants MDI.

*bShow (en)*<br/>
Précise si les barres de contrôle doivent être affichées ou cachées.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’appel de fonction provoque un changement dans l’état des barres de contrôle; 0 si l’appel ne provoque aucun changement, ou si *pFrameWnd* ne pointe pas vers la fenêtre de cadre du conteneur.

### <a name="remarks"></a>Notes

Cette fonction renvoie 0 si les barres de contrôle sont déjà dans l’état spécifié par *bShow.* Cela se produirait, par exemple, si les barres de contrôle sont cachées et *bShow* est FALSE.

L’implémentation par défaut supprime la barre d’outils de la fenêtre de cadre de haut niveau.

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClientItem::OnShowItem

Appelé par le cadre pour afficher l’élément OLE, le rendant totalement visible lors de l’édition.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Notes

Il est utilisé lorsque votre application de conteneurs prend en charge les liens vers des éléments intégrés (c’est-à-dire, si vous avez dérivé votre classe de documents de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Cette fonction est appelée lors de l’activation sur place ou lorsque l’élément OLE est une source de lien et que l’utilisateur souhaite le modifier. La mise en œuvre par défaut active la première vue sur le document de conteneur. Remplacer cette fonction pour faire défiler le document afin que l’élément OLE soit visible.

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClientItem::OnUpdateFrametitle

Appelé par le cadre lors de l’activation sur place pour mettre à jour la barre de titre de la fenêtre de cadre.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si cette fonction a mis à jour avec succès le titre du cadre, sinon zéro.

### <a name="remarks"></a>Notes

L’implémentation par défaut ne modifie pas le titre de la fenêtre de cadre. Remplacez cette fonction si vous voulez un titre de cadre différent pour votre application, par exemple "*article* *d’application* - serveur en *docname*" (comme dans, "Microsoft Excel - feuille de calcul dans REPORT. DOC"). C’est un avancé primordial.

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClientItem::RéactivateAndUndo

Appelez cette fonction pour réactiver l’élément OLE et annuler la dernière opération effectuée par l’utilisateur lors de l’édition sur place.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si votre application de conteneur prend en charge la commande de défaire, appelez cette fonction si l’utilisateur choisit la commande de défaire immédiatement après avoir désactivé l’élément OLE.

Si l’application serveur est écrite avec les bibliothèques de classe Microsoft Foundation, cette fonction provoque le serveur d’appeler [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Pour plus d’informations, voir [IOleInPlaceObject:ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) dans le SDK Windows.

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClientItem::Libération

Appelez cette fonction pour nettoyer les ressources utilisées par l’article OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Paramètres

*dwCloseOption*<br/>
Indicateur spécifiant dans quelles circonstances l’élément OLE est enregistré lorsqu’il retourne à l’état chargé. Pour une liste de valeurs possibles, voir [COleClientItem::Close](#close).

### <a name="remarks"></a>Notes

`Release`est appelé `COleClientItem` par le destructeur.

Pour plus d’informations, voir [IUnknown::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) in the Windows SDK.

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClientItem::Reload

Ferme et recharge l’article.

```
BOOL Reload();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez `Reload` la fonction après avoir activé l’élément comme un élément d’un autre type par un appel à [ActivateAs](#activateas).

## <a name="coleclientitemrun"></a><a name="run"></a>COleClientItem::Run

Exécute l’application associée à cet article.

```
void Run();
```

### <a name="remarks"></a>Notes

Appelez `Run` la fonction membre pour lancer l’application serveur avant d’activer l’élément. Ceci est fait automatiquement par [Activate](#activate) et [DoVerb](#doverb), il n’est généralement pas nécessaire d’appeler cette fonction. Appelez cette fonction s’il est nécessaire d’exécuter le serveur afin de définir un attribut d’élément, tel que [SetExtent](#setextent), avant d’exécuter [DoVerb](#doverb).

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClientItem::SetDrawAspect

Appelez `SetDrawAspect` la fonction membre pour définir l’aspect ou la vue de l’élément.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Paramètres

*nDrawAspect (en anglais seulement)*<br/>
Une valeur de l’énumération DVASPECT. Ce paramètre peut prendre l'une des valeurs suivantes :

- DVASPECT_CONTENT’élément est représenté de telle sorte qu’il puisse être affiché comme un objet intégré à l’intérieur de son conteneur.

- DVASPECT_THUMBNAIL’élément est rendu dans une représentation "thumbnail" afin qu’il puisse être affiché dans un outil de navigation.

- DVASPECT_ICON’élément est représenté par une icône.

- DVASPECT_DOCPRINT’article est représenté comme s’il avait été imprimé à l’aide de la commande d’impression du menu Fichier.

### <a name="remarks"></a>Notes

L’aspect précise comment l’élément doit être rendu par [Draw](#draw) lorsque la valeur par défaut pour l’argument *nDrawAspect* de cette fonction est utilisée.

Cette fonction est appelée automatiquement par l’icône de changement (et d’autres dialogues qui appellent le dialogue Change Icon directement) pour activer l’aspect d’affichage emblématique sur demande de l’utilisateur.

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClientItem::SetExtent

Appelez cette fonction pour spécifier la quantité d’espace disponible pour l’article OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Paramètres

*Taille*<br/>
Un objet [CSize](../../atl-mfc-shared/reference/csize-class.md) qui contient les informations de taille.

*nDrawAspect (en anglais seulement)*<br/>
Spécifie l’aspect de l’élément OLE dont les limites doivent être définies. Pour les valeurs possibles, voir [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la Microsoft `COleServerItem` Foundation Class Library, cela provoque la fonction membre [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) de l’objet correspondant à être appelé. L’élément OLE peut ensuite ajuster son affichage en conséquence. Les dimensions doivent se trouver dans MM_HIMETRIC unités. Appelez cette fonction lorsque l’utilisateur resize l’élément OLE ou si vous soutenez une certaine forme de négociation de mise en page.

Pour plus d’informations, voir [IOleObject:SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) in the Windows SDK.

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClientItem::SetHostNames

Appelez cette fonction pour spécifier le nom de l’application de conteneurs et le nom du conteneur pour un article OLE intégré.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Paramètres

*lpszHost (lpszHost)*<br/>
Pointeur vers le nom visible de l’utilisateur de l’application de conteneur.

*lpszHostObj*<br/>
Pointeur vers une chaîne d’identification du conteneur qui contient l’élément OLE.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la Microsoft Foundation `COleServerDoc` Class Library, cette fonction appelle la fonction membre [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) du document qui contient l’élément OLE. Ces informations sont utilisées dans les titres de fenêtre lorsque l’élément OLE est en cours de modification. Chaque fois qu’un document de conteneur est chargé, le cadre appelle cette fonction pour tous les éléments OLE dans le document. `SetHostNames`ne s’applique qu’aux articles intégrés. Il n’est pas nécessaire d’appeler cette fonction chaque fois qu’un élément OLE intégré est activé pour l’édition.

Cela s’appelle également automatiquement avec le nom de l’application et le nom du document lorsqu’un objet est chargé ou lorsqu’un fichier est enregistré sous un nom différent. Par conséquent, il n’est généralement pas nécessaire d’appeler cette fonction directement.

Pour plus d’informations, voir [IOleObject:SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) in the Windows SDK.

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClientItem::SetIconicMetafile

Cache le metafile utilisé pour dessiner l’icône de l’objet.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Paramètres

*hMetaPict (en)*<br/>
Une poignée au metafile utilisé pour dessiner l’icône de l’élément.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez [GetIconicMetafile](#geticonicmetafile) pour récupérer le métaafile.

Le *paramètre hMetaPict* est copié dans l’élément; par conséquent, *hMetaPict* doit être libéré par l’appelant.

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClientItem::SetItemRects

Appelez cette fonction pour définir le rectangle de délimitation ou le rectangle visible de l’élément OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Paramètres

*lprcPosRect*<br/>
Pointeur vers le rectangle contenant les limites de l’élément OLE par rapport à sa fenêtre parente, dans les coordonnées des clients.

*lprcClipRect*<br/>
Pointeur vers le rectangle contenant les limites de la partie visible de l’élément OLE par rapport à sa fenêtre mère, dans les coordonnées du client.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Cette fonction est appelée par la mise en œuvre par défaut de la fonction membre [OnChangeItemPosition.](#onchangeitemposition) Vous devez appeler cette fonction chaque fois que la position ou la partie visible de l’élément OLE change. Habituellement, cela signifie que vous l’appelez à partir de votre vue [OnSize](../../mfc/reference/cwnd-class.md#onsize) et [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) fonctions membres.

Pour plus d’informations, voir [IOleInPlaceObject:SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) in the Windows SDK.

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClientItem::SetLinkUpdateOptions

Appelez cette fonction pour définir l’option de mise à jour du lien pour la présentation de l’élément lié spécifié.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Paramètres

*dwUpdateOpt*<br/>
La valeur de l’option de mise à jour de lien pour cet élément. Cette valeur doit être l’une des suivantes :

- OLEUPDATE_ALWAYS Mettre à jour l’élément lié dans la mesure du possible. Cette option prend en charge le bouton radio automatique de mise à jour de lien dans la boîte de dialogue Links.

- OLEUPDATE_ONCALL Mettre à jour l’élément lié uniquement sur demande de l’application de conteneur (lorsque la fonction de membre [UpdateLink](#updatelink) est appelée). Cette option prend en charge le bouton radio de mise à jour manuelle du lien dans la boîte de dialogue Links.

### <a name="remarks"></a>Notes

En règle générale, vous ne devez pas modifier les options de mise à jour choisies par l’utilisateur dans la boîte de dialogue Links.

Pour plus d’informations, voir [IOleLink:SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) in the Windows SDK.

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClientItem::SetPrintDevice

Appelez cette fonction pour modifier l’appareil d’impression cible pour cet article.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Paramètres

*Ptd*<br/>
Pointeur vers une structure de données [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) qui contient des informations sur le nouvel appareil d’impression-cible. Sa valeur peut être NULL.

*Ppd*<br/>
Pointeur vers une structure de données [PRINTDLG,](/windows/win32/api/commdlg/ns-commdlg-printdlga) qui contient des informations sur le nouvel appareil d’impression cible. Sa valeur peut être NULL.

### <a name="return-value"></a>Valeur de retour

Nonzero si la fonction a été réussie; sinon 0.

### <a name="remarks"></a>Notes

Cette fonction met à jour l’appareil d’impression-cible pour l’élément, mais ne rafraîchit pas le cache de présentation. Pour mettre à jour le cache de présentation pour un élément, appelez [UpdateLink](#updatelink).

Les arguments de cette fonction contiennent des informations que le système OLE utilise pour identifier l’appareil cible. La `PRINTDLG` structure contient des informations que Windows utilise pour initialiser la boîte de dialogue imprimée commune. Après que l’utilisateur ferme la boîte de dialogue, Windows renvoie des informations sur les sélections de l’utilisateur dans cette structure. Le `m_pd` membre d’un objet [CPrintDialog](../../mfc/reference/cprintdialog-class.md) est une `PRINTDLG` structure.

Pour plus d’informations sur cette structure, voir [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) dans le SDK Windows.

Pour plus d’informations, voir [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) dans le SDK Windows.

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClientItem::UpdateLink

Appelez cette fonction pour mettre à jour immédiatement les données de présentation de l’élément OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro en cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Pour les éléments liés, la fonction trouve la source de lien pour obtenir une nouvelle présentation pour l’élément OLE. Ce processus peut impliquer l’exécution d’une ou plusieurs applications serveur, ce qui pourrait prendre beaucoup de temps. Pour les éléments intégrés, la fonction fonctionne de façon récursive, en vérifiant si l’élément intégré contient des liens qui pourraient être obsolètes et les mettre à jour. L’utilisateur peut également mettre à jour manuellement les liens individuels à l’aide de la boîte de dialogue Links.

Pour plus d’informations, voir [IOleLink::Mise à jour](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) dans le SDK Windows.

## <a name="see-also"></a>Voir aussi

[MFC Échantillon MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Échantillon MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem, classe](../../mfc/reference/cdocitem-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem, classe](../../mfc/reference/coleserveritem-class.md)
