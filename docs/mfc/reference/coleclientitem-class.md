---
title: COleClientItem (classe)
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/16/2020
ms.locfileid: "79421722"
---
# <a name="coleclientitem-class"></a>COleClientItem (classe)

Définit l'interface du conteneur pour les éléments OLE.

## <a name="syntax"></a>Syntaxe

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Name|Description|
|----------|-----------------|
|[COleClientItem :: COleClientItem](#coleclientitem)|Construit un objet `COleClientItem`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Name|Description|
|----------|-----------------|
|[COleClientItem :: Activate](#activate)|Ouvre l’élément OLE pour une opération, puis exécute le verbe spécifié.|
|[COleClientItem :: Activatas](#activateas)|Active l’élément comme un autre type.|
|[COleClientItem :: AttachDataObject](#attachdataobject)|Accède aux données de l’objet OLE.|
|[COleClientItem :: CanCreateFromData](#cancreatefromdata)|Indique si une application conteneur peut créer un objet incorporé.|
|[COleClientItem :: CanCreateLinkFromData](#cancreatelinkfromdata)|Indique si une application conteneur peut créer un objet lié.|
|[COleClientItem :: CanPaste](#canpaste)|Indique si le presse-papiers contient un élément OLE incorporable ou statique.|
|[COleClientItem :: CanPasteLink](#canpastelink)|Indique si le presse-papiers contient un élément OLE qui est lié.|
|[COleClientItem :: Close](#close)|Ferme un lien vers un serveur, mais ne détruit pas l’élément OLE.|
|[COleClientItem :: ConvertTo](#convertto)|Convertit l’élément en un autre type.|
|[COleClientItem :: CopyToClipboard](#copytoclipboard)|Copie l’élément OLE dans le presse-papiers.|
|[COleClientItem :: CreateCloneFrom](#createclonefrom)|Crée un doublon d’un élément existant.|
|[COleClientItem :: CreateFromClipboard](#createfromclipboard)|Crée un élément incorporé à partir du presse-papiers.|
|[COleClientItem :: CreateFromData](#createfromdata)|Crée un élément incorporé à partir d’un objet de données.|
|[COleClientItem :: CreateFromFile](#createfromfile)|Crée un élément incorporé à partir d’un fichier.|
|[COleClientItem :: CreateLinkFromClipboard](#createlinkfromclipboard)|Crée un élément lié à partir du presse-papiers.|
|[COleClientItem :: CreateLinkFromData](#createlinkfromdata)|Crée un élément lié à partir d’un objet de données.|
|[COleClientItem :: CreateLinkFromFile](#createlinkfromfile)|Crée un élément lié à partir d’un fichier.|
|[COleClientItem :: CreateNewItem](#createnewitem)|Crée un nouvel élément incorporé en lançant l’application serveur.|
|[COleClientItem :: CreateStaticFromClipboard](#createstaticfromclipboard)|Crée un élément statique à partir du presse-papiers.|
|[COleClientItem :: CreateStaticFromData](#createstaticfromdata)|Crée un élément statique à partir d’un objet de données.|
|[COleClientItem ::D eactivate](#deactivate)|Désactive l’élément.|
|[COleClientItem ::D eactivateUI](#deactivateui)|Restaure l’état d’origine de l’interface utilisateur de l’application conteneur.|
|[COleClientItem ::D supprim](#delete)|Supprime ou ferme l’élément OLE s’il s’agit d’un élément lié.|
|[COleClientItem ::D oDragDrop](#dodragdrop)|Effectue une opération de glisser-déplacer.|
|[COleClientItem ::D oVerb](#doverb)|Exécute le verbe spécifié.|
|[COleClientItem ::D RAW](#draw)|Dessine l’élément OLE.|
|[COleClientItem :: GetActiveView](#getactiveview)|Obtient la vue sur laquelle l’élément est activé sur place.|
|[COleClientItem :: GetCachedExtent](#getcachedextent)|Retourne les limites du rectangle de l’élément OLE.|
|[COleClientItem :: GetClassID](#getclassid)|Obtient l’ID de classe de l’élément actuel.|
|[COleClientItem :: GetClipboardData](#getclipboarddata)|Obtient les données qui seraient placées dans le presse-papiers en appelant la fonction membre `CopyToClipboard`.|
|[COleClientItem :: GetDocument](#getdocument)|Retourne l’objet `COleDocument` qui contient l’élément présent.|
|[COleClientItem :: GetDrawAspect](#getdrawaspect)|Obtient la vue actuelle de l’élément pour le rendu.|
|[COleClientItem :: GetExtent](#getextent)|Retourne les limites du rectangle de l’élément OLE.|
|[COleClientItem :: GetIconFromRegistry](#geticonfromregistry)|Récupère un handle vers une icône associée au serveur d’un CLSID particulier.|
|[COleClientItem :: GetIconicMetafile](#geticonicmetafile)|Obtient le métafichier utilisé pour dessiner l’icône de l’élément.|
|[COleClientItem :: GetInPlaceWindow](#getinplacewindow)|Retourne un pointeur vers la fenêtre de modification sur place de l’élément.|
|[COleClientItem :: GetItemState](#getitemstate)|Obtient l’état actuel de l’élément.|
|[COleClientItem :: GetLastStatus](#getlaststatus)|Retourne l’état de la dernière opération OLE.|
|[COleClientItem :: GetLinkUpdateOptions](#getlinkupdateoptions)|Retourne le mode de mise à jour d’un élément lié (fonctionnalité avancée).|
|[COleClientItem :: GetType](#gettype)|Retourne le type (incorporé, lié ou statique) de l’élément OLE.|
|[COleClientItem :: GetUserType](#getusertype)|Obtient une chaîne décrivant le type de l’élément.|
|[COleClientItem :: IsInPlaceActive](#isinplaceactive)|Retourne la valeur TRUE si l’élément est actif sur place.|
|[COleClientItem :: IsLinkUpToDate](#islinkuptodate)|Retourne la valeur TRUE si un élément lié est à jour avec son document source.|
|[COleClientItem :: IsModified](#ismodified)|Retourne la valeur TRUE si l’élément a été modifié depuis son dernier enregistrement.|
|[COleClientItem :: IsOpen](#isopen)|Retourne la valeur TRUE si l’élément est actuellement ouvert dans l’application serveur.|
|[COleClientItem :: IsRunning](#isrunning)|Retourne la valeur TRUE si l’application serveur de l’élément est en cours d’exécution.|
|[COleClientItem :: OnActivate](#onactivate)|Appelé par l’infrastructure pour notifier l’élément qu’il est activé.|
|[COleClientItem :: OnActivateUI](#onactivateui)|Appelé par l’infrastructure pour notifier l’élément qu’il est activé et doit afficher son interface utilisateur.|
|[COleClientItem :: OnChange](#onchange)|Appelé lorsque le serveur modifie l’élément OLE. Implémentation requise.|
|[COleClientItem :: OnDeactivate](#ondeactivate)|Appelé par le Framework lorsqu’un élément est désactivé.|
|[COleClientItem :: OnDeactivateUI](#ondeactivateui)|Appelé par le Framework lorsque le serveur a supprimé son interface utilisateur sur place.|
|[COleClientItem :: OnGetClipboardData](#ongetclipboarddata)|Appelée par l’infrastructure pour récupérer les données à copier dans le presse-papiers.|
|[COleClientItem :: OnInsertMenus](#oninsertmenus)|Appelé par l’infrastructure pour créer un menu composite.|
|[COleClientItem :: OnRemoveMenus](#onremovemenus)|Appelé par le Framework pour supprimer les menus du conteneur d’un menu composite.|
|[COleClientItem :: OnSetMenu](#onsetmenu)|Appelé par le Framework pour installer et supprimer un menu composite.|
|[COleClientItem :: OnShowControlBars](#onshowcontrolbars)|Appelé par le Framework pour afficher et masquer les barres de contrôles.|
|[COleClientItem :: OnUpdateFrameTitle](#onupdateframetitle)|Appelé par l’infrastructure pour mettre à jour la barre de titre de la fenêtre frame.|
|[COleClientItem :: ReactivateAndUndo](#reactivateandundo)|Réactive l’élément et annule la dernière opération de modification sur place.|
|[COleClientItem :: Release](#release)|Libère la connexion à un élément lié OLE et la ferme si elle était ouverte. Ne détruit pas l’élément client.|
|[COleClientItem :: Reload](#reload)|Recharge l’élément après un appel à `ActivateAs`.|
|[COleClientItem :: Run](#run)|Exécute l’application associée à l’élément.|
|[COleClientItem :: SetDrawAspect](#setdrawaspect)|Définit l’affichage actuel de l’élément pour le rendu.|
|[COleClientItem :: setraverste](#setextent)|Définit le rectangle englobant de l’élément OLE.|
|[COleClientItem :: SetHostNames](#sethostnames)|Définit les noms que le serveur affiche lors de la modification de l’élément OLE.|
|[COleClientItem :: SetIconicMetafile](#seticonicmetafile)|Met en cache le métafichier utilisé pour dessiner l’icône de l’élément.|
|[COleClientItem :: SetItemRects](#setitemrects)|Définit le rectangle englobant de l’élément.|
|[COleClientItem :: SetLinkUpdateOptions](#setlinkupdateoptions)|Définit le mode de mise à jour d’un élément lié (fonctionnalité avancée).|
|[COleClientItem :: SetPrintDevice](#setprintdevice)|Définit l’appareil cible d’impression pour cet élément client.|
|[COleClientItem :: UpdateLink](#updatelink)|Met à jour le cache de présentation d’un élément.|

### <a name="protected-methods"></a>Méthodes protégées

|Name|Description|
|----------|-----------------|
|[COleClientItem :: CanActivate](#canactivate)|Appelé par l’infrastructure pour déterminer si l’activation sur place est autorisée.|
|[COleClientItem :: OnChangeItemPosition](#onchangeitemposition)|Appelé par le Framework lorsque la position d’un élément change.|
|[COleClientItem :: OnDeactivateAndUndo](#ondeactivateandundo)|Appelé par le Framework pour annuler après l’activation.|
|[COleClientItem :: OnDiscardUndoState](#ondiscardundostate)|Appelé par l’infrastructure pour ignorer les informations d’état d’annulation de l’élément.|
|[COleClientItem :: OnGetClipRect](#ongetcliprect)|Appelé par l’infrastructure pour récupérer les coordonnées du rectangle de découpage de l’élément.|
|[COleClientItem :: OnGetItemPosition](#ongetitemposition)|Appelée par l’infrastructure pour obtenir la position de l’élément par rapport à la vue.|
|[COleClientItem :: OnGetWindowContext](#ongetwindowcontext)|Appelé par le Framework lorsqu’un élément est activé sur place.|
|[COleClientItem :: OnScrollBy](#onscrollby)|Appelé par l’infrastructure pour faire défiler l’élément dans l’affichage.|
|[COleClientItem :: OnShowItem](#onshowitem)|Appelé par le Framework pour afficher l’élément OLE.|

## <a name="remarks"></a>Notes

Un élément OLE représente des données, créées et gérées par une application serveur, qui peuvent être incorporées en toute transparence dans un document afin qu’elles apparaissent à l’utilisateur en tant que document unique. Le résultat est un « document composé » composé de l’élément OLE et d’un document contenant.

Un élément OLE peut être incorporé ou lié. S’il est incorporé, ses données sont stockées dans le cadre du document composé. S’il est lié, ses données sont stockées dans un fichier distinct créé par l’application serveur, et seul un lien vers ce fichier est stocké dans le document composé. Tous les éléments OLE contiennent des informations qui spécifient l’application serveur qui doit être appelée pour les modifier.

`COleClientItem` définit plusieurs fonctions substituables qui sont appelées en réponse aux demandes de l’application serveur ; Ces remplaçable jouent généralement le rôle de notifications. Cela permet à l’application serveur d’informer le conteneur des modifications apportées par l’utilisateur lors de la modification de l’élément OLE, ou d’extraire les informations nécessaires lors de la modification.

`COleClientItem` peut être utilisé avec la classe [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)ou [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) . Pour utiliser `COleClientItem`, dérivez une classe de celle-ci et implémentez la fonction membre [OnChange](#onchange) , qui définit la manière dont le conteneur répond aux modifications apportées à l’élément. Pour prendre en charge l’activation sur place, substituez la fonction membre [OnGetItemPosition](#ongetitemposition) . Cette fonction fournit des informations sur la position affichée de l’élément OLE.

Pour plus d’informations sur l’utilisation de l’interface de conteneur, consultez les articles [conteneurs : Implementing a Container](../../mfc/containers-implementing-a-container.md) and [activation](../../mfc/activation-cpp.md).

> [!NOTE]
>  Le SDK Windows fait référence aux éléments incorporés et liés en tant que « objets » et fait référence aux types d’éléments en tant que « classes ». Cette référence utilise le terme « Item » pour distinguer l’entité OLE de l’objet C++ correspondant et le terme « type » pour distinguer la catégorie OLE de la C++ classe.

## <a name="inheritance-hierarchy"></a>Hiérarchie d’héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Spécifications

**En-tête :** AFXOLE. h

##  <a name="activate"></a>COleClientItem :: Activate

Appelez cette fonction pour exécuter le verbe spécifié au lieu [de DoVerb afin de pouvoir effectuer](#doverb) votre propre traitement lorsqu’une exception est levée.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb*<br/>
Spécifie le verbe à exécuter. Les valeurs possibles sont les suivantes :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|- 0|Primary (verbe)|OLEIVERB_PRIMARY|
|- 1|Verbe secondaire|(aucune)|
|- 1|Élément d’affichage pour modification|OLEIVERB_SHOW|
|- 2|Modifier l’élément dans une fenêtre distincte|OLEIVERB_OPEN|
|- 3|Masquer l’élément|OLEIVERB_HIDE|

La valeur-1 est généralement un alias pour un autre verbe. Si la modification ouverte n’est pas prise en charge,-2 a le même effet que-1. Pour obtenir des valeurs supplémentaires, consultez [IOleObject ::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

*pView*<br/>
Pointeur vers la fenêtre d’affichage de conteneur qui contient l’élément OLE ; Cela est utilisé par l’application serveur pour l’activation sur place. Ce paramètre doit avoir la valeur NULL si le conteneur ne prend pas en charge l’activation sur place.

*lpMsg*<br/>
Pointeur vers le message qui a provoqué l’activation de l’élément.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la bibliothèque MFC (Microsoft Foundation Class), cette fonction provoque l’exécution de la fonction membre [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) de l’objet `COleServerItem` correspondant.

Si le verbe principal est Edit et zéro est spécifié dans le paramètre *nVerb* , l’application serveur est lancée pour permettre la modification de l’élément OLE. Si l’application conteneur prend en charge l’activation sur place, la modification peut être effectuée sur place. Si le conteneur ne prend pas en charge l’activation sur place (ou si le verbe Open est spécifié), le serveur est lancé dans une fenêtre distincte et la modification peut être effectuée ici. En règle générale, lorsque l’utilisateur de l’application de conteneur double-clique sur l’élément OLE, la valeur du verbe principal dans le paramètre *nVerb* détermine l’action que l’utilisateur peut effectuer. Toutefois, si le serveur ne prend en charge qu’une seule action, il prend cette action, quelle que soit la valeur spécifiée dans le paramètre *nVerb* .

Pour plus d’informations, consultez [IOleObject ::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

##  <a name="activateas"></a>COleClientItem :: Activatas

Utilise les fonctions de conversion d’objets d’OLE pour activer l’élément comme s’il s’agissait d’un élément du type spécifié par *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Paramètres

*lpszUserType*<br/>
Pointeur vers une chaîne représentant le type d’utilisateur cible, tel que « document Word ».

*clsidOld*<br/>
Référence à l’ID de classe actuel de l’élément. L’ID de classe doit représenter le type de l’objet réel, tel qu’il est stocké, sauf s’il s’agit d’un lien. Dans ce cas, il doit s’agir du CLSID de l’élément auquel le lien fait référence. Le [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fournit automatiquement l’ID de classe correct pour l’élément.

*clsidNew*<br/>
Référence à l’ID de classe cible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode est appelée automatiquement par [COleConvertDialog ::D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Il n’est généralement pas appelé directement.

##  <a name="attachdataobject"></a>COleClientItem :: AttachDataObject

Appelez cette fonction pour initialiser un [COleDataObject](../../mfc/reference/coledataobject-class.md) pour accéder aux données de l’élément OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Paramètres

*rDataObject*<br/>
Référence à un objet `COleDataObject` qui sera initialisé pour autoriser l’accès aux données de l’élément OLE.

##  <a name="canactivate"></a>COleClientItem :: CanActivate

Appelé par l’infrastructure quand l’utilisateur demande l’activation sur place de l’élément OLE ; la valeur de retour de cette fonction détermine si l’activation sur place est autorisée.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’activation sur place est autorisée ; Sinon, 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut autorise l’activation sur place si le conteneur a une fenêtre valide. Substituez cette fonction pour implémenter une logique spéciale pour accepter ou refuser la demande d’activation. Par exemple, une demande d’activation peut être refusée si l’élément OLE est trop petit ou n’est pas visible actuellement.

Pour plus d’informations, consultez [IOleInPlaceSite :: CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) dans le SDK Windows.

##  <a name="cancreatefromdata"></a>COleClientItem :: CanCreateFromData

Vérifie si une application conteneur peut créer un objet incorporé à partir de l’objet `COleDataObject` donné.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le conteneur peut créer un objet incorporé à partir de l’objet `COleDataObject` ; Sinon, 0.

### <a name="remarks"></a>Notes

La classe `COleDataObject` est utilisée dans les transferts de données pour récupérer des données dans différents formats à partir du presse-papiers, par glisser-déplacer ou à partir d’un élément OLE incorporé.

Les conteneurs peuvent utiliser cette fonction pour décider d’activer ou de désactiver les commandes de Collage spécial Edition coller et Edition.

Pour plus d’informations, consultez l’article [objets de données et sources de données (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>COleClientItem :: CanCreateLinkFromData

Vérifie si une application conteneur peut créer un objet lié à partir de l’objet `COleDataObject` donné.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le conteneur peut créer un objet lié à partir de l’objet `COleDataObject`.

### <a name="remarks"></a>Notes

La classe `COleDataObject` est utilisée dans les transferts de données pour récupérer des données dans différents formats à partir du presse-papiers, par glisser-déplacer ou à partir d’un élément OLE incorporé.

Les conteneurs peuvent utiliser cette fonction pour décider d’activer ou de désactiver les commandes Edit Paste collage Special et Edit Paste Link.

Pour plus d’informations, consultez l’article [objets de données et sources de données (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>COleClientItem :: CanPaste

Appelez cette fonction pour voir si un élément OLE incorporé peut être collé à partir du presse-papiers.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un élément OLE incorporé peut être collé à partir du presse-papiers ; Sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) et [OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) dans la SDK Windows.

##  <a name="canpastelink"></a>COleClientItem :: CanPasteLink

Appelez cette fonction pour voir si un élément OLE lié peut être collé à partir du presse-papiers.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si un élément OLE lié peut être collé à partir du presse-papiers ; Sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) et [OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) dans la SDK Windows.

##  <a name="close"></a>COleClientItem :: Close

Appelez cette fonction pour faire passer l’état d’un élément OLE de l’État en cours d’exécution à l’État chargé, c’est-à-dire chargé avec son gestionnaire en mémoire, mais avec le serveur qui n’est pas en cours d’exécution.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Paramètres

*dwCloseOption*<br/>
Indicateur spécifiant dans quelles circonstances l’élément OLE est enregistré lorsqu’il revient à l’État chargé. Il peut prendre l’une des valeurs suivantes :

- OLECLOSE_SAVEIFDIRTY enregistrer l’élément OLE.

- OLECLOSE_NOSAVE n’enregistrez pas l’élément OLE.

- OLECLOSE_PROMPTSAVE demander à l’utilisateur s’il faut enregistrer l’élément OLE.

### <a name="remarks"></a>Notes

Cette fonction n’a aucun effet lorsque l’élément OLE n’est pas en cours d’exécution.

Pour plus d’informations, consultez [IOleObject :: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) dans la SDK Windows.

##  <a name="coleclientitem"></a>COleClientItem :: COleClientItem

Construit un objet `COleClientItem` et l’ajoute à la collection d’éléments de document du document conteneur, qui construit uniquement l' C++ objet et n’effectue aucune initialisation OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Paramètres

*pContainerDoc*<br/>
Pointeur vers le document conteneur qui contiendra cet élément. Il peut s’agir de n’importe quel dérivé de [COleDocument](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Notes

Si vous transmettez un pointeur NULL, aucun ajout n’est effectué dans le document conteneur. Vous devez appeler explicitement [COleDocument :: AddItem](../../mfc/reference/coledocument-class.md#additem).

Vous devez appeler l’une des fonctions membres de création suivantes avant d’utiliser l’élément OLE :

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>COleClientItem :: ConvertTo

Appelez cette fonction membre pour convertir l’élément en type spécifié par *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Paramètres

*clsidNew*<br/>
ID de classe du type cible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette méthode est appelée automatiquement par [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Il n’est pas nécessaire de l’appeler directement.

##  <a name="copytoclipboard"></a>COleClientItem :: CopyToClipboard

Appelez cette fonction pour copier l’élément OLE dans le presse-papiers.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Paramètres

*bIncludeLink*<br/>
TRUE si les informations de lien doivent être copiées dans le presse-papiers, ce qui permet de coller un élément lié ; Sinon, FALSe.

### <a name="remarks"></a>Notes

En général, vous appelez cette fonction lors de l’écriture de gestionnaires de messages pour les commandes copier ou couper à partir du menu Edition. Si vous souhaitez implémenter les commandes copier ou couper, vous devez implémenter la sélection des éléments dans votre application conteneur.

Pour plus d’informations, consultez [OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) dans le SDK Windows.

##  <a name="createclonefrom"></a>COleClientItem :: CreateCloneFrom

Appelez cette fonction pour créer une copie de l’élément OLE spécifié.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Paramètres

*pSrcItem*<br/>
Pointeur vers l’élément OLE à dupliquer.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La copie est identique à l’élément source. Vous pouvez utiliser cette fonction pour prendre en charge les opérations d’annulation.

##  <a name="createfromclipboard"></a>COleClientItem :: CreateFromClipboard

Appelez cette fonction pour créer un élément incorporé à partir du contenu du presse-papiers.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

En général, vous appelez cette fonction à partir du gestionnaire de messages pour la commande coller du menu Edition. (La commande Coller est activée par le Framework si la fonction membre [CanPaste](#canpaste) retourne une valeur différente de zéro.)

Pour plus d’informations, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createfromdata"></a>COleClientItem :: CreateFromData

Appelez cette fonction pour créer un élément incorporé à partir d’un objet `COleDataObject`.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Les opérations de transfert de données, telles que le collage à partir du presse-papiers ou les opérations de glisser-déplacer, fournissent des `COleDataObject` objets contenant les informations fournies par une application serveur. Il est généralement utilisé dans votre remplacement de [CView :: OnDrop](../../mfc/reference/cview-class.md#ondrop).

Pour plus d’informations, consultez [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createfromfile"></a>COleClientItem :: CreateFromFile

Appelez cette fonction pour créer un élément OLE incorporé à partir d’un fichier.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*lpszFileName*<br/>
Pointeur vers le nom du fichier à partir duquel l’élément OLE doit être créé.

*identificateur*<br/>
Réservé pour un usage futur.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette fonction à partir de [COleInsertDialog :: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si l’utilisateur clique sur OK dans la boîte de dialogue Insérer un objet lorsque le bouton créer à partir d’un fichier est sélectionné.

Pour plus d’informations, consultez [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createlinkfromclipboard"></a>COleClientItem :: CreateLinkFromClipboard

Appelez cette fonction pour créer un élément lié à partir du contenu du presse-papiers.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

En général, vous appelez cette fonction à partir du gestionnaire de messages pour la commande Coller le lien du menu Edition. (La commande Coller le lien est activée dans l’implémentation par défaut de [COleDocument](../../mfc/reference/coledocument-class.md) si le presse-papiers contient un élément OLE qui peut être lié à.)

Pour plus d’informations, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createlinkfromdata"></a>COleClientItem :: CreateLinkFromData

Appelez cette fonction pour créer un élément lié à partir d’un objet `COleDataObject`.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez cette commande pendant une opération de déplacement lorsque l’utilisateur indique qu’un lien doit être créé. Elle peut également être utilisée pour gérer la commande Edition coller. Elle est appelée par l’infrastructure dans `COleClientItem::CreateLinkFromClipboard` et dans [COlePasteSpecialDialog :: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) lorsque l’option de lien a été sélectionnée.

Pour plus d’informations, consultez [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createlinkfromfile"></a>COleClientItem :: CreateLinkFromFile

Appelez cette fonction pour créer un élément OLE lié à partir d’un fichier.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*lpszFileName*<br/>
Pointeur vers le nom du fichier à partir duquel l’élément OLE doit être créé.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette fonction si l’utilisateur clique sur OK dans la boîte de dialogue Insérer un objet lorsque le bouton créer à partir d’un fichier est sélectionné et que la case à cocher lien est activée. Elle est appelée à partir de [COleInsertDialog :: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Pour plus d’informations, consultez [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createnewitem"></a>COleClientItem :: CreateNewItem

Appelez cette fonction pour créer un élément incorporé. Cette fonction lance l’application serveur qui permet à l’utilisateur de créer l’élément OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*identificateur*<br/>
ID qui identifie de façon unique le type d’élément OLE à créer.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

L’infrastructure appelle cette fonction si l’utilisateur clique sur OK dans la boîte de dialogue Insérer un objet lorsque le bouton créer un nouveau est sélectionné.

Pour plus d’informations, consultez [OleCreate](/windows/win32/api/ole/nf-ole-olecreate), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createstaticfromclipboard"></a>COleClientItem :: CreateStaticFromClipboard

Appelez cette fonction pour créer un élément statique à partir du contenu du presse-papiers.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Un élément statique contient les données de présentation, mais pas les données natives ; par conséquent, il ne peut pas être modifié. En général, vous appelez cette fonction si la fonction membre [CreateFromClipboard](#createfromclipboard) échoue.

Pour plus d’informations, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="createstaticfromdata"></a>COleClientItem :: CreateStaticFromData

Appelez cette fonction pour créer un élément statique à partir d’un objet `COleDataObject`.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataObject*<br/>
Pointeur vers l’objet [COleDataObject](../../mfc/reference/coledataobject-class.md) à partir duquel l’élément OLE doit être créé.

*render*<br/>
Indicateur spécifiant le mode de rendu de l’élément OLE par le serveur. Pour connaître les valeurs possibles, consultez [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) dans le SDK Windows.

*cfFormat*<br/>
Spécifie le format de données du presse-papiers à mettre en cache lors de la création de l’élément OLE.

*lpFormatEtc*<br/>
Pointeur vers une structure [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) utilisée si *Render* est OLERENDER_FORMAT ou OLERENDER_DRAW. Fournissez une valeur pour ce paramètre uniquement si vous souhaitez spécifier des informations de mise en forme supplémentaires au-delà du format du presse-papiers spécifié par *cfFormat*. Si vous omettez ce paramètre, les valeurs par défaut sont utilisées pour les autres champs de la structure `FORMATETC`.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Un élément statique contient les données de présentation, mais pas les données natives ; par conséquent, il ne peut pas être modifié. C’est fondamentalement identique à [CreateStaticFromClipboard](#createstaticfromclipboard) , à ceci près qu’un élément statique peut être créé à partir d’un `COleDataObject`arbitraire, et pas uniquement à partir du presse-papiers.

Utilisé dans [COlePasteSpecialDialog :: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quand static est sélectionné.

Pour plus d’informations, consultez [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)et [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) dans le SDK Windows.

##  <a name="deactivate"></a>COleClientItem ::D eactivate

Appelez cette fonction pour désactiver l’élément OLE et libérer toutes les ressources associées.

```
void Deactivate();
```

### <a name="remarks"></a>Notes

En général, vous désactivez un élément OLE actif sur place quand l’utilisateur clique sur la souris sur la zone cliente en dehors des limites de l’élément. Notez que la désactivation de l’élément OLE supprimera son état d’annulation, ce qui rend impossible l’appel de la fonction membre [ReactivateAndUndo](#reactivateandundo) .

Si votre application prend en charge l’annulation, n’appelez pas `Deactivate`; au lieu de cela, appelez [DeactivateUI](#deactivateui).

Pour plus d’informations, consultez [IOleInPlaceObject :: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) dans le SDK Windows.

##  <a name="deactivateui"></a>COleClientItem ::D eactivateUI

Appelez cette fonction lorsque l’utilisateur désactive un élément qui a été activé sur place.

```
void DeactivateUI();
```

### <a name="remarks"></a>Notes

Cette fonction restaure l’état d’origine de l’interface utilisateur de l’application conteneur, en masquant les menus et les autres contrôles qui ont été créés pour l’activation sur place.

Cette fonction ne vide pas les informations d’état d’annulation pour l’élément. Ces informations sont conservées afin que [ReactivateAndUndo](#reactivateandundo) puisse être utilisé ultérieurement pour exécuter une commande Undo dans l’application serveur, au cas où la commande Undo du conteneur serait choisie immédiatement après la désactivation de l’élément.

Pour plus d’informations, consultez [IOleInPlaceObject :: InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) dans le SDK Windows.

##  <a name="delete"></a>COleClientItem ::D supprim

Appelez cette fonction pour supprimer l’élément OLE du document conteneur.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Paramètres

*bAutoDelete*<br/>
Spécifie si l’élément doit être supprimé du document.

### <a name="remarks"></a>Notes

Cette fonction appelle la fonction membre [Release](#release) qui, à son tour, supprime C++ l’objet pour l’élément, en supprimant définitivement l’élément OLE du document. Si l’élément OLE est incorporé, les données natives de l’élément sont supprimées. Il ferme toujours un serveur en cours d’exécution ; par conséquent, si l’élément est un lien ouvert, cette fonction le ferme.

##  <a name="dodragdrop"></a>COleClientItem ::D oDragDrop

Appelez la fonction membre `DoDragDrop` pour effectuer une opération de glisser-déplacer.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Paramètres

*lpItemRect*<br/>
Rectangle de l’élément sur l’écran en coordonnées clientes (pixels).

*ptOffset*<br/>
Décalage à partir de *lpItemRect* où la position de la souris était au moment de l’opération glisser.

*bIncludeLink*<br/>
Affectez la valeur TRUE si les données de liaison doivent être copiées dans le presse-papiers. Affectez-lui la valeur FALSe si votre application serveur ne prend pas en charge les liens.

*dwEffects*<br/>
Détermine les effets que la source de glissement autorisera dans l’opération de glissement.

*lpRectStartDrag*<br/>
Pointeur vers le rectangle qui définit où le glissement commence réellement. Pour plus d'informations, consultez la section Notes qui suit.

### <a name="return-value"></a>Valeur de retour

Valeur DROPEFFECT. S’il est DROPEFFECT_MOVE, les données d’origine doivent être supprimées.

### <a name="remarks"></a>Notes

L’opération de glisser-déplacer ne démarre pas immédiatement. Elle attend que le curseur de la souris quitte le rectangle spécifié par *lpRectStartDrag* ou jusqu’à ce qu’un nombre spécifié de millisecondes soit écoulé. Si *lpRectStartDrag* a la valeur null, la taille du rectangle est d’un pixel.

Le délai est spécifié par un paramètre de clé de registre. Vous pouvez modifier le délai en appelant [CWinApp :: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) ou [CWinApp :: WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Si vous ne spécifiez pas de délai, une valeur par défaut de 200 millisecondes est utilisée. Le délai de glissement est stocké comme suit :

- Le délai de glissement de Windows NT est stocké dans HKEY_LOCAL_MACHINE \SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Le délai de glissement de Windows 3. x est stocké dans le fichier WIN. Fichier INI, sous la section [Windows}.

- Le délai de glissement de Windows 95/98 est stocké dans une version mise en cache de WIN. INI.

Pour plus d’informations sur la façon dont les informations sur les retards de glissement sont stockées dans le registre ou le. INI, consultez [WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) dans le SDK Windows.

##  <a name="doverb"></a>COleClientItem ::D oVerb

Appelez `DoVerb` pour exécuter le verbe spécifié.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Paramètres

*nVerb*<br/>
Spécifie le verbe à exécuter. Il peut inclure l’un des éléments suivants :

|Valeur|Signification|Symbole|
|-----------|-------------|------------|
|- 0|Primary (verbe)|OLEIVERB_PRIMARY|
|- 1|Verbe secondaire|(aucune)|
|- 1|Élément d’affichage pour modification|OLEIVERB_SHOW|
|- 2|Modifier l’élément dans une fenêtre distincte|OLEIVERB_OPEN|
|- 3|Masquer l’élément|OLEIVERB_HIDE|

La valeur-1 est généralement un alias pour un autre verbe. Si la modification ouverte n’est pas prise en charge,-2 a le même effet que-1. Pour obtenir des valeurs supplémentaires, consultez [IOleObject ::D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) dans le SDK Windows.

*pView*<br/>
Pointeur vers la fenêtre d’affichage ; Cela est utilisé par le serveur pour l’activation sur place. Ce paramètre doit avoir la valeur NULL si l’application conteneur n’autorise pas l’activation sur place.

*lpMsg*<br/>
Pointeur vers le message qui a provoqué l’activation de l’élément.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le verbe a été exécuté avec succès ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction appelle la fonction membre [Activate](#activate) pour exécuter le verbe. Il intercepte également les exceptions et affiche une boîte de message à l’utilisateur si une telle opération est levée.

Si le verbe principal est Edit et zéro est spécifié dans le paramètre *nVerb* , l’application serveur est lancée pour permettre la modification de l’élément OLE. Si l’application conteneur prend en charge l’activation sur place, la modification peut être effectuée sur place. Si le conteneur ne prend pas en charge l’activation sur place (ou si le verbe Open est spécifié), le serveur est lancé dans une fenêtre distincte et la modification peut être effectuée ici. En règle générale, lorsque l’utilisateur de l’application de conteneur double-clique sur l’élément OLE, la valeur du verbe principal dans le paramètre *nVerb* détermine l’action que l’utilisateur peut effectuer. Toutefois, si le serveur ne prend en charge qu’une seule action, il prend cette action, quelle que soit la valeur spécifiée dans le paramètre *nVerb* .

##  <a name="draw"></a>COleClientItem ::D RAW

Appelez cette fonction pour dessiner l’élément OLE dans le rectangle englobant spécifié à l’aide du contexte de périphérique spécifié.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Paramètres

*pDC*<br/>
Pointeur vers un objet [CDC](../../mfc/reference/cdc-class.md) utilisé pour dessiner l’élément OLE.

*lpBounds*<br/>
Pointeur vers un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou `RECT` structure qui définit le rectangle englobant dans lequel dessiner l’élément OLE (dans les unités logiques déterminées par le contexte de périphérique).

*nDrawAspect*<br/>
Spécifie l’aspect de l’élément OLE, c’est-à-dire la manière dont il doit être affiché. Si *nDrawAspect* a la valeur-1, le dernier jeu d’aspect à l’aide de [SetDrawAspect](#setdrawaspect) est utilisé. Pour plus d’informations sur les valeurs possibles de cet indicateur, consultez [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

La fonction peut utiliser la représentation du métafichier de l’élément OLE créé par la fonction membre [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) de `COleServerItem`.

En général, vous utilisez `Draw` pour l’affichage à l’écran, en passant le contexte de périphérique d’écran en tant que *contrôleur de domaine principal*. Dans ce cas, vous devez spécifier uniquement les deux premiers paramètres.

Le paramètre *lpBounds* identifie le rectangle dans le contexte de périphérique cible (par rapport à son mode de mappage actuel). Le rendu peut impliquer la mise à l’échelle de l’image et peut être utilisé par les applications de conteneur pour imposer une vue qui s’adapte à la vue affichée et à l’image finale imprimée.

Pour plus d’informations, consultez [IViewObject ::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) dans le SDK Windows.

##  <a name="getactiveview"></a>COleClientItem :: GetActiveView

Retourne la vue sur laquelle l’élément est activé sur place.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la vue ; Sinon, NULL si l’élément n’est pas activé sur place.

##  <a name="getcachedextent"></a>COleClientItem :: GetCachedExtent

Appelez cette fonction pour récupérer la taille de l’élément OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Paramètres

*lpSize*<br/>
Pointeur vers une structure `SIZE` ou un objet [CSize](../../atl-mfc-shared/reference/csize-class.md) qui recevra les informations de taille.

*nDrawAspect*<br/>
Spécifie l’aspect de l’élément OLE dont les limites doivent être récupérées. Pour connaître les valeurs possibles, consultez [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; 0 si l’élément OLE est vide.

### <a name="remarks"></a>Notes

Cette fonction fournit les mêmes informations que [GetExtent](#getextent). Toutefois, vous pouvez appeler `GetCachedExtent` pour recevoir des informations sur les extensions pendant le traitement d’autres gestionnaires OLE, tels que [OnChange](#onchange). Les dimensions sont en MM_HIMETRIC unités.

Cela est possible parce que `GetCachedExtent` utilise l’interface [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) au lieu d’utiliser l’interface [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject) pour connaître l’étendue de cet élément. L’objet COM `IViewObject2` met en cache les informations d’étendue utilisées dans l’appel précédent à [IViewObject ::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Pour plus d’informations, consultez [IViewObject2 :: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) dans le SDK Windows.

##  <a name="getclassid"></a>COleClientItem :: GetClassID

Retourne l’ID de classe de l’élément dans la mémoire vers laquelle pointe *pClassId*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Paramètres

*pClassID*<br/>
Pointeur vers un identificateur de type [CLSID](/windows/win32/com/clsid-key-hklm) pour récupérer l’ID de classe. Pour plus d’informations sur CLSID, consultez le SDK Windows.

### <a name="remarks"></a>Notes

L’ID de classe est un nombre 128 bits qui identifie de façon unique l’application qui modifie l’élément.

Pour plus d’informations, consultez [IPersist :: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) dans la SDK Windows.

##  <a name="getclipboarddata"></a>COleClientItem :: GetClipboardData

Appelez cette fonction pour obtenir un objet `COleDataSource` contenant toutes les données qui seraient placées dans le presse-papiers par un appel à la fonction membre [copytoclipboard](#copytoclipboard) .

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Paramètres

*pDataSource*<br/>
Pointeur vers un objet [COleDataSource](../../mfc/reference/coledatasource-class.md) qui recevra les données contenues dans l’élément OLE.

*bIncludeLink*<br/>
TRUE si les données de liaison doivent être incluses ; Sinon, FALSe.

*lpOffset*<br/>
Décalage du curseur de la souris par rapport à l’origine de l’objet, en pixels.

*lpSize*<br/>
Taille de l’objet en pixels.

### <a name="remarks"></a>Notes

`GetClipboardData` est appelée en tant qu’implémentation par défaut de [OnGetClipboardData](#ongetclipboarddata). Remplacez `OnGetClipboardData` uniquement si vous souhaitez offrir des formats de données en plus de ceux proposés par `CopyToClipboard`. Placez ces formats dans l’objet `COleDataSource` avant ou après l’appel de `CopyToClipboard`, puis passez l’objet `COleDataSource` à la fonction [COleDataSource :: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) . Par exemple, si vous souhaitez que la position de l’élément OLE dans son document de conteneur l’accompagne dans le presse-papiers, vous devez définir votre propre format pour transmettre ces informations et les placer dans le `COleDataSource` avant d’appeler `CopyToClipboard`.

##  <a name="getdocument"></a>COleClientItem :: GetDocument

Appelez cette fonction pour obtenir un pointeur vers le document qui contient l’élément OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers le document qui contient l’élément OLE. NULL si l’élément ne fait pas partie d’un document.

### <a name="remarks"></a>Notes

Ce pointeur autorise l’accès à l’objet `COleDocument` que vous avez passé comme argument au constructeur `COleClientItem`.

##  <a name="getdrawaspect"></a>COleClientItem :: GetDrawAspect

Appelez la fonction membre `GetDrawAspect` pour déterminer l’aspect ou la vue actuel de l’élément.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur de l’énumération DVASPECT, dont les valeurs sont répertoriées dans la référence pour [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Notes

L’aspect spécifie le mode de rendu de l’élément.

##  <a name="getextent"></a>COleClientItem :: GetExtent

Appelez cette fonction pour récupérer la taille de l’élément OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Paramètres

*lpSize*<br/>
Pointeur vers une structure `SIZE` ou un objet `CSize` qui recevra les informations de taille.

*nDrawAspect*<br/>
Spécifie l’aspect de l’élément OLE dont les limites doivent être récupérées. Pour connaître les valeurs possibles, consultez [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; 0 si l’élément OLE est vide.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la bibliothèque MFC (Microsoft Foundation Class), cette fonction provoque l’appel de la fonction membre [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) de l’objet `COleServerItem` correspondant. Notez que la taille Récupérée peut différer de la dernière taille définie par la [fonction membre à](#setextent) la fois. la taille spécifiée par `SetExtent` est traitée comme une suggestion. Les dimensions sont en MM_HIMETRIC unités.

> [!NOTE]
>  N’appelez pas `GetExtent` pendant le traitement d’un gestionnaire OLE, par exemple [OnChange](#onchange). Appelez [GetCachedExtent](#getcachedextent) à la place.

Pour plus d’informations, consultez [IOleObject :: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) dans le SDK Windows.

##  <a name="geticonfromregistry"></a>COleClientItem :: GetIconFromRegistry

Appelez cette fonction membre pour récupérer un handle vers une ressource icône associée au serveur d’un CLSID particulier.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Paramètres

*identificateur*<br/>
Référence au CLSID du serveur associé à l’icône.

### <a name="return-value"></a>Valeur de retour

Handle valide pour la ressource d’icône, ou NULL si l’icône du serveur ou une icône par défaut est introuvable.

### <a name="remarks"></a>Notes

Cette fonction membre ne démarre pas le serveur ou n’obtient pas dynamiquement une icône, même si le serveur est déjà en cours d’exécution. Au lieu de cela, cette fonction membre ouvre l’image exécutable du serveur et récupère l’icône statique associée au serveur telle qu’elle a été inscrite.

##  <a name="geticonicmetafile"></a>COleClientItem :: GetIconicMetafile

Récupère le métafichier utilisé pour dessiner l’icône de l’élément.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valeur de retour

Handle vers le métafichier en cas de réussite ; Sinon, NULL.

### <a name="remarks"></a>Notes

S’il n’y a pas d’icône actuelle, une icône par défaut est retournée. Cette méthode est appelée automatiquement par les boîtes de dialogue MFC/OLE et n’est généralement pas appelée directement.

Cette fonction appelle également [SetIconicMetafile](#seticonicmetafile) pour mettre en cache le métafichier en vue d’une utilisation ultérieure.

##  <a name="getinplacewindow"></a>COleClientItem :: GetInPlaceWindow

Appelez la fonction membre `GetInPlaceWindow` pour obtenir un pointeur vers la fenêtre dans laquelle l’élément a été ouvert pour la modification sur place.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers la fenêtre de modification sur place de l’élément ; NULL si l’élément n’est pas actif ou si son serveur n’est pas disponible.

### <a name="remarks"></a>Notes

Cette fonction doit être appelée uniquement pour les éléments qui sont actifs sur place.

##  <a name="getitemstate"></a>COleClientItem :: GetItemState

Appelez cette fonction pour récupérer l’état actuel de l’élément OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valeur de retour

`COleClientItem::ItemState` valeur énumérée, qui peut être l’une des suivantes : `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Pour plus d’informations sur ces États, consultez l’article [conteneurs : États du client-élément](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Notes

Pour être averti lorsque l’état de l’élément OLE change, utilisez la fonction membre [OnChange](#onchange) .

Pour plus d’informations, consultez l’article [conteneurs : clients-États des éléments](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>COleClientItem :: GetLastStatus

Retourne le code d’état de la dernière opération OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur SCODE.

### <a name="remarks"></a>Notes

Pour les fonctions membres qui retournent une valeur BOOLÉENNE FALSe, ou d’autres fonctions membres qui retournent NULL, `GetLastStatus` retourne des informations plus détaillées sur les échecs. N’oubliez pas que la plupart des fonctions membres OLE lèvent des exceptions pour les erreurs plus graves. Les informations spécifiques sur l’interprétation du SCODE dépendent de l’appel OLE sous-jacent qui a retourné une valeur SCODE.

Pour plus d’informations sur SCODE, consultez [structure of com Error Codes](/windows/win32/com/structure-of-com-error-codes) dans la documentation SDK Windows.

##  <a name="getlinkupdateoptions"></a>COleClientItem :: GetLinkUpdateOptions

Appelez cette fonction pour obtenir la valeur actuelle de l’option Link-Update pour l’élément OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valeur de retour

L’une des valeurs suivantes :

- OLEUPDATE_ALWAYS mettre à jour l’élément lié dans la mesure du possible. Cette option prend en charge la case d’option de mise à jour automatique des liaisons dans la boîte de dialogue liaisons.

- OLEUPDATE_ONCALL mettre à jour l’élément lié uniquement à la demande à partir de l’application conteneur (lorsque la fonction membre [UpdateLink](#updatelink) est appelée). Cette option prend en charge la case d’option liaison manuelle-mettre à jour dans la boîte de dialogue liaisons.

### <a name="remarks"></a>Notes

Il s’agit d’une opération avancée.

Cette fonction est appelée automatiquement par la classe [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Pour plus d’informations, consultez [IOleLink :: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) dans le SDK Windows.

##  <a name="gettype"></a>COleClientItem :: GetType

Appelez cette fonction pour déterminer si l’élément OLE est incorporé ou lié, ou statique.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valeur de retour

Entier non signé avec l’une des valeurs suivantes :

- OT_LINK l’élément OLE est un lien.

- OT_EMBEDDED l’élément OLE est incorporé.

- OT_STATIC l’élément OLE est statique, c’est-à-dire qu’il contient uniquement des données de présentation, et non des données natives, et ne peut donc pas être modifié.

##  <a name="getusertype"></a>COleClientItem :: GetUserType

Appelez cette fonction pour récupérer la chaîne visible par l’utilisateur décrivant le type de l’élément OLE, par exemple « document Word ».

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Paramètres

*nUserClassType*<br/>
Valeur indiquant la variante souhaitée de la chaîne qui décrit le type de l’élément OLE. Il peut s’agir de l’une des valeurs suivantes :

- USERCLASSTYPE_FULL le nom de type complet affiché à l’utilisateur.

- USERCLASSTYPE_SHORT un nom abrégé (15 caractères maximum) à utiliser dans les menus contextuels et dans la boîte de dialogue Modifier les liens.

- USERCLASSTYPE_APPNAME nom de l’application qui dessert la classe.

*rString*<br/>
Référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) dans lequel la chaîne décrivant le type de l’élément OLE doit être retournée.

### <a name="remarks"></a>Notes

Il s’agit souvent de l’entrée de la base de données d’inscription du système.

Si le nom de type complet est demandé mais pas disponible, le nom abrégé est utilisé à la place. Si aucune entrée n’est trouvée pour le type d’élément OLE dans la base de données d’inscription, ou si aucun type d’utilisateur n’est inscrit pour le type d’élément OLE, le type d’utilisateur actuellement stocké dans l’élément OLE est utilisé. Si le nom de ce type d’utilisateur est une chaîne vide, l’expression « objet inconnu » est utilisée.

Pour plus d’informations, consultez [IOleObject :: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) dans le SDK Windows.

##  <a name="isinplaceactive"></a>COleClientItem :: IsInPlaceActive

Appelez cette fonction pour voir si l’élément OLE est actif sur place.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’élément OLE est actif sur place ; Sinon, 0.

### <a name="remarks"></a>Notes

Il est courant d’exécuter une logique différente selon que l’élément est en cours de modification ou non. La fonction vérifie si l’état actuel de l’élément est égal à la `activeState` ou à la `activeUIState`.

##  <a name="islinkuptodate"></a>COleClientItem :: IsLinkUpToDate

Appelez cette fonction pour voir si l’élément OLE est à jour.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’élément OLE est à jour ; Sinon, 0.

### <a name="remarks"></a>Notes

Un élément lié peut être obsolète si son document source a été mis à jour. Un élément incorporé qui contient des liens dans celui-ci peut être mis à jour de la même façon. La fonction effectue une vérification récursive de l’élément OLE. Notez que le fait de déterminer si un élément OLE est obsolète peut être aussi coûteux que l’exécution d’une mise à jour.

Cette méthode est appelée automatiquement par l’implémentation de [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) .

Pour plus d’informations, consultez [IOleObject :: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) dans le SDK Windows.

##  <a name="ismodified"></a>COleClientItem :: IsModified

Appelez cette fonction pour voir si l’élément OLE a été modifié (modifié depuis son dernier enregistrement).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro si l’élément OLE est modifié ; Sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [IPersistStorage :: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) dans le SDK Windows.

##  <a name="isopen"></a>COleClientItem :: IsOpen

Appelez cette fonction pour voir si l’élément OLE est ouvert ; autrement dit, ouvert dans une instance de l’application serveur s’exécutant dans une fenêtre distincte.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’élément OLE est ouvert ; Sinon, 0.

### <a name="remarks"></a>Notes

Il est utilisé pour déterminer quand dessiner l’objet avec un modèle de hachurage. Un objet ouvert doit avoir un motif hachuré dessiné au-dessus de l’objet. Pour ce faire, vous pouvez utiliser un objet [CRectTracker](../../mfc/reference/crecttracker-class.md) .

##  <a name="isrunning"></a>COleClientItem :: IsRunning

Appelez cette fonction pour voir si l’élément OLE est en cours d’exécution ; autrement dit, si l’élément est chargé et en cours d’exécution dans l’application serveur.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’élément OLE est en cours d’exécution ; Sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) dans le SDK Windows.

##  <a name="onactivate"></a>COleClientItem :: OnActivate

Appelé par l’infrastructure pour avertir l’élément qu’il vient d’être activé sur place.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Notes

Notez que cette fonction est appelée pour indiquer que le serveur est en cours d’exécution, et non pour indiquer que son interface utilisateur a été installée dans l’application conteneur. À ce stade, l’objet n’a pas d’interface utilisateur active (n’est pas `activeUIState`). Elle n’a pas installé ses menus ou sa barre d’outils. La fonction membre [OnActivateUI](#onactivateui) est appelée quand cela se produit.

L’implémentation par défaut appelle la fonction membre [OnChange](#onchange) avec OLE_CHANGEDSTATE comme paramètre. Substituez cette fonction pour effectuer un traitement personnalisé lorsqu’un élément devient actif sur place.

##  <a name="onactivateui"></a>COleClientItem :: OnActivateUI

Le Framework appelle `OnActivateUI` lorsque l’objet est entré dans l’état d’interface utilisateur actif.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Notes

L’objet a maintenant installé ses menus et barres d’outils.

L’implémentation par défaut mémorise le HWND du serveur pour les appels `GetServerWindow` ultérieurs.

##  <a name="onchange"></a>COleClientItem :: OnChange

Appelée par l’infrastructure lorsque l’utilisateur modifie, enregistre ou ferme l’élément OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Paramètres

*nCode*<br/>
Raison pour laquelle le serveur a modifié cet élément. Il peut prendre l’une des valeurs suivantes :

- OLE_CHANGED l’apparence de l’élément OLE a changé.

- OLE_SAVED l’élément OLE a été enregistré.

- OLE_CLOSED l’élément OLE a été fermé.

- OLE_CHANGED_STATE l’élément OLE est passé d’un État à un autre.

*dwParam*<br/>
Si *nCode* est OLE_SAVED ou OLE_CLOSED, ce paramètre n’est pas utilisé. Si *nCode* est OLE_CHANGED, ce paramètre spécifie l’aspect de l’élément OLE qui a changé. Pour connaître les valeurs possibles, consultez le paramètre *dwParam* de [COleClientItem ::D RAW](#draw). Si *nCode* est OLE_CHANGED_STATE, ce paramètre est une `COleClientItem::ItemState` valeur énumérée et décrit l’État entré. Il peut prendre l’une des valeurs suivantes : `emptyState`, `loadedState`, `openState`, `activeState`ou `activeUIState`.

### <a name="remarks"></a>Notes

(Si l’application serveur est écrite à l’aide de la bibliothèque MFC (Microsoft Foundation Class), cette fonction est appelée en réponse aux fonctions membres `Notify` de `COleServerDoc` ou `COleServerItem`.) L’implémentation par défaut marque le document conteneur comme modifié si *nCode* est OLE_CHANGED ou OLE_SAVED.

Pour OLE_CHANGED_STATE, l’état actuel retourné par [GetItemState](#getitemstate) sera toujours l’ancien État, ce qui signifie que l’État qui était actif avant ce changement d’État.

Substituez cette fonction pour répondre aux modifications de l’état de l’élément OLE. En général, vous mettez à jour l’apparence de l’élément en invalidant la zone dans laquelle l’élément est affiché. Appelez l’implémentation de la classe de base au début de votre remplacement.

##  <a name="onchangeitemposition"></a>COleClientItem :: OnChangeItemPosition

Appelée par l’infrastructure pour notifier au conteneur que l’étendue de l’élément OLE a été modifiée pendant l’activation sur place.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Paramètres

*rectPos*<br/>
Indique la position de l’élément par rapport à la zone cliente de l’application conteneur.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la position de l’élément est modifiée avec succès ; Sinon, 0.

### <a name="remarks"></a>Notes

L’implémentation par défaut détermine le nouveau rectangle visible de l’élément OLE et appelle [SetItemRects](#setitemrects) avec les nouvelles valeurs. L’implémentation par défaut calcule le rectangle visible pour l’élément et transmet ces informations au serveur.

Substituez cette fonction pour appliquer des règles spéciales à l’opération de redimensionnement/déplacement. Si l’application est écrite en MFC, cet appel se produit parce que le serveur appelé [COleServerDoc :: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>COleClientItem :: OnDeactivate

Appelée par l’infrastructure lorsque l’élément OLE passe de l’état actif sur place (`activeState`) à l’État chargé, ce qui signifie qu’il est désactivé après une activation sur place.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Notes

Notez que cette fonction est appelée pour indiquer que l’élément OLE est fermé, et non que son interface utilisateur a été supprimée de l’application conteneur. Lorsque cela se produit, la fonction membre [OnDeactivateUI](#ondeactivateui) est appelée.

L’implémentation par défaut appelle la fonction membre [OnChange](#onchange) avec OLE_CHANGEDSTATE comme paramètre. Substituez cette fonction pour effectuer un traitement personnalisé lorsqu’un élément actif sur place est désactivé. Par exemple, si vous prenez en charge la commande Annuler dans votre application conteneur, vous pouvez remplacer cette fonction pour ignorer l’état d’annulation, ce qui indique que la dernière opération effectuée sur l’élément OLE ne peut pas être annulée une fois que l’élément est désactivé.

##  <a name="ondeactivateandundo"></a>COleClientItem :: OnDeactivateAndUndo

Appelée par l’infrastructure lorsque l’utilisateur appelle la commande Annuler après l’activation de l’élément OLE sur place.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Notes

L’implémentation par défaut appelle [DeactivateUI](#deactivateui) pour désactiver l’interface utilisateur du serveur. Remplacez cette fonction si vous implémentez la commande Annuler dans votre application conteneur. Dans votre remplacement, appelez la version de la classe de base de la fonction, puis annulez la dernière commande exécutée dans votre application.

Pour plus d’informations, consultez [IOleInPlaceSite ::D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) dans le SDK Windows.

##  <a name="ondeactivateui"></a>COleClientItem :: OnDeactivateUI

Appelé lorsque l’utilisateur désactive un élément qui a été activé sur place.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Paramètres

*bUndoable*<br/>
Spécifie si les modifications de modification peuvent être annulées.

### <a name="remarks"></a>Notes

Cette fonction restaure l’état d’origine de l’interface utilisateur de l’application conteneur, en masquant les menus et les autres contrôles qui ont été créés pour l’activation sur place.

Si *bUndoable* a la valeur false, le conteneur doit désactiver la commande Annuler, en ignorant l’état d’annulation du conteneur, car il indique que la dernière opération effectuée par le serveur ne peut pas être annulée.

##  <a name="ondiscardundostate"></a>COleClientItem :: OnDiscardUndoState

Appelée par l’infrastructure lorsque l’utilisateur effectue une action qui ignore l’état d’annulation lors de la modification de l’élément OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Notes

L'implémentation par défaut n'exécute aucune opération. Remplacez cette fonction si vous implémentez la commande Annuler dans votre application conteneur. Dans votre remplacement, ignorez l’état d’annulation de l’application conteneur.

Si le serveur a été écrit avec le bibliothèque MFC (Microsoft Foundation Class), le serveur peut faire en sorte que cette fonction soit appelée en appelant [COleServerDoc ::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Pour plus d’informations, consultez [IOleInPlaceSite ::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) dans le SDK Windows.

##  <a name="ongetclipboarddata"></a>COleClientItem :: OnGetClipboardData

Appelée par l’infrastructure pour obtenir un objet `COleDataSource` contenant toutes les données qui seraient placées dans le presse-papiers par un appel à la fonction membre [copytoclipboard](#copytoclipboard) ou [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Paramètres

*bIncludeLink*<br/>
Affectez la valeur TRUE si les données de liaison doivent être copiées dans le presse-papiers. Affectez la valeur FALSe si votre application serveur ne prend pas en charge les liens.

*lpOffset*<br/>
Pointeur vers le décalage du curseur de la souris à partir de l’origine de l’objet, en pixels.

*lpSize*<br/>
Pointeur vers la taille de l’objet en pixels.

### <a name="return-value"></a>Valeur de retour

Pointeur vers un objet [COleDataSource](../../mfc/reference/coledatasource-class.md) contenant les données du presse-papiers.

### <a name="remarks"></a>Notes

L’implémentation par défaut de cette fonction appelle [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>COleClientItem :: OnGetClipRect

Le Framework appelle la fonction membre `OnGetClipRect` pour récupérer les coordonnées du rectangle de découpage de l’élément qui est modifié sur place.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Paramètres

*rClipRect*<br/>
Pointeur vers un objet de classe [CRect](../../atl-mfc-shared/reference/crect-class.md) qui contiendra les coordonnées du rectangle de découpage de l’élément.

### <a name="remarks"></a>Notes

Les coordonnées sont exprimées en pixels par rapport à la zone cliente de la fenêtre d’application du conteneur.

L’implémentation par défaut retourne simplement le rectangle client de la vue sur laquelle l’élément est actif sur place.

##  <a name="ongetitemposition"></a>COleClientItem :: OnGetItemPosition

Le Framework appelle la fonction membre `OnGetItemPosition` pour récupérer les coordonnées de l’élément qui est modifié sur place.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Paramètres

*rPosition*<br/>
Référence à l’objet [CRect](../../atl-mfc-shared/reference/crect-class.md) qui contiendra les coordonnées de position de l’élément.

### <a name="remarks"></a>Notes

Les coordonnées sont exprimées en pixels par rapport à la zone cliente de la fenêtre d’application du conteneur.

L’implémentation par défaut de cette fonction est sans effet. Les applications qui prennent en charge la modification sur place nécessitent son implémentation.

##  <a name="ongetwindowcontext"></a>COleClientItem :: OnGetWindowContext

Appelé par le Framework lorsqu’un élément est activé sur place.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Paramètres

*ppMainFrame*<br/>
Pointeur vers un pointeur vers la fenêtre frame principale.

*ppDocFrame*<br/>
Pointeur vers un pointeur vers la fenêtre frame de document.

*lpFrameInfo*<br/>
Pointeur vers une structure [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) qui recevra les informations de fenêtre frame.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction permet de récupérer des informations sur la fenêtre parente de l’élément OLE.

Si le conteneur est une application MDI, l’implémentation par défaut retourne un pointeur vers l’objet [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) dans *ppMainFrame* et un pointeur vers l’objet [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) actif dans *ppDocFrame*. Si le conteneur est une application SDI, l’implémentation par défaut retourne un pointeur vers l’objet [CFrameWnd](../../mfc/reference/cframewnd-class.md) dans *ppMainFrame* et retourne la valeur null dans *ppDocFrame*. L’implémentation par défaut remplit également les membres de *lpFrameInfo*.

Substituez cette fonction uniquement si l’implémentation par défaut ne correspond pas à votre application. par exemple, si votre application possède un paradigme d’interface utilisateur qui diffère de SDI ou MDI. Il s’agit d’un substituable avancé.

Pour plus d’informations, consultez [IOleInPlaceSite :: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) et la structure [OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) dans le SDK Windows.

##  <a name="oninsertmenus"></a>COleClientItem :: OnInsertMenus

Appelée par l’infrastructure lors de l’activation sur place pour insérer les menus de l’application conteneur dans un menu vide.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Pointe vers un menu vide.

*lpMenuWidths*<br/>
Pointe vers un tableau de six valeurs longues indiquant le nombre de menus dans chacun des groupes de menus suivants : fichier, modifier, conteneur, objet, fenêtre, aide. L’application de conteneur est responsable des groupes de fichiers, de conteneurs et de menus de fenêtre, correspondant aux éléments 0, 2 et 4 de ce tableau.

### <a name="remarks"></a>Notes

Ce menu est ensuite transmis au serveur, qui insère ses propres menus, créant ainsi un menu composite. Cette fonction peut être appelée à plusieurs reprises pour générer plusieurs menus composites.

L’implémentation par défaut insère dans *pMenuShared* les menus conteneurs sur place ; autrement dit, les groupes de menus fichier, conteneur et fenêtre. [CDocTemplate :: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) est utilisé pour définir cette ressource de menu. L’implémentation par défaut assigne également les valeurs appropriées aux éléments 0, 2 et 4 dans *lpMenuWidths*, en fonction de la ressource de menu. Substituez cette fonction si l’implémentation par défaut n’est pas appropriée pour votre application ; par exemple, si votre application n’utilise pas de modèles de document pour associer des ressources à des types de documents. Si vous remplacez cette fonction, vous devez également remplacer [OnSetMenu](#onsetmenu) et [OnRemoveMenus](#onremovemenus). Il s’agit d’un substituable avancé.

Pour plus d’informations, consultez [IOleInPlaceFrame :: InsertMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) dans la SDK Windows.

##  <a name="onremovemenus"></a>COleClientItem :: OnRemoveMenus

Appelé par l’infrastructure pour supprimer les menus du conteneur du menu composite spécifié lorsque l’activation sur place se termine.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Pointe vers le menu composite construit par les appels à la fonction membre [OnInsertMenus](#oninsertmenus) .

### <a name="remarks"></a>Notes

L’implémentation par défaut supprime de *pMenuShared* les menus de conteneurs sur place, autrement dit, les groupes de fichiers, de conteneurs et de menus de fenêtre. Substituez cette fonction si l’implémentation par défaut n’est pas appropriée pour votre application ; par exemple, si votre application n’utilise pas de modèles de document pour associer des ressources à des types de documents. Si vous remplacez cette fonction, vous devez probablement remplacer [OnInsertMenus](#oninsertmenus) et [OnSetMenu](#onsetmenu) . Il s’agit d’un substituable avancé.

Les sous-menus de *pMenuShared* peuvent être partagés par plusieurs menus composites si le serveur est appelé à plusieurs reprises `OnInsertMenus`. Par conséquent, vous ne devez pas supprimer les sous-menus de votre remplacement de `OnRemoveMenus`; vous devez uniquement les détacher.

Pour plus d’informations, consultez [IOleInPlaceFrame :: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) dans la SDK Windows.

##  <a name="onscrollby"></a>COleClientItem :: OnScrollBy

Appelé par l’infrastructure pour faire défiler l’élément OLE en réponse aux demandes du serveur.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Paramètres

*sizeExtent*<br/>
Spécifie les distances, en pixels, à faire défiler dans les directions x et y.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’élément a fait l’objet d’un défilement ; 0 si l’élément n’a pas pu faire l’objet d’un défilement.

### <a name="remarks"></a>Notes

Par exemple, si l’élément OLE est partiellement visible et que l’utilisateur se déplace hors de la zone visible tout en effectuant une modification sur place, cette fonction est appelée pour garder le curseur visible. L'implémentation par défaut n'exécute aucune opération. Substituez cette fonction pour faire défiler l’élément de la quantité spécifiée. Notez que, à la suite du défilement, la partie visible de l’élément OLE peut changer. Appelez [SetItemRects](#setitemrects) pour mettre à jour le rectangle visible de l’élément.

Pour plus d’informations, consultez [IOleInPlaceSite :: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) dans le SDK Windows.

##  <a name="onsetmenu"></a>COleClientItem :: OnSetMenu

Appelé par le Framework deux fois lorsque l’activation sur place commence et se termine ; la première fois que vous installez le menu composite et la deuxième fois (avec *holemenu* égal à null) pour le supprimer.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Paramètres

*pMenuShared*<br/>
Pointeur vers le menu composite construit par les appels à la fonction membre [OnInsertMenus](#oninsertmenus) et à la fonction `InsertMenu`.

*holemenu*<br/>
Handle sur le descripteur de menu retourné par la fonction `OleCreateMenuDescriptor`, ou valeur NULL si le code de distribution doit être supprimé.

*hwndActiveObject*<br/>
Handle vers la fenêtre d’édition de l’élément OLE. Il s’agit de la fenêtre qui recevra les commandes de modification d’OLE.

### <a name="remarks"></a>Notes

L’implémentation par défaut installe ou supprime le menu composite, puis appelle la fonction [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) pour installer ou supprimer le code de distribution. Substituez cette fonction si l’implémentation par défaut n’est pas appropriée pour votre application. Si vous remplacez cette fonction, vous devez probablement remplacer [OnInsertMenus](#oninsertmenus) et [OnRemoveMenus](#onremovemenus) . Il s’agit d’un substituable avancé.

Pour plus d’informations, consultez [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)et [IOleInPlaceFrame :: SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) dans la SDK Windows.

##  <a name="onshowcontrolbars"></a>COleClientItem :: OnShowControlBars

Appelé par le Framework pour afficher et masquer les barres de contrôle de l’application conteneur.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Paramètres

*pFrameWnd*<br/>
Pointeur vers la fenêtre frame de l’application conteneur. Il peut s’agir d’une fenêtre frame principale ou d’une fenêtre enfant MDI.

*bShow*<br/>
Spécifie si les barres de contrôle doivent être affichées ou masquées.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’appel de fonction entraîne une modification de l’état des barres de contrôle ; 0 si l’appel n’entraîne aucune modification ou si *pFrameWnd* ne pointe pas vers la fenêtre frame du conteneur.

### <a name="remarks"></a>Notes

Cette fonction retourne 0 si les barres de contrôle sont déjà dans l’état spécifié par *bShow.* Cela se produit, par exemple, si les barres de contrôle sont masquées et *bShow* a la valeur false.

L’implémentation par défaut supprime la barre d’outils de la fenêtre frame de niveau supérieur.

##  <a name="onshowitem"></a>COleClientItem :: OnShowItem

Appelée par l’infrastructure pour afficher l’élément OLE, ce qui le rend totalement visible pendant la modification.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Notes

Il est utilisé lorsque votre application conteneur prend en charge les liens vers des éléments incorporés (autrement dit, si vous avez dérivé votre classe de document à partir de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Cette fonction est appelée pendant l’activation sur place ou lorsque l’élément OLE est une source de liaison et que l’utilisateur souhaite le modifier. L’implémentation par défaut active la première vue sur le document conteneur. Substituez cette fonction pour faire défiler le document afin que l’élément OLE soit visible.

##  <a name="onupdateframetitle"></a>COleClientItem :: OnUpdateFrameTitle

Appelé par l’infrastructure lors de l’activation sur place pour mettre à jour la barre de titre de la fenêtre frame.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si cette fonction a correctement mis à jour le titre du frame, sinon zéro.

### <a name="remarks"></a>Notes

L’implémentation par défaut ne change pas le titre de la fenêtre frame. Remplacez cette fonction si vous souhaitez obtenir un autre titre de cadre pour votre application, par exemple « l' *application serveur* - *élément* dans *docname*» (comme dans, «Microsoft Excel-feuille de calcul dans le rapport. DOC»). Il s’agit d’un substituable avancé.

##  <a name="reactivateandundo"></a>COleClientItem :: ReactivateAndUndo

Appelez cette fonction pour réactiver l’élément OLE et annuler la dernière opération effectuée par l’utilisateur pendant la modification sur place.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Si votre application conteneur prend en charge la commande Annuler, appelez cette fonction si l’utilisateur choisit la commande annuler immédiatement après la désactivation de l’élément OLE.

Si l’application serveur est écrite avec les bibliothèques MFC (Microsoft Foundation Class), cette fonction force le serveur à appeler [COleServerDoc :: OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Pour plus d’informations, consultez [IOleInPlaceObject :: ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) dans le SDK Windows.

##  <a name="release"></a>COleClientItem :: Release

Appelez cette fonction pour nettoyer les ressources utilisées par l’élément OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Paramètres

*dwCloseOption*<br/>
Indicateur spécifiant dans quelles circonstances l’élément OLE est enregistré lorsqu’il revient à l’État chargé. Pour obtenir la liste des valeurs possibles, consultez [COleClientItem :: Close](#close).

### <a name="remarks"></a>Notes

`Release` est appelé par le destructeur `COleClientItem`.

Pour plus d’informations, consultez [IUnknown :: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) dans le SDK Windows.

##  <a name="reload"></a>COleClientItem :: Reload

Ferme et recharge l’élément.

```
BOOL Reload();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Appelez la fonction `Reload` après l’activation de l’élément en tant qu’élément d’un autre type par un appel à [activatas](#activateas).

##  <a name="run"></a>COleClientItem :: Run

Exécute l’application associée à cet élément.

```
void Run();
```

### <a name="remarks"></a>Notes

Appelez la fonction membre `Run` pour lancer l’application serveur avant d’activer l’élément. Cette opération est effectuée automatiquement par [Activate](#activate) et [DoVerb](#doverb), donc il n’est généralement pas nécessaire d’appeler cette fonction. Appelez cette fonction s’il est nécessaire d’exécuter le serveur afin de définir un attribut d' [élément, tel que](#setextent)sesenser, avant d’exécuter [DoVerb](#doverb).

##  <a name="setdrawaspect"></a>COleClientItem :: SetDrawAspect

Appelez la fonction membre `SetDrawAspect` pour définir l' « aspect » ou l’affichage de l’élément.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Paramètres

*nDrawAspect*<br/>
Valeur de l’énumération DVASPECT. Ce paramètre peut prendre l'une des valeurs suivantes :

- DVASPECT_CONTENT élément est représenté de façon à ce qu’il puisse être affiché sous la forme d’un objet incorporé à l’intérieur de son conteneur.

- DVASPECT_THUMBNAIL élément est rendu dans une représentation « miniature » afin qu’il puisse être affiché dans un outil de navigation.

- DVASPECT_ICON élément est représenté par une icône.

- DVASPECT_DOCPRINT élément est représenté comme s’il avait été imprimé à l’aide de la commande Imprimer du menu fichier.

### <a name="remarks"></a>Notes

L’aspect spécifie le mode de rendu de l’élément en [dessin](#draw) lorsque la valeur par défaut de l’argument *nDrawAspect* de cette fonction est utilisée.

Cette fonction est appelée automatiquement par l’icône de modification (et d’autres boîtes de dialogue qui appellent directement la boîte de dialogue changer d’icône) pour activer l’aspect de l’affichage sous forme lorsque l’utilisateur le demande.

##  <a name="setextent"></a>COleClientItem :: setraverste

Appelez cette fonction pour spécifier la quantité d’espace disponible pour l’élément OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Paramètres

*size*<br/>
Objet [CSize](../../atl-mfc-shared/reference/csize-class.md) qui contient les informations sur la taille.

*nDrawAspect*<br/>
Spécifie l’aspect de l’élément OLE dont les limites doivent être définies. Pour connaître les valeurs possibles, consultez [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la bibliothèque MFC (Microsoft Foundation Class), cela entraîne l’appel de la fonction membre [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) de l’objet `COleServerItem` correspondant. L’élément OLE peut ensuite ajuster son affichage en conséquence. Les dimensions doivent être en MM_HIMETRIC unités. Appelez cette fonction lorsque l’utilisateur redimensionne l’élément OLE ou si vous prenez en charge une certaine forme de négociation de mise en page.

Pour plus d’informations, consultez [IOleObject ::](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) seversion dans la SDK Windows.

##  <a name="sethostnames"></a>COleClientItem :: SetHostNames

Appelez cette fonction pour spécifier le nom de l’application conteneur et le nom du conteneur pour un élément OLE incorporé.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Paramètres

*lpszHost*<br/>
Pointeur vers le nom visible par l’utilisateur de l’application conteneur.

*lpszHostObj*<br/>
Pointeur vers une chaîne d’identification du conteneur qui contient l’élément OLE.

### <a name="remarks"></a>Notes

Si l’application serveur a été écrite à l’aide de la bibliothèque MFC (Microsoft Foundation Class), cette fonction appelle la fonction membre [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) du document `COleServerDoc` qui contient l’élément OLE. Ces informations sont utilisées dans les titres de fenêtre lorsque l’élément OLE est en cours de modification. Chaque fois qu’un document conteneur est chargé, l’infrastructure appelle cette fonction pour tous les éléments OLE dans le document. `SetHostNames` s’applique uniquement aux éléments incorporés. Il n’est pas nécessaire d’appeler cette fonction chaque fois qu’un élément OLE incorporé est activé pour modification.

Elle est également appelée automatiquement avec le nom de l’application et le nom du document lorsqu’un objet est chargé ou lorsqu’un fichier est enregistré sous un nom différent. En conséquence, il n’est généralement pas nécessaire d’appeler cette fonction directement.

Pour plus d’informations, consultez [IOleObject :: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) dans le SDK Windows.

##  <a name="seticonicmetafile"></a>COleClientItem :: SetIconicMetafile

Met en cache le métafichier utilisé pour dessiner l’icône de l’élément.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Paramètres

*hMetaPict*<br/>
Handle du métafichier utilisé pour dessiner l’icône de l’élément.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez [GetIconicMetafile](#geticonicmetafile) pour récupérer le métafichier.

Le paramètre *hMetaPict* est copié dans l’élément ; par conséquent, *hMetaPict* doit être libéré par l’appelant.

##  <a name="setitemrects"></a>COleClientItem :: SetItemRects

Appelez cette fonction pour définir le rectangle englobant ou le rectangle visible de l’élément OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Paramètres

*lprcPosRect*<br/>
Pointeur vers le rectangle contenant les limites de l’élément OLE par rapport à sa fenêtre parente, dans les coordonnées clientes.

*lprcClipRect*<br/>
Pointeur vers le rectangle contenant les limites de la partie visible de l’élément OLE par rapport à sa fenêtre parente, dans les coordonnées clientes.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction est appelée par l’implémentation par défaut de la fonction membre [OnChangeItemPosition](#onchangeitemposition) . Vous devez appeler cette fonction chaque fois que la partie position ou visible de l’élément OLE change. Cela signifie généralement que vous l’appelez à partir des fonctions membres [OnSize](../../mfc/reference/cwnd-class.md#onsize) et [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) de votre vue.

Pour plus d’informations, consultez [IOleInPlaceObject :: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) dans le SDK Windows.

##  <a name="setlinkupdateoptions"></a>COleClientItem :: SetLinkUpdateOptions

Appelez cette fonction pour définir l’option Link-Update pour la présentation de l’élément lié spécifié.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Paramètres

*dwUpdateOpt*<br/>
Valeur de l’option Link-Update pour cet élément. Cette valeur doit être l’une des suivantes :

- OLEUPDATE_ALWAYS mettre à jour l’élément lié dans la mesure du possible. Cette option prend en charge la case d’option de mise à jour automatique des liaisons dans la boîte de dialogue liaisons.

- OLEUPDATE_ONCALL mettre à jour l’élément lié uniquement à la demande à partir de l’application conteneur (lorsque la fonction membre [UpdateLink](#updatelink) est appelée). Cette option prend en charge la case d’option liaison manuelle-mettre à jour dans la boîte de dialogue liaisons.

### <a name="remarks"></a>Notes

En règle générale, vous ne devez pas modifier les options de mise à jour choisies par l’utilisateur dans la boîte de dialogue liaisons.

Pour plus d’informations, consultez [IOleLink :: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) dans le SDK Windows.

##  <a name="setprintdevice"></a>COleClientItem :: SetPrintDevice

Appelez cette fonction pour modifier l’appareil cible d’impression pour cet élément.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Paramètres

*PTD*<br/>
Pointeur vers une structure de données [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , qui contient des informations sur le nouvel appareil cible d’impression. Sa valeur peut être NULL.

*fournis*<br/>
Pointeur vers une structure de données [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) , qui contient des informations sur le nouvel appareil cible d’impression. Sa valeur peut être NULL.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la fonction a réussi ; Sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction met à jour l’appareil cible d’impression pour l’élément, mais n’actualise pas le cache de présentation. Pour mettre à jour le cache de présentation d’un élément, appelez [UpdateLink](#updatelink).

Les arguments de cette fonction contiennent des informations que le système OLE utilise pour identifier l’appareil cible. La structure `PRINTDLG` contient des informations que Windows utilise pour initialiser la boîte de dialogue d’impression courante. Une fois que l’utilisateur a fermé la boîte de dialogue, Windows retourne des informations sur les sélections de l’utilisateur dans cette structure. Le membre `m_pd` d’un objet [CPrintDialog](../../mfc/reference/cprintdialog-class.md) est une structure `PRINTDLG`.

Pour plus d’informations sur cette structure, consultez [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) dans le SDK Windows.

Pour plus d’informations, consultez [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) dans le SDK Windows.

##  <a name="updatelink"></a>COleClientItem :: UpdateLink

Appelez cette fonction pour mettre à jour immédiatement les données de présentation de l’élément OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro en cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Pour les éléments liés, la fonction recherche la source de la liaison pour obtenir une nouvelle présentation pour l’élément OLE. Ce processus peut impliquer l’exécution d’une ou plusieurs applications serveur, ce qui peut prendre du temps. Pour les éléments incorporés, la fonction fonctionne de manière récursive, en vérifiant si l’élément incorporé contient des liens qui peuvent être obsolètes et les mettre à jour. L’utilisateur peut également mettre à jour manuellement des liens individuels à l’aide de la boîte de dialogue liaisons.

Pour plus d’informations, consultez [IOleLink :: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) dans le SDK Windows.

## <a name="see-also"></a>Voir aussi

[Exemple MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Exemple MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem, classe](../../mfc/reference/cdocitem-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem, classe](../../mfc/reference/coleserveritem-class.md)
