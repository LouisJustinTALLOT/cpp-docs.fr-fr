---
title: CRichEditCtrl (classe)
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: fc2b4c08b5a999f0369199e0dd65a09a7cdf8dff
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/15/2019
ms.locfileid: "69503149"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl (classe)

Fournit les fonctionnalités du contrôle d'édition enrichi.

## <a name="syntax"></a>Syntaxe

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|Construit un objet `CRichEditCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CRichEditCtrl::CanPaste](#canpaste)|Détermine si le contenu du presse-papiers peut être collé dans ce contrôle RichEdit.|
|[CRichEditCtrl::CanRedo](#canredo)|Détermine s’il existe des actions dans la file d’attente de restauration par progression du contrôle.|
|[CRichEditCtrl::CanUndo](#canundo)|Détermine si une opération de modification peut être annulée.|
|[CRichEditCtrl::CharFromPos](#charfrompos)|Récupère des informations sur le caractère le plus proche d’un point spécifié dans la zone cliente d’un contrôle d’édition.|
|[CRichEditCtrl::Clear](#clear)|Efface la sélection actuelle.|
|[CRichEditCtrl::Copy](#copy)|Copie la sélection actuelle dans le presse-papiers.|
|[CRichEditCtrl::Create](#create)|Crée le contrôle Rich Edit Windows et l’associe à `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::CreateEx](#createex)|Crée le contrôle Rich Edit Windows avec les styles Windows étendus spécifiés et l’associe à cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::Cut](#cut)|Coupe la sélection actuelle dans le presse-papiers.|
|[CRichEditCtrl::DisplayBand](#displayband)|Affiche une partie du contenu de cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|Réinitialise (efface) l’indicateur d’annulation de cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::FindText](#findtext)|Localise le texte dans `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|Recherche la prochaine césure de mot avant ou après la position de caractère spécifiée, ou récupère des informations sur le caractère à cette position.|
|[CRichEditCtrl::FormatRange](#formatrange)|Met en forme une plage de texte pour le périphérique de sortie cible.|
|[CRichEditCtrl::GetCharPos](#getcharpos)|Détermine l’emplacement d’un caractère donné dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|Récupère les attributs de mise en forme de caractères par défaut `CRichEditCtrl` actuels dans cet objet.|
|[CRichEditCtrl::GetEventMask](#geteventmask)|Récupère le masque d’événement pour cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|Détermine la ligne la plus visible dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|Récupère un pointeur vers l' `IRichEditOle` interface pour ce contrôle RichEdit.|
|[CRichEditCtrl::GetLimitText](#getlimittext)|Obtient la limite de la quantité de texte qu’un utilisateur peut entrer dans `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::GetLine](#getline)|Récupère une ligne de texte à partir de `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::GetLineCount](#getlinecount)|Récupère le nombre de lignes dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetModify](#getmodify)|Détermine si le contenu de cet `CRichEditCtrl` objet a été modifié depuis le dernier enregistrement.|
|[CRichEditCtrl::GetOptions](#getoptions)|Récupère les options de contrôle RichEdit.|
|[CRichEditCtrl::GetParaFormat](#getparaformat)|Récupère les attributs de mise en forme des paragraphes dans la sélection actuelle `CRichEditCtrl` de cet objet.|
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|Récupère les caractères de ponctuation actuels pour le contrôle RichEdit. Ce message est disponible uniquement dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::GetRect](#getrect)|Récupère le rectangle de mise en forme pour `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::GetRedoName](#getredoname)|Récupère le type de l’action suivante, le cas échéant, dans la file d’attente de restauration par progression du contrôle.|
|[CRichEditCtrl::GetSel](#getsel)|Obtient les positions de début et de fin de la sélection actuelle `CRichEditCtrl` dans cet objet.|
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|Récupère les attributs de mise en forme des caractères dans la sélection actuelle `CRichEditCtrl` de cet objet.|
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|Récupère le type de contenu de la sélection actuelle dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetSelText](#getseltext)|Obtient le texte de la sélection actuelle dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetTextLength](#gettextlength)|Récupère la longueur du texte, en caractères, dans cet `CRichEditCtrl` objet. N’inclut pas le caractère null de fin.|
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|Récupère le nombre de caractères ou d’octets dans la vue RichEdit. Accepte une liste d’indicateurs pour indiquer la méthode permettant de déterminer la longueur du texte dans un contrôle Rich Edit|
|[CRichEditCtrl::GetTextMode](#gettextmode)|Récupère le mode texte actuel et le niveau d’annulation d’un contrôle RichEdit.|
|[CRichEditCtrl::GetTextRange](#gettextrange)|Récupère la plage de texte spécifiée.|
|[CRichEditCtrl::GetUndoName](#getundoname)|Récupère le type de la prochaine action d’annulation, le cas échéant.|
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|Récupère les options d’habillage et de césure des mots en cours pour le contrôle RichEdit. Ce message est disponible uniquement dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::HideSelection](#hideselection)|Affiche ou masque la sélection actuelle.|
|[CRichEditCtrl::LimitText](#limittext)|Limite la quantité de texte qu’un utilisateur peut entrer dans `CRichEditCtrl` l’objet.|
|[CRichEditCtrl::LineFromChar](#linefromchar)|Détermine la ligne qui contient le caractère donné.|
|[CRichEditCtrl::LineIndex](#lineindex)|Récupère l’index de caractère d’une ligne donnée dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::LineLength](#linelength)|Récupère la longueur d’une ligne donnée dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::LineScroll](#linescroll)|Fait défiler le texte `CRichEditCtrl` dans cet objet.|
|[CRichEditCtrl::Paste](#paste)|Insère le contenu du presse-papiers dans ce contrôle RichEdit.|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|Insère le contenu du presse-papiers dans ce contrôle RichEdit au format de données spécifié.|
|[CRichEditCtrl::PosFromChar](#posfromchar)|Récupère les coordonnées de la zone cliente d’un caractère spécifié dans un contrôle d’édition.|
|[CRichEditCtrl::Redo](#redo)|Répète l’action suivante dans la file d’attente de restauration par progression du contrôle.|
|[CRichEditCtrl::ReplaceSel](#replacesel)|Remplace la sélection actuelle dans cet `CRichEditCtrl` objet par le texte spécifié.|
|[CRichEditCtrl::RequestResize](#requestresize)|Force cet `CRichEditCtrl` objet à envoyer des notifications de redimensionnement de demande.|
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|Indique si la détection d’URL automatique est active dans un contrôle RichEdit.|
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|Définit la couleur d’arrière- `CRichEditCtrl` plan dans cet objet.|
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|Définit les attributs de mise en forme de caractères par `CRichEditCtrl` défaut actuels dans cet objet.|
|[CRichEditCtrl::SetEventMask](#seteventmask)|Définit le masque d’événement pour `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::SetModify](#setmodify)|Définit ou efface l’indicateur de modification pour `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::SetOLECallback](#setolecallback)|Définit l' `IRichEditOleCallback` objet com pour ce contrôle RichEdit.|
|[CRichEditCtrl::SetOptions](#setoptions)|Définit les options pour cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::SetParaFormat](#setparaformat)|Définit les attributs de mise en forme des paragraphes dans la sélection `CRichEditCtrl` actuelle de cet objet.|
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|Définit les caractères de ponctuation pour un contrôle RichEdit. Ce message est disponible uniquement dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::SetReadOnly](#setreadonly)|Définit l’option en lecture seule pour cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::SetRect](#setrect)|Définit le rectangle de mise en forme `CRichEditCtrl` pour cet objet.|
|[CRichEditCtrl::SetSel](#setsel)|Définit la sélection dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|Définit les attributs de mise en forme des caractères dans la sélection `CRichEditCtrl` actuelle de cet objet.|
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|Définit le périphérique de sortie cible pour `CRichEditCtrl` cet objet.|
|[CRichEditCtrl::SetTextMode](#settextmode)|Définit le mode texte ou le niveau d’annulation d’un contrôle RichEdit. Le message échoue si le contrôle contient du texte.|
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|Définit le nombre maximal d’actions qui peuvent être stockées dans la file d’attente d’annulation.|
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|Définit les attributs de mise en forme des caractères dans le mot `CRichEditCtrl` actuel de cet objet.|
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|Définit les options de retour automatique à la disposition et de césure de mots pour le contrôle RichEdit. Ce message est disponible uniquement dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|Empêche le contrôle de collecter des actions de frappe supplémentaires dans l’action d’annulation actuelle. Le contrôle stocke l’action de frappe suivante, le cas échéant, dans une nouvelle action de la file d’attente d’annulation.|
|[CRichEditCtrl::StreamIn](#streamin)|Insère du texte à partir d’un flux d' `CRichEditCtrl` entrée dans cet objet.|
|[CRichEditCtrl::StreamOut](#streamout)|Stocke le texte `CRichEditCtrl` de cet objet dans un flux de sortie.|
|[CRichEditCtrl::Undo](#undo)|Inverse la dernière opération de modification.|

## <a name="remarks"></a>Notes

Un «contrôle RichEdit» est une fenêtre dans laquelle l’utilisateur peut entrer et modifier du texte. Le texte peut être affecté à la mise en forme des caractères et des paragraphes, et peut inclure des objets OLE incorporés. Les contrôles RichEdit fournissent une interface de programmation pour mettre en forme le texte. Toutefois, une application doit implémenter tous les composants d’interface utilisateur nécessaires pour rendre les opérations de mise en forme disponibles pour l’utilisateur.

Ce contrôle commun Windows (et par conséquent `CRichEditCtrl` la classe) est disponible uniquement pour les programmes qui s’exécutent sous Windows 95/98 et Windows NT versions 3,51 et ultérieures. La `CRichEditCtrl` classe prend en charge les versions 2,0 et 3,0 du contrôle Rich Edit SDK Windows.

> [!CAUTION]
>  Si vous utilisez un contrôle RichEdit dans une boîte de dialogue (que votre application soit SDI, MDI ou basée sur une boîte de dialogue), vous devez appeler [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit) une fois pour que la boîte de dialogue s’affiche. Vous pouvez appeler cette fonction dans la fonction `InitInstance` membre de votre programme. Vous n’avez pas besoin de l’appeler pour chaque fois que vous affichez la boîte de dialogue, uniquement la première fois. Vous n’avez pas besoin d' `AfxInitRichEdit` appeler si vous `CRichEditView`utilisez.

Pour plus d’informations sur `CRichEditCtrl`l’utilisation de, consultez:

- [Contrôles](../../mfc/controls-mfc.md)

- [Utilisation de CRichEditCtrl](../../mfc/using-cricheditctrl.md)

Pour obtenir un exemple d’utilisation d’un contrôle RichEdit dans une application MFC, consultez l’exemple d’application [WordPad](../../overview/visual-cpp-samples.md) .

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>Configuration requise

**En-tête :** afxcmn.h

##  <a name="canpaste"></a>  CRichEditCtrl::CanPaste

Détermine si le contrôle RichEdit peut coller le format de presse-papiers spécifié.

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>Paramètres

*nFormat*<br/>
Format de données du presse-papiers à interroger. Ce paramètre peut être l’un des formats de presse-papiers prédéfinis ou la valeur retournée par [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw).

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le format du presse-papiers peut être collé; Sinon, 0.

### <a name="remarks"></a>Notes

Si *nFormat* a la valeur `CanPaste` 0, essaiera tout format actuellement dans le presse-papiers.

Pour plus d’informations, consultez [EM_CANPASTE](/windows/win32/Controls/em-canpaste) message and [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw) Function dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

##  <a name="canredo"></a>  CRichEditCtrl::CanRedo

Détermine si la file d’attente de restauration par progression contient des actions.

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro si la file d’attente de restauration par progression contient des actions, sinon 0.

### <a name="remarks"></a>Notes

Pour découvrir le nom de l’opération dans la file d’attente de restauration par progression, appelez [CRichEditCtrl:: GetRedoName](#getredoname). Pour rétablir l’opération d’annulation la plus récente, appelez [Redo](#redo).

Pour plus d’informations, consultez [EM_CANREDO](/windows/win32/Controls/em-canredo) dans le SDK Windows.

##  <a name="canundo"></a>  CRichEditCtrl::CanUndo

Détermine si la dernière opération de modification peut être annulée.

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si la dernière opération de modification peut être annulée par un appel à la fonction membre [Undo](#undo) ; 0 si elle ne peut pas être annulée.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_CANUNDO](/windows/win32/Controls/em-canundo) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

##  <a name="charfrompos"></a>  CRichEditCtrl::CharFromPos

Récupère des informations sur le caractère situé à l’emplacement spécifié par le paramètre *PT*.

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>Paramètres

*pt*<br/>
Objet [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) contenant les coordonnées du point spécifié.

### <a name="return-value"></a>Valeur de retour

Index de caractère de base zéro du caractère le plus proche du point spécifié. Si le point spécifié est au-delà du dernier caractère du contrôle, la valeur de retour indique le dernier caractère dans le contrôle.

### <a name="remarks"></a>Notes

Cette fonction membre fonctionne avec un contrôle RichEdit. Pour obtenir les informations d’un contrôle d’édition, appelez [CEdit:: CharFromPos](../../mfc/reference/cedit-class.md#charfrompos).

Pour plus d’informations, consultez [EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) dans le SDK Windows.

##  <a name="clear"></a>  CRichEditCtrl::Clear

Supprime (efface) la sélection actuelle (le cas échéant) dans le contrôle Rich Edit.

```
void Clear();
```

### <a name="remarks"></a>Notes

La suppression effectuée par `Clear` peut être annulée en appelant la fonction membre [Undo](#undo) .

Pour supprimer la sélection actuelle et placer le contenu supprimé dans le presse-papiers, appelez la fonction membre [Cut](#cut) .

Pour plus d’informations, consultez [WM_CLEAR](/windows/win32/dataxchg/wm-clear) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

##  <a name="copy"></a>  CRichEditCtrl::Copy

Copie la sélection actuelle (le cas échéant) dans le contrôle Rich Edit dans le presse-papiers.

```
void Copy();
```

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [WM_COPY](/windows/win32/dataxchg/wm-copy) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

##  <a name="create"></a>  CRichEditCtrl::Create

Crée le contrôle Rich Edit Windows et l’associe à `CRichEditCtrl` cet objet.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle*<br/>
Spécifie le style du contrôle d’édition. Appliquez une combinaison des styles de fenêtre répertoriés dans la section **Notes** ci-dessous, et [Modifiez les styles de contrôle](/windows/win32/Controls/edit-control-styles), décrits dans la SDK Windows.

*rect*<br/>
Spécifie la taille et la position du contrôle d’édition. Peut être un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou une structure [Rect](/windows/win32/api/windef/ns-windef-rect) .

*pParentWnd*<br/>
Spécifie la fenêtre parente du contrôle d’édition (souvent un [CDialog](../../mfc/reference/cdialog-class.md)). Il ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle d’édition.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro si l’initialisation réussit; Sinon, 0.

### <a name="remarks"></a>Notes

Vous construisez `CRichEditCtrl` un objet en deux étapes. Tout d’abord, appelez le constructeur [CRichEditCtrl](#cricheditctrl) , `Create`puis appelez, qui crée le contrôle d’édition Windows et l’attache `CRichEditCtrl` à l’objet.

Lorsque vous créez un contrôle RichEdit avec cette fonction, vous devez d’abord charger la bibliothèque de contrôles communs nécessaire. Pour charger la bibliothèque, appelez la fonction globale [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit), qui à son tour initialise la bibliothèque de contrôles communs. Vous ne devez appeler `AfxInitRichEdit` qu’une seule fois dans votre processus.

Lorsque `Create` exécute, Windows envoie les messages [WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate), [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize), [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)et [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) au contrôle d’édition.

Ces messages sont gérés par défaut par les fonctions membres [OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate), [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize), [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)et [OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) dans la `CWnd` classe de base. Pour étendre la gestion des messages par défaut, dérivez une classe de, ajoutez une table des `CRichEditCtrl`messages à la nouvelle classe et substituez les fonctions membres du gestionnaire de messages ci-dessus. Substituez `OnCreate`, par exemple, pour effectuer l’initialisation nécessaire pour la nouvelle classe.

Appliquez les [styles de fenêtre](../../mfc/reference/styles-used-by-mfc.md#window-styles) suivants à un contrôle d’édition.

- WS_CHILD toujours.

- WS_VISIBLE généralement.

- WS_DISABLED rarement.

- WS_GROUP pour regrouper les contrôles.

- WS_TABSTOP pour inclure le contrôle d’édition dans l’ordre de tabulation.

Pour plus d’informations sur les styles de fenêtre, consultez [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

##  <a name="createex"></a>  CRichEditCtrl::CreateEx

Crée un contrôle (une fenêtre enfant) et l’associe à `CRichEditCtrl` l’objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour obtenir la liste des styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le SDK Windows.

*dwStyle*<br/>
Spécifie le style du contrôle d’édition. Appliquez une combinaison des styles de fenêtre répertoriés dans la section **Notes** de [Create](#create) and [Edit Control styles](/windows/win32/Controls/edit-control-styles), décrite dans la SDK Windows.

*rect*<br/>
Référence à une structure [Rect](/previous-versions/dd162897\(v=vs.85\)) décrivant la taille et la position de la fenêtre à créer, en coordonnées clientes de *pParentWnd*.

*pParentWnd*<br/>
Pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
ID de la fenêtre enfant du contrôle.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au lieu `Create` de pour appliquer des styles Windows étendus, spécifiés par la préface de style étendu Windows **WS_EX_** .

##  <a name="cricheditctrl"></a>  CRichEditCtrl::CRichEditCtrl

Construit un objet `CRichEditCtrl`.

```
CRichEditCtrl();
```

### <a name="remarks"></a>Notes

Utilisez [créer](#create) pour construire le contrôle Rich Edit Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

##  <a name="cut"></a>  CRichEditCtrl::Cut

Supprime (coupe) la sélection actuelle (le cas échéant) dans le contrôle Rich Edit et copie le texte supprimé dans le presse-papiers.

```
void Cut();
```

### <a name="remarks"></a>Notes

La suppression effectuée par `Cut` peut être annulée en appelant la fonction membre [Undo](#undo) .

Pour supprimer la sélection actuelle sans placer le texte supprimé dans le presse-papiers, appelez la fonction membre [Clear](#clear) .

Pour plus d’informations, consultez [WM_CUT](/windows/win32/dataxchg/wm-cut) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

##  <a name="displayband"></a>  CRichEditCtrl::DisplayBand

Affiche une partie du contenu du contrôle RichEdit (texte et éléments OLE), tel qu’il a été précédemment mis en forme par [FormatRange](#formatrange).

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>Paramètres

*pDisplayRect*<br/>
Pointeur vers un objet [Rect](/windows/win32/api/windef/ns-windef-rect) ou [CRect](../../atl-mfc-shared/reference/crect-class.md) spécifiant la zone de l’appareil pour afficher le texte.

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’affichage du texte mis en forme est correct; sinon, 0.

### <a name="remarks"></a>Notes

Le texte et les éléments OLE sont tronqués à la zone spécifiée par le pointeur *pDisplayRect*.

Pour plus d’informations, consultez [EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) dans le SDK Windows.

### <a name="example"></a>Exemples

  Consultez l’exemple pour [CRichEditCtrl:: FormatRange](#formatrange).

##  <a name="emptyundobuffer"></a>  CRichEditCtrl::EmptyUndoBuffer

Réinitialise (efface) l’indicateur d’annulation de ce contrôle RichEdit.

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>Notes

Le contrôle ne peut pas annuler la dernière opération de modification. L’indicateur Undo est défini chaque fois qu’une opération dans le contrôle Rich Edit peut être annulée.

L’indicateur d’annulation est automatiquement effacé chaque fois que vous appelez la fonction membre [CWnd](../../mfc/reference/cwnd-class.md) [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

Pour plus d’informations, consultez [EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

##  <a name="findtext"></a>  CRichEditCtrl::FindText

Recherche du texte dans le contrôle RichEdit.

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>Paramètres

*dwFlags*<br/>
Pour obtenir la liste des valeurs possibles, consultez *wParam* dans [EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex) dans le SDK Windows.

*pFindText*<br/>
Pointeur vers la structure [FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw) qui donne les paramètres pour la recherche et retourne la plage où la correspondance a été trouvée.

### <a name="return-value"></a>Valeur de retour

Position de caractère de base zéro de la correspondance suivante; -1 s’il n’y a plus de correspondances.

### <a name="remarks"></a>Notes

Vous pouvez effectuer une recherche vers le haut ou vers le haut en définissant les paramètres de plage appropriés dans la structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) au sein de la structure `FINDTEXTEX`.

Pour plus d’informations, consultez [EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) message and [FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw) structure dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

##  <a name="findwordbreak"></a>  CRichEditCtrl::FindWordBreak

Recherche la prochaine césure de mot avant ou après la position spécifiée par *nStart*.

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>Paramètres

*nCode*<br/>
Indique l’action à entreprendre. Pour obtenir la liste des valeurs possibles, consultez la description du *code* de paramètre dans EM_FINDWORDBREAK dans le SDK Windows.

*nStart*<br/>
Position du caractère de base zéro à partir de laquelle commencer.

### <a name="return-value"></a>Valeur de retour

Basé sur le paramètre *nCode*. Pour plus d’informations, consultez [EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) dans le SDK Windows.

### <a name="remarks"></a>Notes

Vous pouvez utiliser cette fonction membre pour récupérer des informations sur un caractère à une position donnée.

##  <a name="formatrange"></a>  CRichEditCtrl::FormatRange

Met en forme une plage de texte dans un contrôle RichEdit pour un appareil spécifique.

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>Paramètres

*pfr*<br/>
Pointeur vers la structure [FormatRange](/windows/win32/api/richedit/ns-richedit-formatrange) qui contient des informations sur le périphérique de sortie. La valeur NULL indique que les informations mises en cache au sein du contrôle Rich Edit peuvent être libérées.

*bDisplay*<br/>
Indique si le texte doit être rendu. Si la valeur est FALSe, le texte est uniquement mesuré.

### <a name="return-value"></a>Valeur de retour

Index du dernier caractère qui tient dans la région plus un.

### <a name="remarks"></a>Notes

En général, cet appel est suivi d’un appel à [DisplayBand](#displayband).

Pour plus d’informations, consultez [EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) message and [FormatRange](/windows/win32/api/richedit/ns-richedit-formatrange) structure dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

##  <a name="getcharpos"></a>  CRichEditCtrl::GetCharPos

Obtient la position (angle supérieur gauche) d’un caractère donné dans cet `CRichEditCtrl` objet.

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>Paramètres

*lChar*<br/>
Index de base zéro du caractère.

### <a name="return-value"></a>Valeur de retour

Emplacement de l’angle supérieur gauche du caractère spécifié par *lChar*.

### <a name="remarks"></a>Notes

Le caractère est spécifié en donnant sa valeur d’index de base zéro. Si *lChar* est supérieur à l’index du dernier caractère de cet `CRichEditCtrl` objet, la valeur de retour spécifie les coordonnées de la position de caractère juste après le dernier caractère de cet `CRichEditCtrl` objet.

Pour plus d’informations, consultez [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) dans le SDK Windows.

##  <a name="getdefaultcharformat"></a>  CRichEditCtrl::GetDefaultCharFormat

Obtient les attributs de mise en forme de caractères `CRichEditCtrl` par défaut de cet objet.

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Paramètres

*cf*<br/>
Dans la première version, pointeur vers une `CHARFORMAT` structure contenant les attributs de mise en forme de caractères par défaut.

Dans la deuxième version, pointeur vers une `CHARFORMAT2` structure, qui est une extension RichEdit 2,0 de la `CHARFORMAT` structure, contenant les attributs de mise en forme de caractères par défaut.

### <a name="return-value"></a>Valeur de retour

Données membres de *cf.* `dwMask` Il a spécifié les attributs de mise en forme de caractères par défaut.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez le message EM_GETCHARFORMAT et `CHARFORMAT` les `CHARFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [SetDefaultCharFormat](#setdefaultcharformat).

##  <a name="geteventmask"></a>  CRichEditCtrl::GetEventMask

Obtient le masque d’événement pour `CRichEditCtrl` cet objet.

```
long GetEventMask() const;
```

### <a name="return-value"></a>Valeur de retour

Masque d’événement pour cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

Le masque d’événement spécifie les messages `CRichEditCtrl` de notification envoyés par l’objet à sa fenêtre parente.

Pour plus d’informations, consultez [EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CRichEditCtrl:: SetEventMask](#seteventmask).

##  <a name="getfirstvisibleline"></a>  CRichEditCtrl::GetFirstVisibleLine

Détermine la ligne la plus visible dans cet `CRichEditCtrl` objet.

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>Valeur de retour

Index de base zéro de la ligne visible supérieure dans cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle

Accède à l' `IRichEditOle` interface pour cet `CRichEditCtrl` objet.

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’interface [IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) qui peut être utilisée pour accéder aux `CRichEditCtrl` fonctionnalités OLE de cet objet. NULL si l’interface n’est pas accessible.

### <a name="remarks"></a>Notes

Utilisez cette interface pour accéder aux `CRichEditCtrl` fonctionnalités OLE de cet objet.

Pour plus d’informations, consultez message [EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface) et interface [IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) dans la SDK Windows.

##  <a name="getlimittext"></a>  CRichEditCtrl::GetLimitText

Obtient la limite de texte pour `CRichEditCtrl` cet objet.

```
long GetLimitText() const;
```

### <a name="return-value"></a>Valeur de retour

Limite de texte actuelle, en octets, pour cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

La limite de texte correspond à la quantité maximale de texte, en octets, que le contrôle RichEdit peut accepter.

Pour plus d’informations, consultez [EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

##  <a name="getline"></a>  CRichEditCtrl::GetLine

Récupère une ligne de texte à partir de `CRichEditCtrl` cet objet.

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Index de base zéro de la ligne à récupérer.

*lpszBuffer*<br/>
Pointe vers la mémoire tampon pour recevoir le texte. Le premier mot de la mémoire tampon doit spécifier le nombre maximal d’octets qui peuvent être copiés dans la mémoire tampon.

*nMaxLength*<br/>
Nombre maximal de caractères qui peuvent être copiés dans *lpszbuffer a été*. La deuxième forme de `GetLine` place cette valeur dans le premier mot de la mémoire tampon spécifiée par *lpszbuffer a été*.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères copiés dans *lpszbuffer a été*.

### <a name="remarks"></a>Notes

La ligne copiée ne contient pas de caractère null de fin.

> [!NOTE]
>  Étant donné que le premier mot de la mémoire tampon stocke le nombre de caractères à copier, assurez-vous que votre mémoire tampon a une longueur d’au moins 4 octets.

Pour plus d’informations, consultez [EM_GETLINE](/windows/win32/Controls/em-getline) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [GetLineCount](#getlinecount).

##  <a name="getlinecount"></a>  CRichEditCtrl::GetLineCount

Récupère le nombre de lignes dans l' `CRichEditCtrl` objet.

```
int GetLineCount() const;
```

### <a name="return-value"></a>Valeur de retour

Nombre de lignes dans cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

##  <a name="getmodify"></a>  CRichEditCtrl::GetModify

Détermine si le contenu de cet `CRichEditCtrl` objet a été modifié.

```
BOOL GetModify() const;
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si le texte de `CRichEditCtrl` cet objet a été modifié; sinon, 0.

### <a name="remarks"></a>Notes

Windows maintient un indicateur interne indiquant si le contenu du contrôle RichEdit a été modifié. Cet indicateur est effacé lorsque le contrôle d’édition est créé pour la première fois et peut également être effacé en appelant la fonction membre [SetModify](#setmodify) .

Pour plus d’informations, consultez [EM_GETMODIFY](/windows/win32/Controls/em-getmodify) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

##  <a name="getoptions"></a>  CRichEditCtrl::GetOptions

Récupère les options actuellement définies pour le contrôle RichEdit.

```
UINT GetOptions() const;
```

### <a name="return-value"></a>Valeur de retour

Combinaison des valeurs d’indicateur d’option actuelles. Pour obtenir la liste de ces valeurs, consultez le paramètre *fOptions* dans le message [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) , comme décrit dans la SDK Windows.

##  <a name="getparaformat"></a>  CRichEditCtrl::GetParaFormat

Obtient les attributs de mise en forme de paragraphe de la sélection actuelle.

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>Paramètres

*pf*<br/>
Dans la première version, pointeur vers une structure [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) pour contenir les attributs de mise en forme de paragraphe de la sélection actuelle.

Dans la deuxième version, pointeur vers une structure [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) , qui est une extension Rich Edit 2,0 de la `PARAFORMAT` structure, contenant les attributs de mise en forme de caractères par défaut.

### <a name="return-value"></a>Valeur de retour

Membre de données de *PF.* `dwMask` Elle spécifie les attributs de mise en forme des paragraphes qui sont cohérents tout au long de la sélection actuelle.

### <a name="remarks"></a>Notes

Si plusieurs paragraphes sont sélectionnés, *PF* reçoit les attributs du premier paragraphe sélectionné. La valeur de retour spécifie les attributs qui sont cohérents tout au long de la sélection.

Pour plus d’informations, consultez le message [EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat) et `PARAFORMAT` les `PARAFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemples

  Consultez l’exemple pour [CRichEditCtrl:: SetParaFormat](#setparaformat).

##  <a name="getpunctuation"></a>  CRichEditCtrl::GetPunctuation

Obtient les caractères de ponctuation actuels dans un contrôle RichEdit.

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>Paramètres

*fType*<br/>
Indicateur de type de ponctuation, comme décrit dans le paramètre *ftype* de [EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation) dans la SDK Windows.

*lpPunc*<br/>
Pointeur vers une structure de [PUNCTUATION](/windows/win32/api/richedit/ns-richedit-punctuation), comme décrit dans la SDK Windows.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro si l’opération a réussi; sinon, 0.

### <a name="remarks"></a>Notes

Cette fonction membre est disponible uniquement avec les versions en langue asiatique du système d’exploitation.

##  <a name="getrect"></a>  CRichEditCtrl::GetRect

Récupère le rectangle de mise en forme pour `CRichEditCtrl` cet objet.

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) ou pointeur vers un [Rect](/windows/win32/api/windef/ns-windef-rect) pour recevoir le rectangle de mise en forme `CRichEditCtrl` de cet objet.

### <a name="remarks"></a>Notes

Le rectangle de mise en forme est le rectangle englobant du texte. Cette valeur est indépendante de la taille de l' `CRichEditCtrl` objet.

Pour plus d’informations, consultez [EM_GETRECT](/windows/win32/Controls/em-getrect) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [LimitText](#limittext).

##  <a name="getredoname"></a>  CRichEditCtrl::GetRedoName

Récupère le type de la prochaine action disponible dans la file d’attente de restauration par progression, le cas échéant.

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>Valeur de retour

En cas de `GetRedoName` réussite, retourne le type d’énumération [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) indiquant le type de l’action suivante dans la file d’attente de restauration par progression du contrôle. Si la file d’attente de restauration par progression est vide ou si l’action de rétablissement dans la file d' `GetRedoName` attente est d’un type inconnu, retourne 0.

### <a name="remarks"></a>Notes

Les types d’actions qui peuvent être annulés ou réexécutés incluent les opérations de frappe, de suppression, de glisser-déplacer, de couper et de coller. Ces informations peuvent être utiles pour les applications qui fournissent une interface utilisateur étendue pour les opérations d’annulation et de rétablissement, telles qu’une zone de liste déroulante d’actions rétablies.

##  <a name="getsel"></a>  CRichEditCtrl::GetSel

Récupère les limites de la sélection actuelle dans cet `CRichEditCtrl` objet.

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>Paramètres

*cr*<br/>
Référence à une structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) pour recevoir les limites de la sélection actuelle.

*nStartChar*<br/>
Index de base zéro du premier caractère dans la sélection actuelle.

*nEndChar*<br/>
Index de base zéro du dernier caractère de la sélection actuelle.

### <a name="remarks"></a>Notes

Les deux formes de cette fonction offrent d’autres méthodes pour obtenir les limites de la sélection. Une brève description de ces formulaires suit:

- **GetSel (** `cr` **)** ce formulaire utilise la `CHARRANGE` structure avec ses `cpMin` membres `cpMax` et pour retourner les limites.

- **GetSel (** `nStartChar` **,** ) ce formulaire retourne les limites dans les paramètres nStartChar et nEndChar. `nEndChar`

La sélection inclut tout si le début (`cpMin` ou *nStartChar*) est égal à 0 et la`cpMax` fin (ou *nEndChar*) est égale à-1.

Pour plus d’informations, consultez [EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) message and [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) structure dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

##  <a name="getselectioncharformat"></a>  CRichEditCtrl::GetSelectionCharFormat

Obtient les attributs de mise en forme de caractères de la sélection actuelle.

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Paramètres

*cf*<br/>
Dans la première version, pointeur vers une structure [Charformat](/windows/win32/api/richedit/ns-richedit-_charformat) pour recevoir les attributs de mise en forme de caractères de la sélection actuelle.

Dans la deuxième version, pointeur vers une structure [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , qui est une extension Rich Edit 2,0 de la `CHARFORMAT` structure pour recevoir les attributs de mise en forme de caractères de la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Données membres de *cf.* `dwMask` Elle spécifie les attributs de mise en forme de caractères qui sont cohérents dans toute la sélection actuelle.

### <a name="remarks"></a>Notes

Le paramètre *CF* reçoit les attributs du premier caractère dans la sélection actuelle. La valeur de retour spécifie les attributs qui sont cohérents tout au long de la sélection.

Pour plus d’informations, consultez le message [EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat) et `CHARFORMAT` les `CHARFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [SetSelectionCharFormat](#setselectioncharformat).

##  <a name="getselectiontype"></a>  CRichEditCtrl::GetSelectionType

Détermine le type de sélection dans `CRichEditCtrl` cet objet.

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>Valeur de retour

Indicateurs spécifiant le contenu de la sélection actuelle. Combinaison des indicateurs suivants:

- SEL_EMPTY indique qu’il n’y a aucune sélection actuelle.

- SEL_TEXT indique que la sélection actuelle contient du texte.

- SEL_OBJECT indique que la sélection actuelle contient au moins un élément OLE.

- SEL_MULTICHAR indique que la sélection actuelle contient plus d’un caractère de texte.

- SEL_MULTIOBJECT indique que la sélection actuelle contient plus d’un objet OLE.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

##  <a name="getseltext"></a>  CRichEditCtrl::GetSelText

Récupère le texte de la sélection actuelle dans cet `CRichEditCtrl` objet.

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>Paramètres

*lpBuf*<br/>
Pointeur vers la mémoire tampon pour recevoir le texte de la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Dépend du formulaire:

- **GetSelText (** `lpBuf` **)** nombre de caractères copiés dans *lpBuf*, à l’exclusion de la terminaison NULL.

- **GetSelText ()** Chaîne contenant la sélection actuelle.

### <a name="remarks"></a>Notes

Si vous utilisez le premier formulaire, **GetSelText (** `lpBuf` **)** , vous devez vous assurer que la mémoire tampon est suffisamment grande pour le texte qu’elle recevra. Appelez [GetSel](#getsel) pour déterminer le nombre de caractères dans la sélection actuelle.

Pour plus d’informations, consultez [EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) dans le SDK Windows.

### <a name="example"></a>Exemples

  Consultez l’exemple pour [CRichEditCtrl:: GetSelectionType](#getselectiontype).

##  <a name="gettextlength"></a>  CRichEditCtrl::GetTextLength

Récupère la longueur du texte, en caractères, dans cet `CRichEditCtrl` objet, à l’exclusion du caractère null de fin.

```
long GetTextLength() const;
```

### <a name="return-value"></a>Valeur de retour

Longueur du texte dans cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

##  <a name="gettextlengthex"></a>  CRichEditCtrl::GetTextLengthEx

Calcule la longueur du texte dans le contrôle Rich Edit.

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>Paramètres

*dwFlags*<br/>
Valeur spécifiant la méthode à utiliser pour déterminer la longueur du texte. Ce membre peut être une ou plusieurs des valeurs répertoriées dans le membre Flags de [GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex) décrit dans la SDK Windows.

*uCodePage*<br/>
Page de codes pour la traduction (CP_ACP pour la page de codes ANSI, 1200 pour Unicode).

### <a name="return-value"></a>Valeur de retour

Nombre de caractères ou d’octets dans le contrôle d’édition. Si des indicateurs incompatibles ont été définis dans *dwFlags*, cette fonction membre retourne E_INVALIDARG.

### <a name="remarks"></a>Notes

`GetTextLengthEx`fournit des méthodes supplémentaires pour déterminer la longueur du texte. Il prend en charge la fonctionnalité Rich Edit 2,0. Pour plus d’informations, consultez [à propos des contrôles RichEdit](/windows/win32/Controls/about-rich-edit-controls) dans Windows SDKfor.

##  <a name="gettextmode"></a>  CRichEditCtrl::GetTextMode

Récupère le mode texte actuel et le niveau d’annulation d’un contrôle RichEdit.

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>Valeur de retour

Jeu d’indicateurs binaires du type d’énumération [TextMode](/windows/win32/api/richedit/ne-richedit-textmode) , comme décrit dans la SDK Windows. Les indicateurs indiquent le mode texte actuel et le niveau d’annulation du contrôle.

##  <a name="gettextrange"></a>  CRichEditCtrl::GetTextRange

Obtient la plage de caractères spécifiée.

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>Paramètres

*nFirst*<br/>
Index de position de caractère qui précède immédiatement le premier caractère de la plage.

*nLast*<br/>
Position du caractère qui suit immédiatement le dernier caractère de la plage.

*refString*<br/>
Référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) qui recevra le texte.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères copiés, à l’exclusion du caractère null de fin.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) dans le SDK Windows.

`GetTextRange`prend en charge la fonctionnalité Rich Edit 2,0. Pour plus d’informations, consultez [à propos des contrôles RichEdit](/windows/win32/Controls/about-rich-edit-controls) dans Windows SDKfor.

##  <a name="getundoname"></a>  CRichEditCtrl::GetUndoName

Récupère le type de la prochaine action disponible dans la file d’attente d’annulation, le cas échéant.

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>Valeur de retour

Si une opération d’annulation se trouve dans la file d’attente `GetUndoName` d’annulation du contrôle, retourne le type d’énumération [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) indiquant le type de l’action suivante dans la file d’attente. Si la file d’attente d’annulation est vide ou si l’action d’annulation dans la file d’attente est `GetUndoName` d’un type inconnu, retourne 0.

### <a name="remarks"></a>Notes

Les types d’actions qui peuvent être annulés ou réexécutés incluent les opérations de frappe, de suppression, de glisser-déplacer, de couper et de coller. Ces informations peuvent être utiles pour les applications qui fournissent une interface utilisateur étendue pour les opérations d’annulation et de rétablissement, telles qu’une zone de liste déroulante d’actions qui peuvent être annulées.

##  <a name="getwordwrapmode"></a>  CRichEditCtrl::GetWordWrapMode

Récupère les options d’habillage et de césure des mots en cours pour le contrôle RichEdit.

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>Valeur de retour

Options de retour automatique à la disposition et de césure des mots active. Ces options sont décrites dans [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) dans le SDK Windows.

### <a name="remarks"></a>Notes

Cette fonction membre est disponible uniquement pour les versions en langue asiatique du système d’exploitation.

##  <a name="hideselection"></a>  CRichEditCtrl::HideSelection

Modifie la visibilité de la sélection.

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>Paramètres

*bHide*<br/>
Indique si la sélection doit être affichée ou masquée, TRUE pour masquer la sélection.

*bPerm*<br/>
Indique si cette modification de la visibilité de la sélection doit être permanente.

### <a name="remarks"></a>Notes

Quand *bPerm* a la valeur true, il modifie l’option ECO_NOHIDESEL `CRichEditCtrl` pour cet objet. Pour obtenir une brève description de cette option, consultez [SetOptions](#setoptions). Vous pouvez utiliser cette fonction pour définir toutes les options de cet `CRichEditCtrl` objet.

Pour plus d’informations, consultez [EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

##  <a name="limittext"></a>  CRichEditCtrl::LimitText

Limite la longueur du texte que l’utilisateur peut entrer dans un contrôle d’édition.

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>Paramètres

*nChars*<br/>
Spécifie la longueur (en octets) du texte que l’utilisateur peut entrer. Si ce paramètre est égal à 0 (valeur par défaut), la longueur du texte est définie à 64 Ko d’octets.

### <a name="remarks"></a>Notes

La modification de la limite de texte restreint uniquement le texte que l’utilisateur peut entrer. Elle n’a aucun effet sur le texte déjà présent dans le contrôle d’édition, ni sur la longueur du texte copié dans le contrôle d’édition par la fonction membre [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) dans `CWnd`. Si une application utilise la `SetWindowText` fonction pour placer plus de texte dans un contrôle d’édition que celui spécifié dans l' `LimitText`appel à, l’utilisateur peut supprimer n’importe quel texte dans le contrôle d’édition. Toutefois, la limite de texte empêche l’utilisateur de remplacer le texte existant par un nouveau texte, sauf si la suppression de la sélection actuelle provoque la chute du texte en dessous de la limite du texte.

> [!NOTE]
>  Pour la limite de texte, chaque élément OLE est compté comme un caractère unique.

Pour plus d’informations, consultez [EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

##  <a name="linefromchar"></a>  CRichEditCtrl::LineFromChar

Récupère le numéro de ligne de la ligne qui contient l’index de caractère spécifié.

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Contient la valeur d’index de base zéro du caractère souhaité dans le texte du contrôle d’édition, ou contient-1. Si *nIndex* est-1, il spécifie la ligne active, autrement dit, la ligne qui contient le signe insertion.

### <a name="return-value"></a>Valeur de retour

Numéro de ligne de base zéro de la ligne contenant l’index de caractère spécifié par *nIndex*. Si *nIndex* a la valeur-1, le numéro de la ligne qui contient le premier caractère de la sélection est retourné. Si aucune sélection n’est effectuée, le numéro de la ligne active est retourné.

### <a name="remarks"></a>Notes

Un index de caractère est le nombre de caractères à partir du début du contrôle Rich Edit. Pour le comptage de caractères, un élément OLE est compté comme un caractère unique.

Pour plus d’informations, consultez [EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

##  <a name="lineindex"></a>  CRichEditCtrl::LineIndex

Récupère l’index de caractère d’une ligne dans cet `CRichEditCtrl` objet.

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>Paramètres

*nLine*<br/>
Contient la valeur d’index de la ligne souhaitée dans le texte du contrôle d’édition, ou contient-1. Si *nLigne* est-1, il spécifie la ligne active, autrement dit, la ligne qui contient le signe insertion.

### <a name="return-value"></a>Valeur de retour

Index de caractère de la ligne spécifiée dans *nLigne* ou-1 si le numéro de ligne spécifié est supérieur au nombre de lignes dans le contrôle d’édition.

### <a name="remarks"></a>Notes

L’index de caractère est le nombre de caractères à partir du début du contrôle Rich Edit jusqu’à la ligne spécifiée.

Pour plus d’informations, consultez [EM_LINEINDEX](/windows/win32/controls/em-lineindex) dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

##  <a name="linelength"></a>  CRichEditCtrl::LineLength

Récupère la longueur d’une ligne dans un contrôle RichEdit.

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>Paramètres

*nLine*<br/>
Spécifie l’index de caractère d’un caractère de la ligne dont la longueur doit être récupérée. Si ce paramètre est défini sur-1, la longueur de la ligne active (la ligne qui contient le signe insertion) est retournée, à l’exclusion de la longueur du texte sélectionné dans la ligne. Lorsque `LineLength` est appelé pour un contrôle d’édition sur une seule ligne, ce paramètre est ignoré.

### <a name="return-value"></a>Valeur de retour

Lorsque `LineLength` est appelé pour un contrôle d’édition sur plusieurs lignes, la valeur de retour est la longueur (dans Tchar) de la ligne spécifiée par *nLigne*.  Elle n’inclut pas le caractère de retour chariot à la fin de la ligne. Lorsque `LineLength` est appelé pour un contrôle d’édition sur une seule ligne, la valeur de retour est la longueur (dans Tchar) du texte du contrôle d’édition. Si nLigne est supérieur au nombre de caractères dans le contrôle, la valeur de retour est zéro.

### <a name="remarks"></a>Notes

Utilisez la fonction membre [LineIndex](#lineindex) pour récupérer un index de caractère pour un numéro de ligne donné `CRichEditCtrl` au sein de cet objet.

Pour plus d’informations, consultez [EM_LINELENGTH](/windows/win32/Controls/em-linelength) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [LineIndex](#lineindex).

##  <a name="linescroll"></a>  CRichEditCtrl::LineScroll

Fait défiler le texte d’un contrôle d’édition sur plusieurs lignes.

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>Paramètres

*nLines*<br/>
Spécifie le nombre de lignes à faire défiler verticalement.

*nChars*<br/>
Spécifie le nombre de positions de caractère à faire défiler horizontalement. Cette valeur est ignorée si le contrôle RichEdit a le style ES_RIGHT ou ES_CENTER. Les [styles de modification](../../mfc/reference/styles-used-by-mfc.md#edit-styles) sont spécifiés dans [Create](#create).

### <a name="remarks"></a>Notes

Le contrôle d’édition ne fait pas défiler verticalement la dernière ligne de texte dans le contrôle d’édition. Si la ligne actuelle plus le nombre de lignes spécifié par *nLines* dépasse le nombre total de lignes dans le contrôle d’édition, la valeur est ajustée de sorte que la dernière ligne du contrôle d’édition soit défilant en haut de la fenêtre de contrôle de modification.

`LineScroll`peut être utilisé pour faire défiler horizontalement le dernier caractère d’une ligne.

Pour plus d’informations, consultez [EM_LINESCROLL](/windows/win32/Controls/em-linescroll) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [GetFirstVisibleLine](#getfirstvisibleline).

##  <a name="paste"></a>  CRichEditCtrl::Paste

Insère les données du presse-papiers dans le `CRichEditCtrl` au niveau du point d’insertion, à l’emplacement du signe insertion.

```
void Paste();
```

### <a name="remarks"></a>Notes

Les données sont insérées uniquement si le presse-papiers contient des données dans un format reconnu.

Pour plus d’informations, consultez [WM_PASTE](/windows/win32/dataxchg/wm-paste) dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

##  <a name="pastespecial"></a>  CRichEditCtrl::PasteSpecial

Colle des données dans un format de presse-papiers `CRichEditCtrl` spécifique dans cet objet.

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>Paramètres

*nClipFormat*<br/>
Format du presse-papiers à `CRichEditCtrl` coller dans cet objet.

*dvAspect*<br/>
Aspect de l’appareil pour les données à récupérer à partir du presse-papiers.

*hMF*<br/>
Handle vers le métafichier contenant la vue sous forme de l’objet à coller.

### <a name="remarks"></a>Notes

Le nouveau matériau est inséré au point d’insertion, à l’emplacement du signe insertion.

Pour plus d’informations, consultez [EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

##  <a name="posfromchar"></a>  CRichEditCtrl::PosFromChar

Récupère les coordonnées de la zone cliente d’un caractère spécifié dans un contrôle d’édition.

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>Paramètres

*nChar*<br/>
Index de base zéro du caractère.

### <a name="return-value"></a>Valeur de retour

Position du caractère, (x, y). Pour un contrôle d’édition sur une seule ligne, la coordonnée y est toujours égale à zéro.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) dans le SDK Windows.

##  <a name="redo"></a>  CRichEditCtrl::Redo

Répète l’action suivante dans la file d’attente de restauration par progression du contrôle.

```
BOOL Redo();
```

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez [EM_REDO](/windows/win32/Controls/em-redo) dans le SDK Windows.

##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel

Remplace la sélection actuelle dans cet `CRichEditCtrl` objet par le texte spécifié.

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>Paramètres

*lpszNewText*<br/>
Pointeur vers une chaîne se terminant par un caractère null qui contient le texte de remplacement.

*bCanUndo*<br/>
Pour spécifier que cette fonction peut être annulée, affectez la valeur TRUE à ce paramètre. La valeur par défaut est FALSe.

### <a name="remarks"></a>Notes

Pour remplacer tout le texte de cet `CRichEditCtrl` objet, utilisez [CWnd:: SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

S’il n’y a aucune sélection actuelle, le texte de remplacement est inséré au point d’insertion, c’est-à-dire l’emplacement actuel du signe insertion.

Cette fonction met en forme le texte inséré avec la mise en forme de caractères existante. Lors du remplacement de l’intégralité de la plage de `SetSel`texte (en appelant (0,- `ReplaceSel`1) avant d’appeler), il existe un caractère de fin de paragraphe qui conserve la mise en forme du paragraphe précédent, qui est héritée par le texte nouvellement inséré.

Pour plus d’informations, consultez [EM_REPLACESEL](/windows/win32/Controls/em-replacesel) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [LineIndex](#lineindex).

##  <a name="requestresize"></a>  CRichEditCtrl::RequestResize

Force cet `CRichEditCtrl` objet à envoyer des messages de notification EN_REQUESTRESIZE à sa fenêtre parente.

```
void RequestResize();
```

### <a name="remarks"></a>Notes

Cette fonction est utile lors du traitement de [CWnd:: OnSize](../../mfc/reference/cwnd-class.md#onsize) pour un `CRichEditCtrl` objet sans fin.

Pour plus d’informations, consultez le message [EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize) et la section « **RichEdit Control Controls** » de la rubrique [à propos des contrôles RichEdit](/windows/win32/Controls/about-rich-edit-controls) dans le SDK Windows.

##  <a name="setautourldetect"></a>  CRichEditCtrl::SetAutoURLDetect

Définit le contrôle Rich Edit pour détecter automatiquement une URL.

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
Spécifie si le contrôle est configuré pour détecter automatiquement une URL. Si la valeur est TRUE, il est activé. Si la valeur est FALSe, elle est désactivée.

### <a name="return-value"></a>Valeur de retour

Zéro en cas de réussite, sinon valeur différente de zéro. Par exemple, le message peut échouer en raison d’une insuffisance de mémoire.

### <a name="remarks"></a>Notes

Si cette option est activée, le contrôle RichEdit analyse le texte pour déterminer s’il correspond à un format d’URL standard. Pour obtenir la liste de ces formats d’URL, consultez [EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) dans le SDK Windows.

> [!NOTE]
>  N’affectez `SetAutoURLDetect` pas la valeur true si votre contrôle d’édition utilise l’effet CFE_LINK pour du texte autre que des URL. `SetAutoURLDetect`Active cet effet pour les URL et le désactive pour tout autre texte. Pour plus d’informations sur l’effet CFE_LINK, consultez [EN_LINK](/windows/win32/Controls/en-link) .

##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor

Définit la couleur d’arrière- `CRichEditCtrl` plan de cet objet.

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>Paramètres

*bSysColor*<br/>
Indique si la couleur d’arrière-plan doit être définie sur la valeur système. Si cette valeur est TRUE, *CR* est ignoré.

*cr*<br/>
Couleur d’arrière-plan demandée. Utilisé uniquement si *bSysColor* a la valeur false.

### <a name="return-value"></a>Valeur de retour

Couleur d’arrière-plan précédente `CRichEditCtrl` pour cet objet.

### <a name="remarks"></a>Notes

La couleur d’arrière-plan peut être définie sur la valeur système ou sur une valeur [COLORREF](/windows/win32/gdi/colorref) spécifiée.

Pour plus d’informations, consultez [EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) message et [COLORREF](/windows/win32/gdi/colorref) structure dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

##  <a name="setdefaultcharformat"></a>  CRichEditCtrl::SetDefaultCharFormat

Définit les attributs de mise en forme des caractères pour le `CRichEditCtrl` nouveau texte dans cet objet.

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*cf*<br/>
Dans la première version, pointeur vers une structure [Charformat](/windows/win32/api/richedit/ns-richedit-_charformat) contenant les nouveaux attributs de mise en forme de caractères par défaut.

Dans la deuxième version, pointeur vers une structure [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , qui est une extension Rich Edit 2,0 de la `CHARFORMAT` structure, contenant les attributs de mise en forme de caractères par défaut.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Seuls les attributs spécifiés par `dwMask` le membre de *CF* sont modifiés par cette fonction.

Pour plus d’informations, consultez le message [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et `CHARFORMAT` les `CHARFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

##  <a name="seteventmask"></a>  CRichEditCtrl::SetEventMask

Définit le masque d’événement pour `CRichEditCtrl` cet objet.

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>Paramètres

*dwEventMask*<br/>
Nouveau masque d’événement pour cet `CRichEditCtrl` objet.

### <a name="return-value"></a>Valeur de retour

Masque d’événement précédent.

### <a name="remarks"></a>Notes

Le masque d’événement spécifie les messages `CRichEditCtrl` de notification envoyés par l’objet à sa fenêtre parente.

Pour plus d’informations, consultez [EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

##  <a name="setmodify"></a>  CRichEditCtrl::SetModify

Définit ou efface l’indicateur modifié pour un contrôle d’édition.

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Paramètres

*bModified*<br/>
La valeur TRUE indique que le texte a été modifié et la valeur FALSe indique qu’il n’est pas modifié. Par défaut, l’indicateur modifié est défini.

### <a name="remarks"></a>Notes

L’indicateur modifié indique si le texte du contrôle d’édition a été modifié ou non. Elle est définie automatiquement chaque fois que l’utilisateur modifie le texte. Sa valeur peut être récupérée à l’aide de la fonction membre [GetModify](#getmodify) .

Pour plus d’informations, consultez [EM_SETMODIFY](/windows/win32/Controls/em-setmodify) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [GetModify](#getmodify).

##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback

Donne à `CRichEditCtrl` cet objet `IRichEditOleCallback` un objet à utiliser pour accéder aux ressources et aux informations relatives à OLE.

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>Paramètres

*pCallback*<br/>
Pointeur vers un objet [IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) qui sera `CRichEditCtrl` utilisé par cet objet pour recevoir des informations et des ressources liées à OLE.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Cet `CRichEditCtrl` objet appellera [IUnknown:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) pour incrémenter le nombre d’utilisations de l’objet com spécifié par *pCallback*.

Pour plus d’informations, consultez message [EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback) et interface [IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) dans la SDK Windows.

##  <a name="setoptions"></a>  CRichEditCtrl::SetOptions

Définit les options pour cet `CRichEditCtrl` objet.

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>Paramètres

*wOp*<br/>
Indique le type de l’opération. L’une des valeurs suivantes :

- ECOOP_SET définit les options à celles spécifiées par *dwFlags*.

- ECOOP_OR combine les options actuelles avec celles spécifiées par *dwFlags*.

- ECOOP_AND conserve uniquement les options actuelles qui sont également spécifiées par *dwFlags*.

- ECOOP_XOR logiquement exclusive ou les options actuelles avec celles qui sont spécifiées par *dwFlags*.

*dwFlags*<br/>
Options d’édition enrichies. Les valeurs d’indicateur sont répertoriées dans la section Notes.

### <a name="remarks"></a>Notes

Les options peuvent être une combinaison des valeurs suivantes:

- ECO_AUTOWORDSELECTION la sélection automatique des mots sur le double-clic.

- ECO_AUTOVSCROLL fait défiler automatiquement le texte vers la droite de 10 caractères lorsque l’utilisateur tape un caractère à la fin de la ligne. Quand l’utilisateur appuie sur la touche entrée, le contrôle fait défiler tout le texte jusqu’à la position zéro.

- ECO_AUTOHSCROLL fait défiler automatiquement le texte d’une page vers le haut lorsque l’utilisateur appuie sur la touche entrée sur la dernière ligne.

- ECO_NOHIDESEL inverse le comportement par défaut d’un contrôle d’édition. Le comportement par défaut masque la sélection lorsque le contrôle perd le focus d’entrée et affiche la sélection lorsque le contrôle reçoit le focus d’entrée. Si vous spécifiez ECO_NOHIDESEL, le texte sélectionné est inversé, même si le contrôle n’a pas le focus.

- ECO_READONLY empêche l’utilisateur de taper ou de modifier du texte dans le contrôle d’édition.

- ECO_WANTRETURN spécifie qu’un retour chariot est inséré lorsque l’utilisateur appuie sur la touche entrée tout en entrant du texte dans un contrôle Rich Edit à plusieurs lignes dans une boîte de dialogue. Si vous ne spécifiez pas ce style, le fait d’appuyer sur la touche entrée envoie une commande à la fenêtre parente du contrôle RichEdit, qui simule le clic sur le bouton par défaut de la fenêtre parente (par exemple, le bouton OK dans une boîte de dialogue). Ce style n’a aucun effet sur un contrôle d’édition sur une seule ligne.

- ECO_SAVESEL conserve la sélection lorsque le contrôle perd le focus. Par défaut, l’ensemble du contenu du contrôle est sélectionné lorsqu’il obtient le focus.

- ECO_VERTICAL dessine le texte et les objets dans un sens vertical. Disponible pour les langues asiatiques uniquement.

Pour plus d’informations, consultez [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

##  <a name="setparaformat"></a>  CRichEditCtrl::SetParaFormat

Définit les attributs de mise en forme du paragraphe pour la sélection `CRichEditCtrl` actuelle dans cet objet.

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>Paramètres

*pf*<br/>
Dans la première version, pointeur vers une structure [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) contenant les nouveaux attributs de mise en forme des paragraphes par défaut.

Dans la deuxième version, pointeur vers une structure [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) , qui est une extension Rich Edit 2,0 de la `PARAFORMAT` structure, contenant les attributs de mise en forme de caractères par défaut.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Seuls les attributs spécifiés par `dwMask` le membre de *PF* sont modifiés par cette fonction.

Pour plus d’informations, consultez le message [EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat) et `PARAFORMAT` les `PARAFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

##  <a name="setpunctuation"></a>  CRichEditCtrl::SetPunctuation

Définit la ponctuation dans un contrôle RichEdit.

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>Paramètres

*fType*<br/>
Indicateur de ponctuation. Pour obtenir la liste des valeurs possibles, consultez le paramètre *ftype* pour [EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation) dans le SDK Windows.

*lpPunc*<br/>
Pointeur vers une structure de [PUNCTUATION](/windows/win32/api/richedit/ns-richedit-punctuation), comme décrit dans la SDK Windows.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite, sinon 0.

### <a name="remarks"></a>Notes

Cette fonction membre est disponible uniquement pour les versions asiatiques du système d’exploitation.

##  <a name="setreadonly"></a>  CRichEditCtrl::SetReadOnly

Modifie l’option ECO_READONLY pour cet `CRichEditCtrl` objet.

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>Paramètres

*bReadOnly*<br/>
Indique si cet `CRichEditCtrl` objet doit être en lecture seule.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Pour obtenir une brève description de cette option, consultez [SetOptions](#setoptions). Vous pouvez utiliser cette fonction pour définir toutes les options de cet `CRichEditCtrl` objet.

Pour plus d’informations, consultez [EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

##  <a name="setrect"></a>  CRichEditCtrl::SetRect

Définit le rectangle de mise en forme `CRichEditCtrl` pour cet objet.

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) ou pointeur vers un [Rect](/windows/win32/api/windef/ns-windef-rect) qui indique les nouvelles limites du rectangle de mise en forme.

### <a name="remarks"></a>Notes

Le rectangle de mise en forme est le rectangle de limitation du texte. Le rectangle de limitation est indépendant de la taille de la fenêtre de contrôle RichEdit. Lorsque cet `CRichEditCtrl` objet est créé pour la première fois, le rectangle de mise en forme est de la même taille que la zone cliente de la fenêtre. Utilisez `SetRect` pour que le rectangle de mise en forme soit plus grand ou plus petit que la fenêtre de modification enrichie.

Pour plus d’informations, consultez [EM_SETRECT](/windows/win32/Controls/em-setrect) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

##  <a name="setsel"></a>  CRichEditCtrl::SetSel

Définit la sélection dans cet `CRichEditCtrl` objet.

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>Paramètres

*nStartChar*<br/>
Index de base zéro du premier caractère de la sélection.

*nEndChar*<br/>
Index de base zéro du dernier caractère de la sélection.

*cr*<br/>
Structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) qui contient les limites de la sélection actuelle.

### <a name="remarks"></a>Notes

Les deux formes de cette fonction offrent d’autres façons de définir les limites de la sélection. Une brève description de ces formulaires suit:

- **SetSel (** `cr` **)** ce formulaire utilise la `CHARRANGE` structure avec ses `cpMin` membres `cpMax` et pour définir les limites.

- **SetSel (** `nStartChar` **,** ) ce formulaire utilise les paramètres nStartChar et nEndChar pour définir les limites. `nEndChar`

Le signe insertion est placé à la fin de la sélection indiquée par la plus grande des index de`cpMin` début (ou de *nStartChar*)`cpMax` et de fin (ou *nEndChar*). Cette fonction fait défiler le contenu `CRichEditCtrl` de afin que le signe insertion soit visible.

Pour sélectionner tout le texte de cet `CRichEditCtrl` objet, appelez `SetSel` avec un index de début de 0 et un index de fin de-1.

Pour plus d’informations, consultez [EM_EXSETSEL](/windows/win32/Controls/em-exsetsel) message and [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) structure dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [GetSel](#getsel).

##  <a name="setselectioncharformat"></a>  CRichEditCtrl::SetSelectionCharFormat

Définit les attributs de mise en forme de caractères pour le texte de la sélection `CRichEditCtrl` actuelle dans cet objet.

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*cf*<br/>
Dans la première version, pointeur vers une structure [Charformat](/windows/win32/api/richedit/ns-richedit-_charformat) contenant les nouveaux attributs de mise en forme de caractères pour la sélection actuelle.

Dans la deuxième version, pointeur vers une structure [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , qui est une extension Rich Edit 2,0 de la `CHARFORMAT` structure, contenant les nouveaux attributs de mise en forme de caractères pour la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Seuls les attributs spécifiés par `dwMask` le membre de *CF* sont modifiés par cette fonction.

Pour plus d’informations, consultez les structures [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et les structures `CHARFORMAT` et `CHARFORMAT2` dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

##  <a name="settargetdevice"></a>  CRichEditCtrl::SetTargetDevice

Définit l’appareil cible et la largeur de ligne utilisés pour le format WYSIWYG (que vous obtenez) dans cet `CRichEditCtrl` objet.

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>Paramètres

*hDC*<br/>
Handle vers le contexte de périphérique pour le nouvel appareil cible.

*lLineWidth*<br/>
Largeur de ligne à utiliser pour la mise en forme.

*dc*<br/>
[CDC](../../mfc/reference/cdc-class.md) pour le nouvel appareil cible.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Si cette fonction est réussie, le contrôle Rich Edit possède le contexte de périphérique passé en tant que paramètre. Dans ce cas, la fonction appelante ne doit pas détruire le contexte de périphérique.

Pour plus d’informations, consultez [EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

##  <a name="settextmode"></a>  CRichEditCtrl::SetTextMode

Définit le mode texte ou le niveau d’annulation et de rétablissement pour un contrôle RichEdit.

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>Paramètres

*fMode*<br/>
Spécifie les nouveaux paramètres pour le mode texte et les paramètres de niveau d’annulation du contrôle. Pour obtenir la liste des valeurs possibles, consultez le paramètre mode de [EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode) dans la SDK Windows.

### <a name="return-value"></a>Valeur de retour

Zéro en cas de réussite, sinon valeur différente de zéro.

### <a name="remarks"></a>Notes

Pour obtenir une description des modes de texte, consultez EM_SETTEXTMODE dans le SDK Windows.

Cette fonction membre échoue si le contrôle contient du texte. Pour vous assurer que le contrôle est vide, envoyez un message [WM_SETTEXT](/windows/win32/winmsg/wm-settext) avec une chaîne vide.

##  <a name="setundolimit"></a>  CRichEditCtrl::SetUndoLimit

Définit le nombre maximal d’actions qui peuvent être stockées dans la file d’attente d’annulation.

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>Paramètres

*nLimit*<br/>
Spécifie le nombre maximal d’actions qui peuvent être stockées dans la file d’attente d’annulation. Affectez la valeur zéro pour désactiver annuler.

### <a name="return-value"></a>Valeur de retour

Nouveau nombre maximal d’actions d’annulation pour le contrôle RichEdit.

### <a name="remarks"></a>Notes

Par défaut, le nombre maximal d’actions dans la file d’attente d’annulation est 100. Si vous augmentez ce nombre, la mémoire disponible doit être suffisante pour accueillir le nouveau nombre. Pour de meilleures performances, définissez la limite à la plus petite valeur possible.

##  <a name="setwordcharformat"></a>  CRichEditCtrl::SetWordCharFormat

Définit les attributs de mise en forme des caractères pour le mot actuellement `CRichEditCtrl` sélectionné dans cet objet.

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*cf*<br/>
Dans la première version, pointeur vers une structure [Charformat](/windows/win32/api/richedit/ns-richedit-_charformat) contenant les nouveaux attributs de mise en forme des caractères pour le mot actuellement sélectionné.

Dans la deuxième version, pointeur vers une structure [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , qui est une extension Rich Edit 2,0 de la `CHARFORMAT` structure, contenant les nouveaux attributs de mise en forme de caractères pour le mot actuellement sélectionné.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro en cas de réussite; Sinon, 0.

### <a name="remarks"></a>Notes

Seuls les attributs spécifiés par `dwMask` le membre de *CF* sont modifiés par cette fonction.

Pour plus d’informations, consultez le message [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et `CHARFORMAT` les `CHARFORMAT2` structures et dans le SDK Windows.

### <a name="example"></a>Exemples

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

##  <a name="setwordwrapmode"></a>  CRichEditCtrl::SetWordWrapMode

Définit les options de retour automatique à la disposition et de césure de mots pour le contrôle RichEdit.

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>Paramètres

*uFlags*<br/>
Options à définir pour le retour automatique à la disposition des mots et du retour automatique à la disposition. Pour obtenir la liste des options possibles, consultez [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Options de retour automatique à la disposition et de césure en cours.

### <a name="remarks"></a>Notes

Ce message est disponible uniquement dans les versions en langue asiatique du système d’exploitation.

##  <a name="stopgrouptyping"></a>  CRichEditCtrl::StopGroupTyping

Empêche le contrôle de collecter des actions de frappe supplémentaires dans l’action d’annulation actuelle.

```
void StopGroupTyping();
```

### <a name="remarks"></a>Notes

Le contrôle stocke l’action de frappe suivante, le cas échéant, dans une nouvelle action de la file d’attente d’annulation.

Pour plus d’informations, consultez [EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) dans le SDK Windows.

##  <a name="streamin"></a>  CRichEditCtrl::StreamIn

Remplace le texte de `CRichEditCtrl` cet objet par le texte du flux d’entrée spécifié.

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Paramètres

*nFormat*<br/>
Indicateurs spécifiant les formats de données d’entrée. Pour plus d'informations, consultez la section Notes.

*sec*<br/>
Structure [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) spécifiant le flux d’entrée. Pour plus d'informations, consultez la section Notes.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères lus à partir du flux d’entrée.

### <a name="remarks"></a>Notes

La valeur de *nFormat* doit être l’une des suivantes:

- SF_TEXT indique la lecture du texte uniquement.

- SF_RTF indique la lecture du texte et de la mise en forme.

L’une ou l’autre de ces valeurs peut être combinée avec SFF_SELECTION. Si SFF_SELECTION est spécifié, `StreamIn` remplace la sélection actuelle par le contenu du flux d’entrée. S’il n’est pas spécifié `StreamIn` , remplace tout le contenu de `CRichEditCtrl` cet objet.

Dans le `EDITSTREAM` paramètre *es*, vous spécifiez une fonction de rappel qui remplit un tampon avec du texte. Cette fonction de rappel est appelée à plusieurs reprises, jusqu’à ce que le flux d’entrée soit épuisé.

Pour plus d’informations, consultez [EM_STREAMIN](/windows/win32/Controls/em-streamin) message and [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) structure dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

##  <a name="streamout"></a>  CRichEditCtrl::StreamOut

Écrit le contenu de cet `CRichEditCtrl` objet dans le flux de sortie spécifié.

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Paramètres

*nFormat*<br/>
Indicateurs spécifiant les formats de données de sortie. Pour plus d'informations, consultez la section Notes.

*sec*<br/>
Structure [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) spécifiant le flux de sortie. Pour plus d'informations, consultez la section Notes.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères écrits dans le flux de sortie.

### <a name="remarks"></a>Notes

La valeur de *nFormat* doit être l’une des suivantes:

- SF_TEXT indique l’écriture de texte uniquement.

- SF_RTF indique l’écriture de texte et de mise en forme.

- SF_RTFNOOBJS indique l’écriture de texte et de mise en forme, en remplaçant les éléments OLE par des espaces.

- SF_TEXTIZED indique l’écriture de texte et de mise en forme avec des représentations textuelles d’éléments OLE.

Ces valeurs peuvent être combinées avec SFF_SELECTION. Si SFF_SELECTION est spécifié, `StreamOut` écrit la sélection actuelle dans le flux de sortie. S’il n’est pas spécifié `StreamOut` , écrit le contenu entier de cet `CRichEditCtrl` objet.

Dans le `EDITSTREAM` paramètre *es*, vous spécifiez une fonction de rappel qui remplit un tampon avec du texte. Cette fonction de rappel est appelée à plusieurs reprises, jusqu’à épuisement du flux de sortie.

Pour plus d’informations, consultez [EM_STREAMOUT](/windows/win32/Controls/em-streamout) message and [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) structure dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

##  <a name="undo"></a>  CRichEditCtrl::Undo

Annule la dernière opération dans le contrôle Rich Edit.

```
BOOL Undo();
```

### <a name="return-value"></a>Valeur de retour

Différent de zéro si l’opération d’annulation réussit; Sinon, 0.

### <a name="remarks"></a>Notes

Une opération d’annulation peut également être annulée. Par exemple, vous pouvez restaurer le texte supprimé avec le premier appel `Undo`à. Tant qu’il n’y a pas d’opération de modification intermédiaire, vous pouvez supprimer le texte avec un deuxième appel `Undo`à.

Pour plus d’informations, consultez [EM_UNDO](/windows/win32/Controls/em-undo) dans le SDK Windows.

### <a name="example"></a>Exemple

  Consultez l’exemple pour [CanUndo](#canundo).

## <a name="see-also"></a>Voir aussi

[Exemple MFC WORDPAD](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CEdit, classe](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView, classe](../../mfc/reference/cricheditview-class.md)
