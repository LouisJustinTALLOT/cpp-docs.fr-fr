---
title: Classe CRichEditCtrl
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 07c3c864e91d8aebc8d70f54fed4286a24986208
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368273"
---
# <a name="cricheditctrl-class"></a>Classe CRichEditCtrl

Fournit les fonctionnalités du contrôle d'édition enrichi.

## <a name="syntax"></a>Syntaxe

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>Membres

### <a name="public-constructors"></a>Constructeurs publics

|Nom|Description|
|----------|-----------------|
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|Construit un objet `CRichEditCtrl`.|

### <a name="public-methods"></a>M&#233;thodes publiques

|Nom|Description|
|----------|-----------------|
|[CRichEditCtrl::CanPaste](#canpaste)|Détermine si le contenu du Clipboard peut être collé dans ce contrôle de modification riche.|
|[CRichEditCtrl::CanRedo](#canredo)|Détermine s’il y a des actions dans la file d’attente de la circulation.|
|[CRichEditCtrl::CanUndo](#canundo)|Détermine si une opération d’édition peut être annulée.|
|[CRichEditCtrl::CharDepos](#charfrompos)|Récupère des informations sur le personnage le plus proche d’un point spécifié dans la zone client d’un contrôle de modification.|
|[CRichEditCtrl::Clair](#clear)|Efface la sélection actuelle.|
|[CRichEditCtrl::Copie](#copy)|Copie de la sélection actuelle au Clipboard.|
|[CRichEditCtrl::Créer](#create)|Crée le contrôle d’édition riche `CRichEditCtrl` windows et l’associe à cet objet.|
|[CRichEditCtrl::CreateEx](#createex)|Crée le contrôle d’édition riche windows avec les `CRichEditCtrl` styles Windows étendus spécifiés et l’associe à cet objet.|
|[CRichEditCtrl::Cut](#cut)|Coupe la sélection actuelle au Clipboard.|
|[CRichEditCtrl::DisplayBand](#displayband)|Affiche une partie du `CRichEditCtrl` contenu de cet objet.|
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|Réinitialise (efface) le `CRichEditCtrl` drapeau défaire de cet objet.|
|[CRichEditCtrl::FindText](#findtext)|Localise le `CRichEditCtrl` texte dans cet objet.|
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|Trouve le mot suivant pause avant ou après la position de caractère spécifiée, ou récupère des informations sur le personnage à cette position.|
|[CRichEditCtrl::FormatRange](#formatrange)|Formate une gamme de texte pour le périphérique de sortie cible.|
|[CRichEditCtrl::GetCharPos](#getcharpos)|Détermine l’emplacement d’un `CRichEditCtrl` personnage donné à l’intérieur de cet objet.|
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|Récupère les attributs actuels de formatage de caractère par défaut dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetEventMask](#geteventmask)|Récupère le masque d’événement pour cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|Détermine la ligne visible la `CRichEditCtrl` plus haute de cet objet.|
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|Récupère un pointeur `IRichEditOle` à l’interface pour ce contrôle d’édition riche.|
|[CRichEditCtrl::GetLimitText](#getlimittext)|Obtient la limite sur la quantité de `CRichEditCtrl` texte qu’un utilisateur peut entrer dans cet objet.|
|[CRichEditCtrl::GetLine](#getline)|Récupère une ligne de `CRichEditCtrl` texte de cet objet.|
|[CRichEditCtrl::GetLineCount](#getlinecount)|Récupère le nombre de `CRichEditCtrl` lignes dans cet objet.|
|[CRichEditCtrl::GetModify](#getmodify)|Détermine si le contenu `CRichEditCtrl` de cet objet a changé depuis le dernier enregistrement.|
|[CRichEditCtrl::GetOptions](#getoptions)|Récupère les riches options de contrôle de modification.|
|[CRichEditCtrl::GetParaFormat](#getparaformat)|Récupère les attributs de formatage du `CRichEditCtrl` paragraphe dans la sélection actuelle de cet objet.|
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|Récupère les caractères de ponctuation actuels pour le contrôle d’édition riche. Ce message n’est disponible que dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::GetRect](#getrect)|Récupère le rectangle de `CRichEditCtrl` formatage pour cet objet.|
|[CRichEditCtrl::GetRedoName](#getredoname)|Récupère le type de l’action suivante, le cas échéant, dans la file d’attente de la commande.|
|[CRichEditCtrl::GetSel](#getsel)|Obtient les positions de départ et `CRichEditCtrl` de fin de la sélection actuelle dans cet objet.|
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|Récupère les attributs de formatage des `CRichEditCtrl` personnages dans la sélection actuelle de cet objet.|
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|Récupère le type de contenu dans `CRichEditCtrl` la sélection actuelle dans cet objet.|
|[CRichEditCtrl::GetSelText](#getseltext)|Obtient le texte de la `CRichEditCtrl` sélection actuelle dans cet objet|
|[CRichEditCtrl::GetTextLength](#gettextlength)|Récupère la longueur du texte, en `CRichEditCtrl` caractères, dans cet objet. N’inclut pas le caractère nul de fin.|
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|Récupère le nombre de caractères ou d’octets dans la vue d’édition riche. Accepte une liste de drapeaux pour indiquer la méthode de détermination de la longueur du texte dans un contrôle de modification riche|
|[CRichEditCtrl::GetTextMode](#gettextmode)|Récupère le mode texte actuel et annule le niveau d’un contrôle d’édition riche.|
|[CRichEditCtrl::GetTextRange](#gettextrange)|Récupère la plage spécifiée de texte.|
|[CRichEditCtrl::GetUndoName](#getundoname)|Récupère le type de l’action annuler prochaine, le cas échéant.|
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|Récupère les options actuelles d’emballage de mots et de rupture de mot pour le contrôle d’édition riche. Ce message n’est disponible que dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::HideSelection](#hideselection)|Affiche ou cache la sélection actuelle.|
|[CRichEditCtrl::LimitText](#limittext)|Limite la quantité de texte qu’un utilisateur peut entrer dans l’objet. `CRichEditCtrl`|
|[CRichEditCtrl::LineDeChar](#linefromchar)|Détermine quelle ligne contient le caractère donné.|
|[CRichEditCtrl::LineIndex](#lineindex)|Récupère l’index de caractère d’une ligne donnée dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::LineLength](#linelength)|Récupère la longueur d’une `CRichEditCtrl` ligne donnée dans cet objet.|
|[CRichEditCtrl::LineScroll](#linescroll)|Faites défiler le `CRichEditCtrl` texte de cet objet.|
|[CRichEditCtrl::Paste](#paste)|Insère le contenu du Clipboard dans ce riche contrôle d’édition.|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|Insère le contenu du Clipboard dans ce contrôle d’édition riche dans le format de données spécifié.|
|[CRichEditCtrl::PosFromChar](#posfromchar)|Récupère les coordonnées de la zone client d’un personnage spécifié dans un contrôle de modification.|
|[CRichEditCtrl::Redo](#redo)|Refait la prochaine action dans la file d’attente de la refonte du contrôle.|
|[CRichEditCtrl::ReplaceSel](#replacesel)|Remplace la sélection actuelle `CRichEditCtrl` dans cet objet par un texte spécifié.|
|[CRichEditCtrl::RequestResize](#requestresize)|Force `CRichEditCtrl` cet objet à envoyer des notifications de resize de demande.|
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|Indique si la détection d’URL automatique est active dans un contrôle de modification riche.|
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|Définit la couleur `CRichEditCtrl` de fond dans cet objet.|
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|Définit les attributs actuels de `CRichEditCtrl` formatage de caractère par défaut dans cet objet.|
|[CRichEditCtrl::SetEventMask](#seteventmask)|Définit le masque `CRichEditCtrl` d’événement pour cet objet.|
|[CRichEditCtrl::SetModify](#setmodify)|Définit ou efface le drapeau `CRichEditCtrl` de modification de cet objet.|
|[CRichEditCtrl::SetOLECallback](#setolecallback)|Définit `IRichEditOleCallback` l’objet COM pour ce contrôle d’édition riche.|
|[CRichEditCtrl::SetOptions](#setoptions)|Définit les options `CRichEditCtrl` pour cet objet.|
|[CRichEditCtrl::SetParaFormat](#setparaformat)|Définit les attributs de formatage du `CRichEditCtrl` paragraphe dans la sélection actuelle de cet objet.|
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|Définit les caractères de ponctuation pour un contrôle d’édition riche. Ce message n’est disponible que dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::SetReadOnly](#setreadonly)|Définit l’option de `CRichEditCtrl` lecture uniquement pour cet objet.|
|[CRichEditCtrl::SetRect](#setrect)|Définit le rectangle de `CRichEditCtrl` formatage pour cet objet.|
|[CRichEditCtrl::SetSel](#setsel)|Définit la sélection `CRichEditCtrl` dans cet objet.|
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|Définit les attributs de formatage des `CRichEditCtrl` personnages dans la sélection actuelle de cet objet.|
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|Définit le périphérique de `CRichEditCtrl` sortie cible pour cet objet.|
|[CRichEditCtrl::SetTextMode](#settextmode)|Définit le mode texte ou annule le niveau d’un contrôle d’édition riche. Le message échoue si le contrôle contient du texte.|
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|Définit le nombre maximum d’actions qui peuvent être stockées dans la file d’attente.|
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|Définit les attributs de formatage de `CRichEditCtrl` caractère dans le mot actuel dans cet objet.|
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|Définit les options d’emballage de mots et de rupture de mots pour le contrôle d’édition riche. Ce message n’est disponible que dans les versions en langue asiatique du système d’exploitation.|
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|Empêche le contrôle de collecter des actions de frappe supplémentaires dans l’action annuler en cours. Le contrôle stocke l’action de frappe suivante, le cas échéant, dans une nouvelle action dans la file d’attente annuler.|
|[CRichEditCtrl::StreamIn](#streamin)|Insère le texte d’un flux d’entrée dans cet `CRichEditCtrl` objet.|
|[CRichEditCtrl::StreamOut](#streamout)|Stocke le `CRichEditCtrl` texte de cet objet dans un flux de sortie.|
|[CRichEditCtrl::Undo](#undo)|Renverse la dernière opération d’édition.|

## <a name="remarks"></a>Notes

Un « contrôle d’édition riche » est une fenêtre dans laquelle l’utilisateur peut entrer et modifier le texte. Le texte peut être attribué formatage de caractère et de paragraphe, et peut inclure des objets OLE intégrés. Les contrôles d’édition riches fournissent une interface de programmation pour le formatage du texte. Toutefois, une application doit implémenter tous les composants d’interface utilisateur nécessaires pour mettre les opérations de formatage à la disposition de l’utilisateur.

Ce contrôle Windows Common `CRichEditCtrl` (et donc la classe) n’est disponible que pour les programmes fonctionnant sous Windows 95/98 et Windows NT versions 3.51 et plus tard. La `CRichEditCtrl` classe prend en charge les versions 2.0 et 3.0 du contrôle d’édition riche Windows SDK.

> [!CAUTION]
> Si vous utilisez un contrôle d’édition riche dans une boîte de dialogue (que votre application soit SDI, MDI ou basée sur le dialogue), vous devez appeler [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit) une fois avant que la boîte de dialogue ne s’affiche. Un endroit typique pour appeler cette fonction `InitInstance` est dans la fonction de membre de votre programme. Vous n’avez pas besoin de l’appeler pour chaque fois que vous affichez la boîte de dialogue, seulement la première fois. Vous n’avez `AfxInitRichEdit` pas à appeler `CRichEditView`si vous travaillez avec .

Pour plus d’informations sur l’utilisation `CRichEditCtrl`, voir:

- [Contrôles](../../mfc/controls-mfc.md)

- [Utilisation de CRichEditCtrl](../../mfc/using-cricheditctrl.md)

Par exemple, utilisez un contrôle d’édition riche dans une application MFC, consultez l’application [d’échantillon WORDPAD.](../../overview/visual-cpp-samples.md)

## <a name="inheritance-hierarchy"></a>Hiérarchie d'héritage

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>Spécifications

**En-tête :** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a>CRichEditCtrl::CanPaste

Détermine si le contrôle d’édition riche peut coller le format Clipboard spécifié.

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>Paramètres

*nFormat (en)*<br/>
Le format de données Clipboard à interroger. Ce paramètre peut être l’un des formats Predefined Clipboard ou la valeur retournée par [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw).

### <a name="return-value"></a>Valeur de retour

Nonzero si le format Clipboard peut être collé; sinon 0.

### <a name="remarks"></a>Notes

Si *nFormat* est `CanPaste` 0, essayera n’importe quel format actuellement sur le Clipboard.

Pour plus d’informations, voir [EM_CANPASTE](/windows/win32/Controls/em-canpaste) message et la fonction [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a>CRichEditCtrl::CanRedo

Détermine si la file d’attente de redo contient des actions.

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si la file d’attente de refaire contient des actions, sinon 0.

### <a name="remarks"></a>Notes

Pour découvrir le nom de l’opération dans la file d’attente refaire, appelez [CRichEditCtrl::GetRedoName](#getredoname). Pour refaire la dernière opération Undo, appelez [Redo](#redo).

Pour plus d’informations, voir [EM_CANREDO](/windows/win32/Controls/em-canredo) dans le SDK Windows.

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a>CRichEditCtrl::CanUndo

Détermine si la dernière opération d’édition peut être annulée.

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si la dernière opération de modification peut être annulée par un appel à la fonction membre [Annuler;](#undo) 0 s’il ne peut pas être annulé.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_CANUNDO](/windows/win32/Controls/em-canundo) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a>CRichEditCtrl::CharDepos

Récupère des informations sur le personnage au point spécifié par le *paramètre pt*.

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>Paramètres

*Pt*<br/>
Un objet [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) contenant les coordonnées du point spécifié.

### <a name="return-value"></a>Valeur de retour

L’index de caractère basé sur zéro du personnage le plus proche du point spécifié. Si le point spécifié est au-delà du dernier caractère dans le contrôle, la valeur de retour indique le dernier caractère dans le contrôle.

### <a name="remarks"></a>Notes

Cette fonction de membre fonctionne avec un contrôle d’édition riche. Pour obtenir l’information pour un contrôle de modification, appelez [CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos).

Pour plus d’informations, voir [EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) dans le SDK Windows.

## <a name="cricheditctrlclear"></a><a name="clear"></a>CRichEditCtrl::Clair

Supprime (efface) la sélection actuelle (le cas échéant) dans le contrôle d’édition riche.

```
void Clear();
```

### <a name="remarks"></a>Notes

La suppression effectuée `Clear` par peut être annulée en appelant la fonction membre [Annuler.](#undo)

Pour supprimer la sélection actuelle et placer le contenu supprimé sur le Clipboard, appelez la fonction [membre Cut.](#cut)

Pour plus d’informations, voir [WM_CLEAR](/windows/win32/dataxchg/wm-clear) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a>CRichEditCtrl::Copie

Copie la sélection actuelle (le cas échéant) dans le contrôle d’édition riche au Clipboard.

```
void Copy();
```

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [WM_COPY](/windows/win32/dataxchg/wm-copy) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a>CRichEditCtrl::Créer

Crée le contrôle d’édition riche `CRichEditCtrl` windows et l’associe à cet objet.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwStyle (en)*<br/>
Spécifie le style du contrôle de modification. Appliquer une combinaison des styles de fenêtre énumérés dans la section **Remarques** ci-dessous, et [modifier les styles de contrôle](/windows/win32/Controls/edit-control-styles), décrit dans le SDK Windows.

*Rect*<br/>
Spécifie la taille et la position du contrôle de modification. Peut être un objet [CRect](../../atl-mfc-shared/reference/crect-class.md) ou une structure [RECT.](/windows/win32/api/windef/ns-windef-rect)

*pParentWnd*<br/>
Spécifie la fenêtre parente du contrôle d’édition (souvent un [CDialog](../../mfc/reference/cdialog-class.md)). Ce ne doit pas être NULL.

*nID*<br/>
Spécifie l’ID du contrôle de modification.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’initialisation est réussie; autrement, 0.

### <a name="remarks"></a>Notes

Vous construisez un `CRichEditCtrl` objet en deux étapes. Tout d’abord, appelez le constructeur [CRichEditCtrl,](#cricheditctrl) puis appelez `Create`, ce `CRichEditCtrl` qui crée le contrôle de modification Windows et l’attache à l’objet.

Lorsque vous créez un contrôle d’édition riche avec cette fonction, vous devez d’abord charger la bibliothèque de commandes communes nécessaire. Pour charger la bibliothèque, appelez la fonction globale [AfxInitRichEdit](application-information-and-management.md#afxinitrichedit), qui à son tour initialise la bibliothèque de contrôle commun. Vous n’avez besoin d’appeler `AfxInitRichEdit` qu’une seule fois dans votre processus.

Lors `Create` de l’exécution, Windows envoie le [WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate), [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize), [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate), et [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) messages au contrôle de modification.

Ces messages sont traités par défaut par le [OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate), [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize), [OnCreate](../../mfc/reference/cwnd-class.md#oncreate) `CWnd` , et Les fonctions des membres [OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) dans la classe de base. Pour étendre la manipulation par défaut `CRichEditCtrl`du message, extraire une classe, ajouter une carte de message à la nouvelle classe et remplacer les fonctions de membre de message ci-dessus. `OnCreate`Remplacer, par exemple, pour effectuer l’initialisation nécessaire pour la nouvelle classe.

Appliquer les [styles de fenêtre](../../mfc/reference/styles-used-by-mfc.md#window-styles) suivants à un contrôle de modification.

- WS_CHILD toujours.

- WS_VISIBLE Habituellement.

- WS_DISABLED Rarement.

- WS_GROUP Pour regrouper les contrôles.

- WS_TABSTOP Inclure le contrôle de modification dans l’ordre de tabbing.

Pour plus d’informations sur les styles de fenêtre, voir [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a>CRichEditCtrl::CreateEx

Crée un contrôle (une fenêtre enfant) `CRichEditCtrl` et l’associe à l’objet.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Paramètres

*dwExStyle (en anglais)*<br/>
Spécifie le style étendu du contrôle en cours de création. Pour une liste de styles Windows étendus, consultez le paramètre *dwExStyle* pour [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) dans le Windows SDK.

*dwStyle (en)*<br/>
Spécifie le style du contrôle de modification. Appliquer une combinaison des styles de fenêtre énumérés dans la section **Remarques** de [Créer](#create) et modifier les styles de [contrôle](/windows/win32/Controls/edit-control-styles), décrit dans le SDK Windows.

*Rect*<br/>
Une référence à une structure [RECT](/previous-versions/dd162897\(v=vs.85\)) décrivant la taille et la position de la fenêtre à créer, dans les coordonnées des clients de *pParentWnd*.

*pParentWnd*<br/>
Un pointeur vers la fenêtre qui est le parent du contrôle.

*nID*<br/>
L’id de fenêtre pour enfants du contrôle.

### <a name="return-value"></a>Valeur de retour

Valeur différente de zéro cas de réussite ; sinon, 0.

### <a name="remarks"></a>Notes

Utilisez `CreateEx` au `Create` lieu d’appliquer des styles Windows étendus, spécifiés par la préface de style étendu Windows **WS_EX_**.

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a>CRichEditCtrl::CRichEditCtrl

Construit un objet `CRichEditCtrl`.

```
CRichEditCtrl();
```

### <a name="remarks"></a>Notes

Utilisez [Create](#create) pour construire le contrôle d’édition riche en fenêtres.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a>CRichEditCtrl::Cut

Supprimer (coupes) la sélection actuelle (le cas échéant) dans le contrôle de modification riche et copie le texte supprimé à la Carte Clip.

```
void Cut();
```

### <a name="remarks"></a>Notes

La suppression effectuée `Cut` par peut être annulée en appelant la fonction membre [Annuler.](#undo)

Pour supprimer la sélection actuelle sans placer le texte supprimé dans le Clipboard, appelez la fonction [membre Clear.](#clear)

Pour plus d’informations, voir [WM_CUT](/windows/win32/dataxchg/wm-cut) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a>CRichEditCtrl::DisplayBand

Affiche une partie du contenu du contrôle d’édition riche (textes et éléments OLE), tel qu’auparavant formaté par [FormatRange](#formatrange).

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>Paramètres

*pDisplayRect*<br/>
Pointeur vers un objet [RECT](/windows/win32/api/windef/ns-windef-rect) ou [CRect](../../atl-mfc-shared/reference/crect-class.md) spécifiant la zone de l’appareil pour afficher le texte.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’affichage du texte formaté réussit, autrement, 0.

### <a name="remarks"></a>Notes

Le texte et les éléments OLE sont coupés à la zone spécifiée par le pointeur *pDisplayRect*.

Pour plus d’informations, voir [EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CRichEditCtrl:FormatRange](#formatrange).

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a>CRichEditCtrl::EmptyUndoBuffer

Réinitialise (clair) le drapeau annuler de ce contrôle d’édition riche.

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>Notes

Le contrôle sera désormais incapable de défaire la dernière opération d’édition. Le drapeau annuler est réglé chaque fois qu’une opération dans le contrôle d’édition riche peut être annulée.

Le drapeau de défaire est automatiquement effacé chaque fois que vous appelez la fonction membre [CWnd](../../mfc/reference/cwnd-class.md) [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

Pour plus d’informations, voir [EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a>CRichEditCtrl::FindText

Trouve du texte dans le contrôle de modification riche.

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>Paramètres

*dwFlags*<br/>
Pour une liste de valeurs possibles, voir *wParam* dans [EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex) dans le Windows SDK.

*pFindText*<br/>
Pointeur vers la structure [FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw) donnant les paramètres de la recherche et le retour de la plage où le match a été trouvé.

### <a name="return-value"></a>Valeur de retour

Position de caractère basée sur zéro du prochain match; - 1 s’il n’y a plus d’allumettes.

### <a name="remarks"></a>Notes

Vous pouvez rechercher vers le haut ou vers le bas en `FINDTEXTEX` définissant les paramètres de portée appropriés dans la structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) dans la structure.

Pour plus d’informations, consultez [EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) message et la structure [FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a>CRichEditCtrl::FindWordBreak

Trouve le mot suivant pause avant ou après la position spécifiée par *nStart*.

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>Paramètres

*nCode (en)*<br/>
Indique les mesures à prendre. Pour une liste de valeurs possibles, consultez la description du *code* de paramètres dans EM_FINDWORDBREAK dans le SDK Windows.

*nStart (en)*<br/>
La position de caractère zéro à partir de laquelle commencer.

### <a name="return-value"></a>Valeur de retour

Basé sur le paramètre *nCode*. Pour plus d’informations, voir [EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) dans le SDK Windows.

### <a name="remarks"></a>Notes

Vous pouvez utiliser cette fonction de membre pour récupérer des informations sur un personnage à une position donnée.

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a>CRichEditCtrl::FormatRange

Formate une gamme de texte dans un contrôle d’édition riche pour un appareil spécifique.

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>Paramètres

*Pfr*<br/>
Pointeur vers la structure [FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange) qui contient des informations sur le périphérique de sortie. NULL indique que les informations mises en cache dans le contrôle de modification riche peuvent être libérées.

*bDisplay (en)*<br/>
Indique si le texte doit être rendu. Si FALSE, le texte est juste mesuré.

### <a name="return-value"></a>Valeur de retour

L’index du dernier caractère qui s’inscrit dans la région plus un.

### <a name="remarks"></a>Notes

Typiquement, cet appel est suivi d’un appel à [DisplayBand](#displayband).

Pour plus d’informations, voir [EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) message et la structure [FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a>CRichEditCtrl::GetCharPos

Obtient la position (coin supérieur gauche) d’un personnage donné dans cet `CRichEditCtrl` objet.

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>Paramètres

*lChar (en)*<br/>
Indice zéro du personnage.

### <a name="return-value"></a>Valeur de retour

L’emplacement du coin supérieur gauche du personnage spécifié par *lChar*.

### <a name="remarks"></a>Notes

Le caractère est spécifié en donnant sa valeur d’index à base de zéro. Si *lChar* est supérieur à l’index `CRichEditCtrl` du dernier personnage de cet objet, la valeur de retour `CRichEditCtrl` spécifie les coordonnées de la position du personnage juste après le dernier personnage de cet objet.

Pour plus d’informations, voir [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) dans le SDK Windows.

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a>CRichEditCtrl::GetDefaultCharFormat

Obtient les attributs de formatage de caractère par défaut de cet `CRichEditCtrl` objet.

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Paramètres

*Cf*<br/>
Dans la première version, `CHARFORMAT` un pointeur à une structure contenant les attributs de formatage de caractère par défaut.

Dans la deuxième version, `CHARFORMAT2` un pointeur vers une structure, qui est `CHARFORMAT` une extension Rich Edit 2.0 à la structure, tenant les attributs de formatage de caractère par défaut.

### <a name="return-value"></a>Valeur de retour

Le `dwMask` membre des données de *cf*. Il a spécifié les attributs de formatage de caractère par défaut.

### <a name="remarks"></a>Notes

Pour plus d’informations, consultez le `CHARFORMAT` `CHARFORMAT2` message EM_GETCHARFORMAT et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple de [SetDefaultCharFormat](#setdefaultcharformat).

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a>CRichEditCtrl::GetEventMask

Obtient le masque `CRichEditCtrl` d’événement pour cet objet.

```
long GetEventMask() const;
```

### <a name="return-value"></a>Valeur de retour

Le masque d’événement pour cet `CRichEditCtrl` objet.

### <a name="remarks"></a>Notes

Le masque d’événement précise `CRichEditCtrl` les messages de notification que l’objet envoie à sa fenêtre parente.

Pour plus d’informations, voir [EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CRichEditCtrl:SetEventMask](#seteventmask).

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a>CRichEditCtrl::GetFirstVisibleLine

Détermine la ligne visible la `CRichEditCtrl` plus haute de cet objet.

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>Valeur de retour

Indice à base zéro de la `CRichEditCtrl` ligne visible la plus élevée de cet objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a>CRichEditCtrl::GetIRichEditOle

Accéde `IRichEditOle` à l’interface de cet `CRichEditCtrl` objet.

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>Valeur de retour

Pointeur vers l’interface [IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) qui `CRichEditCtrl` peut être utilisée pour accéder à la fonctionnalité OLE de cet objet ; NULL si l’interface n’est pas accessible.

### <a name="remarks"></a>Notes

Utilisez cette interface `CRichEditCtrl` pour accéder à la fonctionnalité OLE de cet objet.

Pour plus d’informations, voir [EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface) message et [l’interface IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole) dans le SDK Windows.

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a>CRichEditCtrl::GetLimitText

Obtient la limite `CRichEditCtrl` de texte pour cet objet.

```
long GetLimitText() const;
```

### <a name="return-value"></a>Valeur de retour

La limite actuelle de texte, `CRichEditCtrl` dans les octets, pour cet objet.

### <a name="remarks"></a>Notes

La limite de texte est la quantité maximale de texte, dans les octets, le contrôle de modification riche peut accepter.

Pour plus d’informations, voir [EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a>CRichEditCtrl::GetLine

Récupère une ligne de `CRichEditCtrl` texte de cet objet.

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Indice zéro de la ligne à récupérer.

*lpszBuffer (en)*<br/>
Points à la mémoire tampon pour recevoir le texte. Le premier mot du tampon doit spécifier le nombre maximum d’octets qui peuvent être copiés dans le tampon.

*nMaxLength (en)*<br/>
Nombre maximum de caractères qui peuvent être copiés en *lpszBuffer*. La deuxième `GetLine` forme de place cette valeur dans le premier mot de la mémoire tampon spécifié par *lpszBuffer*.

### <a name="return-value"></a>Valeur de retour

Le nombre de caractères copiés en *lpszBuffer*.

### <a name="remarks"></a>Notes

La ligne copiée ne contient pas de caractère nul de fin.

> [!NOTE]
> Parce que le premier mot du tampon stocke le nombre de caractères à copier, assurez-vous que votre mémoire tampon est d’au moins 4 octets de long.

Pour plus d’informations, voir [EM_GETLINE](/windows/win32/Controls/em-getline) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [GetLineCount](#getlinecount).

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a>CRichEditCtrl::GetLineCount

Récupère le nombre de `CRichEditCtrl` lignes dans l’objet.

```
int GetLineCount() const;
```

### <a name="return-value"></a>Valeur de retour

Le nombre de `CRichEditCtrl` lignes dans cet objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a>CRichEditCtrl::GetModify

Détermine si le contenu `CRichEditCtrl` de cet objet a été modifié.

```
BOOL GetModify() const;
```

### <a name="return-value"></a>Valeur de retour

Nonzero si le `CRichEditCtrl` texte de cet objet a été modifié; sinon 0.

### <a name="remarks"></a>Notes

Windows maintient un drapeau interne indiquant si le contenu du contrôle d’édition riche ont été modifiés. Ce drapeau est effacé lorsque le contrôle de modification est créé et peut également être effacé en appelant la fonction [membre SetModify.](#setmodify)

Pour plus d’informations, voir [EM_GETMODIFY](/windows/win32/Controls/em-getmodify) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a>CRichEditCtrl::GetOptions

Récupère les options actuellement définies pour le contrôle d’édition riche.

```
UINT GetOptions() const;
```

### <a name="return-value"></a>Valeur de retour

Une combinaison des valeurs actuelles du drapeau d’option. Pour une liste de ces valeurs, voir le *paramètre fOptions* dans le [message EM_SETOPTIONS,](/windows/win32/Controls/em-setoptions) tel que décrit dans le SDK Windows.

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a>CRichEditCtrl::GetParaFormat

Obtient les attributs de formatage de paragraphe de la sélection actuelle.

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>Paramètres

*Pf*<br/>
Dans la première version, un pointeur à une structure [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) pour tenir les attributs de formatage de paragraphe de la sélection actuelle.

Dans la deuxième version, un pointeur vers une structure [PARAFORMAT2,](/windows/win32/api/richedit/ns-richedit-paraformat2) qui `PARAFORMAT` est une extension Rich Edit 2.0 à la structure, tenant les attributs de formatage de caractère par défaut.

### <a name="return-value"></a>Valeur de retour

Le `dwMask` membre des données de *pf*. Il spécifie les attributs de formatage des paragraphes qui sont cohérents tout au long de la sélection actuelle.

### <a name="remarks"></a>Notes

Si plus d’un paragraphe est sélectionné, *pf* reçoit les attributs du premier paragraphe sélectionné. La valeur de rendement spécifie quels attributs sont cohérents tout au long de la sélection.

Pour plus d’informations, consultez le `PARAFORMAT` `PARAFORMAT2` [message EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CRichEditCtrl:SetParaFormat](#setparaformat).

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a>CRichEditCtrl::GetPunctuation

Obtient les caractères de ponctuation actuels dans un contrôle de modification riche.

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>Paramètres

*fType*<br/>
Le drapeau de type ponctuation, tel que décrit dans le paramètre *fType* de [EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation) dans le SDK Windows.

*lpPunc (lpPunc)*<br/>
Un pointeur vers une structure [PUNCTUATION,](/windows/win32/api/richedit/ns-richedit-punctuation) tel que décrit dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Nonzero si l’opération a réussi, sinon 0.

### <a name="remarks"></a>Notes

Cette fonction de membre est disponible avec seulement les versions de langue asiatique du système d’exploitation.

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a>CRichEditCtrl::GetRect

Récupère le rectangle de `CRichEditCtrl` formatage pour cet objet.

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) ou pointeur vers un [RECT](/windows/win32/api/windef/ns-windef-rect) pour `CRichEditCtrl` recevoir le rectangle de formatage de cet objet.

### <a name="remarks"></a>Notes

Le rectangle de formatage est le rectangle de délimitation du texte. Cette valeur est indépendante de `CRichEditCtrl` la taille de l’objet.

Pour plus d’informations, voir [EM_GETRECT](/windows/win32/Controls/em-getrect) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [LimitText](#limittext).

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a>CRichEditCtrl::GetRedoName

Récupère le type de la prochaine action disponible dans la file d’attente refaire, le cas échéant.

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>Valeur de retour

En cas `GetRedoName` de succès, renvoie le type de recensement [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) indiquant le type de l’action suivante dans la file d’attente de la circulation du contrôle. Si la file d’attente est vide, ou si l’action `GetRedoName` de refaire dans la file d’attente est d’un type inconnu, retourne 0.

### <a name="remarks"></a>Notes

Les types d’actions qui peuvent être annulés ou refaits comprennent les opérations de dactylographie, de suppression, de goutte de traînée, de coupe et de pâte. Ces informations peuvent être utiles pour les applications qui fournissent une interface utilisateur étendue pour les opérations Annuler et refaire, telles qu’une boîte de liste d’abandon des actions recomitables.

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a>CRichEditCtrl::GetSel

Récupère les limites de la `CRichEditCtrl` sélection actuelle dans cet objet.

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>Paramètres

*Cr*<br/>
Référence à une structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) pour recevoir les limites de la sélection actuelle.

*nStartChar (en)*<br/>
Indice zéro du premier personnage de la sélection actuelle.

*nEndChar (en)*<br/>
Indice zéro du dernier personnage de la sélection actuelle.

### <a name="remarks"></a>Notes

Les deux formes de cette fonction offrent d’autres moyens d’obtenir les limites pour la sélection. Voici de brèves descriptions de ces formulaires :

- **GetSel(** `cr` **)** Ce formulaire `CHARRANGE` utilise la `cpMin` `cpMax` structure avec ses et ses membres pour retourner les limites.

- **GetSel(** `nStartChar` **,** `nEndChar` **)** Ce formulaire renvoie les limites dans les paramètres *nStartChar* et *nEndChar*.

La sélection comprend tout`cpMin` si le début ( ou *nStartChar*) est de 0 et la fin (`cpMax` ou *nEndChar*) est - 1.

Pour plus d’informations, voir [EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) message et la structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a>CRichEditCtrl::GetSelectionCharFormat

Obtient les attributs de formatage de caractère de la sélection actuelle.

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Paramètres

*Cf*<br/>
Dans la première version, un pointeur à une structure [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) pour recevoir les attributs de formatage de caractères de la sélection actuelle.

Dans la deuxième version, un pointeur vers une structure [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) qui `CHARFORMAT` est une extension Rich Edit 2.0 à la structure pour recevoir les attributs de formatage de caractère de la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Le `dwMask` membre des données de *cf*. Il spécifie les attributs de formatage des personnages qui sont cohérents tout au long de la sélection actuelle.

### <a name="remarks"></a>Notes

Le paramètre *cf* reçoit les attributs du premier personnage de la sélection actuelle. La valeur de rendement spécifie quels attributs sont cohérents tout au long de la sélection.

Pour plus d’informations, consultez le `CHARFORMAT` message `CHARFORMAT2` [EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple de [SetSelectionCharFormat](#setselectioncharformat).

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a>CRichEditCtrl::GetSelectionType

Détermine le type de `CRichEditCtrl` sélection dans cet objet.

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>Valeur de retour

Drapeaux indiquant le contenu de la sélection actuelle. Une combinaison des drapeaux suivants :

- SEL_EMPTY indique qu’il n’y a pas de sélection actuelle.

- SEL_TEXT indique que la sélection actuelle contient du texte.

- SEL_OBJECT indique que la sélection actuelle contient au moins un élément OLE.

- SEL_MULTICHAR indique que la sélection actuelle contient plus d’un caractère de texte.

- SEL_MULTIOBJECT indique que la sélection actuelle contient plus d’un objet OLE.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a>CRichEditCtrl::GetSelText

Récupère le texte de la `CRichEditCtrl` sélection actuelle dans cet objet.

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>Paramètres

*lpBuf*<br/>
Pointeur vers le tampon pour recevoir le texte dans la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Dépend de la forme:

- **GetSelText(** `lpBuf` **)** Le nombre de caractères copiés dans *lpBuf*, sans compter la résiliation nulle.

- **GetSelText( )** La chaîne contenant la sélection actuelle.

### <a name="remarks"></a>Notes

Si vous utilisez le premier formulaire, **GetSelText(** `lpBuf` **)**, vous devez vous assurer que le tampon est assez grand pour le texte qu’il recevra. Appelez [GetSel](#getsel) pour déterminer le nombre de caractères dans la sélection actuelle.

Pour plus d’informations, voir [EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CRichEditCtrl:GetSelectionType](#getselectiontype).

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a>CRichEditCtrl::GetTextLength

Récupère la longueur du texte, en `CRichEditCtrl` caractères, dans cet objet, sans compter le caractère nul de fin.

```
long GetTextLength() const;
```

### <a name="return-value"></a>Valeur de retour

La longueur du texte `CRichEditCtrl` dans cet objet.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a>CRichEditCtrl::GetTextLengthEx

Calcule la longueur du texte dans le contrôle de modification riche.

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>Paramètres

*dwFlags*<br/>
Valeur spécifiant la méthode à utiliser pour déterminer la longueur du texte. Ce membre peut être une ou plusieurs des valeurs énumérées dans le membre des drapeaux de [GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex) décrit dans le SDK Windows.

*uCodePage*<br/>
Page de code pour la traduction (CP_ACP pour la page de code ANSI, 1200 pour Unicode).

### <a name="return-value"></a>Valeur de retour

Nombre de caractères ou d’octets dans le contrôle de modification. Si des drapeaux incompatibles ont été placés dans *dwFlags*, cette fonction membre retourne E_INVALIDARG.

### <a name="remarks"></a>Notes

`GetTextLengthEx`fournit des moyens supplémentaires de déterminer la durée du texte. Il prend en charge la fonctionnalité Rich Edit 2.0. Voir [à propos de Rich Edit Controls](/windows/win32/Controls/about-rich-edit-controls) in the Windows SDKfor plus d’informations.

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a>CRichEditCtrl::GetTextMode

Récupère le mode texte actuel et annule le niveau d’un contrôle d’édition riche.

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>Valeur de retour

Un ensemble de drapeaux bits du type de recensement [TEXTMODE,](/windows/win32/api/richedit/ne-richedit-textmode) tel que décrit dans le SDK Windows. Les drapeaux indiquent le mode texte actuel et annulent le niveau du contrôle.

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a>CRichEditCtrl::GetTextRange

Obtient la gamme spécifiée de caractères.

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>Paramètres

*nFirst*<br/>
L’index de position de caractère immédiatement précédant le premier caractère de la plage.

*nLast (en)*<br/>
La position du personnage immédiatement après le dernier personnage de la gamme.

*refString*<br/>
Une référence à un objet [CString](../../atl-mfc-shared/reference/cstringt-class.md) qui recevra le texte.

### <a name="return-value"></a>Valeur de retour

Le nombre de caractères copiés, sans compter le caractère nul de fin.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) dans le SDK Windows.

`GetTextRange`prend en charge la fonctionnalité Rich Edit 2.0. Voir [à propos de Rich Edit Controls](/windows/win32/Controls/about-rich-edit-controls) in the Windows SDKfor plus d’informations.

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a>CRichEditCtrl::GetUndoName

Récupère le type de la prochaine action disponible dans la file d’attente annuler, le cas échéant.

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>Valeur de retour

Si une action défaire est dans la `GetUndoName` file d’attente de défaire du contrôle, renvoie le type de recensement [UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid) indiquant le type de l’action suivante dans la file d’attente. Si la file d’attente est vide, ou si l’action `GetUndoName` annuler dans la file d’attente est d’un type inconnu, retourne 0.

### <a name="remarks"></a>Notes

Les types d’actions qui peuvent être annulés ou refaits comprennent les opérations de dactylographie, de suppression, de goutte de traînée, de coupe et de pâte. Ces informations peuvent être utiles pour les applications qui fournissent une interface utilisateur étendue pour les opérations Annuler et refaire, telles qu’une boîte de liste d’abandon des actions qui peuvent être annulées.

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a>CRichEditCtrl::GetWordWrapMode

Récupère les options actuelles d’emballage de mots et de rupture de mot pour le contrôle d’édition riche.

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>Valeur de retour

Les options actuelles d’emballage de mot et de rupture de mot. Ces options sont décrites dans [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) dans le SDK Windows.

### <a name="remarks"></a>Notes

Cette fonction de membre n’est disponible que pour les versions en langue asiatique du système d’exploitation.

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a>CRichEditCtrl::HideSelection

Modifie la visibilité de la sélection.

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>Paramètres

*bHide (en)*<br/>
Indique si la sélection doit être affichée ou cachée, VRAI pour masquer la sélection.

*bPerm (en)*<br/>
Indique si ce changement de visibilité pour la sélection doit être permanent.

### <a name="remarks"></a>Notes

Lorsque *bPerm* est VRAI, il change l’option ECO_NOHIDESEL pour cet `CRichEditCtrl` objet. Pour une brève description de cette option, voir [SetOptions](#setoptions). Vous pouvez utiliser cette fonction pour `CRichEditCtrl` définir toutes les options pour cet objet.

Pour plus d’informations, voir [EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a>CRichEditCtrl::LimitText

Limite la longueur du texte que l’utilisateur peut entrer dans un contrôle de modification.

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>Paramètres

*nChars (nChars)*<br/>
Spécifie la longueur (dans les octets) du texte que l’utilisateur peut entrer. Si ce paramètre est de 0 (la valeur par défaut), la longueur du texte est réglée à 64K octets.

### <a name="remarks"></a>Notes

La modification de la limite de texte restreint uniquement le texte que l’utilisateur peut entrer. Il n’a aucun effet sur un texte déjà dans le contrôle de modification, ni n’affecte la `CWnd`longueur du texte copié au contrôle de modification par la fonction [membre SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) dans . Si une application `SetWindowText` utilise la fonction pour placer plus de texte `LimitText`dans un contrôle de modification que ce qui est spécifié dans l’appel, l’utilisateur peut supprimer n’importe quel texte dans le contrôle de modification. Toutefois, la limite de texte empêchera l’utilisateur de remplacer le texte existant par un nouveau texte, à moins que la suppression de la sélection actuelle ne fait tomber le texte en dessous de la limite de texte.

> [!NOTE]
> Pour la limite de texte, chaque élément OLE compte comme un seul caractère.

Pour plus d’informations, voir [EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a>CRichEditCtrl::LineDeChar

Récupère le numéro de ligne de la ligne qui contient l’index de caractère spécifié.

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>Paramètres

*nIndex*<br/>
Contient la valeur d’index zéro pour le caractère désiré dans le texte du contrôle de modification, ou contient -1. Si *nIndex* est -1, il spécifie la ligne actuelle, c’est-à-dire la ligne qui contient le caret.

### <a name="return-value"></a>Valeur de retour

Le numéro de ligne à base nulle de la ligne contenant l’indice de caractère spécifié par *nIndex*. Si *nIndex* est de -1, le nombre de la ligne qui contient le premier caractère de la sélection est retourné. S’il n’y a pas de sélection, le numéro de ligne actuel est retourné.

### <a name="remarks"></a>Notes

Un index de caractère est le nombre de caractères dès le début du riche contrôle d’édition. Pour le comptage des personnages, un élément OLE est compté comme un seul personnage.

Pour plus d’informations, voir [EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a>CRichEditCtrl::LineIndex

Récupère l’index de caractère `CRichEditCtrl` d’une ligne à l’intérieur de cet objet.

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>Paramètres

*nLine (en)*<br/>
Contient la valeur indicative de la ligne souhaitée dans le texte du contrôle de modification, ou contient -1. Si *nLine* est de -1, il spécifie la ligne actuelle, c’est-à-dire la ligne qui contient le caret.

### <a name="return-value"></a>Valeur de retour

L’index de caractère de la ligne spécifié dans *nLine* ou -1 si le numéro de ligne spécifié est plus élevé que le nombre de lignes dans le contrôle de modification.

### <a name="remarks"></a>Notes

L’index de caractère est le nombre de caractères depuis le début du contrôle d’édition riche à la ligne spécifiée.

Pour plus d’informations, voir [EM_LINEINDEX](/windows/win32/controls/em-lineindex) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a>CRichEditCtrl::LineLength

Récupère la longueur d’une ligne dans un contrôle d’édition riche.

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>Paramètres

*nLine (en)*<br/>
Spécifie l’index de caractère d’un personnage de la ligne dont la longueur doit être récupérée. Si ce paramètre est de -1, la longueur de la ligne actuelle (la ligne qui contient le caret) est retournée, sans compter la longueur d’un texte sélectionné dans la ligne. Lorsqu’il `LineLength` est appelé pour un contrôle de modification à une seule ligne, ce paramètre est ignoré.

### <a name="return-value"></a>Valeur de retour

Lorsqu’il `LineLength` est demandé pour un contrôle de modification à plusieurs lignes, la valeur de retour est la longueur (dans TCHAR) de la ligne spécifiée par *nLine*.  Il n’inclut pas le caractère de transport-retour à la fin de la ligne. Lorsqu’il `LineLength` est appelé pour un contrôle de modification à une seule ligne, la valeur de retour est la longueur (dans TCHAR) du texte dans le contrôle de modification. Si nLine est supérieure au nombre de caractères dans le contrôle, la valeur de retour est nulle.

### <a name="remarks"></a>Notes

Utilisez la fonction membre [LineIndex](#lineindex) pour récupérer un index `CRichEditCtrl` de caractère pour un numéro de ligne donné dans cet objet.

Pour plus d’informations, voir [EM_LINELENGTH](/windows/win32/Controls/em-linelength) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [LineIndex](#lineindex).

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a>CRichEditCtrl::LineScroll

Faites défiler le texte d’un contrôle de modification à plusieurs lignes.

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>Paramètres

*nLines*<br/>
Spécifie le nombre de lignes à défiler verticalement.

*nChars (nChars)*<br/>
Spécifie le nombre de positions de caractères à défiler horizontalement. Cette valeur est ignorée si le contrôle d’édition riche a soit le ES_RIGHT ou ES_CENTER style. [Les styles d’édition](../../mfc/reference/styles-used-by-mfc.md#edit-styles) sont spécifiés dans [Create](#create).

### <a name="remarks"></a>Notes

Le contrôle de modification ne défile pas verticalement au-delà de la dernière ligne de texte dans le contrôle de modification. Si la ligne actuelle plus le nombre de lignes spécifiées par *nLines* dépasse le nombre total de lignes dans le contrôle de modification, la valeur est ajustée de sorte que la dernière ligne du contrôle de modification est défichée en haut de la fenêtre de modification-contrôle.

`LineScroll`peut être utilisé pour faire défiler horizontalement le dernier caractère de n’importe quelle ligne.

Pour plus d’informations, voir [EM_LINESCROLL](/windows/win32/Controls/em-linescroll) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [GetFirstVisibleLine](#getfirstvisibleline).

## <a name="cricheditctrlpaste"></a><a name="paste"></a>CRichEditCtrl::Paste

Insère les données du `CRichEditCtrl` Clipboard dans le point d’insertion, l’emplacement du caret.

```
void Paste();
```

### <a name="remarks"></a>Notes

Les données ne sont insérées que si le Clipboard contient des données dans un format reconnu.

Pour plus d’informations, voir [WM_PASTE](/windows/win32/dataxchg/wm-paste) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a>CRichEditCtrl::PasteSpecial

Colle les données dans un format `CRichEditCtrl` Clipboard spécifique dans cet objet.

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>Paramètres

*nClipFormat (en)*<br/>
Format Clipboard à coller `CRichEditCtrl` dans cet objet.

*dvAspect*<br/>
Aspect de l’appareil pour que les données soient récupérées à partir du Clipboard.

*Hmf*<br/>
Poignée au metafile contenant la vue iconique de l’objet à coller.

### <a name="remarks"></a>Notes

Le nouveau matériau est inséré au point d’insertion, l’emplacement du caret.

Pour plus d’informations, voir [EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a>CRichEditCtrl::PosFromChar

Récupère les coordonnées de la zone client d’un personnage spécifié dans un contrôle de modification.

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>Paramètres

*Nchar*<br/>
L’index zéro du personnage.

### <a name="return-value"></a>Valeur de retour

La position du personnage, (x, y). Pour un contrôle de modification à une seule ligne, la y-coordinate est toujours nulle.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) dans le SDK Windows.

## <a name="cricheditctrlredo"></a><a name="redo"></a>CRichEditCtrl::Redo

Refait la prochaine action dans la file d’attente de la refonte du contrôle.

```
BOOL Redo();
```

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Pour plus d’informations, voir [EM_REDO](/windows/win32/Controls/em-redo) dans le SDK Windows.

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a>CRichEditCtrl::ReplaceSel

Remplace la sélection actuelle `CRichEditCtrl` dans cet objet par le texte spécifié.

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>Paramètres

*lpszNewText*<br/>
Pointeur vers une chaîne non terminée contenant le texte de remplacement.

*bCanUndo (en)*<br/>
Pour spécifier que cette fonction peut être annulée, définissez la valeur de ce paramètre à TRUE. La valeur par défaut est FALSE.

### <a name="remarks"></a>Notes

Pour remplacer tout le `CRichEditCtrl` texte de cet objet, utilisez [CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

S’il n’y a pas de sélection actuelle, le texte de remplacement est inséré au point d’insertion, c’est-à-dire l’emplacement actuel des soins.

Cette fonction formatera le texte inséré avec le formatage de caractère existant. Lors du remplacement de l’ensemble `SetSel`de la gamme de texte `ReplaceSel`(en appelant (0,1) avant d’appeler), il ya une fin de caractère paragraphe qui conserve le formatage du paragraphe précédent, qui dans hérité par le texte nouvellement inséré.

Pour plus d’informations, voir [EM_REPLACESEL](/windows/win32/Controls/em-replacesel) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [LineIndex](#lineindex).

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a>CRichEditCtrl::RequestResize

Force `CRichEditCtrl` cet objet à envoyer EN_REQUESTRESIZE messages de notification à sa fenêtre parente.

```
void RequestResize();
```

### <a name="remarks"></a>Notes

Cette fonction est utile pendant [CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize) traitement pour un objet sans `CRichEditCtrl` fond.

Pour plus d’informations, consultez le [message EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize) et la section **Bottomless Rich Edit Controls** de About Rich Edit [Controls](/windows/win32/Controls/about-rich-edit-controls) dans le SDK Windows.

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a>CRichEditCtrl::SetAutoURLDetect

Définit le contrôle d’édition riche pour détecter automatiquement une URL.

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Paramètres

*bEnable*<br/>
Précise si le contrôle est configuré pour détecter automatiquement une URL. Si VRAI, il est activé. Si FALSE, il est désactivé.

### <a name="return-value"></a>Valeur de retour

Zéro en cas de succès, sinon nonzero. Par exemple, le message peut échouer en raison d’une mémoire insuffisante.

### <a name="remarks"></a>Notes

Si activé, le contrôle d’édition riche analysera le texte pour déterminer s’il correspond à un format URL standard. Pour une liste de ces formats URL, voir [EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) dans le SDK Windows.

> [!NOTE]
> Ne définissez `SetAutoURLDetect` pas à VRAI si votre contrôle de modification utilise l’effet CFE_LINK pour le texte autre que les URL. `SetAutoURLDetect`permet cet effet pour les URL et le désactive pour tous les autres textes. Consultez [EN_LINK](/windows/win32/Controls/en-link) pour plus d’informations sur l’effet CFE_LINK.

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a>CRichEditCtrl::SetBackgroundColor

Définit la couleur `CRichEditCtrl` de fond pour cet objet.

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>Paramètres

*bSysColor (en)*<br/>
Indique si la couleur de fond doit être réglée à la valeur du système. Si cette valeur est VRAI, *cr* est ignoré.

*Cr*<br/>
La couleur de fond demandée. Utilisé uniquement si *bSysColor* est FALSE.

### <a name="return-value"></a>Valeur de retour

La couleur de `CRichEditCtrl` fond précédente pour cet objet.

### <a name="remarks"></a>Notes

La couleur de fond peut être réglée à la valeur du système ou à une valeur [COLORREF](/windows/win32/gdi/colorref) spécifiée.

Pour plus d’informations, voir [EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) message et la structure [COLORREF](/windows/win32/gdi/colorref) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a>CRichEditCtrl::SetDefaultCharFormat

Définit les attributs de formatage `CRichEditCtrl` de caractère pour le nouveau texte dans cet objet.

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*Cf*<br/>
Dans la première version, un pointeur à une structure [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) contenant les nouveaux attributs de formatage de caractère par défaut.

Dans la deuxième version, un pointeur vers une structure [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) qui `CHARFORMAT` est une extension Rich Edit 2.0 à la structure, contenant les attributs de formatage de caractère par défaut.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Seuls les attributs `dwMask` spécifiés par le membre de *cf* sont modifiés par cette fonction.

Pour plus d’informations, consultez le `CHARFORMAT` message `CHARFORMAT2` [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a>CRichEditCtrl::SetEventMask

Définit le masque `CRichEditCtrl` d’événement pour cet objet.

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>Paramètres

*dwEventMask dwEventMask*<br/>
Le nouveau masque `CRichEditCtrl` d’événement pour cet objet.

### <a name="return-value"></a>Valeur de retour

Le masque de l’événement précédent.

### <a name="remarks"></a>Notes

Le masque d’événement précise `CRichEditCtrl` les messages de notification que l’objet envoie à sa fenêtre parente.

Pour plus d’informations, voir [EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a>CRichEditCtrl::SetModify

Définit ou efface le drapeau modifié pour un contrôle de modification.

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Paramètres

*bModifié*<br/>
Une valeur de TRUE indique que le texte a été modifié, et une valeur de FALSE indique qu’il n’est pas modifié. Par défaut, le drapeau modifié est défini.

### <a name="remarks"></a>Notes

Le drapeau modifié indique si le texte dans le contrôle de modification a été modifié. Il est automatiquement défini chaque fois que l’utilisateur modifie le texte. Sa valeur peut être récupérée avec la fonction membre [GetModify.](#getmodify)

Pour plus d’informations, voir [EM_SETMODIFY](/windows/win32/Controls/em-setmodify) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [GetModify](#getmodify).

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a>CRichEditCtrl::SetOLECallback

Donne `CRichEditCtrl` à `IRichEditOleCallback` cet objet un objet à utiliser pour accéder aux ressources et aux informations liées à l’OL.

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>Paramètres

*pCallback*<br/>
Pointeur vers un objet [IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) que cet `CRichEditCtrl` objet utilisera pour obtenir des ressources et des informations liées à l’OLE.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Cet `CRichEditCtrl` objet appellera [IUnknown::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) pour incrémenter le nombre d’utilisation pour l’objet COM spécifié par *pCallback*.

Pour plus d’informations, voir [EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback) message et [l’interface IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback) dans le SDK Windows.

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a>CRichEditCtrl::SetOptions

Définit les options `CRichEditCtrl` pour cet objet.

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>Paramètres

*Wop*<br/>
Indique le type d’opération. L’une des valeurs suivantes :

- ECOOP_SET Définir les options à celles spécifiées par *dwFlags*.

- ECOOP_OR Combinez les options actuelles avec celles spécifiées par *dwFlags*.

- ECOOP_AND Conserver uniquement les options actuelles qui sont également spécifiées par *dwFlags*.

- ECOOP_XOR logiquement exclusive OU les options actuelles avec celles spécifiées par *dwFlags*.

*dwFlags*<br/>
Options d’édition riches. Les valeurs du drapeau sont énumérées dans la section Remarques.

### <a name="remarks"></a>Notes

Les options peuvent être une combinaison des valeurs suivantes :

- ECO_AUTOWORDSELECTION Sélection automatique de mots en double clic.

- ECO_AUTOVSCROLL défile automatiquement le texte vers la droite par 10 caractères lorsque l’utilisateur tape un personnage à la fin de la ligne. Lorsque l’utilisateur appuie sur la touche ENTER, le contrôle fait défiler tout le texte vers zéro.

- ECO_AUTOHSCROLL fait défiler automatiquement le texte vers le haut d’une page lorsque l’utilisateur appuie sur la touche ENTER sur la dernière ligne.

- ECO_NOHIDESEL annule le comportement par défaut pour un contrôle de modification. Le comportement par défaut cache la sélection lorsque le contrôle perd la mise au point d’entrée et affiche la sélection lorsque le contrôle reçoit la mise au point d’entrée. Si vous spécifiez ECO_NOHIDESEL, le texte sélectionné est inversé, même si le contrôle n’a pas la mise au point.

- ECO_READONLY empêche l’utilisateur de taper ou d’éditer du texte dans le contrôle de modification.

- ECO_WANTRETURN précise qu’un retour de chariot doit être inséré lorsque l’utilisateur appuie sur la clé ENTER tout en entrant du texte dans un contrôle d’édition riche en lignes multiples dans une boîte de dialogue. Si vous ne spécifiez pas ce style, appuyer sur la touche ENTER envoie une commande à la fenêtre parente du contrôle d’édition riche, qui imite en cliquant sur le bouton par défaut de la fenêtre parente (par exemple, le bouton OK dans une boîte de dialogue). Ce style n’a aucun effet sur un contrôle de modification à une seule ligne.

- ECO_SAVESEL préserve la sélection lorsque le contrôle perd la mise au point. Par défaut, l’ensemble du contenu du contrôle est sélectionné lorsqu’il retrouve la mise au point.

- ECO_VERTICAL dessine du texte et des objets dans une direction verticale. Disponible uniquement pour les langues asiatiques.

Pour plus d’informations, voir [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a>CRichEditCtrl::SetParaFormat

Définit les attributs de formatage du `CRichEditCtrl` paragraphe pour la sélection actuelle dans cet objet.

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>Paramètres

*Pf*<br/>
Dans la première version, un pointeur à une structure [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat) contenant les nouveaux attributs de formatage de paragraphe par défaut.

Dans la deuxième version, un pointeur vers une structure [PARAFORMAT2,](/windows/win32/api/richedit/ns-richedit-paraformat2) qui `PARAFORMAT` est une extension Rich Edit 2.0 à la structure, tenant les attributs de formatage de caractère par défaut.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Seuls les attributs `dwMask` spécifiés par le membre de *pf* sont modifiés par cette fonction.

Pour plus d’informations, consultez le `PARAFORMAT` `PARAFORMAT2` [message EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a>CRichEditCtrl::SetPunctuation

Définit la ponctuation dans un contrôle d’édition riche.

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>Paramètres

*fType*<br/>
Le drapeau de ponctuation. Pour une liste de valeurs possibles, voir le *paramètre fType* pour [EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation) dans le SDK Windows.

*lpPunc (lpPunc)*<br/>
Un pointeur vers une structure [PUNCTUATION,](/windows/win32/api/richedit/ns-richedit-punctuation) tel que décrit dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès, sinon 0.

### <a name="remarks"></a>Notes

Cette fonction de membre n’est disponible que pour les versions en langue asiatique du système d’exploitation.

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a>CRichEditCtrl::SetReadOnly

Modifie l’option ECO_READONLY pour `CRichEditCtrl` cet objet.

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>Paramètres

*bReadOnly*<br/>
Indique si `CRichEditCtrl` cet objet ne doit être lu que.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Pour une brève description de cette option, voir [SetOptions](#setoptions). Vous pouvez utiliser cette fonction pour `CRichEditCtrl` définir toutes les options pour cet objet.

Pour plus d’informations, voir [EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a>CRichEditCtrl::SetRect

Définit le rectangle de `CRichEditCtrl` formatage pour cet objet.

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>Paramètres

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md) ou pointeur à un [RECT](/windows/win32/api/windef/ns-windef-rect) qui indique les nouvelles limites pour le rectangle de formatage.

### <a name="remarks"></a>Notes

Le rectangle de formatage est le rectangle limitant pour le texte. Le rectangle limitant est indépendant de la taille de la fenêtre de contrôle d’édition riche. Lorsque `CRichEditCtrl` cet objet est créé pour la première fois, le rectangle de formatage est de la même taille que la zone client de la fenêtre. Utilisez `SetRect` pour rendre le rectangle de formatage plus grand ou plus petit que la fenêtre d’édition riche.

Pour plus d’informations, voir [EM_SETRECT](/windows/win32/Controls/em-setrect) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a>CRichEditCtrl::SetSel

Définit la sélection `CRichEditCtrl` dans cet objet.

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>Paramètres

*nStartChar (en)*<br/>
Indice zéro du premier personnage pour la sélection.

*nEndChar (en)*<br/>
Indice zéro du dernier personnage de la sélection.

*Cr*<br/>
[Structure CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) qui détient les limites de la sélection actuelle.

### <a name="remarks"></a>Notes

Les deux formes de cette fonction offrent d’autres moyens de définir les limites de la sélection. Voici de brèves descriptions de ces formulaires :

- **SetSel(** `cr` **)** Ce formulaire `CHARRANGE` utilise la `cpMin` `cpMax` structure avec ses et ses membres pour définir les limites.

- **SetSel(** `nStartChar` **,** `nEndChar` **)** Ce formulaire utilise les paramètres *nStartChar* et *nEndChar* pour définir les limites.

Le caret est placé à la fin de la`cpMin` sélection indiquée par le`cpMax` plus grand des indices de départ ( ou *nStartChar*) et fin ( ou *nEndChar*). Cette fonction fait défiler `CRichEditCtrl` le contenu de la sorte que le caret est visible.

Pour sélectionner tout le `CRichEditCtrl` texte `SetSel` de cet objet, appelez avec un index de démarrage de 0 et un indice final de - 1.

Pour plus d’informations, voir [EM_EXSETSEL](/windows/win32/Controls/em-exsetsel) message et la structure [CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [GetSel](#getsel).

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a>CRichEditCtrl::SetSelectionCharFormat

Définit les attributs de formatage de caractère `CRichEditCtrl` pour le texte dans la sélection actuelle dans cet objet.

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*Cf*<br/>
Dans la première version, un pointeur à une structure [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) contenant les nouveaux attributs de formatage de caractère pour la sélection actuelle.

Dans la deuxième version, un pointeur vers une structure [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) qui `CHARFORMAT` est une extension Rich Edit 2.0 à la structure, contenant les nouveaux attributs de formatage de caractère pour la sélection actuelle.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Seuls les attributs `dwMask` spécifiés par le membre de *cf* sont modifiés par cette fonction.

Pour plus d’informations, voir `CHARFORMAT` les `CHARFORMAT2` [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a>CRichEditCtrl::SetTargetDevice

Définit le dispositif cible et la largeur de la ligne utilisés pour WYSIWYG (ce que vous voyez est ce que vous obtenez) formatage dans cet `CRichEditCtrl` objet.

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>Paramètres

*Hdc*<br/>
Gérer le contexte de l’appareil pour le nouvel appareil cible.

*lLineWidth (en)*<br/>
Largeur de ligne à utiliser pour le formatage.

*Dc*<br/>
[CDC](../../mfc/reference/cdc-class.md) pour le nouvel appareil cible.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Si cette fonction est réussie, le contrôle d’édition riche possède le contexte de l’appareil passé comme un paramètre. Dans ce cas, la fonction d’appel ne doit pas détruire le contexte de l’appareil.

Pour plus d’informations, voir [EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a>CRichEditCtrl::SetTextMode

Définit le mode texte ou annuler et refaire le niveau pour un contrôle de modification riche.

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>Paramètres

*fMode*<br/>
Spécifie les nouveaux paramètres du mode texte du contrôle et annulez les paramètres de niveau. Pour une liste des valeurs possibles, consultez le paramètre de mode pour [EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Zéro en cas de succès, sinon nonzero.

### <a name="remarks"></a>Notes

Pour une description des modes texte, voir EM_SETTEXTMODE dans le SDK Windows.

Cette fonction de membre échoue si le contrôle contient du texte. Pour vous assurer que le contrôle est vide, envoyez un [message WM_SETTEXT](/windows/win32/winmsg/wm-settext) avec une ficelle vide.

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a>CRichEditCtrl::SetUndoLimit

Définit le nombre maximum d’actions qui peuvent être stockées dans la file d’attente.

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>Paramètres

*nLimit (en)*<br/>
Spécifie le nombre maximum d’actions qui peuvent être stockées dans la file d’attente annuler. Réglé à zéro pour désactiver Annuler.

### <a name="return-value"></a>Valeur de retour

Le nouveau nombre maximum d’actions annuler pour le contrôle de modification riche.

### <a name="remarks"></a>Notes

Par défaut, le nombre maximum d’actions dans la file d’attente annuler est de 100. Si vous augmentez ce nombre, il doit y avoir suffisamment de mémoire disponible pour accueillir le nouveau nombre. Pour de meilleures performances, définissez la limite à la plus petite valeur possible.

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a>CRichEditCtrl::SetWordCharFormat

Définit les attributs de formatage de `CRichEditCtrl` caractère pour le mot actuellement sélectionné dans cet objet.

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Paramètres

*Cf*<br/>
Dans la première version, un pointeur à une structure [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata) contenant les nouveaux attributs de formatage de caractère pour le mot actuellement sélectionné.

Dans la deuxième version, un pointeur vers une structure [CHARFORMAT2,](/windows/win32/api/richedit/ns-richedit-charformat2w) qui `CHARFORMAT` est une extension Rich Edit 2.0 à la structure, contenant les nouveaux attributs de formatage de caractère pour le mot actuellement sélectionné.

### <a name="return-value"></a>Valeur de retour

Nonzero en cas de succès; autrement, 0.

### <a name="remarks"></a>Notes

Seuls les attributs `dwMask` spécifiés par le membre de *cf* sont modifiés par cette fonction.

Pour plus d’informations, consultez le `CHARFORMAT` message `CHARFORMAT2` [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) et les structures et les structures dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a>CRichEditCtrl::SetWordWrapMode

Définit les options d’emballage de mots et de rupture de mots pour le contrôle d’édition riche.

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>Paramètres

*uFlags*<br/>
Les options à définir pour l’emballage de mot et la rupture de mot. Pour une liste d’options possibles, voir [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) dans le SDK Windows.

### <a name="return-value"></a>Valeur de retour

Les options actuelles d’emballage de mots et de rupture de mots.

### <a name="remarks"></a>Notes

Ce message n’est disponible que dans les versions en langue asiatique du système d’exploitation.

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a>CRichEditCtrl::StopGroupTyping

Empêche le contrôle de collecter des actions de frappe supplémentaires dans l’action annuler en cours.

```
void StopGroupTyping();
```

### <a name="remarks"></a>Notes

Le contrôle stocke l’action de frappe suivante, le cas échéant, dans une nouvelle action dans la file d’attente annuler.

Pour plus d’informations, voir [EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) dans le SDK Windows.

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a>CRichEditCtrl::StreamIn

Remplace le texte `CRichEditCtrl` de cet objet par le texte du flux d’entrée spécifié.

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Paramètres

*nFormat (en)*<br/>
Drapeaux spécifiant les formats de données d’entrée. Pour plus d'informations, consultez la section Remarques.

*es es*<br/>
[Structure EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) spécifiant le flux d’entrée. Pour plus d'informations, consultez la section Remarques.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères lus à partir du flux d’entrées.

### <a name="remarks"></a>Notes

La valeur de *nFormat* doit être l’une des suivantes :

- SF_TEXT indique uniquement la lecture du texte.

- SF_RTF indique la lecture du texte et le formatage.

L’une ou l’autre de ces valeurs peut être combinée à SFF_SELECTION. Si SFF_SELECTION est spécifiée, `StreamIn` remplace la sélection actuelle par le contenu du flux d’entrée. S’il n’est pas spécifié, `StreamIn` `CRichEditCtrl` remplace l’ensemble du contenu de cet objet.

Dans `EDITSTREAM` le paramètre *es*, vous spécifiez une fonction de rappel qui remplit un tampon avec du texte. Cette fonction de rappel est appelée à plusieurs reprises, jusqu’à ce que le flux d’entrée soit épuisé.

Pour plus d’informations, voir [EM_STREAMIN](/windows/win32/Controls/em-streamin) message et la structure [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a>CRichEditCtrl::StreamOut

Écrit le contenu `CRichEditCtrl` de cet objet au flux de sortie spécifié.

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Paramètres

*nFormat (en)*<br/>
Drapeaux spécifiant les formats de données de sortie. Pour plus d'informations, consultez la section Remarques.

*es es*<br/>
[Structure EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) spécifiant le flux de sortie. Pour plus d'informations, consultez la section Remarques.

### <a name="return-value"></a>Valeur de retour

Nombre de caractères écrits sur le flux de sortie.

### <a name="remarks"></a>Notes

La valeur de *nFormat* doit être l’une des suivantes :

- SF_TEXT indique uniquement l’écriture de texte.

- SF_RTF indique l’écriture de texte et le formatage.

- SF_RTFNOOBJS indique l’écriture de texte et de formatage, en remplaçant les éléments OLE par des espaces.

- SF_TEXTIZED indique l’écriture de texte et de formatage, avec des représentations textuelles d’éléments OLE.

N’importe lequel de ces valeurs peut être combiné avec SFF_SELECTION. Si SFF_SELECTION est spécifiée, `StreamOut` écrit la sélection actuelle dans le flux de sortie. S’il n’est pas spécifié, `StreamOut` `CRichEditCtrl` écrit l’ensemble du contenu de cet objet.

Dans `EDITSTREAM` le paramètre *es*, vous spécifiez une fonction de rappel qui remplit un tampon avec du texte. Cette fonction de rappel est appelée à plusieurs reprises, jusqu’à ce que le flux de sortie soit épuisé.

Pour plus d’informations, voir [EM_STREAMOUT](/windows/win32/Controls/em-streamout) message et la structure [EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream) dans le SDK Windows.

### <a name="example"></a>Exemple

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a>CRichEditCtrl::Undo

Annule la dernière opération dans le contrôle de modification riche.

```
BOOL Undo();
```

### <a name="return-value"></a>Valeur de retour

Nonzero si l’opération de défaire est réussie; autrement, 0.

### <a name="remarks"></a>Notes

Une opération annulée peut également être annulée. Par exemple, vous pouvez restaurer le texte `Undo`supprimé avec le premier appel à . Tant qu’il n’y a pas d’opération de modification `Undo`intermédiaire, vous pouvez supprimer le texte à nouveau avec un deuxième appel à .

Pour plus d’informations, voir [EM_UNDO](/windows/win32/Controls/em-undo) dans le SDK Windows.

### <a name="example"></a>Exemple

  Voir l’exemple pour [CanUndo](#canundo).

## <a name="see-also"></a>Voir aussi

[Échantillon MFC WORDPAD](../../overview/visual-cpp-samples.md)<br/>
[CWnd, classe](../../mfc/reference/cwnd-class.md)<br/>
[Graphique hiérarchique](../../mfc/hierarchy-chart.md)<br/>
[CEdit Class](../../mfc/reference/cedit-class.md)<br/>
[Classe CRichEditView](../../mfc/reference/cricheditview-class.md)
