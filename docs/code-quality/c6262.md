---
title: C6262
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- C6262
helpviewer_keywords:
- C6262
ms.assetid: 3eddc74e-2b05-4159-a093-fd469fdcebbb
ms.openlocfilehash: 3e26670ed039171bc316f81379df22321eb6828e
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/29/2020
ms.locfileid: "91498859"
---
# <a name="c6262"></a>C6262

> AVERTISSEMENT C6262 : la fonction utilise *constant1* octets de la pile : dépasse/Analyze : STACKSIZE *Constant2*. Envisagez de déplacer certaines données vers le tas

Cet avertissement indique que l’utilisation de la pile qui dépasse un seuil prédéfini (*Constant2*) a été détectée dans une fonction. La taille de frame de pile par défaut pour cet avertissement est 16 Ko pour le mode utilisateur, 1 Ko pour le mode noyau. La pile, même en mode utilisateur, est limitée et l’échec de la validation d’une page de la pile provoque une exception de dépassement de capacité de la pile. Le mode noyau a une limite de taille de pile de 12 Ko, qui ne peut pas être augmentée. par conséquent, le code en mode noyau doit limiter de manière agressive l’utilisation de la pile.

Pour corriger le problème qui sous-tend cet avertissement, vous pouvez déplacer des données vers le tas ou vers une autre mémoire dynamique.  En mode utilisateur, un grand frame de pile peut ne pas être un problème, et cet avertissement peut être supprimé, mais un grand frame de pile augmente le risque d’un dépassement de capacité de la pile. (Un grand frame de pile peut se produire si la fonction utilise largement la pile ou est récursive.) La taille totale de la pile en mode utilisateur peut être augmentée si le dépassement de capacité de la pile se produit en réalité, mais uniquement jusqu’à la limite du système.  Vous pouvez utiliser l' **`/analyze`** option de ligne de commande pour modifier la valeur de *Constant2*, mais l’accentuation entraîne un risque qu’une erreur ne soit pas signalée.

Pour le code en mode noyau (par exemple, dans les projets de pilote), la valeur de *Constant2* est définie sur 1 Ko. Les pilotes bien écrits doivent avoir très peu de fonctions qui approchent cette valeur, et la modification de la limite à la baisse peut être souhaitable.  Les techniques générales utilisées pour le code en mode utilisateur afin de réduire la taille de la pile peuvent être adaptées au code en mode noyau.

## <a name="example"></a>Exemple

Le code suivant génère cet avertissement, car `char buffer` alloue 16 382 octets, et la variable de type entier local `i` alloue 4 octets, qui dépassent ensemble la limite de taille de la pile par défaut de 16 Ko.

```cpp
// cl.exe /c /analyze /EHsc /W4
#include <windows.h>
#define MAX_SIZE 16382

void f( )
{
    int i;
    char buffer[MAX_SIZE];

    i = 0;
    buffer[0]='\0';

    // code...
}
```

Le code suivant corrige cet avertissement en déplaçant certaines données vers le tas.

```cpp
// cl.exe /c /analyze /EHsc /W4
#include <stdlib.h>
#include <malloc.h>
#define MAX_SIZE 16382

void f( )
{
    int i;
    char *buffer;

    i = 0;
    buffer = (char *) malloc( MAX_SIZE );
    if (buffer != NULL)
    {
        buffer[0] = '\0';
        // code...
        free(buffer);
    }
}
```

L’utilisation de `malloc` et `free` présentent de nombreux pièges en termes de fuites de mémoire et d’exceptions. Pour éviter l’ensemble de ces types de fuites et de problèmes d’exception, utilisez les mécanismes fournis par la bibliothèque STL (C++ Standard Template Library). Il s’agit notamment de [`shared_ptr`](../standard-library/shared-ptr-class.md) , [`unique_ptr`](../standard-library/unique-ptr-class.md) et [`vector`](../standard-library/vector.md) . Pour plus d’informations, consultez [pointeurs intelligents](../cpp/smart-pointers-modern-cpp.md) et [bibliothèque standard C++](../standard-library/cpp-standard-library-reference.md).

### <a name="to-correct-this-warning-by-adjusting-the-stack-size"></a>Pour corriger cet avertissement en ajustant la taille de la pile

1. Dans la barre de menus, choisissez Propriétés du **projet**  >  **Properties**.

1. Dans la boîte de dialogue **pages de propriétés** , sélectionnez la page de propriétés ligne de commande des **Propriétés de configuration**  >  **C/C++**  >  **Command Line** .

1. Dans **options supplémentaires**, ajoutez *`/analyze:stacksize32768`* .

## <a name="see-also"></a>Voir aussi

- [`/STACK` (Allocations de la pile)](../build/reference/stack-stack-allocations.md)
- [`_resetstkoflw`](../c-runtime-library/reference/resetstkoflw.md)
- [Comment : utiliser les contrôles natifs au moment de l’exécution](/visualstudio/debugger/how-to-use-native-run-time-checks)
